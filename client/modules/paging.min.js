Fancy.modules.paging=!0,Fancy.Mixin("Fancy.store.mixin.Paging",{initPaging(){const e=this;void 0!==e.paging&&(Fancy.isObject(e.paging)&&Fancy.apply(e,e.paging),e.calcPages())},firstPage(){const e=this;e.calcPages(),e.showPage=0,"server"===e.pageType?e.loadPage():e.changeDataView({stoppedFilter:!0})},prevPage(){const e=this;e.calcPages(),e.showPage--,e.showPage<0&&(e.showPage=0),"server"===e.pageType?e.loadPage():e.changeDataView({stoppedFilter:!0})},nextPage(){const e=this;e.calcPages(),e.showPage++,e.showPage===e.pages&&e.showPage--,e.showPage<0&&(e.showPage=0),"server"===e.pageType?e.loadPage():e.changeDataView({stoppedFilter:!0})},lastPage(){const e=this;e.calcPages(),e.showPage=e.pages-1,e.showPage<0&&(e.showPage=0),"server"===e.pageType?e.loadPage():e.changeDataView({stoppedFilter:!0})},calcPages(){var e,a=this;switch(a.widget.paging.pageOverFlowType){case void 0:case"last":e="last";break;case"first":e="first"}if("server"===a.pageType){if(a.pages=Math.ceil(a.getTotal()/a.pageSize),!isNaN(a.showPage)&&a.showPage>a.pages)return"last"===e?(a.showPage=Math.floor(a.getTotal()/a.pageSize)-1,a.showPage<0&&(a.showPage=0)):a.showPage=0,"needs reload"}else a.pages=Math.ceil(a.getTotal()/a.pageSize);a.showPage>=a.pages&&(a.showPage="last"===e?a.pages-1:0),a.showPage<0&&(a.showPage=0),a.fire("changepages",a.showPage)},setPage(e,a){const t=this;t.showPage=e,t.showPage===t.pages&&t.showPage--,t.showPage<0&&(t.showPage=0),"server"===t.pageType?t.loadPage():!1!==a&&t.changeDataView({stoppedFilter:!0})},refresh(){const e=this;"server"===e.pageType?e.loadPage():e.changeDataView({stoppedFilter:!0})},processPagingData(e){const a=this,t=a.widget;void 0!==e.totalCount&&(a.totalCount=e.totalCount),a.checkPagingType(e),!1===a.proxy.wrapper||void 0===e[a.readerRootProperty]?a.setData(e):a.setData(e[a.readerRootProperty]),t.stateIsWaiting?a.calcPages():(a.changeDataView({stoppedFilter:!0}),"needs reload"===a.calcPages()&&a.loadPage())},checkPagingType(e){const a=this;void 0!==e.totalCount&&e.totalCount!==e[a.readerRootProperty].length&&(a.totalCount=e.totalCount,a.pageType="server",void 0===a.remoteSort&&(a.remoteSort=!0))},loadPage(){this.loadData()},setPageSize(e){const a=this,t=a.widget;a.pageSize=e,a.calcPages(),"server"===a.pageType?a.loadPage():a.changeDataView({stoppedFilter:!0}),t.fire("changepagesize",e)}}),function(){const e=Fancy,a=e.PANEL_TBAR_CLS,t=e.PANEL_BBAR_CLS,s=e.PANEL_BAR_PAGING_CLS;Fancy.define("Fancy.grid.plugin.Paging",{extend:Fancy.Plugin,ptype:"grid.paging",inWidgetName:"paging",barType:"bbar",constructor:function(){this.Super("const",arguments)},init(){this.Super("init",arguments),this.ons()},ons(){const e=this,a=e.widget,t=a.store;t.on("change",e.onChangeStore,e),t.on("remove",e.onChangeStore,e),t.on("filter",e.onChangeStore,e),a.on("render",e.onRenderGrid,e),a.on("docmove",e.onDocMouseMove,e),a.on("render",()=>e.setCls())},setPageSize(e){this.widget.store.setPageSize(e),this.widget.update()},nextPage(){this.widget.store.nextPage(),this.widget.update()},lastPage(){this.widget.store.lastPage(),this.widget.update()},prevPage(){this.widget.store.prevPage(),this.widget.update()},firstPage(){this.widget.store.firstPage(),this.widget.update()},onChangeStore(e){var a=this,t=a.widget,s=t.store,g=t.panel;switch(a.barType){case"both":g._bbar.roles.pagenumber.setValue(s.showPage+1),g._tbar.roles.pagenumber.setValue(s.showPage+1),a.updateBar("tbar"),a.updateBar("bbar");break;case"none":case!1:break;default:g["_"+a.barType].roles.pagenumber.setValue(s.showPage+1),a.updateBar()}t.setSidesHeight(),void 0===a.$prevPage?t.fire("changepage",e.showPage):a.$prevPage!==e.showPage&&t.fire("changepage",e.showPage),a.$prevPage=e.showPage},setPage(e,a){const t=this.widget,s=t.store;return e<0?e=0:e>s.pages&&(e=s.pages),s.setPage(e,a),t.update(),e},refresh(){const e=this.widget,a=e.store;e.showLoadMask(),setTimeout(()=>{a.refresh(),"server"!==a.pageType&&e.hideLoadMask()},200)},updateBar(e){e=e||this.barType;var a=this.widget,t=a.store,s=t.showPage,g=t.pageSize,o=t.pages,i=a.panel["_"+e],r=i.roles,n=r.pagenumber,p=r.ofText,h=r.info,l=r.first,d=r.prev,c=r.next,P=r.last,w=s*g+1,u=w+g-1,b=t.getTotal()||0,y=a.lang;u>b&&(u=b),0===u&&(w=0),w>u&&(u=w),n.setValue(t.showPage+1),p.el.update(Fancy.String.format(y.paging.of,[o||1])),h.el.update(Fancy.String.format(y.paging.info,[w,u,b])),0===s?(l.disable(),d.disable()):(l.enable(),d.enable()),o-1===s||0===o?(P.disable(),c.disable()):(P.enable(),c.enable()),parseInt(a.el.css("width"))<350&&(h.hide(),i.checkScroll())},onRenderGrid(){const e=this;switch(e.barType){case"both":e.updateBar("tbar"),e.updateBar("bbar");break;case"none":case!1:break;default:e.updateBar()}},onDocMouseMove(){const e=this,a=e.widget;"none"===a.el.css("display")||a.panel&&a.panel.el&&"none"===a.panel.el.css("display")?e.wasHidden||(Fancy.combo.Manager.hideLists(),e.wasHidden=!0):e.wasHidden=!1},update(){const e=this.widget.store;e.calcPages(),this.onChangeStore(e)},setCls(){const e=this,g=e.widget;switch(e.barType){case"bbar":g.panel.el.select("."+t).addCls(s);break;case"tbar":g.panel.el.select("."+a).addCls(s);break;case"both":g.panel.el.select("."+t).addCls(s),g.panel.el.select("."+a).addCls(s)}}})}();