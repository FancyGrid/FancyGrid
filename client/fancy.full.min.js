/*
All of the code within the FancyGrid software is developed and copyrighted by FancyGrid, Inc., and may not be copied,
replicated, or used in any other software or application without prior permission from FancyGrid. All usage must coincide with the
FancyGrid End User License Agreement which can be requested by email at support@fancygrid.com.

Build: 1.7.76
*/

!function(a,b){"object"==typeof module&&module.exports?module.exports=a.document?b(a):b:a.Fancy=b(a)}("undefined"!=typeof window?window:this,function(win){var Fancy={global:window,version:"1.7.76",site:"fancygrid.com",COLORS:["#9DB160","#B26668","#4091BA","#8E658E","#3B8D8B","#ff0066","#eeaaee","#55BF3B","#DF5353","#7798BF","#aaeeee"]};return window.Fancy=Fancy,Fancy.apply=function(a,b){if(void 0!==b)for(var c in b)a[c]=b[c]},Fancy.applyIf=function(a,b){for(var c in b)void 0===a[c]&&(a[c]=b[c])},Fancy.namespace=function(){for(var a=0,b=arguments.length;a<b;a++){var c=arguments[a],d=c.split("."),e=1,f=d.length;Fancy.global[d[0]]=Fancy.global[d[0]]||{};for(var g=Fancy.global[d[0]];e<f;e++)g[d[e]]=g[d[e]]||{},g=g[d[e]]}},Fancy.ns=Fancy.namespace,Fancy.typeOf=function(a){if(null===a)return"null";var b=typeof a;if("undefined"===b||"string"===b||"number"===b||"boolean"===b)return b;var c=Object.prototype.toString,d=c.call(a);if(void 0!==a.length&&"function"!=typeof a)return"array";switch(d){case"[object Array]":return"array";case"[object Date]":return"date";case"[object Boolean]":return"boolean";case"[object Number]":return"number";case"[object RegExp]":return"regexp"}return"function"===b?"function":"object"===b?"object":void 0},Fancy.isArray="isArray"in Array?Array.isArray:function(a){var b=Object.prototype.toString;return"[object Array]"===b.call(a)},Fancy.isObject=function(a){var b=Object.prototype.toString;return"[object Object]"===b.call(a)},Fancy.isFunction=function(a){var b=Object.prototype.toString;return"[object Function]"===b.apply(a)},Fancy.isString=function(a){return"string"==typeof a},Fancy.isNumber=function(a){return"number"==typeof a&&isFinite(a)},Fancy.isDom=function(a){try{return a instanceof HTMLElement}catch(b){return"object"==typeof a&&1===a.nodeType&&"object"==typeof a.style&&"object"==typeof a.ownerDocument}},Fancy.isBoolean=function(a){return"boolean"==typeof a},Fancy.isDate=function(a){return"date"===Fancy.typeOf(a)},Fancy.each=function(a,b){switch(Fancy.typeOf(a)){case"array":case"string":for(var c=0,d=a.length;c<d&&!0!==b(a[c],c,a);c++);break;case"object":for(var e in a)if(!0===b(a[e],e,a))break}},Fancy.mixin=function(a,b){var c,d=0,e=b.length;if("object"===Fancy.typeOf(b[0]))for(;d<e;d++){c=b[d];for(var f=c._class,g=c.methods,h=0,i=g.length;h<i;h++){var j=g[h];a[j]=f.prototype[j]}}else for(;d<e;d++)if(c=b[d],Fancy.isString(c)){var k=Fancy.ClassManager.getMixin(c);k?Fancy.apply(a,k.prototype):Fancy.ClassManager.waitMixin(c,a)}else Fancy.apply(a,c.prototype)},Fancy.Mixin=function(a,b){var c=a.split("."),d=1,e=c.length-1;Fancy.ns(a);for(var f=Fancy.global[c[0]];d<e;d++)f=f[c[d]];c.length>1?(f[c[c.length-1]]=function(){},f[c[c.length-1]].prototype=b):(Fancy.global[c[0]]=function(){},Fancy.global[c[0]].prototype=b);var g=Fancy.ClassManager.waitMixins[a];if(g)for(g=g.waiters,d=0,e=g.length;d<e;d++)Fancy.apply(g[d],b)},Fancy.applyConfig=function(a,b){var c;if(b=b||{},a.plugins&&b.plugins&&(a.plugins=a.plugins.concat(b.plugins),delete b.plugins),!0===a._isConfigApplied)return a;for(c in b)a[c]=b[c];return a._isConfigApplied=!0,a},Fancy.styleToString=function(a){var b="";a=a||{};for(var c in a)b+=c+": "+a[c]+";";return b},Fancy.apply(Fancy,{prefix:"fancy-gen-",idSeed:0,zIndex:1,id:function(a,b){return a?(a=a.dom||{},a.id||(a.id=(b||Fancy.prefix)+ ++Fancy.idSeed),a.id):(b||Fancy.prefix)+ ++Fancy.idSeed}}),Fancy.apply(Fancy,{cls:"fancy",TOUCH_CLS:"fancy-touch",HIDDEN_CLS:"fancy-display-none",CLEARFIX_CLS:"fancy-clearfix",MODAL_CLS:"fancy-modal",PANEL_CLS:"fancy-panel",PANEL_BODY_CLS:"fancy-panel-body",PANEL_BODY_INNER_CLS:"fancy-panel-body-inner",PANEL_GRID_INSIDE_CLS:"fancy-panel-grid-inside",PANEL_SHADOW_CLS:"fancy-panel-shadow",PANEL_SUB_HEADER_CLS:"fancy-panel-sub-header",PANEL_SUB_HEADER_TEXT_CLS:"fancy-panel-sub-header-text",PANEL_HEADER_CLS:"fancy-panel-header",PANEL_HEADER_IMG_CLS:"fancy-panel-header-img",PANEL_HEADER_TEXT_CLS:"fancy-panel-header-text",PANEL_HEADER_TOOLS_CLS:"fancy-panel-header-tools",PANEL_TBAR_CLS:"fancy-panel-tbar",PANEL_BBAR_CLS:"fancy-panel-bbar",PANEL_SUB_TBAR_CLS:"fancy-panel-sub-tbar",PANEL_BUTTONS_CLS:"fancy-panel-buttons",PANEL_NOFRAME_CLS:"fancy-panel-noframe",PANEL_FOOTER_CLS:"fancy-panel-footer",PANEL_TAB_CLS:"fancy-panel-tab",PANEL_DRAGGABLE_CLS:"fancy-panel-draggable",BAR_CLS:"fancy-bar",BAR_TEXT_CLS:"fancy-bar-text",BAR_CONTAINER_CLS:"fancy-bar-container",BAR_BUTTON_CLS:"fancy-bar-button",BAR_SEG_BUTTON_CLS:"fancy-bar-seg-button",BAR_LEFT_SCROLLER_CLS:"fancy-bar-left-scroller",BAR_RIGHT_SCROLLER_CLS:"fancy-bar-right-scroller",FORM_CLS:"fancy-form",FORM_BODY_CLS:"fancy-form-body",FIELD_CLS:"fancy-field",FIELD_LABEL_CLS:"fancy-field-label",FIELD_EMPTY_CLS:"fancy-field-empty",FIELD_DISABLED_CLS:"fancy-field-disabled",FIELD_BLANK_ERR_CLS:"fancy-field-blank-err",FIELD_NOT_VALID_CLS:"fancy-field-not-valid",FIELD_TEXT_CLS:"fancy-field-text",FIELD_TEXT_INPUT_CLS:"fancy-field-text-input",FIELD_ERROR_CLS:"fancy-field-error",FIELD_SPIN_CLS:"fancy-field-spin",FIELD_SPIN_UP_CLS:"fancy-field-spin-up",FIELD_SPIN_DOWN_CLS:"fancy-field-spin-down",FIELD_CHECKBOX_CLS:"fancy-field-checkbox",FIELD_CHECKBOX_DISABLED_CLS:"fancy-field-checkbox-disabled",FIELD_CHECKBOX_INPUT_CLS:"fancy-field-checkbox-input",FIELD_CHECKBOX_ON_CLS:"fancy-checkbox-on",FIELD_CHECKBOX_MIDDLE_CLS:"fancy-checkbox-middle",FIELD_INPUT_LABEL_CLS:"fancy-field-input-label",FIELD_BUTTON_CLS:"fancy-field-button",FIELD_TAB_CLS:"fancy-field-tab",FIELD_COMBO_CLS:"fancy-combo",FIELD_COMBO_SELECTED_ITEM_CLS:"fancy-combo-item-selected",FIELD_COMBO_FOCUSED_ITEM_CLS:"fancy-combo-item-focused",FIELD_COMBO_DROPDOWN_BUTTON_CLS:"fancy-combo-dropdown-button",FIELD_COMBO_INPUT_CONTAINER_CLS:"fancy-combo-input-container",FIELD_COMBO_LIST_VALUE_CLS:"fancy-combo-list-value",FIELD_COMBO_LEFT_EL_CLS:"fancy-combo-left-el",FIELD_COMBO_RESULT_LIST_CLS:"fancy-combo-result-list",FIELD_SEARCH_CLS:"fancy-field-search",FIELD_SEARCH_LIST_CLS:"fancy-field-search-list",FIELD_SEARCH_PARAMS_LINK_CLS:"fancy-field-search-params-link",FIELD_SEARCH_PARAMED_CLS:"fancy-field-search-paramed",FIELD_SEARCH_PARAMED_EMPTY_CLS:"fancy-field-search-paramed-empty",FIELD_PICKER_BUTTON_CLS:"fancy-field-picker-button",FIELD_LABEL_ALIGN_TOP_CLS:"fancy-field-label-align-top",FIELD_LABEL_ALIGN_RIGHT_CLS:"fancy-field-label-align-right",FIELD_TEXTAREA_CLS:"fancy-textarea",FIELD_TEXTAREA_TEXT_CLS:"fancy-textarea-text",FIELD_TEXTAREA_TEXT_INPUT_CLS:"fancy-textarea-text-input",FIELD_RADIO_CLS:"fancy-field-radio",FIELD_RADIO_COLUMN_CLS:"fancy-field-radio-column",FIELD_RADIO_ON_CLS:"fancy-field-radio-on",FIELD_RADIO_INPUT_CLS:"fancy-field-radio-input",FIELD_TAB_ACTIVE_CLS:"fancy-field-tab-active",GRID_CLS:"fancy-grid",GRID_ANIMATION_CLS:"fancy-grid-animation",GRID_UNSELECTABLE_CLS:"fancy-grid-unselectable",GRID_EMPTY_CLS:"fancy-grid-empty-text",GRID_LEFT_EMPTY_CLS:"fancy-grid-left-empty",GRID_RIGHT_EMPTY_CLS:"fancy-grid-right-empty",GRID_CENTER_CLS:"fancy-grid-center",GRID_LEFT_CLS:"fancy-grid-left",GRID_RIGHT_CLS:"fancy-grid-right",GRID_RESIZER_LEFT_CLS:"fancy-grid-resizer-left",GRID_RESIZER_RIGHT_CLS:"fancy-grid-resizer-right",GRID_STATE_DRAG_COLUMN_CLS:"fancy-grid-state-drag-column",GRID_STATE_RESIZE_COLUMN_CLS:"fancy-grid-state-resize-column",GRID_COPY_TEXTAREA:"fancy-grid-copy-textarea",GRID_HEADER_CLS:"fancy-grid-header",GRID_HEADER_CELL_CLS:"fancy-grid-header-cell",GRID_HEADER_CELL_CONTAINER_CLS:"fancy-grid-header-cell-container",GRID_HEADER_CELL_TEXT_CLS:"fancy-grid-header-cell-text",GRID_HEADER_CELL_DOUBLE_CLS:"fancy-grid-header-cell-double",GRID_HEADER_CELL_TRIPLE_CLS:"fancy-grid-header-cell-triple",GRID_HEADER_CELL_TRIGGER_CLS:"fancy-grid-header-cell-trigger",GRID_HEADER_CELL_TRIGGER_IMAGE_CLS:"fancy-grid-header-cell-trigger-image",GRID_HEADER_CELL_TRIGGER_DISABLED_CLS:"fancy-grid-header-cell-trigger-disabled",GRID_HEADER_CELL_GROUP_LEVEL_1_CLS:"fancy-grid-header-cell-group-level-1",GRID_HEADER_CELL_GROUP_LEVEL_2_CLS:"fancy-grid-header-cell-group-level-2",GRID_HEADER_CELL_SELECT_CLS:"fancy-grid-header-cell-select",GRID_HEADER_CELL_TRIGGER_UP_CLS:"fancy-grid-header-cell-trigger-up",GRID_HEADER_CELL_TRIGGER_DOWN_CLS:"fancy-grid-header-cell-trigger-down",GRID_HEADER_COLUMN_TRIGGERED_CLS:"fancy-grid-header-column-triggered",GRID_HEADER_CELL_FILTER_CLS:"fancy-grid-header-filter-cell",GRID_HEADER_CELL_FILTER_FULL_CLS:"fancy-grid-header-filter-cell-full",GRID_HEADER_CELL_FILTER_SMALL_CLS:"fancy-grid-header-filter-cell-small",GRID_HEADER_CELL_CHECKBOX_CLS:"fancy-grid-header-cell-checkbox",GRID_HEADER_CELL_SORTABLE_CLS:"fancy-grid-header-cell-sortable",GRID_HEADER_CELL_NOT_SORTABLE_CLS:"fancy-grid-header-cell-not-sortable",GRID_CELL_CLS:"fancy-grid-cell",GRID_CELL_INNER_CLS:"fancy-grid-cell-inner",GRID_CELL_OVER_CLS:"fancy-grid-cell-over",GRID_CELL_SELECTED_CLS:"fancy-grid-cell-selected",GRID_CELL_ACTIVE_CLS:"fancy-grid-cell-active",GRID_CELL_EVEN_CLS:"fancy-grid-cell-even",GRID_CELL_WRAPPER_CLS:"fancy-grid-cell-wrapper",GRID_CELL_DIRTY_CLS:"fancy-grid-cell-dirty",GRID_CELL_DIRTY_EL_CLS:"fancy-grid-cell-dirty-el",GRID_PSEUDO_CELL_CLS:"fancy-grid-pseudo-cell",GRID_COLUMN_CLS:"fancy-grid-column",GRID_COLUMN_OVER_CLS:"fancy-grid-column-over",GRID_COLUMN_SELECT_CLS:"fancy-grid-column-select",GRID_COLUMN_SELECTED_CLS:"fancy-grid-column-selected",GRID_COLUMN_ELLIPSIS_CLS:"fancy-grid-column-ellipsis",GRID_COLUMN_ORDER_CLS:"fancy-grid-column-order",GRID_COLUMN_TEXT_CLS:"fancy-grid-column-text",GRID_COLUMN_SORT_ASC:"fancy-grid-column-sort-ASC",GRID_COLUMN_SORT_DESC:"fancy-grid-column-sort-DESC",GRID_COLUMN_COLOR_CLS:"fancy-grid-column-color",GRID_COLUMN_RESIZER_CLS:"fancy-grid-column-resizer",GRID_COLUMN_ROW_DRAG_CLS:"fancy-grid-column-row-drag",GRID_ROW_DRAG_EL_CLS:"fancy-grid-row-drag-el",GRID_COLUMN_TREE_CLS:"fancy-grid-column-tree",GRID_COLUMN_TREE_EXPANDER_CLS:"fancy-grid-tree-expander",GRID_COLUMN_SPARKLINE_CLS:"fancy-grid-column-sparkline",GRID_COLUMN_SPARKLINE_BULLET_CLS:"fancy-grid-column-sparkline-bullet",GRID_COLUMN_SPARK_PROGRESS_DONUT_CLS:"fancy-grid-column-spark-progress-donut",GRID_COLUMN_CHART_CIRCLE_CLS:"fancy-grid-column-chart-circle",GRID_COLUMN_GROSSLOSS_CLS:"fancy-grid-column-grossloss",GRID_COLUMN_PROGRESS_CLS:"fancy-grid-column-progress",GRID_COLUMN_PROGRESS_BAR_CLS:"fancy-grid-column-progress-bar",GRID_COLUMN_H_BAR_CLS:"fancy-grid-column-h-bar",GRID_COLUMN_ACTION_ITEM_CLS:"fancy-grid-column-action-item",GRID_ROW_OVER_CLS:"fancy-grid-cell-over",GRID_ROW_EDIT_CLS:"fancy-grid-row-edit",GRID_ROW_EDIT_BUTTONS_CLS:"fancy-grid-row-edit-buttons",GRID_ROW_EDIT_BUTTON_UPDATE_CLS:"fancy-edit-row-button-update",GRID_ROW_EDIT_BUTTON_CANCEL_CLS:"fancy-edit-row-button-cancel",GRID_ROW_GROUP_CLS:"fancy-grid-group-row",GRID_ROW_GROUP_INNER_CLS:"fancy-grid-group-row-inner",GRID_ROW_GROUP_COLLAPSED_CLS:"fancy-grid-group-row-collapsed",GRID_ROW_SUMMARY_CLS:"fancy-grid-summary-row",GRID_ROW_SUMMARY_CONTAINER_CLS:"fancy-grid-summary-container",GRID_ROW_SUMMARY_BOTTOM_CLS:"fancy-grid-summary-row-bottom",GRID_ROW_EXPAND_CLS:"fancy-grid-expand-row",GRID_ROW_EXPAND_OVER_CLS:"fancy-grid-expand-row-over",GRID_ROW_EXPAND_SELECTED_CLS:"fancy-grid-expand-row-selected",GRID_BODY_CLS:"fancy-grid-body",MENU_CLS:"fancy-menu",MENU_ITEM_CLS:"fancy-menu-item",MENU_ITEM_IMAGE_CLS:"fancy-menu-item-image",MENU_ITEM_TEXT_CLS:"fancy-menu-item-text",MENU_ITEM_SIDE_TEXT_CLS:"fancy-menu-item-side-text",MENU_ITEM_ACTIVE_CLS:"fancy-menu-item-active",MENU_ITEM_RIGHT_IMAGE_CLS:"fancy-menu-item-right-image",MENU_ITEM_EXPAND_CLS:"fancy-menu-item-expand",MENU_ITEM_DISABLED_CLS:"fancy-menu-item-disabled",MENU_ITEM_SEP_CLS:"fancy-menu-item-sep",MENU_ITEM_NO_IMAGE_CLS:"fancy-menu-item-no-image",MENU_ITEM_IMG_COPY_CLS:"fancy-menu-item-img-copy",MENU_ITEM_IMG_DELETE_CLS:"fancy-menu-item-img-delete",MENU_ITEM_IMG_DUPLICATE_CLS:"fancy-menu-item-img-duplicate",MENU_ITEM_IMG_EDIT_CLS:"fancy-menu-item-img-edit",TAB_WRAPPER_CLS:"fancy-tab-wrapper",TAB_ACTIVE_WRAPPER_CLS:"fancy-active-tab-wrapper",TAB_TBAR_CLS:"fancy-toolbar-tab",TAB_TBAR_ACTIVE_CLS:"fancy-toolbar-tab-active",BUTTON_CLS:"fancy-button",BUTTON_DISABLED_CLS:"fancy-button-disabled",BUTTON_PRESSED_CLS:"fancy-button-pressed",BUTTON_IMAGE_CLS:"fancy-button-image",BUTTON_IMAGE_COLOR_CLS:"fancy-button-image-color",BUTTON_TEXT_CLS:"fancy-button-text",BUTTON_DROP_CLS:"fancy-button-drop",BUTTON_MENU_CLS:"fancy-button-menu",SEG_BUTTON_CLS:"fancy-seg-button",TOOLTIP_CLS:"fancy-tooltip",TOOLTIP_INNER_CLS:"fancy-tooltip-inner",SEPARATOR_CLS:"fancy-separator",FOOTER_STATUS_CLS:"fancy-footer-status",STATUS_SOURCE_TEXT_CLS:"fancy-status-source-text",STATUS_SOURCE_LINK_CLS:"fancy-status-source-link",FOOTER_SOURCE_CLS:"fancy-footer-source",PICKER_MONTH_CELL_ACTIVE_CLS:"fancy-month-picker-cell-active",PICKER_MONTH_CLS:"fancy-month-picker",PICKER_BUTTON_BACK_CLS:"fancy-picker-button-back",PICKER_BUTTON_NEXT_CLS:"fancy-picker-button-next",PICKER_MONTH_ACTION_BUTTONS_CLS:"fancy-month-picker-action-buttons",PICKER_DATE_CLS:"fancy-date-picker",PICKER_DATE_CELL_TODAY_CLS:"fancy-date-picker-cell-today",PICKER_DATE_CELL_ACTIVE_CLS:"fancy-date-picker-cell-active",PICKER_DATE_CELL_OUT_RANGE_CLS:"fancy-date-picker-cell-out-range",PICKER_BUTTON_DATE_CLS:"fancy-picker-button-date",PICKER_BUTTON_DATE_WRAPPER_CLS:"fancy-picker-button-date-wrapper",PICKER_BUTTON_TODAY_CLS:"fancy-picker-button-today",PICKER_BUTTON_TODAY_WRAPPER_CLS:"fancy-picker-button-today-wrapper"}),Fancy.ANIMATE_DURATION=400,function(){var a=navigator.userAgent.toLowerCase(),b=function(b){return b.test(a)},c=b(/opera/),d=!c&&b(/msie/),e=window.chrome,f=window.navigator,g=f.vendor,h=f.userAgent.indexOf("Edge")>-1,i=f.userAgent.match("CriOS"),j=function(){var a=f.userAgent.indexOf("OPR")>-1;return!!i||null!==e&&void 0!==e&&"Google Inc."===g&&!1===a&&!1===h}();11===function(){var a,b,c=-1;return"Microsoft Internet Explorer"==navigator.appName?(a=navigator.userAgent,b=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),null!=b.exec(a)&&(c=parseFloat(RegExp.$1))):"Netscape"==navigator.appName&&(a=navigator.userAgent,b=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})"),null!=b.exec(a)&&(c=parseFloat(RegExp.$1))),c}()&&(d=!0),!1===d&&h&&(d=!0),Fancy.apply(Fancy,{isOpera:c,isIE:d,isChrome:j}),Fancy.getViewSize=function(){var a=[];return Fancy.isIE?(a[0]=document.documentElement.clientHeight,a[1]=document.documentElement.clientWidth):(a[0]=window.innerHeight,a[1]=window.innerWidth),a},Fancy.getScroll=function(){var a=document.documentElement,b=document.body;return a&&(a.scrollTop||a.scrollLeft)?[a.scrollTop,a.scrollLeft]:b?[b.scrollTop,b.scrollLeft]:[0,0]},Fancy.getMouseWheelEventName=function(){return"onmousewheel"in document.body?"mousewheel":"DOMMouseScroll"},Fancy.getWheelDelta=function(a){var b=0;return a.wheelDelta?b=a.wheelDelta/120:a.detail&&(b=-a.detail/3),b},Fancy.isTouch=void 0!==document.ontouchstart,Fancy.i18n={},Fancy.currencies={map:{EUR:"€",USD:"$",GBP:"£",RUB:"₽",CZK:"Kč",AUD:"$",JPY:"¥",PLN:"zł",TRY:"₺",DKK:"kr",KRW:"₩",BRL:"R$",CNY:"¥",SEK:"kr",CAD:"$",NOK:"kr",IDR:"Rp"}}}(),Fancy.modules={},Fancy.getModulesList=function(){var a=[];return Fancy.each(Fancy.modules,function(b,c){a.push(c)}),a},function(){var a={};Fancy.loadModule=function(b,c){var d=document.getElementsByTagName("body")[0],e=document.createElement("script"),f=b,g=Fancy.DEBUG?".js":".min.js",h=Fancy.version.replace(/\./g,""),i=Fancy.MODULESDIR||FancyGrid.MODULESDIR||"https://cdn.fancygrid.com/@"+Fancy.version+"/modules/";c=c||function(){},!1!==Fancy.MODULELOAD&&!1!==Fancy.MODULESLOAD&&(b=b.replace(/ /g,"-"),Fancy.DEBUG?g+="?_dc="+ +new Date:g+="?_v="+h,Fancy.Modules.on("loaded",function(a,d){d===b&&(Fancy.modules[f]=!0,c(b))}),a[b]||(a[b]=!0,e.src=i+b+g,e.charset="utf-8",e.onload=function(){Fancy.Modules.fire("loaded",b)},e.onerror=function(){throw new Error("[FancyGrid error] - module "+b+" was not loaded")},d.appendChild(e)))},Fancy.loadLang=function(a,b){if(void 0!==Fancy.i18n[a])return!0;var c=document.getElementsByTagName("body")[0],d=document.createElement("script"),e=Fancy.MODULESDIR||FancyGrid.MODULESDIR||"https://cdn.fancygrid.com/@"+Fancy.version+"/modules/";d.src=e+"i18n/"+a+".js",d.charset="utf-8",d.async="true",d.onload=function(){b({lang:Fancy.i18n[a]})},c.appendChild(d)},Fancy.loadStyle=function(){var a=document.querySelectorAll("link");if(!Fancy.stylesLoaded&&(Fancy.each(a,function(a){/fancy\./.test(a.href)&&(Fancy.stylesLoaded=!0)}),a=document.querySelectorAll("link"),!Fancy.stylesLoaded&&(Fancy.each(a,function(a){/fancy\./.test(a.href)&&(Fancy.stylesLoaded=!0)}),!Fancy.stylesLoaded))){var b=document.getElementsByTagName("head")[0],c=document.createElement("link"),d=Fancy.DEBUG?".css":".min.css",e=Fancy.version.replace(/\./g,""),f=Fancy.MODULESDIR||FancyGrid.MODULESDIR||"https://cdn.fancygrid.com/@"+Fancy.version+"/modules/";f=f.replace("modules/",""),f=f.replace("modules",""),Fancy.DEBUG?d+="?_dc="+ +new Date:d+="?_v="+e,c.href=f+"fancy"+d,c.rel="stylesheet",Fancy.loadingStyle=!0,c.onload=function(){Fancy.loadingStyle=!1},b.appendChild(c)}}}(),Fancy.fullBuilt=!0,Fancy.themes={},Fancy.defineTheme=function(a,b){var c={};b.extend?Fancy.apply(c,Fancy.getTheme(b.extend).config):"default"!==a&&Fancy.apply(c,Fancy.getTheme("default").config),Fancy.apply(c,b.config),b.config=c,Fancy.themes[a]=b},Fancy.getTheme=function(a){var b={config:{}};return Fancy.isObject(a)?(Fancy.applyIf(b,Fancy.themes[a.name||"default"]),Fancy.apply(b.config,Fancy.themes[a.name||"default"].config),Fancy.apply(b.config,a.config),b):Fancy.themes[a]},Fancy.defineTheme("default",{config:{cellHeaderHeight:30,cellWidth:70,minCellWidth:40,cellHeight:32,titleHeight:42,subTitleHeight:42,barHeight:38,bottomScrollHeight:12,minCenterWidth:100,panelBorderWidth:2,groupRowHeight:31,gridBorders:[1,1,1,1],gridWithoutPanelBorders:[1,1,1,1],panelBodyBorders:[0,2,2,2],knobOffSet:2,fieldHeight:37,charWidth:7,menuItemHeight:30}}),Fancy.defineTheme("blue",{config:{panelBorderWidth:1,gridBorders:[1,1,1,1],gridWithoutPanelBorders:[1,1,1,1],panelBodyBorders:[0,0,0,0],charWidth:7,menuItemHeight:30}}),Fancy.defineTheme("gray",{config:{panelBorderWidth:0,gridBorders:[0,0,1,0],gridWithoutPanelBorders:[1,1,1,1],panelBodyBorders:[0,0,0,0],charWidth:7,menuItemHeight:30}}),Fancy.defineTheme("dark",{config:{panelBorderWidth:1,gridBorders:[0,1,1,1],gridWithoutPanelBorders:[1,1,1,1],panelBodyBorders:[0,0,0,0],charWidth:7,menuItemHeight:30}}),Fancy.defineTheme("sand",{config:{panelBorderWidth:1,gridBorders:[0,1,1,1],gridWithoutPanelBorders:[1,1,1,1],panelBodyBorders:[0,0,0,0],charWidth:7,menuItemHeight:30}}),Fancy.defineTheme("bootstrap",{config:{panelBorderWidth:1,gridBorders:[1,1,1,1],gridWithoutPanelBorders:[1,1,1,1],panelBodyBorders:[0,0,0,0],charWidth:7,menuItemHeight:30}}),Fancy.defineTheme("bootstrap-no-borders",{config:{panelBorderWidth:0,gridBorders:[0,0,0,0],gridWithoutPanelBorders:[0,0,0,0],panelBodyBorders:[0,0,0,0],columnLines:!1,charWidth:8,menuItemHeight:30}}),Fancy.defineTheme("material",{config:{columnLines:!1,cellHeaderHeight:40,panelBorderWidth:0,cellHeight:40,titleHeight:48,barHeight:48,subTitleHeight:48,groupRowHeight:40,gridBorders:[0,0,1,0],gridWithoutPanelBorders:[1,1,1,1],panelBodyBorders:[0,0,0,0],charWidth:7,menuItemHeight:35}}),Fancy.String={format:function(a){var b,c,d;if("array"===Fancy.typeOf(arguments[1]))b=arguments[1];else for(d=arguments.length,b=[],c=1;c<d;c++)b[c-1]=arguments[c];return a.replace(/\[(\d+)]/g,function(a,c){return b[c]})},upFirstChar:function(a){return a[0].toLocaleUpperCase()+a.substr(1,a.length)},trim:function(a){return a.replace(/\s/g,"")}},Fancy.Array={copy:function(a,b){if(!b)return a.slice();for(var c=[],d=0,e=a.length;d<e;d++)switch(Fancy.typeOf(a[d])){case"object":c[d]=Fancy.Object.copy(a[d]);break;case"array":c[d]=Fancy.Array.copy(a[d]);break;default:c=a[d]}return c},each:function(a,b){for(var c=0,d=a.length;c<d;c++)b(a[c],c)},count:function(a){return a.length},sum:function(a){var b=0,c=a.length,d=0;if(Fancy.isArray(a[0]))for(d=[];b<c;b++)for(var e=0,f=a[b].length;e<f;e++)void 0===d[e]&&(d[e]=0),d[e]+=a[b][e];else for(;b<c;b++)!1!==Fancy.isNumber(a[b])&&(d+=a[b]);return d},min:function(a){return Math.min.apply(this,a)},max:function(a){return Math.max.apply(this,a)},average:function(a){for(var b=0,c=0,d=a.length;c<d;c++)!1!==Fancy.isNumber(a[c])&&(b+=a[c]);return Math.round(b/a.length)},insert:function(a,b,c){var d=a.splice(b,a.length-b);return a=a.concat(c).concat(d)},none:function(){return""}},Fancy.Object={copy:function(a){var b={};for(var c in a)b[c]=a[c];return b},isEmpty:function(a){var b=!0;for(var c in a)b=!1;return b}},Fancy.Date={daysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],dayIndexes:["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],format:function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t="";if(d=d||"",null===a||void 0===a)return"";if("Invalid Date"===a.toString())return"";d=d.toLocaleLowerCase(),void 0===c?c=Fancy.i18n.en:Fancy.isString(c)&&(c=Fancy.i18n[c]);for(var u=0,v=b.length;u<v;u++){var w=b[u];switch(w){case"i":f=a.getMinutes(),t+=f<10?"0"+f:f;break;case"s":if(f=a.getSeconds(),"sql"===d){if("ss"!==b.substr(u,2))throw new Error("[FancyGrid Error] - Invalid date format: "+b);t+=f<10?"0"+f:f,u++}else t+=f<10?"0"+f:f;break;case"S":if(f=a.getSeconds(),"sql"!==d)throw new Error("[FancyGrid Error] - Invalid date format: "+b);if("SS"!==b.substr(u,2))throw new Error("[FancyGrid Error] - Invalid date format: "+b);t+=f<10?"0"+f:f,u++;break;case"a":e=a.getHours(),t+=e<13?c.date.am:c.date.pm;break;case"A":e=a.getHours(),t+=e<13?c.date.AM:c.date.PM;break;case"n":t+=a.getMonth();break;case"j":t+=a.getDate();break;case"m":if(s=a.getMonth()+1,"sql"===d)if("mm"===b.substr(u,2))s<10&&(s="0"+s),t+=s,u++;else{if("mi"!==b.substr(u,2))throw new Error("[FancyGrid Error] - Invalid date format: "+b);f=a.getMinutes(),t+=f<10?"0"+f:f,u++}else s<10&&(s="0"+s),t+=s;break;case"d":if(r=a.getDate(),"sql"===d){if("dd"!==b.substr(u,2))throw new Error("[FancyGrid Error] - Invalid date format: "+b);r<10&&(r="0"+r),t+=r,u++}else r<10&&(r="0"+r),t+=r;break;case"Y":if("sql"===d)if("YYYY"===b.substr(u,4))t+=a.getFullYear(),u+=3;else{if("YY"!==b.substr(0,2))throw new Error("[FancyGrid Error] - Invalid date format: "+b);String(a.getFullYear()).substr(2,t.length),u+=1}else t+=a.getFullYear();break;case"y":if("sql"===d)if("yyyy"===b.substr(u,4))t+=a.getFullYear(),u+=3;else{if("yy"!==b.substr(0,2))throw new Error("[FancyGrid Error] - Invalid date format: "+b);String(a.getFullYear()).substr(2,4),u+=1}else t+=String(a.getFullYear()).substr(2,4);break;case"D":if(g=a.getDay(),"sql"===d){if("DD"!==b.substr(u,2))throw new Error("[FancyGrid Error] - Invalid date format: "+b);t+=c.date.days[g].substr(0,3),u++}else t+=c.date.days[g].substr(0,3);break;case"l":h=a.getDay(),t+=c.date.days[h];break;case"N":i=a.getDay(),0===i&&(i=7),t+=i;break;case"w":j=a.getDay(),t+=j;break;case"F":k=a.getMonth(),t+=c.date.months[k];break;case"M":if(l=a.getMonth(),"sql"===d)if("MM"===b.substr(u,2))t+=c.date.months[l].substr(0,3),u+=1;else{if("MI"!==b.substr(u,2))throw new Error("[FancyGrid Error] - Invalid date format: "+b);f=a.getMinutes(),t+=f<10?"0"+f:f,u++}else t+=c.date.months[l].substr(0,3);break;case"t":"sql"===d?t+=" ":(m=new Date(a.getFullYear(),a.getMonth(),0).getDate(),t+=m);break;case"T":if("sql"!==d)throw new Error("[FancyGrid Error] - Invalid date format: "+b);t+=" ";break;case"g":n=a.getHours()%12,t+=n;break;case"G":n=a.getHours(),t+=n;break;case"h":if(e=a.getHours(),"sql"===d){if("hh"!==b.substr(u,2))throw new Error("[FancyGrid Error] - Invalid date format: "+b);t+=e>12?e-12:e>9&&e<13?e:"0"+e,u+=1}else t+=e>12?e-12:e>9&&e<13?e:"0"+e;break;case"H":if(o=a.getHours(),"sql"===d){if("HH"!==b.substr(u,2))throw new Error("[FancyGrid Error] - Invalid date format: "+b);t+=o<10?"0"+o:o,u+=1}else t+=o<10?"0"+o:o;break;case"u":p=a.getMilliseconds(),t+=p;break;case"U":q=Number(a)/1e3,t+=q;break;default:t+=w}}return t},parse:function(a,b,c){var d=new Date,e=d.getFullYear(),f=d.getMonth(),g=d.getDate(),h=0,i=0,j=0,k=0;c=c||"",c=c.toLocaleLowerCase();for(var l=0,m=b.length;l<m;l++){var n,o,p,q=b[l];switch(q){case"n":var r;"0"===a[1]||"1"===a[1]||"2"===a[1]?(r=a[0]+a[1],a=a.substr(2,a.length)):(r=a[0],a=a.substr(1,a.length)),f=Number(r);break;case"j":Fancy.isNumber(parseInt(a[1]))?(n=a[0]+a[1],a=a.substr(2,a.length)):(n=a[0],a=a.substr(1,a.length)),g=Number(n);break;case"h":if("sql"===c){if("hh"!==b.substr(l,2))throw new Error("[FancyGrid Error] - Invalid date format: "+b);var s;isNaN(Number(a[1]))?(s=a[0],a=a.substr(1,a.length)):(s=a[0]+a[1],a=a.substr(2,a.length),l+=1),h=Number(s)}else{var s;"0"===a[1]||"1"===a[1]||"2"===a[1]?(s=a[0]+a[1],a=a.substr(2,a.length)):(s=a[0],a=a.substr(1,a.length)),h=Number(s)}break;case"a":"m"===a[1]&&(h+=12),a=a.substr(2,a.length);break;case"A":"M"===a[1]&&(h+=12),a=a.substr(2,a.length);break;case"i":i=a[0]+a[1],a=a.substr(2,a.length);break;case"s":if("sql"===c){if("ss"!==b.substr(l,2))throw new Error("[FancyGrid Error] - Invalid date format: "+b);j=a[0]+a[1],a=a.substr(2,a.length),l++}else j=a[0]+a[1],a=a.substr(2,a.length);break;case"S":if("sql"===c){if("SS"!==b.substr(l,2))throw new Error("[FancyGrid Error] - Invalid date format: "+b);j=a[0]+a[1],a=a.substr(2,a.length),l++}else j=a[0]+a[1],a=a.substr(2,a.length);break;case"u":k=a[0]+a[1]+a[2],a=a.substr(3,a.length);break;case"m":if("sql"===c)if("mm"===b.substr(l,2))switch(a[0]){case"0":case"1":case"2":case"3":isNaN(parseInt(a[1]))?(f=Number(a[0])-1,a=a.substr(1,a.length)):(f=Number(a[0]+a[1])-1,a=a.substr(2,a.length)),l+=1;break;default:f=Number(a[0])-1,a=a.substr(1,a.length)}else{if("mi"!==b.substr(l,2))throw new Error("[FancyGrid Error] - Invalid date format: "+b);i=a[0]+a[1],a=a.substr(2,a.length),l++}else switch(a[0]){case"0":case"1":case"2":case"3":isNaN(parseInt(a[1]))?(f=Number(a[0])-1,a=a.substr(1,a.length)):(f=Number(a[0]+a[1])-1,a=a.substr(2,a.length));break;default:f=Number(a[0])-1,a=a.substr(1,a.length)}break;case"d":if("sql"===c){if("dd"!==b.substr(l,2))throw new Error("[FancyGrid Error] - Invalid date format: "+b);isNaN(parseInt(a[1]))?(g=Number(a[0]),a=a.substr(1,a.length)):(g=Number(a[0]+a[1]),a=a.substr(2,a.length)),l++}else isNaN(parseInt(a[1]))?(g=Number(a[0]),a=a.substr(1,a.length)):(g=Number(a[0]+a[1]),a=a.substr(2,a.length));break;case"Y":if("sql"===c)if("YYYY"===b.substr(l,4))e=Number(a[0]+a[1]+a[2]+a[3]),a=a.substr(4,a.length),l+=3;else{if("YY"!==b.substr(0,2))throw new Error("[FancyGrid Error] - Invalid date format: "+b);e=Number(a[0]+a[1]),a=a.substr(2,a.length),l+=1,e=e<51?Number("20"+e):Number("19"+e)}else e=Number(a[0]+a[1]+a[2]+a[3]),a=a.substr(4,a.length);break;case"y":if("sql"===c)if("yyyy"===b.substr(l,4))e=Number(a[0]+a[1]+a[2]+a[3]),a=a.substr(4,a.length),l+=3;else{if("yy"!==b.substr(0,2))throw new Error("[FancyGrid Error] - Invalid date format: "+b);e=Number(a[0]+a[1]),a=a.substr(2,a.length),l+=1,e=e<51?Number("20"+e):Number("19"+e)}else e=Number(a[0]+a[1]),e=e<51?Number("20"+e):Number("19"+e),a=a.substr(2,a.length);break;case"D":if("sql"===c){if("DD"!==b.substr(l,2))throw new Error("[FancyGrid Error] - Invalid date format: "+b);isNaN(parseInt(a[1]))?(g=Number(a[0]),a=a.substr(1,a.length)):(g=Number(a[0]+a[1]),a=a.substr(2,a.length)),l++}else a=a.substr(3,a.length);break;case"l":for(p=a[0]+a[1]+a[2],n=0,o=7;n<o;n++){var t=lang.days[n];if(p===t.substr(0,3)){a=a.substr(t.length,a.length);break}}break;case"N":case"w":a=a.substr(1,a.length);break;case"F":for(p=a[0]+a[1]+a[2],n=0,o=7;n<o;n++){var u=lang.months[n];if(p===u.substr(0,3)){a=a.substr(u.length,a.length);break}}break;case"M":if("sql"===c)if("MM"===b.substr(l,2))switch(a[0]){case"0":case"1":case"2":case"3":isNaN(parseInt(a[1]))?(f=Number(a[0])-1,a=a.substr(1,a.length)):(f=Number(a[0]+a[1])-1,a=a.substr(2,a.length)),l+=1;break;default:f=Number(a[0])-1,a=a.substr(1,a.length)}else{if("MI"!==b.substr(l,2))throw new Error("[FancyGrid Error] - Invalid date format: "+b);i=a[0]+a[1],a=a.substr(2,a.length),l++}else a=a.substr(3,a.length);break;case"t":a="sql"===c?a.substr(1,a.length):a.substr(2,a.length);break;case"T":if("sql"!==c)throw new Error("[FancyGrid Error] - Invalid date format: "+b);a=a.substr(1,a.length);break;case"G":Fancy.isNumber(parseInt(a[1]))?(h=Number(a[0]+a[1]),a=a.substr(2,a.length)):(h=Number(a[0]),a=a.substr(1,a.length));break;case"g":a=a.substr(1,a.length);break;case"H":if("sql"===c){if("HH"!==b.substr(l,2))throw new Error("[FancyGrid Error] - Invalid date format: "+b);var s;isNaN(Number(a[1]))?(s=a[0],a=a.substr(1,a.length)):(s=a[0]+a[1],a=a.substr(2,a.length),l+=1),h=Number(s)}else h=Number(a[0]+a[1]),a=a.substr(2,a.length);break;default:a=a.substr(1,a.length)}}return new Date(e,f,g,h,i,j,k)},getDaysInMonth:function(a){var b=a.getMonth();return 1===b&&Fancy.Date.isLeapYear(a)?29:Fancy.Date.daysInMonth[b]},getFirstDayOfMonth:function(a){var b=(a.getDay()-(a.getDate()-1))%7;return b<0?b+7:b},isLeapYear:function(a){var b=a.getFullYear();return!(0!=(3&b)||!(b%100||b%400==0&&b))},getMonthNumber:function(a,b){return new Date(a,b+1,0).getDate()}},Fancy.Number={isFloat:function(a){return Number(a)===a&&a%1!=0},getPrecision:function(a){return(a+"").split(".")[1].length+1},correctFloat:function(a){return parseFloat(a.toPrecision(14))},format:function(a,b,c){var d,e;void 0===b&&(b=","),Fancy.isNumber(b)&&(c=b,b=","),d=""===b?".":","===b?".":",";var f=a.toString().split(".");if(f[0]=f[0].replace(/\B(?=(\d{3})+(?!\d))/g,b),void 0===f[1]&&(f[1]=""),void 0!==c)if(0===c)e=f[0];else{var g=c-f[1].length;if(g>0)for(var h=0;h<g;h++)f[1]+="0";else g<0&&(f[1]=f[1].substring(0,c));e=f[0]+d+f[1]}else e=f[0],f[1].length&&(e+=d+f[1]);return e}},Fancy.Collection=function(a){var b=this;if(b.items=[],b.keys=[],b.map={},b.indexMap={},b.length=0,a)if(a.length>0)for(var c=0,d=a.length;c<d;c++)b.add(c,a[c]);else for(var e in a)b.add(e,a[e])},Fancy.Collection.prototype={add:function(a,b){var c=this;c.items.push(b),c.keys.push(a),c.map[a]=b,c.indexMap[a]=c.length,c.length++},remove:function(a){var b=this,c=b.indexMap[a];b.items.splice(c,1),b.keys.splice(c,1),delete b.indexMap[c],delete b.map[a],b.length--,b.updateIndexMap()},updateIndexMap:function(){var a=this,b=0,c=a.keys.length;for(a.indexMap={};b<c;b++)a.indexMap[a.keys[b]]=b},removeAll:function(){var a=this;a.items=[],a.keys=[],a.indexMap={},a.map={},a.length=0},get:function(a){return this.map[a]},each:function(a){for(var b=this,c=0,d=b.length;c<d;c++)a(b.keys[c],b.items[c],c,b.length)}},Fancy.Template=function(a){var b=this;Fancy.isArray(a)?b.tpl=a.join(""):b.tpl=a,b.compile()},Fancy.Template.prototype={re:/\{([\w\-]+)\}/g,getHTML:function(a){return this.compiled(a||{})},compile:function(){function fn(a,b){return"'+("+(b="values['"+b+"']")+" === undefined ? '' : "+b+")+'"}var me=this;return eval("me.compiled = function(values){ return '"+me.tpl.replace(me.re,fn)+"';};"),me}},Fancy.key={BACKSPACE:8,TAB:9,ENTER:13,RETURN:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_PLUS:107,NUM_MINUS:109,NUM_DOT:110,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,DOT:190,PAGE_UP:33,PAGE_DOWN:34},Fancy.Key={isNum:function(a){var b=Fancy.key;switch(a){case b.ZERO:case b.ONE:case b.TWO:case b.THREE:case b.FOUR:case b.FIVE:case b.SIX:case b.SEVEN:case b.EIGHT:case b.NINE:case b.NUM_ZERO:case b.NUM_ONE:case b.NUM_TWO:case b.NUM_THREE:case b.NUM_FOUR:case b.NUM_FIVE:case b.NUM_SIX:case b.NUM_SEVEN:case b.NUM_EIGHT:case b.NUM_NINE:return!0;default:return!1}},isNumControl:function(a,b){var c=Fancy.key;if(Fancy.Key.isNum(a))return!0;if(b.shiftKey&&187===a)return!0;switch(a){case c.NUM_PLUS:case 189:case c.NUM_MINUS:case c.NUM_DOT:case c.BACKSPACE:case c.DELETE:case c.TAB:case c.ENTER:case c.RETURN:case c.SHIFT:case c.CTRL:case c.ALT:case c.ESC:case c.END:case c.HOME:case c.LEFT:case c.UP:case c.RIGHT:case c.DOWN:case c.INSERT:case c.DOT:return!0;default:return!1}}},function(){var a={},b={},c=function(a,b){for(var c in b.prototype)void 0===a.prototype[c]&&(a.prototype[c]=b.prototype[c])},d=function(){this.waitMixins={}};d.prototype={items:new Fancy.Collection,add:function(a,b){var c=a.split("."),d=1,e=c.length-1;Fancy.ns(a);for(var f=Fancy.global[c[0]];d<e;d++)f=f[c[d]];c.length>1?f[c[c.length-1]]=b:Fancy.global[c[0]]=b,this.items.add(a,b)},get:function(a){return this.items.get(a)},waitMixin:function(a,b){var c=this;c.waitMixins[a]=c.waitMixins[a]||{waiters:[]},c.waitMixins[a].waiters.push(b)},getMixin:function(a){var b=a.split("."),c=1,d=b.length,e=Fancy.global[b[0]];if(void 0===e)return!1;for(;c<d;c++)if(void 0===(e=e[b[c]]))return!1;return e}},Fancy.ClassManager=new d,Fancy.define=function(d,e){e=e||{};var f=[];if(Fancy.isArray(d)&&(f=d,d=f[0]),e.constructor===Object&&(void 0===e.extend?e.constructor=function(){}:e.constructor=function(){this.Super("constructor",arguments)}),void 0===e.extend)a[d]=e.constructor;else{a[d]=e.constructor;var g;switch(typeof e.extend){case"string":g=Fancy.ClassManager.get(e.extend),a[d].prototype.$Super=Fancy.ClassManager.get(e.extend);break;case"function":g=e.extend,a[d].prototype.$Super=e.extend}delete e.extend,a[d].prototype.Super=function(a,b){var c=this;switch(c.$Iam?c.$Iam=Fancy.ClassManager.get(c.$Iam.prototype.$Super.prototype.$name):c.$Iam=Fancy.ClassManager.get(c.$Super.prototype.$name),a){case"const":case"constructor":c.$Iam.apply(c,b);break;default:c.$Iam.prototype[a].apply(c,b)}delete c.$Iam},c(a[d],g)}a[d].prototype.$name=d,e.mixins&&(Fancy.mixin(a[d].prototype,e.mixins),delete a[d].prototype.mixins),void 0!==e.plugins&&(void 0===a[d].prototype.$plugins&&(a[d].prototype.$plugins=[]),a[d].prototype.$plugins=a[d].prototype.$plugins.concat(e.plugins),delete a[d].prototype.plugins);for(var h in e)a[d].prototype[h]=e[h];var i=a[d];!0===e.singleton&&(delete a[d],i=new i(e),a[d]=i),f.length>1?Fancy.each(f,function(a){Fancy.ClassManager.add(a,i)}):Fancy.ClassManager.add(d,i),e.type?(b[e.type]=i,Fancy.addWidgetType(e.type,i)):e.ptype&&(b[e.type]=i,Fancy.addPluginByType(e.ptype,i))},Fancy.getClassByType=function(a){return b[a]}}(),Fancy.MixinClass=function(){},Fancy.MixinClass.prototype={initId:function(){var a=this,b=a.prefix||Fancy.prefix;a.id=a.id||Fancy.id(null,b),Fancy.addWidget(a.id,a)},initPlugins:function(){var a,b,c,d=this,e=d;if(d.plugins=d.plugins||[],d._plugins&&(d.plugins=d.plugins.concat(d._plugins)),void 0!==d.plugins&&(d.$plugins=d.plugins,delete d.plugins),void 0!==d.$plugins)for(var f,g=0,h=d.$plugins,i=h.length,j={};g<i;g++){c=h[g],c.widget=e;var k=c.type||c.ptype;if(!0!==j[k]){if(j[k]=!0,void 0===(a=Fancy.getPluginByType(k)))throw new Error("[FancyGrid Error] - some of module was not loaded. Grid plugin does not exist - "+k);b=new a(c),f=c.inWidgetName||b.inWidgetName,void 0!==f&&(e[f]=b)}}}},Fancy.define("Fancy.Data",{constructor:function(a){var b=this;if(b.map={},a)for(var c=0,d=a.length,e=b.map;c<d;c++)e[c]=a[c];b.length=0},add:function(a,b){this.map[a]=b,this.length++},get:function(a){return this.map[a]}}),Fancy.define("Fancy.Model",{constructor:function(a){var b=this,c={},d=b.fields||[],e=0,f=d.length;if(Fancy.isArray(a)){for(;e<f;e++){var g=d[e];c[g]=a[e]}void 0===c.id&&(Fancy.idSeed++,c.id=Fancy.idSeed+1e3),b.data=c,b.id=b.data.id}else{if(a.id?b.id=a.id:(Fancy.idSeed++,b.id=Fancy.idSeed+1e3,a.id=b.id),void 0===b.fields){d=[];for(var g in a)d.push(g);b.fields=d}for(f=d.length;e<f;e++){var g=d[e];void 0===a[g]?c[g]="":c[g]=a[g]}c.id||(b.fields.push("id"),a.id||(a.id=b.id),c.id=a.id),b.data=c}},get:function(a){var b=this;return void 0===a?b.data:b.data[a]},set:function(a,b){var c=this;if(void 0===b&&Fancy.isObject(a))for(var d in a)c.set(d,a[d]);else c.data[a]=b}}),Fancy.define("Fancy.PluginManager",{singleton:!0,constructor:function(){this.ptypes=new Fancy.Data},addPlugin:function(a,b){this.ptypes.add(a,b)},getPlugin:function(a){return this.ptypes.get(a)}}),Fancy.addPluginByType=function(a,b){Fancy.PluginManager.addPlugin(a,b)},Fancy.getPluginByType=function(a){return Fancy.PluginManager.getPlugin(a)},function(){var a=Fancy;a.define("Fancy.WidgetManager",{singleton:!0,constructor:function(){this.wtypes=new a.Data,this.widgets=new a.Data},addWidgetType:function(a,b){b.prototype.wtype=a,this.wtypes.add(a,b)},getWidgetClassByType:function(a){return this.wtypes.get(a)},addWidget:function(a,b){this.widgets.add(a,b)},getWidget:function(a){return this.widgets.get(a)}});var b=a.WidgetManager;a.addWidgetType=function(a,c){b.addWidgetType(a,c)},a.getWidgetClassByType=function(a){return b.getWidgetClassByType(a)},a.addWidget=function(a,c){b.addWidget(a,c)},a.getWidget=function(a){return b.getWidget(a)}}(),function(){var a=0,b={};Fancy.define(["Fancy.Event","Fancy.Observable"],{mixins:[Fancy.MixinClass],constructor:function(a){var b=this;if(Fancy.applyConfig(b,a||{}),b.$events={},b.listeners||b.events)for(var c=b.listeners||b.events,d=0,e=c.length;d<e;d++){var f=c[d],g=null,h=null,i=null,j=0,k=[];for(var l in f)switch(l){case"scope":i=f[l];break;case"params":k=f[l];break;case"delay":j=f[l];break;default:g=l,h=f[l]}if(null===g)throw new Error("Event was not set");switch(Fancy.typeOf(h)){case"string":h=b[h],f.handler=h,void 0===f.scope&&(i=b),f.scope=i;break;case"function":break;default:throw new Error("Handler has wrong type or not defined")}if(!1===Fancy.isArray(k))throw new Error("params must be array");b.addEvent(g),b.on(g,h,i,k,j)}},on:function(c,d,e,f,g){if(void 0===this.$events[c])throw new Error("Event name is not set: "+c);if(void 0===d)throw new Error("Handler is undefined. Name of event is "+c+".");d.$fancyFnSeed=a,b[a]=d,a++,this.$events[c].push({fn:d,scope:e,params:f||[],delay:g})},un:function(a,b){var c=this,d=c.$events[a];if(!d)return!1;for(var e=0,f=d.length;e<f;e++){var g=d[e];if(g.fn.$fancyFnSeed===b.$fancyFnSeed)return g.toRemove=!0,!0}return!1},once:function(a,b,c){var d=this,e=function(){b.apply(this,arguments),d.un(a,e)};d.on(a,e,c)},unAll:function(){this.$events={}},unAllByType:function(a){this.$events[a]=[]},fire:function(a){var b=this,c=b.$events[a];if(!c)return!1;for(var d=1,e=arguments.length,f=[b];d<e;d++)f.push(arguments[d]);for(var d=0,e=c.length;d<e;d++){var g=c[d],h=[];!0!==g.toRemove?(h=h.concat(f),g.params&&(h=h.concat(g.params)),g.delay?setTimeout(function(){g.fn.apply(g.scope||b,h)},g.delay):g.fn.apply(g.scope||b,h)):(c.splice(d,1),d--,e=c.length)}},addEvent:function(a){return this.addEvents(a)},addEvents:function(a){var b=this;if(arguments.length>1){for(var c=[],d=0,e=arguments.length;d<e;d++)c[d]=arguments[d];a=c}if("string"===Fancy.typeOf(a))b.$events[a]=b.$events[a]||[];else if("array"===Fancy.typeOf(a))for(var d=0,e=a.length;d<e;d++)b.$events[a[d]]=b.$events[a[d]]||[]},has:function(a){var b=this.$events[a];return!!b&&0!==b.length}}),Fancy.define("Fancy.Modules",{extend:Fancy.Event,singleton:!0,constructor:function(){this.Super("const",arguments),this.init()},init:function(){this.addEvents("loaded")}})}(),Fancy.modules.paging=!0,Fancy.Mixin("Fancy.store.mixin.Paging",{initPaging:function(){var a=this;void 0!==a.paging&&(Fancy.isObject(a.paging)&&Fancy.apply(a,a.paging),a.calcPages(),a.changeDataView())},firstPage:function(){var a=this;a.calcPages(),a.showPage=0,"server"===a.pageType?a.loadPage():a.changeDataView()},prevPage:function(){var a=this;a.calcPages(),a.showPage--,a.showPage<0&&(a.showPage=0),"server"===a.pageType?a.loadPage():a.changeDataView()},nextPage:function(){var a=this;a.calcPages(),a.showPage++,a.showPage===a.pages&&a.showPage--,a.showPage<0&&(a.showPage=0),"server"===a.pageType?a.loadPage():a.changeDataView()},lastPage:function(){var a=this;a.calcPages(),a.showPage=a.pages-1,a.showPage<0&&(a.showPage=0),"server"===a.pageType?a.loadPage():a.changeDataView()},calcPages:function(){var a=this;if("server"===a.pageType){var b=a.pages;if(a.pages=Math.ceil(a.getTotal()/a.pageSize),!isNaN(b)&&b>a.pages)return a.showPage=Math.floor(a.getTotal()/a.pageSize),a.showPage<0&&(a.showPage=0),"needs reload"}else a.pages=Math.ceil(a.getTotal()/a.pageSize);a.showPage>=a.pages&&(a.showPage=a.pages-1),a.showPage<0&&(a.showPage=0),a.fire("changepages",a.showPage)},setPage:function(a){var b=this;b.showPage=a,b.showPage===b.pages&&b.showPage--,b.showPage<0&&(b.showPage=0),"server"===b.pageType?b.loadPage():b.changeDataView()},refresh:function(){var a=this;"server"===a.pageType?a.loadPage():a.changeDataView()},processPagingData:function(a){var b=this;void 0!==a.totalCount&&(b.totalCount=a.totalCount),b.checkPagingType(a),b.setData(a[b.readerRootProperty]),b.changeDataView({stoppedFilter:!0}),"needs reload"===b.calcPages()&&b.loadPage()},checkPagingType:function(a){var b=this;void 0!==a.totalCount&&a.totalCount!==a[b.readerRootProperty].length&&(b.totalCount=a.totalCount,b.pageType="server",void 0===b.remoteSort&&(b.remoteSort=!0))},loadPage:function(){this.loadData()},setPageSize:function(a){var b=this,c=b.widget;b.pageSize=a,b.calcPages(),"server"===b.pageType?b.loadPage():b.changeDataView(),c.fire("changepagesize",a)}}),Fancy.modules.infinite=!0,Fancy.Mixin("Fancy.store.mixin.Infinite",{initInfinite:function(){var a=this;void 0!==a.infinite&&(Fancy.isObject(a.infinite)&&Fancy.apply(a,a.infinite),Fancy.applyIf(a,{infiniteDisplayedRows:50,infiniteScrolledToRow:0}))}}),Fancy.modules["server-data"]=!0,Fancy.Mixin("Fancy.store.mixin.Proxy",{pageParam:"page",startParam:"start",limitParam:"limit",sortParam:"sort",directionParam:"dir",keyParam:"key",valueParam:"value",filterParam:"filter",autoLoad:!0,autoSave:!0,saveOrder:["create","update","destroy"],batch:!0,filterOperators:{"<":"lt",">":"gt","<=":"lteq",">=":"gteq","=":"eq","==":"eq","===":"stricteq","!=":"noteq","!==":"notstricteq","":"like","*":"likeor","|":"or"},loadedTimes:0,initProxy:function(){var a=this,b=a.widget;a.proxy=a.data.proxy||{};var c=a.proxy;void 0!==c.autoLoad&&(a.autoLoad=c.autoLoad),void 0!==c.autoSave&&(a.autoSave=c.autoSave),void 0!==c.batch&&(a.batch=c.batch),a.initReader(),a.initWriter(),"rest"===a.proxy.type?a.initRest():(a.initServerAPI(),a.initActionMethods(),a.checkProxy()),a.autoLoad&&(b.stateful&&a.remoteFilter?b.WAIT_FOR_APPLYING_ALL_FILTERS=!0:a.loadData())},checkProxy:function(){if(void 0===this.proxy.api.read)throw new Error("[FancyGrid Error] - in data proxy there is not url")},checkUrl:function(){if(void 0===this.proxy.url)throw new Error("[FancyGrid Error] - in data proxy there is not url")},initServerAPI:function(){var a=this,b=a.proxy;b.api=b.api||{},b.url&&(b.api.read=b.url),(b.api.update||b.api.read||b.api.create&&b.api.destroy)&&(a.proxyType="server")},initActionMethods:function(){var a=this,b=a.proxy,c=b.methods||{},d=b.method||"GET";c.create=c.create||d,c.read=c.read||d,c.update=c.update||d,c.destroy=c.destroy||d,b.methods=c},loadData:function(a){var b=this,c=b.proxy,d={},e=c.headers||{};Fancy.apply(d,b.params),Fancy.applyIf(d,c.params),b.fire("beforeload"),"server"===b.pageType&&(d[b.pageParam]=b.showPage,d[b.limitParam]=b.pageSize,d[b.startParam]=b.showPage*b.pageSize),b.loading=!0,Fancy.Ajax({url:c.api.read,method:c.methods.read,params:d,getJSON:!0,headers:e,success:function(c,d,e){if(b.loadedTimes++,b.loading=!1,b.defineModel(c[b.readerRootProperty]),b.widget.isTreeData)return b.data=c[b.readerRootProperty],b.initTreeData(),b.widget.setSidesHeight(),b.fire("change"),b.fire("load"),b.fire("serversuccess",c,e),void(a&&a());b.paging?b.processPagingData(c):(b.setData(c[b.readerRootProperty]),b.widget.setSidesHeight()),b.fire("change"),b.fire("load"),b.fire("serversuccess",c,e),a&&a()},error:function(a,c,d){b.fire("servererror",c,d,a)}})},proxyCRUD:function(a,b,c,d){var e=this;switch(a){case"UPDATE":e.proxyServerUpdate(b,c,d);break;case"DESTROY":e.proxyServerDestroy(b,c);break;case"CREATE":e.proxyServerCreate(b,c)}},proxyServerUpdate:function(a,b,c){var d=this,e=d.proxy,f={},g=e.headers||{},h="json"===d.writerType;Fancy.apply(f,d.params),Fancy.applyIf(f,e.params),e.api.update&&(h?f=Fancy.isArray(a)&&void 0===b&&void 0===c?a:d.prepareWriterJSONParams(a,b,c):(f.id=a,f[d.keyParam]=b,f[d.valueParam]=c,f.action="update"),d.loading=!0,d.fire("beforeupdate",a,b,c),Fancy.Ajax({url:e.api.update,method:e.methods.update,params:f,sendJSON:h,headers:g,success:function(e,f,g){d.loading=!1,d.fire("update",a,b,c),d.fire("serversuccess",e,g)},error:function(a,b,c){d.fire("servererror",b,c,a)}}))},proxyServerDestroy:function(a,b){var c=this,d=c.proxy,e={},f=d.headers||{},g="json"===c.writerType||!1===c.autoSave;Fancy.apply(e,c.params),Fancy.applyIf(e,d.params),g&&Fancy.isArray(a)?e=a:b?e=b:e.id=a,c.loading=!0,c.fire("beforedestroy"),Fancy.Ajax({url:d.api.destroy,method:d.methods.destroy,params:e,sendJSON:g,headers:f,success:function(b,d,e){c.loading=!1,c.fire("destroy",a,b),c.fire("serversuccess",b,e)},error:function(a,b,d){c.fire("servererror",b,d,a)}})},proxyServerCreate:function(a,b){var c=this,d=c.proxy,e={},f=d.headers||{},g="json"===c.writerType||!1===c.autoSave;Fancy.apply(e,c.params),Fancy.applyIf(e,d.params),g&&Fancy.isArray(a)?e=a:b?e=b:(e.id=a,void 0===e.id&&delete e.id),c.loading=!0,c.fire("beforecreate"),Fancy.Ajax({url:d.api.create,method:d.methods.create,params:e,sendJSON:g,headers:f,success:function(b,d,e){if(c.loading=!1,Fancy.isObject(b.data)&&String(a)!==String(b.data.id))c.changeItemId(a,b.data.id);else if(Fancy.isArray(b.data))for(var f=0,g=a.length;f<g;f++)String(a[f].id)!==String(b.data[f].id)&&c.changeItemId(String(a[f].id),String(b.data[f].id));c.fire("create",b.data),c.fire("serversuccess",b,e)},error:function(a,b,d){c.fire("servererror",b,d,a)}})},save:function(){for(var a=this,b=a.removed,c=a.changed,d=a.inserted,e=0,f=a.saveOrder.length;e<f;e++)switch(a.saveOrder[e]){case"create":a.saveInsertActions(d);break;case"update":a.saveChangeActions(c);break;case"destroy":a.saveRemoveActions(b)}a.changed={length:0},a.removed={length:0},a.inserted={length:0}},saveChangeActions:function(a){var b=this;if(a.length)if(b.batch){var c=[];for(var d in a)if("length"!==d){var e=a[d],f={id:d};if(b.writeAllFields)f=b.getById(d).data;else for(var g in e)"length"!==g&&(f[g]=e[g].value);c.push(f)}1===c.length?(c=c[0],b.proxyCRUD("UPDATE",c.id,c)):b.proxyCRUD("UPDATE",c)}else for(var d in a)if("length"!==d){var e=a[d],c={};if(b.writeAllFields)c=b.getById(d).data;else for(var g in e)"length"!==g&&(c[g]={id:e.id});b.proxyCRUD("UPDATE",d,c)}},saveRemoveActions:function(a){var b=this;if(0!==a.length)if(b.batch){var c=[];for(var d in a)if("length"!==d){var e=a[d],f={id:d};if(b.writeAllFields)f=b.getById(d).data;else for(var g in e)"length"!==g&&(f={id:e.id});c.push(f)}1===c.length?(c=c[0],b.proxyCRUD("DESTROY",c.id,c)):b.proxyCRUD("DESTROY",c)}else for(var d in a)if("length"!==d){var e=a[d],c={};if(b.writeAllFields)c=e;else for(var g in e)"length"!==g&&(c[g]=e[g].value);b.proxyCRUD("DESTROY",d,c)}},saveInsertActions:function(a){var b=this;if(0!==a.length)if(b.batch){var c=[];for(var d in a)if("length"!==d){var e=a[d],f={id:d};if(b.writeAllFields)f=b.getById(d).data;else for(var g in e.data)f[g]=e.data[g];c.push(f)}1===c.length?(c=c[0],b.proxyCRUD("CREATE",c.id,c)):b.proxyCRUD("CREATE",c)}else for(var d in a)if("length"!==d){var e=a[d],c={};if(b.writeAllFields)c=e;else for(var g in e)"length"!==g&&(c[g]=e[g].value);b.proxyCRUD("CREATE",d,c)}}}),Fancy.Mixin("Fancy.store.mixin.Rest",{initRest:function(){var a=this;a.proxyType="server",a.checkUrl(),a.initRestServerAPI(),a.initRestActionMethods()},initRestServerAPI:function(){var a=this,b=a.proxy,c=b.url;b.api=b.api||{},b.api.create=c,b.api.read=c,b.api.update=c,b.api.destroy=c},initRestActionMethods:function(){var a=this,b=a.proxy,c=b.methods||{};c.create=c.create||b.method||"POST",c.read=c.read||b.method||"GET",c.update=c.update||b.method||"PUT",c.destroy=c.destroy||b.method||"DELETE",b.methods=c}}),Fancy.Mixin("Fancy.store.mixin.Reader",{readerType:"json",readerRootProperty:"data",initReader:function(){var a=this,b=a.proxy;b.reader&&a.configReader(b.reader)},configReader:function(a){var b=this;switch(Fancy.typeOf(a)){case"string":switch(a){case"json":b.readerType=a;break;default:throw new Error("[FancyGrid Error] - reader "+a+" does not exist")}break;case"object":switch(a.type){case void 0:b.readerType="json";break;case"json":b.readerType=a.type;break;default:throw new Error("[FancyGrid Error] - reader "+a.type+" does not exist")}a.root&&(b.readerRootProperty=a.root)}}}),Fancy.Mixin("Fancy.store.mixin.Writer",{writerType:"string",writeAllFields:!1,initWriter:function(){var a=this,b=a.proxy;b.writer&&a.configWriter(b.writer)},configWriter:function(a){var b=this;switch(a.allFields&&(b.writeAllFields=a.allFields,a.writeAllFields=a.allFields),Fancy.typeOf(a)){case"string":switch(a){case"json":case"string":b.writerType=a;break;default:throw new Error("[FancyGrid Error] - writer "+a.type+" does not exist")}break;case"object":switch(a.type){case void 0:b.writerType="string";break;case"json":case"string":b.writerType=a.type;break;default:throw new Error("[FancyGrid Error] - writer "+a+" does not exist")}a.writeFields&&(b.writeFields=!0),a.root&&(b.writerRootProperty=a.root)}},prepareWriterJSONParams:function(a,b,c){var d=this,e=d.params||{},f={};return f.id=a,d.writeAllFields?Fancy.applyIf(f,d.getById(a).data):void 0===c&&Fancy.isObject(b)?Fancy.applyIf(f,b):void 0===c&&Fancy.isArray(b)?f=b:f[b]=c,d.rootProperty?(e[d.rootProperty]=f,e):f}}),Fancy.modules.sort=!0,Fancy.Mixin("Fancy.store.mixin.Sort",{multiSortLimit:3,sort:function(a,b,c,d){var e,f,g=this;switch(g.fire("beforesort",{key:"key",action:a}),g.multiSort&&!0!==g.multiSortInited&&g.initMultiSort(),b){case"number":case"checkbox":case"switcher":case"progressdonut":case"progressbar":case"grossloss":case"date":case"currency":e="sortNumber",f="number";break;case"string":case"combo":case"text":case"color":case"tree":e="sortString",f="string";break;default:throw new Error("[FancyGrid error] - does not exist sort function for type "+b)}if(g.multiSort?g.addSorter(c,a.toLocaleUpperCase(),f):(g.sorters=[],g.sorters.push({key:c,dir:a.toLocaleUpperCase().toLocaleUpperCase(),type:f,_type:b})),g.remoteSort)return void g.serverSort(a,b,c);if(d.type=b,"drop"===a?delete g.order:g[e](a,c,d),g.multiSort)for(var h=0,i=g.sorters.length-1;h<i;h++)g.multiSortOrder(h);g.changeDataView(),g.fire("sort",{key:c,action:a})},serverSort:function(a,b,c){var d=this;d.params=d.params||{},d.multiSort?d.params.sorters=d.sorters:(d.params[d.sortParam]=c,"drop"===a?delete d.params[d.directionParam]:d.params[d.directionParam]=a),d.once("serversuccess",function(){d.fire("sort",{key:c,action:a})}),d.loadData()},sortNumber:function(a,b,c){var d,e,f,g=this,h=[],i=c.sorter;if(g.isTree){h=g.getColumnOriginalValues("id");var j=g.treeGetDataAsTree(),k=g.treeSort(j,a,b,"number",i);d=g.treeReadSortedId(k)}else if(g.grouping){var l=g.getColumnOriginalValuesByGroup(b,g.grouping.by,c);switch(d=[],e=0,f=l.length,a){case"asc":for(;e<f;e++)h=h.concat(l[e].values),d=i?d.concat(l[e].values.sort(function(a,b){return i("asc",a,b)})):d.concat(l[e].values.sort(function(a,b){return a-b}));break;case"desc":for(;e<f;e++)h=h.concat(l[e].values),d=i?d.concat(l[e].values.sort(function(a,b){i("desc",a,b)})):d.concat(l[e].values.sort(function(a,b){return b-a}))}}else{h=g.getColumnOriginalValues(b,c);for(var m=[],n=Fancy.Array.copy(h),e=0,f=n.length;e<f;e++)isNaN(n[e])&&(m.push(n[e]),n.splice(e,1),f--);switch(a){case"asc":d=i?Fancy.Array.copy(n).sort(function(a,b){return i("asc",a,b)}):Fancy.Array.copy(n).sort(function(a,b){return a-b}),d=d.concat(m);break;case"desc":d=i?Fancy.Array.copy(n).sort(function(a,b){return i("desc",a,b)}):Fancy.Array.copy(n).sort(function(a,b){return b-a}),d=m.concat(d)}}g.order=g.getOrder(h,d)},sortString:function(a,b,c){var d,e,f,g=this,h=[],i=c.sorter;if(g.isTree){h=g.getColumnOriginalValues("id");var j=g.treeGetDataAsTree(),k=g.treeSort(j,a,b,"string",i);d=g.treeReadSortedId(k)}else if(g.grouping){var l=g.getColumnOriginalValuesByGroup(b,g.grouping.by);switch(d=[],e=0,f=l.length,a){case"asc":for(;e<f;e++)h=h.concat(l[e].values),d=i?d.concat(l[e].values.sort(function(a,b){return i("asc",a,b)})):d.concat(l[e].values.sort());break;case"desc":for(;e<f;e++)h=h.concat(l[e].values),d=i?d.concat(l[e].values.sort(function(a,b){return i("desc",a,b)})):d.concat(l[e].values.sort().reverse())}}else switch(h=g.getColumnOriginalValues(b),a){case"asc":d=i?Fancy.Array.copy(h).sort(function(a,b){return i("asc",a,b)}):Fancy.Array.copy(h).sort();break;case"desc":i?d=Fancy.Array.copy(h).sort(function(a,b){return i("desc",a,b)}):(d=Fancy.Array.copy(h).sort(),d=d.reverse())}g.order=g.getOrder(h,d)},getOrder:function(a,b){for(var c,d={},e=0,f=a.length,g=[];e<f;e++){var h=a[e];void 0===d[h]&&(d[h]=[]),d[h].push(e)}for(e=0;e<f;e++)h=b[e],c=d[h],g.push(c[0]),c.length>1&&c.splice(0,1);return g},changeOrderIndexes:function(a,b){var c=this;if(void 0===b&&(b="-"),void 0!==c.order){var d=0,e=c.order.length;if("-"===b)for(;d<e;d++)c.order[d]>a&&c.order[d]--;else for(;d<e;d++)c.order[d]>=a&&c.order[d]++}},initMultiSort:function(){var a=this;a.multiSortInited=!0,a.sorters||(a.sorters=[])},addSorter:function(a,b,c){for(var d=this,e=0,f=d.sorters.length;e<f;e++)if(d.sorters[e].key===a){d.sorters.splice(e,1);break}d.sorters.push({key:a,dir:b.toLocaleUpperCase(),type:c}),d.sorters.length>d.multiSortLimit&&d.sorters.shift()},multiSortOrder:function(a){for(var b,c,d,e=this,f=e.widget,g=f.store,h=e.sorters[a],i=e.sorters[a+1].key,j=h.key,k=0,l=e.getTotal(),m=[],n=[],o=[];k<l;k++)b=g.get(e.order[k],i,!0),d=g.get(e.order[k],j,!0),b===c?(m[m.length-1].push(d),n[n.length-1].push(e.order[k])):(m.push([d]),n.push([e.order[k]])),c=b;for(k=0,l=n.length;k<l;k++)if(1!==n[k].length){var p;if("number"===h.type)switch(h.dir){case"ASC":p=Fancy.Array.copy(m[k]).sort(function(a,b){return a-b});break;case"DESC":p=Fancy.Array.copy(m[k]).sort(function(a,b){return b-a})}else if("string"===h.type)switch(h.dir){case"ASC":p=Fancy.Array.copy(m[k]).sort();break;case"DESC":p=Fancy.Array.copy(m[k]).sort().reverse()}var q,r=n[k],s=[];q=e.getOrder(m[k],p);for(var t=0,u=q.length;t<u;t++)s.push(r[q[t]]);o=o.concat(s)}else o.push(n[k][0]);e.order=o},reSort:function(){var a=this;Fancy.each(a.sorters,function(b){a.sort(b.dir.toLocaleLowerCase(),b.type,b.key,{})})}}),Fancy.Mixin("Fancy.store.mixin.Edit",{remove:function(a,b){var c,d,e,f=this,g=a.id;switch(Fancy.typeOf(a)){case"string":case"number":g=a;break;default:g=a.id||a.data.id}if(f.isTree&&!0!==f.treeCollapsing){var h=f.getById(g),i=f.getById(h.get("parentId"));if(!1===h.get("leaf")&&h.get("expanded")){var j=h.data.child.length-1;Fancy.each(h.data.child,function(a,b,c){f.remove(c[j]),j--})}i&&Fancy.each(i.data.child,function(a,b){if(a.id===g)return i.data.child.splice(b,1),!0})}if("server"===f.proxyType&&f.autoSave&&f.proxy.api.destroy)return void(!1!==b&&f.proxyCRUD("DESTROY",g));if(a.rowIndex)c=f.dataViewIndexes[a.rowIndex],d=a.rowIndex;else if(c=f.getDataIndex(g),d=f.getRow(g),void 0===c&&void 0===d)return;if(f.isTree&&f.treeCollapsing&&f.filteredData){var k;Fancy.each(f.data,function(a,b){if(a.data.id===g)return k=b,!0}),e=f.data.splice(k,1)[0]}else e=f.data.splice(c,1)[0];f.paging&&(d+=f.showPage*f.pageSize),f.order&&f.order.splice(d,1),f.changeOrderIndexes&&f.changeOrderIndexes(c),f.paging&&(0!==f.showPage&&f.showPage*f.pageSize===f.getTotal()&&f.showPage--,f.calcPages()),delete f.map[g],f.treeCollapsing||!1===b||f.fire("remove",g,e,c),!1!==b&&f.changeDataView()},removeAt:function(a){var b=this;b.remove({rowIndex:a,id:b.getId(a)})},removeAll:function(){var a=this;a.data=[],a.dataView=[],delete a.order,a.paging&&(a.showPage=0,a.calcPages()),a.filters&&(delete a.filters,delete a.filteredData,delete a.filterOrder)},add:function(a){var b=this;return b.insert(b.getTotal(),a)},insert:function(a,b,c){var d=this;if(d.grouping&&!d.bugFixGrouping&&(d.defineModel(b,!0),d.bugFixGrouping=!0),d.addIndex=a,void 0===b.id){Fancy.idSeed++;var e=Fancy.idSeed+1e3;"server"===d.proxyType?b.id="Temp-"+e:b.id=e}if(d.getById(b.id)&&d.remove(b.id),"server"!==d.proxyType||!d.autoSave||!d.proxy.api.create)return d.insertItem(b,a,c);!1!==c&&(d.once("create",d.onCreate,d),d.proxyCRUD("CREATE",b))},insertItem:function(a,b,c){var d=this,e=d.model,f=new e(a),b=d.addIndex;return d.treeExpanding||!1===c||d.fire("beforeinsert"),delete d.addIndex,d.data.splice(b,0,f),d.order&&(d.order.splice(b,0,b),d.changeOrderIndexes(b,"+"),d.order[b]--),!1!==c&&d.changeDataView(),d.map[a.id]=f,d.treeExpanding||!1===c||d.fire("insert",f),f},onCreate:function(a,b){return this.insertItem(b)}}),Fancy.modules.grouping=!0,Fancy.Mixin("Fancy.store.mixin.Grouping",{expand:function(a,b){var c=this,d=c.data,e=0,f=d.length,g=[],h={},i={};for(c.filteredData&&(d=c.filteredData,f=d.length),c.expanded=c.expanded||{},c.expanded[b]=!0;e<f;e++){var j=d[e];c.expanded[j.data[a]]&&(g.push(j),h[j.id]=g.length-1,i[g.length-1]=e)}c.dataView=g,c.dataViewMap=h,c.dataViewIndexes=i},collapse:function(a,b){var c=this,d=c.data,e=0,f=d.length,g=[],h={},i={};for(c.expanded=c.expanded||{},delete c.expanded[b];e<f;e++){var j=d[e];c.expanded[j.data[a]]&&(g.push(j),h[j.id]=g.length-1,i[g.length-1]=e)}c.dataView=g,c.dataViewMap=h,c.dataViewIndexes=i},changeOrderByGroups:function(a,b){var c=this,d={},e=[];Fancy.each(a,function(a){d[a]=[]}),Fancy.isArray(c.data)&&Fancy.each(c.data,function(a){var c=a.data[b];d[c]&&d[c].push(a)}),Fancy.each(a,function(a){e=e.concat(d[a])}),c.grouping={by:b},c.data=e},getColumnOriginalValuesByGroup:function(a,b,c){var d=this,e=d.data,f=0,g=e.length,h=[],i=[],j=e[0].data[b];if(c&&c.format&&"date"===c.type)for(;f<g;f++)e[f].data[b]===j?i.push(Fancy.Date.parse(e[f].data[a],c.format,c.mode)):(h.push({values:i,groupName:j}),i=[],j=e[f].data[b],f--);else for(;f<g;f++)e[f].data[b]===j?i.push(e[f].data[a]):(h.push({values:i,groupName:j}),i=[],j=e[f].data[b],f--);return g>0&&h.push({values:i,groupName:j}),h},initGroups:function(a){var b=this,c=b.widget,d=c.grouping,e=d.by;if(a=a||"data",!e)throw new Error("[FancyGrid Error] - not set by param in grouping");var f=b.getColumnOriginalValues(e,{dataProperty:a,groupMap:!0}),g={};Fancy.each(f,function(a){void 0===g[a]&&(g[a]=0),g[a]++});var h=[];for(var i in g)h.push(i);return{groups:h,_groups:g}},orderDataByGroupOnStart:function(){var a=this,b=a.widget.grouping,c=a.initGroups(),d=c.groups,e={},f=[];switch(Fancy.each(d,function(a){var b=a.toLocaleUpperCase();e[b]=a,f.push(b)}),a.widget.grouping.sortGroups){case"asc":case"ASC":case!0:f=f.sort();break;case"desc":case"DESC":f=f.sort().reverse()}for(var g=0,h=d.length;g<h;g++)d[g]=e[f[g]];a.changeOrderByGroups(d,b.by),a.expanded={},b.collapsed?a.collapsed=!0:Fancy.each(d,function(c){b.expanded&&void 0!==b.expanded[c]||(a.expanded[c]=!0)}),a.changeDataView({doNotFired:!0})},getItemsByGroup:function(a){var b=this;return b.findItem(b.grouping.by,a)}}),Fancy.modules.filter=!0,Fancy.Mixin("Fancy.store.mixin.Filter",{filterCheckItem:function(a){var b=this,c=b.widget,d=c.filter.caseSensitive,e=b.filters,f=!0,g=!1;if(b.isTree){var h=a.get("child");if(h){var i=[];if(Fancy.each(h,function(a){var c=a.data?a:new b.model(a);b.filterCheckItem(c)&&i.push(a)}),a.set("filteredChild",i),i.length)return!0}}for(var j in e){var k=c.getColumnByIndex(j),l=e[j],m=a.data[j];if(k&&k.filter&&k.filter.fn)return k.filter.fn(m,e,a);if(b.smartIndexes&&b.smartIndexes[j])m=b.smartIndexes[j](a.data);else if(/\./.test(j)){var n=j.split(".");m=a.data[n[0]][n[1]]}"date"===l.type&&(m=null===m?Math.NEGATIVE_INFINITY:Number(Fancy.Date.parse(m,l.format.read,l.format.mode))),!d&&Fancy.isString(m)&&(m=m.toLocaleLowerCase());for(var o in l){switch(o){case"type":case"format":continue}var p=l[o];switch(!d&&Fancy.isString(p)&&(p=p.toLocaleLowerCase()),o){case"<":f=Number(m)<p;break;case">":f=Number(m)>p;break;case"<=":f=Number(m)<=p;break;case">=":f=Number(m)>=p;break;case"=":case"==":Fancy.isArray(p)?(Fancy.each(p,function(a,b){p[b]=String(a)}),m=String(m),f=-1!==p.indexOf(m)):f=m==p;break;case"===":Fancy.isArray(p)?(m=String(m),f=-1!==p.indexOf(m)):f=m===p;break;case"!==":f=m!==p;break;case"!=":Fancy.isArray(p)?(Fancy.each(p,function(a,b){p[b]=String(a)}),m=String(m),f=-1===p.indexOf(m)):f=m!=p;break;case"":var q=function(a,b){return a=String(a).toLocaleLowerCase(),b=String(b).toLocaleLowerCase(),a=a.replace(/\(/g,"bracketleft"),a=a.replace(/\)/g,"bracketright"),a=a.replace(/\+/g,"plus"),a=a.replace(/\-/g,"minus"),b=b.replace(/\(/g,"bracketleft"),b=b.replace(/\)/g,"bracketright"),b=b.replace(/\+/g,"plus"),b=b.replace(/\-/g,"minus"),new RegExp(a).test(b)};if(Fancy.isArray(p))for(var r=0,s=p.length;r<s&&!1!==(f=q(p[r],m));r++);else f=q(p,m);break;case"*":p=String(p).toLocaleLowerCase(),f=new RegExp(p).test(String(m).toLocaleLowerCase()),g=!0;break;case"|":f=!0===p[String(m).toLocaleLowerCase()];break;case"fn":f=!0===p(m,a);break;default:throw new Error("FancyGrid Error 5: Unknown filter "+o)}if(!0===g){if(!0===f)return!0}else if(!1===f)return!1}}return!0!==g||!1!==f},filterData:function(){var a=this,b=a.data,c=[],d=0,e=b.length,f=[],g=[];if(a.remoteFilter)return void a.serverFilter();for(a.filteredDataMap={};d<e;d++)a.order?(f.push(a.order[d]),g=b[a.order[d]]):(f.push(d),g=b[d]),a.filterCheckItem(g)&&(c.push(g),a.filteredDataMap[g.id]=g);a.filterOrder=f,a.filteredData=c,a.paging&&a.calcPages(),a.fire("filter")},serverFilter:function(){var a=this,b="[",c=a.filters||{};for(var d in c){var e=c[d];for(var f in e){switch(f){case"type":case"format":continue}var g=a.filterOperators[f];if("or"===g){var h=[];for(var i in e[f])h.push(i);b+='{"operator":"'+g+'","value":"'+h.join(", ")+'","property":"'+d+'"},'}else b+='{"operator":"'+g+'","value":"'+e[f]+'","property":"'+d+'"},'}}b=b.replace(/\,$/,""),b+="]",a.params=a.params||{},"[]"===b?(b="",delete a.params[a.filterParam]):a.params[a.filterParam]=b,a.loadData()}}),Fancy.modules.tree=!0,Fancy.Mixin("Fancy.store.mixin.Tree",{initTreeData:function(){var a=this;if(a.isTree=!0,a.data&&0!==a.data.length){var b;b=Fancy.isObject(a.data)?a.treeReadData(a.data.items):a.treeReadData(a.data),a.setData(b)}else;},treeReadData:function(a,b,c){var d=this,e=[];return b=b||1,Fancy.each(a,function(a){a.data&&(a=a.data),a.$deep=b,a.leaf=!!a.leaf,a.expanded=!!a.expanded,Fancy.isArray(a.filteredChild)&&a.filteredChild.length?a.leaf=!1:a.child&&a.child.length&&(a.leaf=!1),c&&(a.parentId=c),a.id||(Fancy.idSeed++,a.id=Fancy.idSeed+1e3),e.push(a),a.expanded&&(e=e.concat(d.treeReadData(a.child||[],b+1,a.id)))}),e},treeGetDataAsTree:function(){var a=this,b=[];return Fancy.each(a.data,function(a){1===a.get("$deep")&&b.push(a)}),b},treeSort:function(a,b,c,d,e){var f=this,g=[],h=[],i={},j=[];Fancy.each(a,function(a){var b=a.data||a;g.push(b[c]),void 0===i[b[c]]?i[b[c]]=a:(Fancy.isArray(i[b[c]])||(i[b[c]]=[i[b[c]]]),i[b[c]].push(a))});var k=!1,l=!1;if(g.length){k=!0,l=!0;var m;Fancy.each(a,function(a){var b=a.data||a;""!==b[c]&&(k=!1),void 0!==m&&m!==b[c]&&(l=!1),m=b[c]})}if("number"===d)switch(b){case"asc":h=e?Fancy.Array.copy(g).sort(function(a,b){return e("asc",a,b)}):Fancy.Array.copy(g).sort(function(a,b){return a-b});break;case"desc":h=e?Fancy.Array.copy(g).sort(function(a,b){return e("desc",a,b)}):Fancy.Array.copy(g).sort(function(a,b){return b-a})}else switch(b){case"asc":h=Fancy.Array.copy(g).sort();break;case"desc":h=Fancy.Array.copy(g).sort(),h=h.reverse()}return Fancy.each(h,function(e,g){var h=i[e];Fancy.isArray(h)&&(h=h.splice(0,1)[0]),(k||l)&&(h=a[g]);var m=h.data||h;m.child&&m.expanded&&(h.data.sorted=f.treeSort(m.child,b,c,d)),j.push(h)}),j},treeReadSortedId:function(a){var b=this,c=[];return Fancy.each(a,function(a){c.push(a.id),a=b.getById(a.id),a.data.expanded&&(a.data.sorted?c=c.concat(b.treeReadSortedId(a.data.sorted)):a.data.child&&(c=c.concat(b.treeReadSortedId(a.data.child))))}),c},treeReBuildData:function(){var a=this,b=[],c=[];Fancy.each(a.data,function(a){1===a.get("$deep")&&b.push(a.data)}),c=a.treeReadData(b),a.setData(c)}}),Fancy.Mixin("Fancy.store.mixin.Dirty",{initTrackDirty:function(){var a=this;a.changed={length:0},a.removed={length:0},a.inserted={length:0},a.undoActions=[],a.redoActions=[],a.on("remove",a.onDirtyRemove,a),a.on("set",a.onDirtySet,a),a.on("insert",a.onDirtyInsert,a)},onDirtySet:function(a,b){var c=this,d=b.id;if("$selected"!==b.key){if(void 0===c.changed[d]?(c.changed[d]={length:1},c.changed.length++):c.changed[d].length++,void 0===c.changed[d][b.key]&&(c.changed[d][b.key]={originValue:b.oldValue}),c.changed[d][b.key].value=b.value,c.changed[d][b.key].value===c.changed[d][b.key].originValue){delete c.changed[d][b.key],c.changed[d].length--;for(var e=0,f=c.undoActions.length-1;e<=f;e++){var g=f-e,h=c.undoActions[g];if(h.id===d&&b.key===h.key){var i=c.undoActions.splice(g,1);c.redoActions.push(i)}}}else c.redoing||(c.redoActions=[]),c.undoActions.push({id:d,type:"edit",key:b.key,value:b.value,oldValue:b.oldValue});0===c.changed[d].length&&(delete c.changed[d],c.changed.length--)}},onDirtyRemove:function(a,b,c,d){var e=this;e.removed[b]=c.data,e.removed.length++,!0!==e.undoStoppped&&(e.redoing||(e.redoActions=[]),e.undoActions.push({id:b,type:"remove",data:c.data,rowIndex:d}))},onDirtyInsert:function(a,b){var c=this;c.treeExpanding||(c.inserted[b.id]=b,c.inserted.length++,!0!==c.undoStoppped&&(c.redoing||(c.redoActions=[]),c.undoActions.push({id:b.id,type:"insert",data:b.data})))},clearDirty:function(){var a=this;a.changed={length:0},a.removed={length:0},a.inserted={length:0},a.undoActions=[],a.redoActions=[]}}),Fancy.define("Fancy.Store",{extend:Fancy.Event,mixins:["Fancy.store.mixin.Paging","Fancy.store.mixin.Infinite","Fancy.store.mixin.Proxy","Fancy.store.mixin.Rest","Fancy.store.mixin.Reader","Fancy.store.mixin.Writer","Fancy.store.mixin.Sort","Fancy.store.mixin.Edit","Fancy.store.mixin.Grouping","Fancy.store.mixin.Filter","Fancy.store.mixin.Search","Fancy.store.mixin.Dirty","Fancy.store.mixin.Tree"],pageSize:10,showPage:0,pages:0,dirty:!1,constructor:function(){var a=this;a.Super("const",arguments),a.init(),a.data=a.data||[],a.dataView=a.dataView||[],a.dataViewMap=a.dataViewMap||{},a.map={},a.setModel(),a.data&&(a.data.proxy?a.initProxy():a.widget.isTreeData||a.setData(a.data)),a.readSmartIndexes(),a.widget.grouping&&a.orderDataByGroupOnStart(),a.widget.isTreeData&&a.initTreeData()},init:function(){var a=this;a.addEvents("add","change","changepages","set","beforeupdate","update","beforeremove","remove","beforedestroy","destroy","beforecreate","create","beforesort","sort","beforeload","load","filter","beforeinsert","insert","servererror","serversuccess"),a.initId(),a.initPlugins(),a.paging&&a.initPaging(),a.infinite&&a.initInfinite(),a.initTrackDirty&&a.initTrackDirty()},setModel:function(){var a=this,b=a.model;if(b=void 0===b?Fancy.Model:Fancy.ClassManager.get(a.model),a.model=b,a.fields=b.prototype.fields,void 0===a.fields)throw new Error("needed to set fields in Model of Store")},setData:function(a){var b,c=this,d=0,e=a.length,f=c.model;if(c.data=[],c.dataView=[],c.dataViewMap={},c.dataViewIndexes={},c.collapsed)for(;d<e;d++)b=new f(a[d]),c.data[d]=b,c.map[b.id]=b;else if(c.expanded)for(;d<e;d++)b=new f(a[d]),c.data[d]=b,c.map[b.id]=b;else if(c.paging)for(;d<e;d++)b=new f(a[d]),c.data[d]=b,d<c.pageSize&&(c.dataView[d]=b,c.dataViewMap[b.id]=d,c.dataViewIndexes[d]=d),c.map[b.id]=b;else for(;d<e;d++)b=new f(a[d]),c.data[d]=b,c.dataView[d]=b,c.dataViewMap[b.id]=d,c.dataViewIndexes[d]=d,c.map[b.id]=b;c.isTree&&Fancy.each(c.data,function(a,b){a.get("expanded")&&Fancy.each(a.data.child,function(b,d){var e=c.getById(b.id);a.data.child[d]=e})})},getItem:function(a){return this.dataView[a]},get:function(a,b,c){var d,e=this;if(void 0===a)return e.data;var f=e.dataView[a];return f?void 0===b?(d=f.data,void 0===d.id&&(d.id=e.dataView[a].id),e.dataView[a].data):"none"===b?"":c?(f=e.data[a],"id"===b?f.data[b]||f.id:f.data[b]):(f=e.dataView[a],"id"===b?f.data[b]||f.id:f.data[b]):(f=e.order?e.data[e.order[a]]:e.data[a],f?"id"===b?f.data[b]||f.id:f.data[b]:f)},getId:function(a){return this.dataView[a].id},getRow:function(a){return this.dataViewMap[a]},set:function(a,b,c,d){var e,f,g=this,h=0;if(g.infiniteScrolledToRow&&(h=g.infiniteScrolledToRow),a+h===-1?e=g.getById(d):(e=g.dataView[a+h],d=e.data.id||e.id),void 0===c){var i=b;for(var j in i)if("id"!==j){var k;a+h===-1?(f=e.get(j),e.set(j,i[j]),k=e.data):(f=g.get(a+h,j),g.dataView[a+h].data[j]=i[j],k=g.dataView[a+h].data),g.fire("set",{id:d,data:k,rowIndex:a,infiniteRowIndex:a+h,key:j,value:i[j],oldValue:f,item:e})}return void("server"===g.proxyType&&g.autoSave&&g.proxyCRUD("UPDATE",d,i))}if((f=a+h===-1?e.get(b):g.get(a+h,b))!=c){if(a+h===-1)e.set(b,c);else{var l=g.dataView[a+h];if(l.data.parentId){var m=g.getById(l.data.parentId);Fancy.each(m.data.child,function(a,d){a.id===l.id&&(a[b]=c)})}l.data[b]=c}"server"===g.proxyType&&g.autoSave&&g.proxyCRUD("UPDATE",d,b,c);var k;k=-1===a?e.data:g.dataView[a+h].data,g.fire("set",{id:d,data:k,rowIndex:a,infiniteRowIndex:a+h,key:b,value:c,oldValue:f,item:e})}},setItemData:function(a,b){var c=this,d=c.get(a);if(c.infinite&&(a-=c.infiniteScrolledToRow),c.writeAllFields&&"server"===c.proxyType)c.set(a,b);else for(var e in b)d[e]!=b[e]&&c.set(a,e,b[e])},getLength:function(){var a=this,b=a.dataView.length;return a.infinite&&b>a.infiniteDisplayedRows&&(b=a.infiniteDisplayedRows),b},getTotal:function(){var a=this;return"server"===a.pageType?a.totalCount:a.filteredData?a.filteredData.length:void 0===a.data?0:Fancy.isObject(a.data)?0:a.data.length},defineModel:function(a,b){var c=this,d=c.store;if(!c.model||!c.fields||0===c.fields.length||b){var a=a||c.data||d.data,e=c.getFieldsFromData(a),f="Fancy.model."+Fancy.id();Fancy.define(f,{extend:Fancy.Model,fields:e}),c.model=f,c.fields=e,c.setModel()}},getFieldsFromData:function(a){var b=a.items||a;if(a.fields)return a.fields;if(!b)throw new Error("not set fields of data");var c=b[0],d=[];void 0===b.length&&(c=b);for(var e in c)d.push(e);return d},getColumnOriginalValues:function(a,b){var c,d=this,e=0,f=[],b=b||{},g=b.dataProperty||"data",h=d[g],i=h.length;if(/\./.test(a)&&(c=!0),b.smartIndexFn)for(;e<i;e++)f.push(b.smartIndexFn(h[e].data));else if(b.format)if("date"===b.type)for(;e<i;e++){var j=h[e].data[a];null===j?f.push(Math.NEGATIVE_INFINITY):f.push(Fancy.Date.parse(j,b.format,b.mode))}else if(c)for(;e<i;e++)f.push(this.getNestedValue(h[e].data,a));else for(;e<i;e++)f.push(h[e].data[a]);else if(b.groupMap)if(d.groupMap={},c)for(;e<i;e++){var k=h[e],j=this.getNestedValue(k.data,a);f.push(j),d.groupMap[k.id]=j}else for(;e<i;e++){var k=h[e],j=k.data[a];f.push(j),d.groupMap[k.id]=j}else if(c)for(;e<i;e++)f.push(this.getNestedValue(h[e].data||h[e],a));else for(;e<i;e++){var l=h[e].data||h[e];f.push(l[a])}return f},getNestedValue:function(a,b){var c=b.split(".");return c.length>1?this.getNestedValue(a[c.shift(0,1)],c.join(".")):a[b]},changeDataView:function(a){var b,c=this,a=a||{},d=[],e={},f=0,g=c.data.length,h=!!c.filters,i=!!c.searches,j=c.data;if(h){if(a.stoppedFilter||a.doNotFired){if(c.paging&&"server"===c.pageType)return}else c.filterData();c.remoteFilter||(j=c.filteredData,void 0===j&&(j=c.data),g=j.length)}i&&(c.searchData(),j=c.searchedData,g=j.length),c.dataViewIndexes={},c.dataViewMap={},c.paging&&(f="server"===c.pageType?0:c.showPage*c.pageSize,g=f+c.pageSize);var k=c.getTotal();g>c.data.length&&(g=c.data.length),h&&g>k&&(g=k),Fancy.isObject(c.data)&&(g=0);var l;if(c.order)if(c.grouping)for(b=c.grouping.by;f<g;f++)c.expanded[c.data[c.order[f]].data[b]]&&(!0===h?(c.dataViewIndexes[d.length]=c.filterOrder[f],l=j[f]):(c.dataViewIndexes[d.length]=c.order[f],l=j[c.order[f]]),d.push(l),e[l.id]=d.length-1);else for(;f<g;f++)!0===h?(c.dataViewIndexes[d.length]=c.filterOrder[f],l=j[f]):(c.dataViewIndexes[d.length]=c.order[f],l=j[c.order[f]]),d.push(l),e[l.id]=d.length-1;else if(c.grouping)for(b=c.grouping.by;f<g;f++)c.expanded[c.data[f].data[b]]&&(c.dataViewIndexes[d.length]=f,l=j[f],d.push(l),e[l.id]=d.length-1);else for(;f<g;f++)c.dataViewIndexes[d.length]=f,l=j[f],d.push(j[f]),e[l.id]=d.length-1;c.dataView=d,c.dataViewMap=e,a.doNotFired||c.fire("change")},getColumnData:function(a,b){var c=this,d=0,e=c.data.length,f=[];if(b)for(;d<e;d++)f.push(b(c.data[d].data));else for(;d<e;d++)f.push(c.data[d].data[a]);return f},getData:function(){for(var a=this,b=0,c=a.data.length,d=[];b<c;b++)d.push(a.data[b].data);return d},getDataView:function(){for(var a=this,b=0,c=a.dataView.length,d=[];b<c;b++)d.push(a.dataView[b].data);return d},getById:function(a){return this.map[a]},changeItemId:function(a,b){var c=this,d=c.getById(a);if(!d)return!1;d.id=b,void 0!==d.data.id&&(d.data.id=b),delete c.map[a],c.map[b]=d,c.fire("changeitemid",a,b)},find:function(a,b,c){var d,e=this,f=e.dataView,g=0,h=f.length,i=[];if(c)for(h=e.data.length;g<h;g++)d=e.order?e.data[e.order[g]]:e.data[g],d.data[a]===b&&i.push(g);else for(;g<h;g++)d=f[g],d.data[a]===b&&i.push(g);return i},findItem:function(a,b){for(var c,d=this,e=d.data,f=0,g=e.length,h=[];f<g;f++)c=e[f],c.data[a]===b&&h.push(c);return h},getDataIndex:function(a){for(var b,c,d=this,e=d.data,f=0,g=e.length;f<g;f++)b=e[f],b.data.id===a&&(c=f);return c},each:function(a,b){var c=this,d=c.dataView,e=0,f=d.length;if(b)for(;e<f;e++)a.apply(this,[d[e]]);else for(;e<f;e++)a(d[e])},readSmartIndexes:function(){var a=this,b=a.widget,c=0,d={};Fancy.each(b.columns,function(a){a.smartIndexFn&&(d[a.index]=a.smartIndexFn,c++)}),c&&(a.smartIndexes=d)},destroy:function(){var a=this;Fancy.each(a.data,function(a){delete a.data,delete a.id}),a.data=[],a.map={},a.dataView=[],a.dataViewIndexes={},a.dataViewMap={}}}),Fancy.$=window.$||window.jQuery,Fancy.nojQuery=void 0===Fancy.$,Fancy.get=function(a){switch(Fancy.typeOf(a)){case"string":return new Fancy.Element(Fancy.$("#"+a)[0]);case"array":return new Fancy.Elements(a);default:return new Fancy.Element(a)}},Fancy.Element=function(a){var b=this;b.dom=a,b.$dom=Fancy.$(a),b.length=1},Fancy.Element.prototype={last:function(){return Fancy.get(this.$dom)},closest:function(a){return Fancy.get(this.$dom.closest(a)[0])},destroy:function(){this.$dom.remove()},remove:function(){this.$dom.remove()},finish:function(){this.$dom.finish()},prev:function(){return Fancy.get(this.$dom.prev()[0])},lastChild:function(){var a=this.$dom.children();return Fancy.get(a[a.length-1])},firstChild:function(){return Fancy.get(this.$dom.children()[0])},on:function(a,b,c,d){var e=this;switch(c&&(b=Fancy.$.proxy(b,c)),d?e.$dom.on(a,d,b):e.$dom.on(a,b),a){case"mouseenter":e.onTouchEnterEvent&&e.onTouchEnterEvent(a,b,c,d);break;case"mouseleave":e.onTouchLeaveEvent&&e.onTouchLeaveEvent(a,b,c,d);break;case"mousemove":e.onTouchMove&&e.onTouchMove("touchmove",b)}},once:function(a,b,c,d){var e=this;c&&(b=Fancy.$.proxy(b,c)),d?e.$dom.one(a,d,b):e.$dom.one(a,b)},prop:function(a){return this.$dom.prop(a)},un:function(a,b,c,d){var e=this;c&&(b=Fancy.$.proxy(b,c)),d?e.$dom.off(a,d,b):e.$dom.off(a,b)},show:function(){this.$dom.show()},hide:function(){this.$dom.hide()},replaceClass:function(a,b){this.$dom.removeClass(a),this.$dom.addClass(b)},getByTag:function(a){return Fancy.get(this.$dom.find(a)[0])},getByClass:function(a){return this.$dom.find("."+a)[0]},addClass:function(a){this.addCls.apply(this,arguments)},addCls:function(a){if(this.$dom.addClass(a),arguments.length>1)for(var b=1,c=arguments.length;b<c;b++)this.addClass(arguments[b])},removeClass:function(a){this.$dom.removeClass(a)},removeCls:function(a){this.$dom.removeClass(a)},hasClass:function(a){return this.$dom.hasClass(a)},hasCls:function(a){return this.$dom.hasClass(a)},toggleClass:function(a){this.$dom.toggleClass(a)},toggleCls:function(a){this.$dom.toggleClass(a)},select:function(a){var b=this,c=b.$dom.find(a);return 1===c.length?Fancy.get(c[0]):c.length>1?Fancy.get(c):0===c.length?{length:0,dom:void 0,addClass:function(){},addCls:function(){},removeClass:function(){},removeCls:function(){},destroy:function(){},remove:function(){},css:function(){},each:function(){},last:function(){},attr:function(){}}:c},css:function(a,b){return void 0===b?this.$dom.css(a):this.$dom.css(a,b)},attr:function(a,b){return void 0===b?this.$dom.attr(a):this.$dom.attr(a,b)},append:function(a){return Fancy.get(this.$dom.append(a)[0])},after:function(a){return Fancy.get(this.$dom.after(a)[0])},next:function(){return Fancy.get(this.$dom.next()[0])},insertAfter:function(a){return Fancy.get(this.$dom.insertAfter(a)[0])},before:function(a){return Fancy.get(this.$dom.before(a)[0])},height:function(a){return a?(this.$dom.height(a),this):this.$dom.height()},width:function(a){return a?(this.$dom.width(a),this):this.$dom.width()},parent:function(a){return Fancy.get(this.$dom.parent(a)[0])},update:function(a){this.dom.innerHTML=a},hover:function(a,b){a&&this.$dom.on("mouseenter",a),a&&this.$dom.on("mouseleave",b)},position:function(){return this.$dom.position()},offset:function(){return this.$dom.offset()},focus:function(){this.$dom.focus()},blur:function(){this.$dom.blur()},within:function(a){var b,c=this,d=!0,e=!1;return a=Fancy.get(a),b=a.attr("id"),void 0!==b&&""!==b||(b=Fancy.id(),e=!0),a.attr("id",b),0===c.select("#"+b).length&&(d=!1),c.dom.id===a.dom.id&&(d=!0),e&&c.removeAttr(b),d},removeAttr:function(a){this.$dom.removeAttr(a)},item:function(){return this},stop:function(){this.$dom.stop&&this.$dom.stop()},animate:function(a,b,c,d){var e={},f=!1,g=a.force;Fancy.nojQuery||(f=!0,g=!0),Fancy.isObject(a)&&delete a.force;for(var h in a){var i=a[h];Fancy.isString(i)&&(i=Number(i.replace("px","")));var j=this.css(h);Fancy.isString(j)&&(j=Number(j.replace("px",""))),i!==j&&(e[h]=a[h],f=!0)}!1!==f&&(g?this.$dom.animate(e,b,c,d):this.$dom.css(e))},stop:function(){this.$dom.stop&&this.$dom.stop()},index:function(){return this.$dom.index()},onTouchEnterEvent:function(a,b,c,d){var e=this,f=Fancy.get(document.body);if(Fancy.isTouch){var g=function(a,f){var g=Fancy.id(),h="fancy-tempt-attr",a=a.originalEvent||a;e.attr(h,g);for(var i=a.targetTouches[0],j=[i.pageX,i.pageY],k=Fancy.get(document.elementFromPoint(j[0]-document.body.scrollLeft,j[1]-document.body.scrollTop)),l=!1,m=10,n=k;m>0&&n.dom;){if(n.attr(h)===g){l=!0;break}n=n.parent(),m--}if(!l||e.touchIn||d||(a.pageX=i.pageX,a.pageY=i.pageY,b(a,f),e.touchIn=!0),l&&d){m=10,n=k;for(var o=[],p=0;m>0&&n.dom;){var q=n.select(d);if(0!==q.length){!0;var r=e.getDelegateTarget(d,q,o,p);r&&(a.currentTarget=r,a.delegateTarget=r,a.pageX=i.pageX,a.pageY=i.pageY,e.touchIn=!0,e.touchInDelegate=e.touchInDelegate||{},void 0===e.touchInDelegate[d]?e.touchInDelegate[d]=r:e.touchInDelegate[d]!==r&&(e.touchInDelegate[d]=[e.touchInDelegate[d],r]),b.apply(c,[a,r]));break}if(n.attr(h)===g)break;o.push(n.dom),n,n=n.parent(),m--,p++}}e.removeAttr(h)};f.on("touchmove",g)}},onTouchLeaveEvent:function(a,b,c,d){var e=this,f=Fancy.get(document.body),g=[];if(Fancy.isTouch){var h=function(a,c){var f=Fancy.id(),h="fancy-tempt-attr",a=a.originalEvent||a;if(e.attr(h,f),!0!==e.touchIn)return void e.removeAttr(h);var i=a.targetTouches[0],j=[i.pageX,i.pageY],k=Fancy.get(document.elementFromPoint(j[0]-document.body.scrollLeft,j[1]-document.body.scrollTop));if(!d){for(var l=!1,m=10,n=k;m>0&&n.dom;){if(n.attr(h)===f){l=!0;break}n=n.parent(),m--}if(!1===l)return a.pageX=i.pageX,a.pageY=i.pageY,e.touchIn=!1,b(a,c),void e.removeAttr(h)}if(g.length>30&&(g=g.slice(g.length-5,g.length-1)),g.push(k.dom),d&&e.touchInDelegate[d]){var o,p=Fancy.id();o=Fancy.isArray(e.touchInDelegate[d])?Fancy.get(e.touchInDelegate[d][0]):Fancy.get(e.touchInDelegate[d]),o.attr(h,p),m=10;var q=!1;for(n=k;m>0&&n.dom;){if(n.attr(h)===p){q=!0;break}n=n.parent(),m--}o.removeAttr(h),q||(delete e.touchInDelegate[d],e.touchIn=!1,a.currentTarget=o.dom,a.delegateTarget=o.dom,a.pageX=i.pageX,a.pageY=i.pageY,b(a,o.dom))}e.removeAttr(h)};f.on("touchmove",h)}},getDelegateTarget:function(a,b,c,d){for(var e=c[d-a.match(/\./g).length],f=0,g=b.length;f<g;f++)if(b.item(f).dom===e)return e;return!1},onTouchMove:function(a,b,c){var d=this,e=Fancy.get(document.body);if(Fancy.isTouch){var f=function(a,c){var e=Fancy.id(),f="fancy-tempt-attr",a=a.originalEvent||a;d.attr(f,e);for(var g=a.targetTouches[0],h=[g.pageX,g.pageY],i=!1,j=10,k=Fancy.get(document.elementFromPoint(h[0]-document.body.scrollLeft,h[1]-document.body.scrollTop)),l=k;j>0&&l.dom;){if(l.attr(f)===e){i=!0;break}l=l.parent(),j--}d.removeAttr(f),i&&(a.pageX=g.pageX,a.pageY=g.pageY,b(a,c))};e.on("touchmove",f)}},each:function(a){a(this,0)}},Fancy.Elements=function(a){var b=this;b.dom=a,b.$dom=a,b.length=a.length},Fancy.Elements.prototype={attr:function(a,b){var c=this,d=c.$dom;return c.length>1&&(d=c.$dom[0]),void 0===b?d.attr(a):d.attr(a,b)},addClass:function(a){this.addCls.apply(this,arguments)},finish:function(){for(var a=this,b=0,c=a.length;b<c;b++)Fancy.get(a.$dom[b]).finish()},addCls:function(a){for(var b=this,c=0,d=b.length;c<d;c++)Fancy.get(b.$dom[c]).addClass(a);if(arguments.length>1)for(c=1,d=arguments.length;c<d;c++)b.addClass(arguments[c])},removeClass:function(a){this.removeCls.apply(this,arguments)},removeCls:function(a){for(var b=this,c=0,d=b.length;c<d;c++)Fancy.get(b.$dom[c]).removeCls(a)},hover:function(a){this.$dom.on("mouseenter",a)},on:Fancy.Element.prototype.on,once:Fancy.Element.prototype.once,item:function(a){return Fancy.get(this.$dom[a])},css:function(a,b){for(var c=this,d=0,e=c.length;d<e;d++)Fancy.get(c.$dom[d]).css(a,b)},toggleClass:function(a){for(var b=this,c=0,d=b.length;c<d;c++)Fancy.get(b.$dom[c]).toggleClass(a)},toggleCls:function(a){for(var b=this,c=0,d=b.length;c<d;c++)Fancy.get(b.$dom[c]).toggleClass(a)},destroy:function(){for(var a=this,b=0,c=a.length;b<c;b++)Fancy.get(a.$dom[b]).destroy()},remove:function(){this.destroy()},hide:function(){for(var a=this,b=0,c=a.length;b<c;b++)Fancy.get(a.$dom[b]).hide()},show:function(){for(var a=this,b=0,c=a.length;b<c;b++)Fancy.get(a.$dom[b]).show()},index:function(){return this.$dom[0].index()},each:function(a){for(var b,c=this,d=0,e=c.length;d<e;d++)b=new Fancy.Element(c.$dom[d]),a(b,d)},last:function(){var a=this;return new Fancy.Element(a.$dom[a.length-1])}},Fancy.select=function(a){return Fancy.get(document.body).select(a)},Fancy.onReady=function(a){Fancy.$(document).ready(a)},Fancy.Ajax=function(a){var b={};a.url&&(b.url=a.url),a.success&&(b.success=a.success),a.error&&(b.error=a.error),a.method&&(b.type=a.method),a.params&&(b.data=a.params),a.dataType&&(b.dataType=a.dataType),a.sendJSON&&(b.dataType="json",b.contentType="application/json; charset=utf-8",b.data=JSON.stringify(b.data)),a.getJSON&&(b.dataType="json",b.contentType="application/json; charset=utf-8"),a.headers&&(b.headers=a.headers),Fancy.$.ajax(b)},Fancy.nojQuery&&(Fancy.modules.dom=!0,Fancy.$=function(){function a(a){return null==a?String(a):W[X.call(a)]||"object"}function b(b){return"function"==a(b)}function c(a){return null!=a&&a==a.window}function d(a){return null!=a&&a.nodeType==a.DOCUMENT_NODE}function e(b){return"object"==a(b)}function f(a){return e(a)&&!c(a)&&Object.getPrototypeOf(a)==Object.prototype}function g(a){return"number"==typeof a.length}function h(a){return E.call(a,function(a){return null!=a})}function i(a){return a.length>0?y.fn.concat.apply([],a):a}function j(a){return a.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function k(a){return a in I?I[a]:I[a]=new RegExp("(^|\\s)"+a+"(\\s|$)")}function l(a,b){return"number"!=typeof b||J[j(a)]?b:b+"px"}function m(a){var b,c;return H[a]||(b=G.createElement(a),G.body.appendChild(b),c=getComputedStyle(b,"").getPropertyValue("display"),b.parentNode.removeChild(b),"none"==c&&(c="block"),H[a]=c),H[a]}function n(a){return"children"in a?F.call(a.children):y.map(a.childNodes,function(a){if(1==a.nodeType)return a})}function o(a,b){var c,d=a?a.length:0;for(c=0;c<d;c++)this[c]=a[c];this.length=d,this.selector=b||""}function p(a,b,c){for(x in b)c&&(f(b[x])||_(b[x]))?(f(b[x])&&!f(a[x])&&(a[x]={}),_(b[x])&&!_(a[x])&&(a[x]=[]),p(a[x],b[x],c)):b[x]!==w&&(a[x]=b[x])}function q(a,b){return null==b?y(a):y(a).filter(b)}function r(a,c,d,e){return b(c)?c.call(a,d,e):c}function s(a,b,c){null==c?a.removeAttribute(b):a.setAttribute(b,c)}function t(a,b){var c=a.className||"",d=c&&c.baseVal!==w;if(b===w)return d?c.baseVal:c;d?c.baseVal=b:a.className=b}function u(a){try{return a?"true"==a||"false"!=a&&("null"==a?null:+a+""==a?+a:/^[\[\{]/.test(a)?y.parseJSON(a):a):a}catch(b){return a}}function v(a,b){b(a);for(var c=0,d=a.childNodes.length;c<d;c++)v(a.childNodes[c],b)}var w,x,y,z,A,B,C=[],D=C.concat,E=C.filter,F=C.slice,G=window.document,H={},I={},J={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},K=/^\s*<(\w+|!)[^>]*>/,L=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,M=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,N=/^(?:body|html)$/i,O=/([A-Z])/g,P=["val","css","html","text","data","width","height","offset"],Q=["after","prepend","before","append"],R=G.createElement("table"),S=G.createElement("tr"),T={tr:G.createElement("tbody"),tbody:R,thead:R,tfoot:R,td:S,th:S,"*":G.createElement("div")},U=/complete|loaded|interactive/,V=/^[\w-]*$/,W={},X=W.toString,Y={},Z=G.createElement("div"),$={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},_=Array.isArray||function(a){return a instanceof Array};return Y.matches=function(a,b){if(!b||!a||1!==a.nodeType)return!1;var c=a.webkitMatchesSelector||a.mozMatchesSelector||a.oMatchesSelector||a.matchesSelector;if(c)return c.call(a,b);var d,e=a.parentNode,f=!e;return f&&(e=Z).appendChild(a),d=~Y.qsa(e,b).indexOf(a),f&&Z.removeChild(a),d},A=function(a){return a.replace(/-+(.)?/g,function(a,b){return b?b.toUpperCase():""})},B=function(a){return E.call(a,function(b,c){return a.indexOf(b)==c})},Y.fragment=function(a,b,c){var d,e,g;return L.test(a)&&(d=y(G.createElement(RegExp.$1))),d||(a.replace&&(a=a.replace(M,"<$1></$2>")),b===w&&(b=K.test(a)&&RegExp.$1),b in T||(b="*"),g=T[b],g.innerHTML=""+a,d=y.each(F.call(g.childNodes),function(){g.removeChild(this)})),f(c)&&(e=y(d),y.each(c,function(a,b){P.indexOf(a)>-1?e[a](b):e.attr(a,b)})),d},Y.Z=function(a,b){return new o(a,b)},Y.isZ=function(a){return a instanceof Y.Z},Y.init=function(a,c){var d;if(!a)return Y.Z();if("string"==typeof a)if(a=a.trim(),"<"==a[0]&&K.test(a))d=Y.fragment(a,RegExp.$1,c),a=null;else{if(c!==w)return y(c).find(a);d=Y.qsa(G,a)}else{if(b(a))return y(G).ready(a);if(Y.isZ(a))return a;if(_(a))d=h(a);else if(e(a))d=[a],a=null;else if(K.test(a))d=Y.fragment(a.trim(),RegExp.$1,c),a=null;else{if(c!==w)return y(c).find(a);d=Y.qsa(G,a)}}return Y.Z(d,a)},y=function(a,b){return Y.init(a,b)},y.extend=function(a){var b,c=F.call(arguments,1);return"boolean"==typeof a&&(b=a,a=c.shift()),c.forEach(function(c){p(a,c,b)}),a},Y.qsa=function(a,b){var c,d="#"==b[0],e=!d&&"."==b[0],f=d||e?b.slice(1):b,g=V.test(f);return a.getElementById&&g&&d?(c=a.getElementById(f))?[c]:[]:1!==a.nodeType&&9!==a.nodeType&&11!==a.nodeType?[]:F.call(g&&!d&&a.getElementsByClassName?e?a.getElementsByClassName(f):a.getElementsByTagName(b):a.querySelectorAll(b))},y.contains=G.documentElement.contains?function(a,b){return a!==b&&a.contains(b)}:function(a,b){for(;b&&(b=b.parentNode);)if(b===a)return!0;return!1},y.type=a,y.isFunction=b,y.isWindow=c,y.isArray=_,y.isPlainObject=f,y.isEmptyObject=function(a){var b;for(b in a)return!1;return!0},y.inArray=function(a,b,c){return C.indexOf.call(b,a,c)},y.camelCase=A,y.trim=function(a){return null==a?"":String.prototype.trim.call(a)},y.uuid=0,y.support={},y.expr={},y.noop=function(){},y.map=function(a,b){var c,d,e,f=[];if(g(a))for(d=0;d<a.length;d++)null!=(c=b(a[d],d))&&f.push(c);else for(e in a)null!=(c=b(a[e],e))&&f.push(c);return i(f)},y.each=function(a,b){var c,d;if(g(a)){for(c=0;c<a.length;c++)if(!1===b.call(a[c],c,a[c]))return a}else for(d in a)if(!1===b.call(a[d],d,a[d]))return a;return a},y.grep=function(a,b){return E.call(a,b)},window.JSON&&(y.parseJSON=JSON.parse),y.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){W["[object "+b+"]"]=b.toLowerCase()}),y.fn={constructor:Y.Z,length:0,forEach:C.forEach,reduce:C.reduce,push:C.push,sort:C.sort,splice:C.splice,indexOf:C.indexOf,concat:function(){var a,b,c=[];for(a=0;a<arguments.length;a++)b=arguments[a],c[a]=Y.isZ(b)?b.toArray():b;return D.apply(Y.isZ(this)?this.toArray():this,c)},map:function(a){return y(y.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return y(F.apply(this,arguments))},ready:function(a){return U.test(G.readyState)&&G.body?a(y):G.addEventListener("DOMContentLoaded",function(){a(y)},!1),this},get:function(a){return a===w?F.call(this):this[a>=0?a:a+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(a){return C.every.call(this,function(b,c){return!1!==a.call(b,c,b)}),this},filter:function(a){return b(a)?this.not(this.not(a)):y(E.call(this,function(b){return Y.matches(b,a)}))},add:function(a,b){return y(B(this.concat(y(a,b))))},is:function(a){return this.length>0&&Y.matches(this[0],a)},not:function(a){var c=[];if(b(a)&&a.call!==w)this.each(function(b){a.call(this,b)||c.push(this)});else{var d="string"==typeof a?this.filter(a):g(a)&&b(a.item)?F.call(a):y(a);this.forEach(function(a){d.indexOf(a)<0&&c.push(a)})}return y(c)},has:function(a){return this.filter(function(){return e(a)?y.contains(this,a):y(this).find(a).size()})},eq:function(a){return-1===a?this.slice(a):this.slice(a,+a+1)},first:function(){var a=this[0];return a&&!e(a)?a:y(a)},last:function(){var a=this[this.length-1];return a&&!e(a)?a:y(a)},find:function(a){var b=this;return a?"object"==typeof a?y(a).filter(function(){var a=this;return C.some.call(b,function(b){return y.contains(b,a)})}):1==this.length?y(Y.qsa(this[0],a)):this.map(function(){return Y.qsa(this,a)}):y()},closest:function(a,b){var c=this[0],e=!1;for("object"==typeof a&&(e=y(a));c&&!(e?e.indexOf(c)>=0:Y.matches(c,a));)c=c!==b&&!d(c)&&c.parentNode;return y(c)},parents:function(a){for(var b=[],c=this;c.length>0;)c=y.map(c,function(a){if((a=a.parentNode)&&!d(a)&&b.indexOf(a)<0)return b.push(a),a});return q(b,a)},parent:function(a){return q(B(this.pluck("parentNode")),a)},children:function(a){return q(this.map(function(){return n(this)}),a)},contents:function(){return this.map(function(){return this.contentDocument||F.call(this.childNodes)})},siblings:function(a){return q(this.map(function(a,b){return E.call(n(b.parentNode),function(a){return a!==b})}),a)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(a){return y.map(this,function(b){return b[a]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display=""),"none"==getComputedStyle(this,"").getPropertyValue("display")&&(this.style.display=m(this.nodeName))})},replaceWith:function(a){return this.before(a).remove()},wrap:function(a){var c=b(a);if(this[0]&&!c)var d=y(a).get(0),e=d.parentNode||this.length>1;return this.each(function(b){y(this).wrapAll(c?a.call(this,b):e?d.cloneNode(!0):d)})},wrapAll:function(a){if(this[0]){y(this[0]).before(a=y(a));for(var b;(b=a.children()).length;)a=b.first();y(a).append(this)}return this},wrapInner:function(a){var c=b(a);return this.each(function(b){var d=y(this),e=d.contents(),f=c?a.call(this,b):a;e.length?e.wrapAll(f):d.append(f)})},unwrap:function(){return this.parent().each(function(){y(this).replaceWith(y(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(a){return this.each(function(){var b=y(this);(a===w?"none"==b.css("display"):a)?b.show():b.hide()})},prev:function(a){return y(this.pluck("previousElementSibling")).filter(a||"*")},next:function(a){return y(this.pluck("nextElementSibling")).filter(a||"*")},html:function(a){return 0 in arguments?this.each(function(b){var c=this.innerHTML;y(this).empty().append(r(this,a,b,c))}):0 in this?this[0].innerHTML:null},text:function(a){return 0 in arguments?this.each(function(b){var c=r(this,a,b,this.textContent);this.textContent=null==c?"":""+c}):0 in this?this.pluck("textContent").join(""):null},attr:function(a,b){var c;return"string"!=typeof a||1 in arguments?this.each(function(c){if(1===this.nodeType)if(e(a))for(x in a)s(this,x,a[x]);else s(this,a,r(this,b,c,this.getAttribute(a)))}):this.length&&1===this[0].nodeType?!(c=this[0].getAttribute(a))&&a in this[0]?this[0][a]:c:w},removeAttr:function(a){return this.each(function(){1===this.nodeType&&a.split(" ").forEach(function(a){s(this,a)},this)})},prop:function(a,b){return a=$[a]||a,1 in arguments?this.each(function(c){this[a]=r(this,b,c,this[a])}):this[0]&&this[0][a]},data:function(a,b){var c="data-"+a.replace(O,"-$1").toLowerCase(),d=1 in arguments?this.attr(c,b):this.attr(c);return null!==d?u(d):w},val:function(a){return 0 in arguments?this.each(function(b){this.value=r(this,a,b,this.value)}):this[0]&&(this[0].multiple?y(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value)},offset:function(a){if(a)return this.each(function(b){var c=y(this),d=r(this,a,b,c.offset()),e=c.offsetParent().offset(),f={top:d.top-e.top,left:d.left-e.left};"static"==c.css("position")&&(f.position="relative"),c.css(f)});if(!this.length)return null;if(!y.contains(G.documentElement,this[0]))return{top:0,left:0};var b=this[0].getBoundingClientRect();return{left:b.left+window.pageXOffset,top:b.top+window.pageYOffset,width:Math.round(b.width),height:Math.round(b.height)}},css:function(b,c){if(arguments.length<2){var d,e=this[0];if(!e)return;if(d=getComputedStyle(e,""),"string"==typeof b)return e.style[A(b)]||d.getPropertyValue(b);if(_(b)){var f={};return y.each(b,function(a,b){f[b]=e.style[A(b)]||d.getPropertyValue(b)}),f}}var g="";if("string"==a(b))c||0===c?g=j(b)+":"+l(b,c):this.each(function(){this.style.removeProperty(j(b))});else for(x in b)b[x]||0===b[x]?g+=j(x)+":"+l(x,b[x])+";":this.each(function(){this.style.removeProperty(j(x))});return this.each(function(){this.style.cssText+=";"+g})},index:function(a){return a?this.indexOf(y(a)[0]):this.parent().children().indexOf(this[0])},hasClass:function(a){return!!a&&C.some.call(this,function(a){return this.test(t(a))},k(a))},addClass:function(a){return a?this.each(function(b){if("className"in this){z=[];var c=t(this);r(this,a,b,c).split(/\s+/g).forEach(function(a){y(this).hasClass(a)||z.push(a)},this),z.length&&t(this,c+(c?" ":"")+z.join(" "))}}):this},removeClass:function(a){return this.each(function(b){if("className"in this){if(a===w)return t(this,"");z=t(this),r(this,a,b,z).split(/\s+/g).forEach(function(a){z=z.replace(k(a)," ")}),t(this,z.trim())}})},toggleClass:function(a,b){return a?this.each(function(c){var d=y(this);r(this,a,c,t(this)).split(/\s+/g).forEach(function(a){(b===w?!d.hasClass(a):b)?d.addClass(a):d.removeClass(a)})}):this},scrollTop:function(a){if(this.length){var b="scrollTop"in this[0];return a===w?b?this[0].scrollTop:this[0].pageYOffset:this.each(b?function(){this.scrollTop=a}:function(){this.scrollTo(this.scrollX,a)})}},scrollLeft:function(a){if(this.length){var b="scrollLeft"in this[0];return a===w?b?this[0].scrollLeft:this[0].pageXOffset:this.each(b?function(){this.scrollLeft=a}:function(){this.scrollTo(a,this.scrollY)})}},position:function(){if(this.length){var a=this[0],b=this.offsetParent(),c=this.offset(),d=N.test(b[0].nodeName)?{top:0,left:0}:b.offset();return c.top-=parseFloat(y(a).css("margin-top"))||0,c.left-=parseFloat(y(a).css("margin-left"))||0,d.top+=parseFloat(y(b[0]).css("border-top-width"))||0,d.left+=parseFloat(y(b[0]).css("border-left-width"))||0,{top:c.top-d.top,left:c.left-d.left}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||G.body;a&&!N.test(a.nodeName)&&"static"==y(a).css("position");)a=a.offsetParent;return a})}},y.fn.detach=y.fn.remove,["width","height"].forEach(function(a){var b=a.replace(/./,function(a){return a[0].toUpperCase()});y.fn[a]=function(e){var f,g=this[0];return e===w?c(g)?g["inner"+b]:d(g)?g.documentElement["scroll"+b]:(f=this.offset())&&f[a]:this.each(function(b){g=y(this),g.css(a,r(this,e,b,g[a]()))})}}),Q.forEach(function(b,c){var d=c%2;y.fn[b]=function(){var b,e,f=y.map(arguments,function(c){return b=a(c),"object"==b||"array"==b||null==c?c:Y.fragment(c)}),g=this.length>1;return f.length<1?this:this.each(function(a,b){e=d?b:b.parentNode,b=0==c?b.nextSibling:1==c?b.firstChild:2==c?b:null;var h=y.contains(G.documentElement,e);f.forEach(function(a){if(g)a=a.cloneNode(!0);else if(!e)return y(a).remove();e.insertBefore(a,b),h&&v(a,function(a){null==a.nodeName||"SCRIPT"!==a.nodeName.toUpperCase()||a.type&&"text/javascript"!==a.type||a.src||window.eval.call(window,a.innerHTML)})})})},y.fn[d?b+"To":"insert"+(c?"Before":"After")]=function(a){return y(a)[b](this),this}}),Y.Z.prototype=o.prototype=y.fn,Y.uniq=B,Y.deserializeValue=u,y.zepto=Y,y}()),Fancy.nojQuery&&function(a){function b(a){return a._zid||(a._zid=m++)}function c(a,c,f,g){if(c=d(c),c.ns)var h=e(c.ns);return(q[b(a)]||[]).filter(function(a){return a&&(!c.e||a.e==c.e)&&(!c.ns||h.test(a.ns))&&(!f||b(a.fn)===b(f))&&(!g||a.sel==g)})}function d(a){var b=(""+a).split(".");return{e:b[0],ns:b.slice(1).sort().join(" ")}}function e(a){return new RegExp("(?:^| )"+a.replace(" "," .* ?")+"(?: |$)")}function f(a,b){return a.del&&!s&&a.e in t||!!b}function g(a){return u[a]||s&&t[a]||a}function h(c,e,h,i,k,m,n){var o=b(c),p=q[o]||(q[o]=[]);e.split(/\s/).forEach(function(b){if("ready"==b)return a(document).ready(h);var e=d(b);e.fn=h,e.sel=k,e.e in u&&(h=function(b){var c=b.relatedTarget;if(!c||c!==this&&!a.contains(this,c))return e.fn.apply(this,arguments)}),e.del=m;var o=m||h;e.proxy=function(a){if(a=j(a),!a.isImmediatePropagationStopped()){a.data=i;var b=o.apply(c,a._args==l?[a]:[a].concat(a._args));return!1===b&&(a.preventDefault(),a.stopPropagation()),b}},e.i=p.length,p.push(e),"addEventListener"in c&&c.addEventListener(g(e.e),e.proxy,f(e,n))})}function i(a,d,e,h,i){var j=b(a);(d||"").split(/\s/).forEach(function(b){c(a,b,e,h).forEach(function(b){delete q[j][b.i],"removeEventListener"in a&&a.removeEventListener(g(b.e),b.proxy,f(b,i))})})}function j(b,c){return!c&&b.isDefaultPrevented||(c||(c=b),a.each(y,function(a,d){var e=c[a];b[a]=function(){return this[d]=v,e&&e.apply(c,arguments)},b[d]=w}),(c.defaultPrevented!==l?c.defaultPrevented:"returnValue"in c?!1===c.returnValue:c.getPreventDefault&&c.getPreventDefault())&&(b.isDefaultPrevented=v)),b}function k(a){var b,c={originalEvent:a};for(b in a)x.test(b)||a[b]===l||(c[b]=a[b]);return j(c,a)}var l,m=1,n=Array.prototype.slice,o=Fancy.isFunction,p=function(a){return"string"==typeof a},q={},r={},s="onfocusin"in window,t={focus:"focusin",blur:"focusout"},u={mouseenter:"mouseover",mouseleave:"mouseout"};r.click=r.mousedown=r.mouseup=r.mousemove="MouseEvents",a.event={add:h,remove:i},a.proxy=function(c,d){var e=2 in arguments&&n.call(arguments,2);if(o(c)){var f=function(){return c.apply(d,e?e.concat(n.call(arguments)):arguments)};return f._zid=b(c),f}if(p(d))return e?(e.unshift(c[d],c),a.proxy.apply(null,e)):a.proxy(c[d],c);throw new TypeError("expected function")},a.fn.bind=function(a,b,c){return this.on(a,b,c)},a.fn.unbind=function(a,b){return this.off(a,b)},a.fn.one=function(a,b,c,d){return this.on(a,b,c,d,1)};var v=function(){return!0},w=function(){return!1},x=/^([A-Z]|returnValue$|layer[XY]$)/,y={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};a.fn.delegate=function(a,b,c){return this.on(b,a,c)},a.fn.undelegate=function(a,b,c){return this.off(b,a,c)},a.fn.live=function(b,c){return a(document.body).delegate(this.selector,b,c),this},a.fn.die=function(b,c){return a(document.body).undelegate(this.selector,b,c),this},a.fn.on=function(b,c,d,e,f){var g,j,m=this;return b&&!p(b)?(a.each(b,function(a,b){m.on(a,c,d,b,f)}),m):(p(c)||o(e)||!1===e||(e=d,d=c,c=l),e!==l&&!1!==d||(e=d,d=l),!1===e&&(e=w),m.each(function(l,m){f&&(g=function(a){return i(m,a.type,e),e.apply(this,arguments)}),c&&(j=function(b){var d,f=a(b.target).closest(c,m).get(0);if(f&&f!==m)return d=a.extend(k(b),{currentTarget:f,liveFired:m}),(g||e).apply(f,[d].concat(n.call(arguments,1)))}),h(m,b,e,d,c,j||g)}))},a.fn.off=function(b,c,d){var e=this;return b&&!p(b)?(a.each(b,function(a,b){e.off(a,c,b)}),e):(p(c)||o(d)||!1===d||(d=c,c=l),!1===d&&(d=w),e.each(function(){i(this,b,d,c)}))},a.fn.trigger=function(b,c){return b=p(b)||a.isPlainObject(b)?a.Event(b):j(b),b._args=c,this.each(function(){b.type in t&&"function"==typeof this[b.type]?this[b.type]():"dispatchEvent"in this?this.dispatchEvent(b):a(this).triggerHandler(b,c)})},a.fn.triggerHandler=function(b,d){var e,f;return this.each(function(g,h){e=k(p(b)?a.Event(b):b),e._args=d,e.target=h,a.each(c(h,b.type||b),function(a,b){if(f=b.proxy(e),e.isImmediatePropagationStopped())return!1})}),f},"focusin focusout focus blur load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(b){a.fn[b]=function(a){return 0 in arguments?this.bind(b,a):this.trigger(b)}}),a.Event=function(a,b){p(a)||(b=a,a=b.type);var c=document.createEvent(r[a]||"Events"),d=!0;if(b)for(var e in b)"bubbles"==e?d=!!b[e]:c[e]=b[e];return c.initEvent(a,d,!0),j(c)}}(Fancy.$),Fancy.nojQuery&&function(a,b){function c(a){return a.replace(/([a-z])([A-Z])/,"$1-$2").toLowerCase()}function d(a){return e?e+a:a.toLowerCase()}var e,f,g,h,i,j,k,l,m,n,o="",p={Webkit:"webkit",Moz:"",O:"o"},q=document.createElement("div"),r=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i,s={};a.each(p,function(a,c){if(q.style[a+"TransitionProperty"]!==b)return o="-"+a.toLowerCase()+"-",e=c,!1}),f=o+"transform",s[g=o+"transition-property"]=s[h=o+"transition-duration"]=s[j=o+"transition-delay"]=s[i=o+"transition-timing-function"]=s[k=o+"animation-name"]=s[l=o+"animation-duration"]=s[n=o+"animation-delay"]=s[m=o+"animation-timing-function"]="",a.fx={off:e===b&&q.style.transitionProperty===b,speeds:{_default:400,fast:200,slow:600},cssPrefix:o,transitionEnd:d("TransitionEnd"),animationEnd:d("AnimationEnd")},a.fn.animate=function(c,d,e,f,g){return a.isFunction(d)&&(f=d,e=b,d=b),a.isFunction(e)&&(f=e,e=b),a.isPlainObject(d)&&(e=d.easing,f=d.complete,g=d.delay,d=d.duration),d&&(d=("number"==typeof d?d:a.fx.speeds[d]||a.fx.speeds._default)/1e3),g&&(g=parseFloat(g)/1e3),this.anim(c,d,e,f,g)},a.fn.anim=function(d,e,o,p,q){var t,u,v,w={},x="",y=this,z=a.fx.transitionEnd,A=!1;if(e===b&&(e=a.fx.speeds._default/1e3),q===b&&(q=0),a.fx.off&&(e=0),"string"==typeof d)w[k]=d,w[l]=e+"s",w[n]=q+"s",w[m]=o||"linear",z=a.fx.animationEnd;else{u=[];for(t in d)r.test(t)?x+=t+"("+d[t]+") ":(w[t]=d[t],u.push(c(t)));x&&(w[f]=x,u.push(f)),e>0&&"object"==typeof d&&(w[g]=u.join(", "),w[h]=e+"s",w[j]=q+"s",w[i]=o||"linear")}return v=function(b){if(void 0!==b){if(b.target!==b.currentTarget)return;a(b.target).unbind(z,v)}else a(this).unbind(z,v);A=!0,a(this).css(s),p&&p.call(this)},e>0&&(this.bind(z,v),setTimeout(function(){A||v.call(y)},1e3*(e+q)+25)),this.size()&&this.get(0).clientLeft,this.css(w),e<=0&&setTimeout(function(){y.each(function(){v.call(this)})},0),this},q=null}(Fancy.$),Fancy.nojQuery&&function(a,b){function c(c,d,e,f,g){"function"!=typeof d||g||(g=d,d=b);var h={opacity:e};return f&&(h.scale=f,c.css(a.fx.cssPrefix+"transform-origin","0 0")),c.animate(h,d,null,g)}function d(b,d,e,g){return c(b,d,0,e,function(){f.call(a(this)),g&&g.call(this)})}var e=a.fn.show,f=a.fn.hide,g=a.fn.toggle;a.fn.show=function(a,d){return e.call(this),a===b?a=0:this.css("opacity",0),c(this,a,1,"1,1",d)},a.fn.hide=function(a,c){return a===b?f.call(this):d(this,a,"0,0",c)},a.fn.toggle=function(c,d){return c===b||"boolean"==typeof c?g.call(this,c):this.each(function(){var b=a(this);b["none"==b.css("display")?"show":"hide"](c,d)})},a.fn.fadeTo=function(a,b,d){return c(this,a,b,null,d)},a.fn.fadeIn=function(a,b){var c=this.css("opacity");return c>0?this.css("opacity",0):c=1,e.call(this).fadeTo(a,c,b)},a.fn.fadeOut=function(a,b){return d(this,a,null,b)},a.fn.fadeToggle=function(b,c){return this.each(function(){var d=a(this);d[0==d.css("opacity")||"none"==d.css("display")?"fadeIn":"fadeOut"](b,c)})}}(Fancy.$),Fancy.nojQuery&&(Fancy.modules.ajax=!0,function(a){function b(b,c,d){var e=a.Event(c);return a(b).trigger(e,d),!e.isDefaultPrevented()}function c(a,c,d,e){if(a.global)return b(c||s,d,e)}function d(b){b.global&&0==a.active++&&c(b,null,"ajaxStart")}function e(b){b.global&&!--a.active&&c(b,null,"ajaxStop")}function f(a,b){var d=b.context;if(!1===b.beforeSend.call(d,a,b)||!1===c(b,d,"ajaxBeforeSend",[a,b]))return!1;c(b,d,"ajaxSend",[a,b])}function g(a,b,d,e){var f=d.context,g="success";d.success.call(f,a,g,b),e&&e.resolveWith(f,[a,g,b]),c(d,f,"ajaxSuccess",[b,d,a]),i(g,b,d)}function h(a,b,d,e,f){var g=e.context;e.error.call(g,d,b,a),f&&f.rejectWith(g,[d,b,a]),c(e,g,"ajaxError",[d,e,a||b]),i(b,d,e)}function i(a,b,d){var f=d.context;d.complete.call(f,b,a),c(d,f,"ajaxComplete",[b,d]),e(d)}function j(){}function k(a){return a&&(a=a.split(";",2)[0]),a&&(a==x?"html":a==w?"json":u.test(a)?"script":v.test(a)&&"xml")||"text"}function l(a,b){return""==b?a:(a+"&"+b).replace(/[&?]{1,2}/,"?")}function m(b){b.processData&&b.data&&"string"!=a.type(b.data)&&(b.data=a.param(b.data,b.traditional)),!b.data||b.type&&"GET"!=b.type.toUpperCase()||(b.url=l(b.url,b.data),b.data=void 0)}function n(b,c,d,e){return a.isFunction(c)&&(e=d,d=c,c=void 0),a.isFunction(d)||(e=d,d=void 0),{url:b,data:c,success:d,dataType:e}}function o(b,c,d,e){var f,g=a.isArray(c),h=a.isPlainObject(c);a.each(c,function(c,i){f=a.type(i),e&&(c=d?e:e+"["+(h||"object"==f||"array"==f?c:"")+"]"),!e&&g?b.add(i.name,i.value):"array"==f||!d&&"object"==f?o(b,i,d,c):b.add(c,i)})}var p,q,r=0,s=window.document,t=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,u=/^(?:text|application)\/javascript/i,v=/^(?:text|application)\/xml/i,w="application/json",x="text/html",y=/^\s*$/,z=s.createElement("a");z.href=window.location.href,a.active=0,a.ajaxJSONP=function(b,c){if(!("type"in b))return a.ajax(b);var d,e,i=b.jsonpCallback,j=(a.isFunction(i)?i():i)||"jsonp"+ ++r,k=s.createElement("script"),l=window[j],m=function(b){a(k).triggerHandler("error",b||"abort")},n={abort:m};return c&&c.promise(n),a(k).on("load error",function(f,i){clearTimeout(e),a(k).off().remove(),"error"!=f.type&&d?g(d[0],n,b,c):h(null,i||"error",n,b,c),window[j]=l,d&&a.isFunction(l)&&l(d[0]),l=d=void 0}),!1===f(n,b)?(m("abort"),n):(window[j]=function(){d=arguments},k.src=b.url.replace(/\?(.+)=\?/,"?$1="+j),s.head.appendChild(k),b.timeout>0&&(e=setTimeout(function(){m("timeout")},b.timeout)),n)},a.ajaxSettings={type:"GET",beforeSend:j,success:j,error:j,complete:j,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:w,xml:"application/xml, text/xml",html:x,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0},a.ajax=function(b){var c,e,i=a.extend({},b||{}),n=a.Deferred&&a.Deferred();for(p in a.ajaxSettings)void 0===i[p]&&(i[p]=a.ajaxSettings[p]);d(i),i.crossDomain||(c=s.createElement("a"),c.href=i.url,c.href=c.href,i.crossDomain=z.protocol+"//"+z.host!=c.protocol+"//"+c.host),i.url||(i.url=window.location.toString()),(e=i.url.indexOf("#"))>-1&&(i.url=i.url.slice(0,e)),m(i);var o=i.dataType,r=/\?.+=\?/.test(i.url);if(r&&(o="jsonp"),!1!==i.cache&&(b&&!0===b.cache||"script"!=o&&"jsonp"!=o)||(i.url=l(i.url,"_="+Date.now())),"jsonp"==o)return r||(i.url=l(i.url,i.jsonp?i.jsonp+"=?":!1===i.jsonp?"":"callback=?")),a.ajaxJSONP(i,n);var t,u=i.accepts[o],v={},w=function(a,b){v[a.toLowerCase()]=[a,b]},x=/^([\w-]+:)\/\//.test(i.url)?RegExp.$1:window.location.protocol,A=i.xhr(),B=A.setRequestHeader;if(n&&n.promise(A),i.crossDomain||w("X-Requested-With","XMLHttpRequest"),w("Accept",u||"*/*"),(u=i.mimeType||u)&&(u.indexOf(",")>-1&&(u=u.split(",",2)[0]),A.overrideMimeType&&A.overrideMimeType(u)),(i.contentType||!1!==i.contentType&&i.data&&"GET"!=i.type.toUpperCase())&&w("Content-Type",i.contentType||"application/x-www-form-urlencoded"),i.headers)for(q in i.headers)w(q,i.headers[q]);if(A.setRequestHeader=w,A.onreadystatechange=function(){if(4==A.readyState){A.onreadystatechange=j,clearTimeout(t);var b,c=!1;if(A.status>=200&&A.status<300||304==A.status||0==A.status&&"file:"==x){if(o=o||k(i.mimeType||A.getResponseHeader("content-type")),"arraybuffer"==A.responseType||"blob"==A.responseType)b=A.response;else{b=A.responseText;try{"script"==o?(0,eval)(b):"xml"==o?b=A.responseXML:"json"==o&&(b=y.test(b)?null:a.parseJSON(b))}catch(a){c=a}if(c)return h(c,"parsererror",A,i,n)}g(b,A,i,n)}else h(A.statusText||null,A.status?"error":"abort",A,i,n)}},!1===f(A,i))return A.abort(),h(null,"abort",A,i,n),A;if(i.xhrFields)for(q in i.xhrFields)A[q]=i.xhrFields[q];var C=!("async"in i)||i.async;A.open(i.type,i.url,C,i.username,i.password);for(q in v)B.apply(A,v[q]);return i.timeout>0&&(t=setTimeout(function(){A.onreadystatechange=j,A.abort(),h(null,"timeout",A,i,n)},i.timeout)),A.send(i.data?i.data:null),A},a.get=function(){return a.ajax(n.apply(null,arguments))},a.post=function(){var b=n.apply(null,arguments);return b.type="POST",a.ajax(b)},a.getJSON=function(){var b=n.apply(null,arguments);return b.dataType="json",a.ajax(b)},a.fn.load=function(b,c,d){if(!this.length)return this;var e,f=this,g=b.split(/\s/),h=n(b,c,d),i=h.success;return g.length>1&&(h.url=g[0],e=g[1]),h.success=function(b){f.html(e?a("<div>").html(b.replace(t,"")).find(e):b),i&&i.apply(f,arguments)},a.ajax(h),this};var A=encodeURIComponent;a.param=function(b,c){var d=[];return d.add=function(b,c){a.isFunction(c)&&(c=c()),null==c&&(c=""),this.push(A(b)+"="+A(c))},o(d,b,c),d.join("&").replace(/%20/g,"+")}}(Fancy.$)),Fancy.i18n.en={paging:{first:"First Page",last:"Last Page",prev:"Previous Page",next:"Next Page",info:"Rows [0] - [1] of [2]",page:"Page",of:"of [0]"},loadingText:"Loading...",thousandSeparator:",",decimalSeparator:".",currencySign:"$",sourceText:"Source",date:{read:"m/d/Y",write:"m/d/Y",edit:"m/d/Y",today:"Today",startDay:0,days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],am:"am",pm:"pm",AM:"AM",PM:"PM",ok:"OK",cancel:"Cancel"},yes:"Yes",no:"No",dragText:"[0] selected row[1]",update:"Update",cancel:"Cancel",columns:"Columns",sortAsc:"Sort ASC",sortDesc:"Sort DESC",lock:"Lock",unlock:"Unlock",rightLock:"Right Lock"},Fancy.i18n["en-US"]=Fancy.i18n.en,Fancy.controllers={},Fancy.defineController=function(a,b){Fancy.controllers[a]=b},Fancy.defineControl=Fancy.defineController,Fancy.getController=function(a){return Fancy.controllers[a]},Fancy.getControl=Fancy.getController,Fancy.define("Fancy.DD",{extend:Fancy.Event,singleton:!0,constructor:function(a){this.Super("const",arguments),this.init()},init:function(){this.addEvents(),this.els={}},add:function(a){var b=this,c=Fancy.id(a.overEl);b.els[c]=a,a.overEl.on("mousedown",b.onMouseDown,b)},onMouseDown:function(a){var b=this,c=Fancy.get(document),d=Fancy.get(a.currentTarget),e=b.els[d.attr("id")].dragEl;a.preventDefault(),b.clientX=a.clientX,b.clientY=a.clientY,b.startX=parseInt(e.css("left")),b.startY=parseInt(e.css("top")),b.activeId=d.attr("id"),c.once("mouseup",b.onMouseUp,b),c.on("mousemove",b.onMouseMove,b)},onMouseUp:function(){Fancy.get(document).un("mousemove",this.onMouseMove,this)},onMouseMove:function(a){var b=this,c=b.els[b.activeId],d=c.dragEl,e=a.clientX,f=a.clientY,g=b.clientX-e,h=b.clientY-f,i=b.startX-g,j=b.startY-h;j<0&&(j=0),d.css({left:i,top:j})}}),Fancy.define("Fancy.Widget",{extend:Fancy.Event,constructor:function(a){var b=this;Fancy.applyConfig(b,a),b.preInitControls(),b.Super("const",arguments),b.init(),b.initControls()},init:function(){var a=this;a.initId(),a.addEvents("beforerender","afterrender","render","show","beforehide","hide","destroy"),a.initPlugins()},renderItems:function(a){var b=this;Fancy.each(b.items,function(c,d){var e=Fancy.getClassByType(c.type);c.renderTo=a,b.items[d]=new e(c)})},preInitControls:function(){var a=this,b=a.controller||a.controllers;if(b)switch(Fancy.typeOf(b)){case"string":b=Fancy.getController(b);for(var c in b)void 0===a[c]&&(a[c]=b[c]);break;case"array":for(var d=[],e=0,f=b.length;e<f;e++){var g=Fancy.getController(b[e]);for(var c in g)"controls"!==c?void 0===a[c]&&(a[c]=g[c]):d=d.concat(g.controls)}a.controls=d}},initControls:function(){var a=this;if(void 0!==a.controls)for(var b=a.controls,c=0,d=b.length;c<d;c++){var e=b[c];if(void 0===e.event)throw new Error("[FancyGrid Error]: - not set event name for control");if(void 0===e.handler)throw new Error("[FancyGrid Error]: - not set handler for control");var f=e.event,g=e.handler,h=e.scope||a,i=e.selector;Fancy.isString(g)&&(g=a[g]),i?function(b,c,d,e){a.$events[b]?a.on(b,function(a,b){var f=b.e.target,g=Fancy.get(f),h=g.parent(),i=h.select(e);if(1===i.length&&i.within(f))c.apply(d,arguments);else if(i.length>1)for(var j=0,k=i.length;j<k;j++)i.item(j).within(f)&&c.apply(d,arguments)},d):a.on("render",function(){a.el.on(b,c,d,e)})}(f,g,h,i):void 0===i&&void 0===e.widget&&a.on(f,g,h)}},css:function(a,b){return this.el.css(a,b)},addClass:function(a){this.el.addCls(a)},addCls:function(a){this.el.addCls(a)},removeClass:function(a){this.el.removeCls(a)},removeCls:function(a){this.el.removeCls(a)},hasClass:function(a){return this.el.hasCls(a)},hasCls:function(a){return this.el.hasCls(a)},toggleClass:function(a){this.el.toggleCls(a)},toggleCls:function(a){this.el.toggleCls(a)},destroy:function(){this.el&&this.el.destroy()},show:function(){this.el.show()},hide:function(){this.el.hide()},initTpl:function(){var a=this;a.tpl&&(a.tpl=new Fancy.Template(a.tpl))}}),Fancy.define("Fancy.Plugin",{extend:Fancy.Event,constructor:function(){this.Super("const",arguments),this.init()},init:function(){this.initId(),this.addEvents("beforerender","afterrender","render","show","hide","destroy")},initTpl:function(){var a=this.tpl;a&&(this.tpl=new Fancy.Template(a))}}),function(){var a={},b=Fancy,c=b.GRID_CLS,d=b.PANEL_BODY_CLS,e=b.BUTTON_CLS,f=b.BUTTON_DISABLED_CLS,g=b.BUTTON_PRESSED_CLS,h=b.BUTTON_IMAGE_CLS,i=b.BUTTON_IMAGE_COLOR_CLS,j=b.BUTTON_TEXT_CLS,k=b.BUTTON_DROP_CLS,l=b.BUTTON_MENU_CLS;b.define("Fancy.Button",{extend:b.Widget,minWidth:30,constructor:function(b,c){var d=this;b.toggleGroup&&(a[b.toggleGroup]=a[b.toggleGroup]||{active:!1,items:[]},a[b.toggleGroup].items.push(d)),d.scope=c||b.scope||d.scope||d,d.Super("const",arguments)},init:function(){var a=this;a.addEvents("click","mousedown","mouseup","mouseover","mouseout","pressedchange"),a.Super("init",arguments),a.style=a.style||{},a.initTpl(),a.render(),a.setOns()},setOns:function(){var a=this,b=a.el;b.on("click",a.onClick,a),b.on("mousedown",a.onMouseDown,a),b.on("mouseup",a.onMouseUp,a),b.on("mouseover",a.onMouseOver,a),b.on("mouseout",a.onMouseOut,a),a.tip&&b.on("mousemove",a.onMouseMove,a)},widgetCls:e,cls:"",extraCls:"",disabledCls:f,pressedCls:g,buttonImageCls:h,buttonImageColorCls:i,textCls:j,dropCls:k,text:"",height:28,paddingTextWidth:5,imageWidth:20,rightImageWidth:20,pressed:!1,theme:"default",tpl:['<div class="'+h+'"></div>','<a class="'+j+'">{text}</a>','<div class="'+k+'" style="{dropDisplay}"></div>'],render:function(){var a,c=this,d=b.get(document.createElement("div")),e=0,g=7;switch(c.theme&&Fancy.themes[c.theme]&&(g=Fancy.themes[c.theme].config.charWidth),c.i18n){case"zh-CN":case"zh-TW":case"ja":case"ko":g=10}if(c.fire("beforerender"),c.wrapper&&c.renderWrapper(),a=b.get(c.renderTo||document.body).dom,c.width?e=c.width:!1!==c.text&&void 0!==c.text&&(e+=c.text.length*g+2*g),c.imageColor&&(c.imageCls=i),e<c.minWidth&&(e=(c.text&&c.text.length,c.minWidth)),c.imageCls&&c.text&&(e+=c.imageWidth),c.menu&&(e+=c.rightImageWidth),d.addCls(b.cls,c.widgetCls,c.cls,c.extraCls),c.disabled&&d.addCls(f),c.menu&&d.addCls(l),d.css({width:e+"px",height:c.height+"px"}),c.hidden&&d.css("display","none"),d.css(c.style||{}),d.update(c.tpl.getHTML({text:c.text||""})),c.imageCls){var j=d.select("."+h);c.imageColor&&j.css("background-color",c.imageColor),j.css("display","block"),b.isString(c.imageCls)&&j.addCls(c.imageCls)}c.id&&d.attr("id",c.id),c.el=b.get(a.appendChild(d.dom)),c.disabled&&c.disable(),c.pressed&&c.setPressed(c.pressed),c.initToggle(),c.width=e,c.fire("afterrender"),c.fire("render")},renderWrapper:function(){var a=this,c=a.wrapper,d=b.get(a.renderTo||document.body).dom,e=b.get(document.createElement("div"));e.css(c.style||{}),e.addCls(c.cls||""),a.wrapper=b.get(d.appendChild(e.dom)),a.renderTo=a.wrapper.dom},initToggle:function(){if(!this.enableToggle)return!1},setPressed:function(b,c){var d=this;if(b){if(d.addCls(g),d.pressed=!0,d.toggleGroup){var e=a[d.toggleGroup].active;e&&e.setPressed(!1),a[d.toggleGroup].active=d}}else d.removeCls(g),d.pressed=!1;!1!==c&&d.fire("pressedchange",d.pressed)},toggle:function(){var a=this,b=!a.pressed;a.setPressed(b),a.pressed=b},onClick:function(a){var c=this,d=c.handler;c.fire("click"),!0!==c.disabled&&(d&&(b.isString(d)&&(d=c.getHandler(d)),c.scope?d.apply(c.scope,[c]):d(c)),c.enableToggle&&(c.toggleGroup?c.setPressed(!0):c.toggle()),c.menu&&(c.toggle(),c.toggleMenuShow(a)))},getHandler:function(a){var e=this;return b.getWidget(e.el.closest("."+d).select("."+c).attr("id"))[a]||function(){throw new Error("[FancyGrid Error] - handler does not exist")}},onMouseDown:function(){this.fire("mousedown")},onMouseUp:function(){this.fire("mouseup")},onMouseOver:function(a){var b=this;b.fire("mouseover"),b.tip&&b.renderTip(a)},renderTip:function(a){var c=this;c.tooltip&&c.tooltip.destroy(),c.tooltip=new b.ToolTip({text:c.tip}),c.tooltip.css("display","block"),c.tooltip.show(a.pageX+15,a.pageY-25)},onMouseOut:function(){var a=this;a.fire("mouseout"),a.tooltip&&(a.tooltip.destroy(),delete a.tooltip)},setText:function(a,b){var c=this,d=c.el,e=7;switch(c.text=a,c.theme&&Fancy.themes[c.theme]&&(e=Fancy.themes[c.theme].config.charWidth),c.i18n){case"zh-CN":case"zh-TW":case"ja":case"ko":e=10}b||(b=0),b||(b+=a.length*e+2*e,c.imageColor&&(c.imageCls=i),b<c.minWidth&&(b=(c.text&&c.text.length,c.minWidth)),c.imageCls&&c.text&&(b+=c.imageWidth),c.menu&&(b+=c.rightImageWidth)),c.css("width",b),d.select("."+j).update(a)},disable:function(){this.disabled=!0,this.addCls(f)},enable:function(){this.disabled=!1,this.removeCls(f)},onMouseMove:function(a){var b=this;b.tip&&b.tooltip&&b.tooltip.show(a.pageX+15,a.pageY-25)},toggleMenuShow:function(a){var c=this,d=c.el.$dom.offset(),e=[d.left,d.top+c.el.$dom.height()];b.isArray(c.menu)?c.initMenu():c.menu.type||c.initMenu(),setTimeout(function(){c.menu.showAt(e[0],e[1])},100)},initMenu:function(){var a=this,c={theme:a.theme,events:[{hide:a.onMenuHide,scope:a}]};b.isObject(a.menu)?b.apply(c,a.menu):c.items=a.menu,a.menu=new b.Menu(c)},onMenuHide:function(){this.setPressed(!1)}})}(),Fancy.define("Fancy.SegButton",{extend:Fancy.Widget,constructor:function(a,b){this.scope=b,this.Super("const",arguments)},init:function(){var a=this;a.addEvents("toggle"),a.Super("init",arguments),a.style=a.style||{},a.render()},widgetCls:Fancy.SEG_BUTTON_CLS,cls:"",extraCls:"",text:"",render:function(){var a,b=this,c=Fancy.get(document.createElement("div"));b.fire("beforerender"),a=Fancy.get(b.renderTo||document.body).dom,c.addCls(Fancy.cls,b.widgetCls,b.cls,b.extraCls),b.hidden&&c.css("display","none"),b.el=Fancy.get(a.appendChild(c.dom)),Fancy.each(b.style,function(a,c){b.el.css(c,a)}),b.renderButtons(),b.fire("afterrender"),b.fire("render")},renderButtons:function(){for(var a=this,b=a.items,c=0,d=b.length,e=Fancy.id(null,"fancy-toggle-group-");c<d;c++){var f=b[c];f.renderTo=a.el.dom,!1!==a.allowToggle&&(f.enableToggle=!0,!0!==a.multiToggle&&(f.toggleGroup=e)),0===c?(f.style={"border-right-width":0,"border-top-right-radius":0,"border-bottom-right-radius":0},1===d&&delete f.style["border-right-width"]):f.style=c>1?{"border-left-width":0,"border-top-left-radius":0,"border-bottom-left-radius":0}:{"border-top-left-radius":0,"border-bottom-left-radius":0},b.length>2&&0!==c&&c!==d-1&&Fancy.apply(f.style,{"border-top-right-radius":0,"border-bottom-right-radius":0,"border-top-left-radius":0,"border-bottom-left-radius":0}),a.items[c]=new Fancy.Button(f),a.items[c].on("pressedchange",function(b,c){a.fire("toggle",b,c,a.getValues())})}},getValues:function(){for(var a=this,b=[],c=a.items,d=0,e=c.length;d<e;d++)b.push(c[d].pressed);return b},clear:function(a){for(var b=this,c=b.items,d=0,e=c.length;d<e;d++)c[d].setPressed(!1,a)},setItems:function(a){var b=this;b.el.update(""),b.items=a,b.renderButtons()},setActiveItem:function(a,b){this.items[a].setPressed(!0,b)}}),Fancy.define("Fancy.toolbar.Tab",{extend:Fancy.Button,constructor:function(a){this.Super("const",arguments)},init:function(){this.Super("init",arguments)},cls:Fancy.BUTTON_CLS+" "+Fancy.TAB_TBAR_CLS,render:function(){this.Super("render",arguments)}}),Fancy.modules.menu=!0,function(){var a=Fancy,b=a.MENU_CLS,c=a.MENU_ITEM_CLS,d=a.MENU_ITEM_IMAGE_CLS,e=a.MENU_ITEM_TEXT_CLS,f=a.MENU_ITEM_SIDE_TEXT_CLS,g=a.MENU_ITEM_ACTIVE_CLS,h=a.MENU_ITEM_RIGHT_IMAGE_CLS,i=a.MENU_ITEM_EXPAND_CLS,j=a.MENU_ITEM_DISABLED_CLS,k=a.MENU_ITEM_SEP_CLS,l=a.MENU_ITEM_NO_IMAGE_CLS;Fancy.define("Fancy.Menu",{extend:Fancy.Widget,constructor:function(a){Fancy.applyConfig(this,a),this.theme&&(this.itemHeight=Fancy.themes[this.theme].config.menuItemHeight),this.Super("const",arguments)},init:function(){var a=this;a.addEvents("hide"),a.Super("init",arguments),a.width<a.minWidth&&(a.width=a.minWidth),a.applyDefaults(),a.render(),a.ons()},ons:function(){var a=this,b=a.el;b.on("mousedown",a.onItemMouseDown,a,"."+c),b.on("click",a.onItemClick,a,"."+c),b.on("mouseenter",a.onItemEnter,a,"."+c),b.on("mouseleave",a.onItemLeave,a,"."+c)},widgetCls:b,itemCls:c,itemImageCls:d,cls:"",extraCls:"",width:142,minWidth:50,itemHeight:30,maxHeight:200,rendered:!1,theme:"default",render:function(){var a,b=this,c=Fancy.get(document.createElement("div"));b.fire("beforerender"),"default"!==b.theme&&c.addCls("fancy-theme-"+b.theme),c.addClass(Fancy.cls,b.widgetCls,b.cls,b.extraCls),b.width<b.minWidth&&(b.width=b.minWidth),c.css({width:b.width,height:b.getItemsHeight()}),b.height&&c.css({height:b.height,"overflow-y":"scroll"}),a=Fancy.get(b.renderTo||document.body),b.el=a.dom.appendChild(c.dom),b.el=Fancy.get(b.el),b.renderItems(),b.items.length||b.el.css("border","0px"),b.fire("afterrender"),b.fire("render"),b.rendered=!0,b.checkHeight()},checkHeight:function(){var a=this;parseInt(a.el.css("height"))>a.maxHeight&&a.el.css({height:a.maxHeight,"overflow-y":"scroll"})},getItemsHeight:function(){for(var a=this,b=a.items,c=this.itemHeight,d=0,e=0,f=b.length;e<f;e++){var g=b[e];"sep"===g.type||"-"===g.type||"-"===g?d+=2:d+=c}return d},renderItems:function(){for(var a,b=this,c=0,g=b.items.length;c<g;c++){a=b.items[c],"-"===a&&(a={type:"sep"});var m=Fancy.get(document.createElement("div"));m.attr("index",c),m.addCls(b.itemCls),"sep"===a.type?m.addCls(k):m.css("height",b.itemHeight),b.el.dom.appendChild(m.dom),a.el=m;var n=a.imageCls||"";if(a.cls&&m.addCls(a.cls),"sep"!==a.type&&"-"!==a.type){var o=[!1===a.image?"":'<div class="'+d+" "+n+'"></div>','<div class="'+e+'"></div>'];a.sideText&&o.push('<div class="'+f+'">'+a.sideText+"</div>"),o.push('<div class="'+h+" "+(a.items?i:"")+'"></div>'),m.update(o.join(""))}switch(!1===a.image&&m.addCls(l),!0===a.disabled&&m.addCls(j),a.type){case"":case"-":case"sep":break;case"number":b.items[c].field=new Fancy.NumberField({label:!1,theme:b.theme,padding:"1px 0px 0px",width:90,renderAfter:m.select("."+d).item(0).dom,events:b.items[c].events,value:a.value||""});break;case"string":b.items[c].field=new Fancy.StringField({label:!1,theme:b.theme,padding:"1px 0px 0px",width:90,renderAfter:m.select("."+d).item(0).dom,events:b.items[c].events,value:a.value||""});break;default:m.select("."+e).item(0).update(a.text||"")}void 0!==a.checked&&(b.items[c].checkbox=new Fancy.CheckBox({label:!1,theme:b.theme,padding:"1px 8px 0px",renderTo:m.select("."+d).item(0).dom,value:a.checked}))}},applyDefaults:function(){var a=this,b=0,c=a.items.length;if(a.defaults)for(;b<c;b++)Fancy.applyIf(a.items[b],a.defaults)},onItemClick:function(a){var b=this,c=Fancy.get(a.currentTarget),d=c.attr("index"),e=b.items[d],f=[b,e];e.handler&&!e.disabled&&(e.scope?e.handler.apply(e.scope,f):e.handler(b,e))},onItemEnter:function(a){var b=this,c=Fancy.get(a.currentTarget),d=c.attr("index"),e=b.items[d],f=c.offset();if(b.shownSubMenu&&b.shownSubMenu.hide(),b.deActivateItem(),b.activateItem(d),e.items){if(!e.menu){var g=b.items[d];Fancy.apply(g,{parentItem:e,parentMenu:b,defaults:e.defaults,items:e.items,theme:b.theme}),b.items[d].menu=new Fancy.Menu(g)}e.menu.showAt(f.left+parseInt(c.width()),f.top),b.shownSubMenu=e.menu}},onItemLeave:function(){},showAt:function(b,c,d){var e=this;e.css("position","absolute"),e.css("left",b),e.css("top",c),e.css("z-index",1e3+a.zIndex++),e.el.show(),!1!==d&&e.checkPosition(),e.parentMenu||Fancy.MenuManager.add(e)},hide:function(){var a=this;a.el.hide(),a.deActivateItem(),a.shownSubMenu&&a.shownSubMenu.hide(),a.fire("hide")},hideAll:function(){var a=this.parentMenu;a&&"none"!==a.el.css("display")&&a.hide(),this.hide()},activateItem:function(a){var b=this,c=b.items[a];"sep"===c.type||"-"===c||c.disabled||(b.activeItem=c,c.el.addCls(g))},deActivateItem:function(){var a=this.activeItem;a&&(a.el.removeClass(g),delete this.activeItem)},onItemMouseDown:function(a){"input"===a.target.tagName.toLocaleLowerCase()||a.preventDefault()},enableItem:function(a){var b=this,c=b.items[a];c.el.removeCls(j),c.disabled=!1},disableItem:function(a){var b=this,c=b.items[a];c.el.addCls(j),c.disabled=!0},checkPosition:function(){var b=this,c=b.el,d=c.offset(),e=parseInt(c.css("height")),f=parseInt(c.css("width")),g=a.getViewSize(),h=a.getScroll(),i=d.top+e,j=d.left+f,k=d.top,l=d.left,m=20;if(i>g[0]+h[0]-m&&(k=d.top-(i-(g[0]+h[0]))-m),j>g[1]+h[1]-m)if(b.parentMenu){var n=parseInt(b.parentMenu.el.css("left"));l=n-f}else l=d.left-(j-(g[1]+h[1]))-m;b.showAt(l,k,!1)},setChecked:function(b,c){var d=this;c&&d.clearChecked();var e=d.el.select(".fancy-menu-item").item(b);a.getWidget(e.select(".fancy-field-checkbox").attr("id")).set(!0)},clearChecked:function(){this.el.select(".fancy-checkbox-on").each(function(b){var c=b.attr("id");a.getWidget(c).set(!1)})}}),Fancy.define("Fancy.MenuManager",{singleton:!0,inited:!1,constructor:function(){},init:function(){Fancy.get(document).on("click",this.onDocClick,this)},add:function(a){var b=this;b.inited||b.init(),b.activeMenu=a},onDocClick:function(a){var c=this,d=Fancy.get(a.target),e=10,f=d;if(c.activeMenu){for(;e>0&&f.dom;){if(f.hasCls(b))return;f=f.parent(),e--}c.activeMenu.hide(),delete c.activeMenu}}})}(),function(){var a=Fancy,b=a.FOOTER_STATUS_CLS,c=a.STATUS_SOURCE_TEXT_CLS,d=a.STATUS_SOURCE_LINK_CLS,e=a.FOOTER_SOURCE_CLS;Fancy.Mixin("Fancy.panel.mixin.PrepareConfig",{prepareConfigTheme:function(a,b){var c=a.theme||b.theme,d=Fancy.getTheme(c).config;return Fancy.isObject(c)&&(a.theme=c.name),Fancy.applyIf(a,d),a.theme&&(this.theme=a.theme),a},prepareConfigFooter:function(a){var f=a.footer,g=a.lang;if(f){var h=[];if(Fancy.isString(f.status)&&h.push({type:"text",text:f.status,cls:b}),f.status&&f.source&&h.push("side"),Fancy.isString(f.source))h.push({type:"text",text:f.source,cls:e});else if(Fancy.isObject(f.source)){var i=f.source.text,j=f.source.sourceText||g.sourceText;if(f.source.link){var k=f.source.link;k=k.replace("http://",""),k="http://"+k,i='<span class="'+c+'">'+j+'</span>: <a class="'+d+'" href="'+k+'">'+i+"</a>"}else i="<span>"+j+":</span> "+i;h.push({type:"text",text:i,cls:e})}a.footer=h}return a},prepareConfigLang:function(a,b){var c=a.i18n||b.i18n,d=Fancy.Object.copy(Fancy.i18n[c]);if(a.lang){for(var e in a.lang)!1===Fancy.isObject(a.lang[e])&&(d[e]=a.lang[e]);d.paging={},a.lang.paging&&Fancy.apply(d.paging,a.lang.paging);for(var e in a.lang.paging)"paging"!==e&&(Fancy.isObject(e)||(d[e]=a.lang.paging[e]));d.date={},a.lang.date&&Fancy.apply(d.date,a.lang.date)}return a.lang=d,a}})}(),Fancy.Mixin("Fancy.panel.mixin.methods",{setTitle:function(a){this.panel&&this.panel.setTitle(a)},getTitle:function(){if(this.panel)return this.panel.getTitle()},setSubTitle:function(a){this.panel&&this.panel.setSubTitle(a)},getSubTitle:function(){if(this.panel)return this.panel.getSubTitle()}}),Fancy.Mixin("Fancy.panel.mixin.DD",{ddCls:Fancy.PANEL_DRAGGABLE_CLS,initDD:function(){this.addDDCls(),this.addDD()},addDDCls:function(){this.el.addCls(this.ddCls)},addDD:function(){Fancy.DD.add({dragEl:this.el,overEl:this.el.select("."+Fancy.PANEL_HEADER_CLS).item(0)})}}),Fancy.Mixin("Fancy.panel.mixin.Resize",{cornerResizeCls:"fancy-panel-resize-corner",resizeMaskCls:"fancy-panel-resize-mask",initResize:function(){var a=this;a.activeResizeEl=void 0,a.renderResizeEls(),a.onsResizeEls()},renderResizeEls:function(){var a=this,b=a.el,c=Fancy.get(document.createElement("div"));c.addCls(a.cornerResizeCls),a.cornerResizeEl=Fancy.get(b.dom.appendChild(c.dom))},onResize:function(){var a=this;a.tbar&&a._tbar.applyScrollChanges(),a.subTBar&&a._subTBar.applyScrollChanges(),a.bbar&&a._bbar.applyScrollChanges(),a.footer&&a._footer.applyScrollChanges(),a.buttons&&a._buttons.applyScrollChanges()},onsResizeEls:function(){var a=this;Fancy.isTouch?a.cornerResizeEl.on("touchstart",a.onMouseDownResizeEl,a):a.cornerResizeEl.on("mousedown",a.onMouseDownResizeEl,a),a.on("resize",a.onResize,a)},onMouseDownResizeEl:function(a){var b=this,c=Fancy.get(document);if(a.preventDefault(),Fancy.nojQuery&&b.el.select("."+Fancy.GRID_ANIMATION_CLS).removeCls(Fancy.GRID_ANIMATION_CLS),Fancy.isTouch){a=a.originalEvent||a;var d=a.changedTouches[0];c.once("touchend",b.onMouseUpResize,b),c.on("touchmove",b.onMouseMoveResize,b),b.renderResizeMask(),b.startClientX=d.clientX,b.startClientY=d.clientY}else c.once("mouseup",b.onMouseUpResize,b),c.on("mousemove",b.onMouseMoveResize,b),b.renderResizeMask(),b.startClientX=a.clientX,b.startClientY=a.clientY},onMouseUpResize:function(){var a=this,b=Fancy.get(document);delete a.activeResizeEl,a.resizeMaskEl.destroy(),delete a.startClientX,delete a.startClientY,b.un("mousemove",a.onMouseMoveResize,a),a.setWidth(a.newResizeWidth),a.setHeight(a.newResizeHeight),a.fire("resize",{width:a.newResizeWidth,height:a.newResizeHeight}),Fancy.nojQuery&&a.el.select(".fancy-grid").addCls(Fancy.GRID_ANIMATION_CLS)},onMouseMoveResize:function(a){var b=this,c=a.clientX,d=a.clientY;if(Fancy.isTouch){a=a.originalEvent||a;var e=a.originalEvent.changedTouches[0];c=e.clientX,d=e.clientY}var f=b.startClientX-c,g=b.startClientY-d,h=b.startResizeWidth-f,i=b.startResizeHeight-g;a.preventDefault(),a.stopPropagation(),h<b.minWidth&&(h=b.minWidth),i<b.minHeight&&(i=b.minHeight),b.newResizeWidth=h,b.newResizeHeight=i,b.resizeMaskEl.css({width:h,height:i})},renderResizeMask:function(){var a=this,b=a.el,c=2,d=Fancy.get(document.createElement("div")),e=parseInt(b.css("top")),f=parseInt(b.css("left")),g=parseInt(b.css("width"))-2*c,h=parseInt(b.css("height"))-2*c,i=parseInt(b.css("z-index"));if(a.startResizeWidth=g,a.startResizeHeight=h,!a.window&&"absolute"!==b.css("position")){var j=b.offset();e=j.top,f=j.left}d.addCls(a.resizeMaskCls),d.css({left:f,top:e,width:g,height:h,"z-index":i}),a.resizeMaskEl=Fancy.get(document.body.appendChild(d.dom))}}),function(){var a=Fancy,b=a.HIDDEN_CLS,c=a.MODAL_CLS,d=a.PANEL_CLS,e=a.PANEL_HEADER_CLS,f=a.PANEL_SUB_HEADER_TEXT_CLS,g=a.PANEL_HEADER_TEXT_CLS,h=a.PANEL_HEADER_TOOLS_CLS,i=a.PANEL_SUB_HEADER_CLS,j=a.PANEL_BODY_CLS,k=a.PANEL_BODY_INNER_CLS,l=a.PANEL_TBAR_CLS,m=a.PANEL_SUB_TBAR_CLS,n=a.PANEL_BUTTONS_CLS,o=a.PANEL_BBAR_CLS,p=a.PANEL_HEADER_IMG_CLS,q=a.PANEL_NOFRAME_CLS,r=a.PANEL_SHADOW_CLS,s=a.PANEL_FOOTER_CLS,t=a.FIELD_PICKER_BUTTON_CLS;a.define("Fancy.Panel",{extend:a.Widget,barScrollEnabled:!0,tabScrollStep:50,mixins:["Fancy.panel.mixin.DD","Fancy.panel.mixin.Resize"],constructor:function(b){a.apply(this,b),this.Super("constructor",arguments)},init:function(){var a=this;a.Super("init",arguments),a.addEvents("resize"),a.initTpl(),a.render(),a.draggable&&a.initDD(),a.resizable&&a.initResize(),a.window&&a.setActiveWindowWatcher()},cls:"",fieldCls:d,value:"",width:300,height:200,titleHeight:30,subTitleHeight:30,barHeight:37,title:void 0,frame:!0,shadow:!0,draggable:!1,minWidth:200,minHeight:200,barContainer:!0,theme:"default",tpl:['<div style="height:{titleHeight}px;" class="'+e+" "+b+'">',"{titleImg}",'<div class="'+g+'">{title}</div>','<div class="'+h+'"></div>',"</div>",'<div style="height:{subTitleHeight}px;" class="'+i+" "+b+'">','<div class="'+f+'">{subTitle}</div>',"</div>",'<div class="'+j+'">','<div class="'+l+" "+b+'" style="height:{tbarHeight}px;"></div>','<div class="'+m+" "+b+'" style="height:{subTBarHeight}px;"></div>','<div class="'+k+'"></div>','<div class="'+o+" "+b+'" style="height:{bbarHeight}px;"></div>','<div class="'+n+" "+b+'" style="height:{buttonsHeight}px;"></div>','<div class="'+s+" "+b+'" style="height:{barHeight}px;"></div>',"</div>"],render:function(){var d=this,f=a.get(d.renderTo||document.body),g=a.get(document.createElement("div")),h=0,k=d.titleHeight,t=d.subTitleHeight;if(d.renderOuter&&(g=f),!f.dom)throw new Error("[FancyGrid Error 1] - Could not find renderTo element: "+d.renderTo);!0===d.window&&g.css({display:"none",position:"absolute"}),!1===d.frame&&g.addCls(q),g.addCls(a.cls,d.cls,d.fieldCls),"default"!==d.theme&&g.addCls("fancy-theme-"+d.theme),d.shadow&&g.addCls(r),g.css({width:d.width+"px",height:d.height-h+"px"}),d.style&&g.css(d.style);var u="",v="";a.isObject(d.title)?u=d.title.text:a.isString(d.title)&&(u=d.title),a.isObject(d.subTitle)?v=d.subTitle.text:a.isString(d.subTitle)&&(v=d.subTitle);var w="";a.isObject(d.title)&&d.title.imgCls&&(w='<div class="'+p+" "+d.title.imgCls+'"></div>'),g.update(d.tpl.getHTML({titleImg:w,barHeight:d.barHeight,subTBarHeight:d.subTBarHeight||d.barHeight,tbarHeight:d.tbarHeight||d.barHeight,bbarHeight:d.bbarHeight||d.barHeight,buttonsHeight:d.buttonsHeight||d.barHeight,titleHeight:k,subTitleHeight:t,title:u,subTitle:v})),a.isObject(d.title)&&(d.title.style&&g.select("."+e).css(d.title.style),d.title.cls&&g.select("."+e).addCls(d.title.cls),d.title.tools&&(d.tools=d.title.tools)),a.isObject(d.subTitle)&&(d.subTitle.style&&g.select("."+i).css(d.subTitle.style),d.subTitle.cls&&g.select("."+i).addCls(d.subTitle.cls)),d.title?g.select("."+e).removeCls(b):g.select("."+j).css("border-top-width","0px"),d.subTitle&&(g.select("."+j).css("border-top-width","0px"),g.select("."+i).removeCls(b)),d.tbar&&g.select("."+l).removeCls(b),d.subTBar&&g.select("."+m).removeCls(b),d.bbar&&g.select("."+o).removeCls(b),d.buttons&&g.select("."+n).removeCls(b),d.footer&&g.select("."+s).removeCls(b),d.renderOuter?d.el=g:(d.el=f.dom.appendChild(g.dom),d.el=a.get(d.el)),d.modal&&0===a.select(c).length&&a.get(document.body).append('<div class="'+c+'" style="display: none;"></div>'),d.id&&!d.el.attr("id")&&d.el.attr("id",d.id),d.renderTools(),d.renderBars(),d.setHardBordersWidth()},setHardBordersWidth:function(){var a=this.panelBodyBorders;this.el.select("."+j).css({"border-top-width":a[0],"border-right-width":a[1],"border-bottom-width":a[2],"border-left-width":a[3]})},renderTools:function(){var b=this,c=b.tools;void 0!==c&&a.each(c,function(c,d){c.renderTo=b.el.select("."+h).dom,b.tools[d]=new a.Tool(c,b.scope||b)})},renderBars:function(){var b=this,c=!1,d=b.theme,e=this;b.items&&b.items[0]&&("grid"===b.items[0].type&&(c=!0),e=b.items[0]),b.bbar&&(b._bbar=new a.Bar({el:b.el.select("."+o),items:b.bbar,height:b.bbarHeight||b.barHeight,barContainer:b.barContainer,barScrollEnabled:b.barScrollEnabled,tabScrollStep:b.tabScrollStep,scope:e,theme:d}),b.bbar=b._bbar.items),b.buttons&&(b._buttons=new a.Bar({el:b.el.select("."+n),items:b.buttons,height:b.buttonsHeight||b.barHeight,barScrollEnabled:b.barScrollEnabled,tabScrollStep:b.tabScrollStep,scope:e,theme:d}),b.buttons=b._buttons.items),b.tbar&&(b._tbar=new a.Bar({el:b.el.select("."+l),items:b.tbar,height:b.tbarHeight||b.barHeight,tabEdit:!b.subTBar&&c,barScrollEnabled:b.barScrollEnabled,tabScrollStep:b.tabScrollStep,scope:e,theme:d}),b.tbar=b._tbar.items),b.subTBar&&(b._subTBar=new a.Bar({el:b.el.select("."+m),items:b.subTBar,height:b.subTBarHeight||b.barHeight,tabEdit:c,barScrollEnabled:b.barScrollEnabled,tabScrollStep:b.tabScrollStep,scope:e,theme:d}),b.subTBar=b._subTBar.items),b.footer&&(b._footer=new a.Bar({disableScroll:!0,el:b.el.select("."+s),items:b.footer,height:b.barHeight,barScrollEnabled:b.barScrollEnabled,tabScrollStep:b.tabScrollStep,scope:e,theme:d}),b.footer=b._footer.items)},showAt:function(b,c){this.css({left:b+"px",display:"","z-index":1e3+a.zIndex++}),void 0!==c&&this.css({top:c+"px"})},show:function(){var b=this;if(b.el.show(),!0===b.window){b.buttons&&b._buttons.checkScroll(),b.tbar&&b._tbar.checkScroll(),b.bbar&&b._bbar.checkScroll(),b.subTBar&&b._subTBar.checkScroll();var d=a.getViewSize(),e=b.el.height(),f=b.el.width(),g=[],h=a.getScroll(),i=h[0],j=h[1];g[0]=(d[1]-f)/2,g[1]=(d[0]-e)/2,g[0]<10&&(g[0]=10),g[1]<10&&(g[1]=10),b.css({left:g[0]+j+"px",top:g[1]+i+"px",display:"","z-index":1e3+a.zIndex++}),b.modal&&a.select("."+c).css({display:"","z-index":1e3+a.zIndex-2})}},hide:function(){var b=this;b.css({display:"none"}),b.modal&&a.select("."+c).css("display","none"),a.each(this.items||[],function(a){"combo"===a.type&&a.hideList()})},setTitle:function(a){this.el.select("."+g).update(a)},getTitle:function(){return this.el.select("."+g).dom.innerHTML},setSubTitle:function(a){this.el.select("."+f).update(a)},getSubTitle:function(){return this.el.select("."+f).dom.innerHTML},getHeight:function(){return parseInt(this.css("height"))},setWidth:function(a){this.items[0].setWidth(a)},setHeight:function(a){this.css("height",a),this.items[0].setHeight(a,!1)},setActiveWindowWatcher:function(){var b=this;b.el.on("mousedown",function(c){a.get(c.target).hasCls(t)||(1e3+a.zIndex-1>parseInt(b.css("z-index"))&&b.css("z-index",1e3+a.zIndex++),a.get(document.body).select(".fancy-active-panel").removeCls("fancy-active-panel"),b.el.addCls("fancy-active-panel"))})}})}(),function(){var a=Fancy,b=a.BUTTON_CLS;a.define("Fancy.Tool",{extend:a.Widget,constructor:function(a,b){this.scope=b,this.Super("const",arguments)},init:function(){var a=this;a.addEvents("click","mousedown","mouseup","mouseover","mouseout"),a.Super("init",arguments),a.style=a.style||{},a.render(),a.ons()},ons:function(){this.el.on("click",this.onClick,this)},cls:b,text:"",height:28,paddingTextWidth:5,render:function(){var b=this,c=a.get(b.renderTo||document.body).dom,d=document.createElement("div");b.fire("beforerender"),d.className="fancy-tool-button",d.innerHTML=b.text,b.el=a.get(c.appendChild(d)),b.fire("afterrender"),b.fire("render")},onClick:function(){var a=this;a.fire("click"),a.handler&&(a.scope?a.handler.apply(a.scope,[a]):a.handler(a))},setText:function(a){this.el.update(a)}})}(),function(){var a=Fancy,b=a.PANEL_BODY_INNER_CLS,c=a.PANEL_GRID_INSIDE_CLS,d=a.TAB_WRAPPER_CLS,e=a.TAB_ACTIVE_WRAPPER_CLS,f=a.TAB_TBAR_ACTIVE_CLS,g=a.PANEL_TAB_CLS,h=a.PANEL_CLS,i=a.GRID_CLS;a.define(["Fancy.panel.Tab","Fancy.Tab","FancyTab"],{extend:a.Panel,constructor:function(a){var b=this;Fancy.loadStyle(),b.prepareConfigTheme(a),b.prepareConfigSize(a),b.Super("const",arguments)},init:function(){var a=this;a.prepareTabs(),a.Super("init",arguments),a.setActiveTab(a.activeTab),a.ons()},activeTab:0,theme:"default",render:function(){var a=this;a.Super("render",arguments),Fancy.loadingStyle&&(a.el.css("opacity",0),a.intervalStyleLoad=setInterval(function(){Fancy.loadingStyle||(clearInterval(a.intervalStyleLoad),a.el.animate({opacity:1,force:!0}))},100)),a.panelBodyEl=a.el.select("."+b).item(0),a.setPanelBodySize(),a.renderTabWrappers(),a.wrapped||a.el.addCls(c),a.el.addCls(g),a.rendered=!0},ons:function(){var b=this;b.responsive&&a.$(window).bind("resize",function(){b.onWindowResize(),b.intWindowResize&&clearInterval(b.intWindowResize),b.intWindowResize=setTimeout(function(){b.onWindowResize(),delete b.intWindowResize,setTimeout(function(){b.onWindowResize()},300)},30)})},onWindowResize:function(){var b,c=this,d=c.renderTo;c.panel&&(d=c.panel.renderTo),b=c.responsive?a.get(d):c.panel?c.panel.el:a.get(d),(b.hasClass(h)||b.hasClass(i))&&(b=b.parent());var e=b.width();if(void 0!==b.dom&&(0===e&&(e=b.parent().width()),c.responsive?c.setWidth(e):c.fitWidth,c.responsiveHeight)){var f=parseInt(b.height());0===f&&(f=parseInt(b.parent().height())),c.setHeight(f)}},setPanelBodySize:function(){var a=this,b=a.height,c=a.panelBodyBorders;a.title&&(b-=a.titleHeight),a.subTitle&&(b-=a.subTitleHeight,b+=c[2]),a.bbar&&(b-=a.bbarHeight||a.barHeight),a.tbar&&(b-=a.tbarHeight||a.barHeight),a.subTBar&&(b-=a.subTBarHeight||a.barHeight),a.buttons&&(b-=a.buttonsHeight||a.barHeight),a.footer&&(b-=a.barHeight),b-=c[0]+c[2],a.panelBodyEl.css({height:b}),a.panelBodyHeight=b,a.panelBodyWidth=a.width-c[1]-c[3]},prepareConfigTheme:function(b){var c=this,d=b.theme||c.theme,e=a.getTheme(d).config;(c.wrapped||b.wrapped)&&(b.panelBodyBorders=[0,0,0,0],c.panelBodyBorders=[0,0,0,0]),a.applyIf(b,e),a.apply(c,b)},prepareConfigSize:function(a){var b,c=a.renderTo;void 0===a.width&&c&&(a.responsive=!0,b=Fancy.get(c),a.width=parseInt(b.width()))},prepareTabs:function(){for(var a=this,b=[],c=0,d=a.items.length;c<d;c++){var e=a.items[c],f={type:"tab"};e.tabTitle?f.text=e.tabTitle:e.title&&(f.text=e.title,delete e.title),f.handler=function(b){return function(){a.setActiveTab(b)}}(c),b.push(f)}a.tbar=b,a.tabs=b},renderTabWrappers:function(){var b=this;a.each(b.items,function(c){var e=a.get(document.createElement("div"));e.addCls(d),c.renderTo=b.panelBodyEl.dom.appendChild(e.dom)})},setActiveTab:function(a){var b=this,c=b.el.select("."+d),g=b.activeTab;if(0!==b.items.length){c.item(b.activeTab).removeCls(e),b.activeTab=a,c.item(b.activeTab).addCls(e);var h=b.items[b.activeTab];if(h.theme=b.theme,h.wrapped=!0,h.width=b.panelBodyWidth,h.height=b.panelBodyHeight,h.rendered)b.setActiveItemWidth(),b.setActiveItemHeight();else switch(h.type){case"form":b.items[b.activeTab]=new FancyForm(h);break;case"grid":b.items[b.activeTab]=new FancyGrid(h);break;case"tab":b.items[b.activeTab]=new FancyTab(h)}b.tabs&&(b.tbar[g].removeCls(f),b.tbar[b.activeTab].addCls(f))}},setWidth:function(a){var b=this;b.width=a,b.css("width",a),b.setPanelBodySize(),b.setActiveItemWidth()},setHeight:function(a){var b=this;b.height=a,b.css("height",a),b.setPanelBodySize(),b.setActiveItemHeight()},setActiveItemWidth:function(){var a=this;a.items[a.activeTab].setWidth(a.panelBodyWidth)},setActiveItemHeight:function(){var a=this;a.items[a.activeTab].setHeight(a.panelBodyHeight,!1)}}),FancyTab.get=function(b){var c=a.get(b).select("."+g).dom.id;return a.getWidget(c)},!a.nojQuery&&a.$&&(a.$.fn.FancyTab=function(b){return this.selector?b.renderTo=a.$(this.selector)[0].id:b.renderTo=this.attr("id"),new FancyTab(b)})}(),Fancy.define("Fancy.toolbar.Tab",{extend:Fancy.Button,constructor:function(a){this.Super("const",arguments)},init:function(){this.Super("init",arguments)},cls:Fancy.BUTTON_CLS+" "+Fancy.TAB_TBAR_CLS,render:function(){this.Super("render",arguments)}}),function(){var a=Fancy,b=a.GRID_CLS,c=a.GRID_CELL_CLS,d=a.BAR_CLS,e=a.BAR_CONTAINER_CLS,f=a.BAR_BUTTON_CLS,g=a.BAR_SEG_BUTTON_CLS,h=a.BAR_LEFT_SCROLLER_CLS,i=a.BAR_RIGHT_SCROLLER_CLS,j=a.FIELD_LABEL_CLS,k=a.FIELD_TEXT_CLS,l=a.FIELD_TEXT_INPUT_CLS,m=a.FIELD_SEARCH_CLS,n=a.FIELD_SEARCH_LIST_CLS,o=a.FIELD_SEARCH_PARAMS_LINK_CLS,p=a.FIELD_SEARCH_PARAMED_CLS,q=a.FIELD_SEARCH_PARAMED_EMPTY_CLS,r=a.PICKER_MONTH_ACTION_BUTTONS_CLS,s=a.CLEARFIX_CLS;a.define("Fancy.Bar",{extend:a.Widget,widgetCls:d,containerCls:e,cls:"",text:"",floating:"left",sideRight:3,scrolled:0,tabOffSet:5,tabScrollStep:50,barScrollEnabled:!0,constructor:function(b){a.apply(this,b),this.init()},init:function(){var a=this;a.roles={},a.render(),a.barScrollEnabled&&(a.initScroll(),setTimeout(function(){a.checkScroll()},150))},render:function(){var a=this;a.renderEl(),a.renderItems(),a.initTabEdit()},renderEl:function(){var b=this;if(!b.el){var c=a.get(document.createElement("div"));c.addCls(b.widgetCls,b.cls),c.update(b.text),b.el=a.get(b.renderTo.appendChild(c.dom)),b.style&&b.el.css(b.style)}var d=a.get(document.createElement("div"));d.addCls(b.containerCls),b.containerEl=a.get(b.el.dom.appendChild(d.dom))},renderItems:function(){for(var b=this,c=b.containerEl,d=b.items||[],e=0,f=d.length,g=!1,h=[],i=f-1,j=0;e<f;e++){var k=d[e];switch(g&&(k=d[i],i--),k.toggleGroup&&(k.enableToggle=!0),a.isObject(k)&&(k.type=k.type||"button"),g&&(b.floating="right",k.style=k.style||{},k.style.right=j),k.renderTo=c.dom,k){case"|":var l={float:b.floating,"margin-right":"5px","margin-top":"6px","padding-left":"0px"};"right"===b.floating&&a.applyIf(l,{right:"1px",position:"absolute"}),h.push(new a.Separator({renderTo:c.dom,style:l}));continue;case"side":g=!0;continue;default:g?h[i]=b.renderItem(k):h.push(b.renderItem(k))}g&&(k.text?j+=7*k.text.length+5+5+5:k.width&&(j+=k.width+5),k.imageCls&&(k.imageWidth?j+=k.imageWidth:j+=20),j+=3)}b.items=h},renderItem:function(c){var d,e=this,h=e.containerEl,i=e.theme;switch(c.style=c.style||{},c.label=!1,c.padding=!1,c.theme=e.theme,a.applyIf(c.style,{float:e.floating}),"right"===e.floating&&a.applyIf(c.style,{right:e.sideRight,position:"absolute"}),!c.scope&&e.scope&&(c.scope=e.scope),c.type){case"wrapper":c.cls===r&&(h.destroy(),h=e.el);for(var t,u=h.append('<div class="'+(c.cls||"")+'"></div>').select("div").item(0),v=0,w=c.items.length,x=0;v<w;v++){t=c.items[v],a.isObject(t)&&(t.type=t.type||"button"),t.renderTo=u.dom,d=e.renderItem(t);var y=d.el;v===w-1?y.css("margin-right","0px"):x+=parseInt(y.css("margin-right")),a.nojQuery?x+=parseInt(y.width()):x+=parseInt(y.$dom.outerWidth()),x+=parseInt(y.css("margin-left"))}u.css("width",x);break;case void 0:case"button":c.extraCls=f,c.scope=c.scope||e.scope,d=new a.Button(c);break;case"segbutton":c.extraCls=g,a.applyIf(c.style,{"margin-right":"6px"}),d=new a.SegButton(c);break;case"tab":d=new a.toolbar.Tab(c);break;case"text":a.applyIf(c.style,{"margin-right":"10px","padding-left":"0px","padding-top":"11px"}),a.apply(c,{renderTo:h.dom,cls:c.cls||""}),d=new a.bar.Text(c);break;case"combo":c.inputWidth=18,a.applyIf(c.style,{"padding-left":"0px","margin-right":"8px","margin-top":"4px"}),a.applyIf(c,{width:70}),d=new a.Combo(c);break;case"date":c.inputWidth=18,a.applyIf(c.style,{"padding-left":"0px","margin-right":"8px","margin-top":"4px"}),a.applyIf(c,{width:100}),d=new a.DateField(c);break;case"number":c.inputWidth=18,a.applyIf(c.style,{"padding-left":"0px","margin-right":"8px","margin-top":"4px"}),a.applyIf(c,{width:35}),d=new a.NumberField(c);break;case"checkbox":a.applyIf(c.style,{"padding-left":"0px","margin-right":"8px","margin-top":"4px"}),d=new a.CheckBox(c);break;case"switcher":a.applyIf(c.style,{"padding-left":"0px","margin-right":"8px","margin-top":"4px"}),a.applyIf(c,{width:35}),d=new a.Switcher(c);break;case"string":c.inputWidth=18,a.applyIf(c.style,{"padding-left":"0px","margin-right":"8px","margin-top":"4px"}),a.applyIf(c,{width:100}),d=new a.StringField(c);break;case"search":c.inputWidth=18,c.events=c.events||[],c.events=c.events.concat([{enter:function(c,d){var e=a.getWidget(c.el.parent().parent().parent().parent().select("."+b).item(0).attr("id"));e.search(d),e.expander&&e.expander.reSet()}},{key:function(c,d){var e=this,f=a.getWidget(c.el.parent().parent().parent().parent().select("."+b).item(0).attr("id"));f.filter&&!1===f.filter.autoEnterDelay||(e.autoEnterTime||(e.autoEnterTime=new Date),e.intervalAutoEnter&&clearInterval(e.intervalAutoEnter),delete e.intervalAutoEnter,e.intervalAutoEnter=setInterval(function(){new Date-e.autoEnterTime>500&&(clearInterval(e.intervalAutoEnter),delete e.intervalAutoEnter,d=c.getValue(),f.search(d),f.expander&&f.expander.reSet())},200))}},{render:function(c){var d=this,e=!1;c.el.on("mouseenter",function(){e=!0},null,"."+o),c.el.on("mousedown",function(a){a.preventDefault()},null,"."+o),c.el.on("click",function(f){var g=!1,h=a.getWidget(c.el.parent().parent().parent().parent().select("."+b).attr("id")),j=h.columns||[],k=h.leftColumns||[],l=h.rightColumns||[],m=j.concat(k).concat(l),o=[],p=0,q=m.length,r=1;if(h.searching.items)a.each(h.searching.items,function(a){o.push({inputLabel:" &nbsp;&nbsp;"+a.text,value:!0,name:a.index}),r+=h.fieldHeight});else for(;p<q;p++){var s=m[p],t=s.title;if(void 0===t&&(t=""),!1!==s.searchable){switch(s.type){case"color":case"combo":case"date":case"number":case"string":case"text":case"currency":break;default:continue}r+=h.fieldHeight,o.push({inputLabel:" &nbsp;&nbsp;"+t,value:!0,name:s.index})}}if(d.list){if("none"!==d.list.el.css("display"))return void d.list.el.css("display","none");g=!0}else d.list=new FancyForm({width:150,height:r,theme:i,defaults:{type:"checkbox",label:!1,style:{padding:"8px 16px 0px"}},items:o,cls:n,events:[{set:function(){h.searching.setKeys(d.list.get())}},{init:function(){setTimeout(function(){var b=d.list.el;b.on("mouseenter",function(){e=!0}),b.on("mouseleave",function(){e=!1,setTimeout(function(){!1===e&&d.list&&b.css("display","none")},750)});var g=a.get(f.target),h=g.offset(),i=parseInt(c.el.css("height"));b.css({position:"absolute",top:h.top+i+20,left:h.left}),d.list.el.css("display","block"),b.animate({duration:200,top:h.top+i-1})},50)}}]});var u=a.get(f.target),v=u.offset(),w=parseInt(c.el.css("height"));d.list&&d.list.el&&(d.list.css({position:"absolute",top:v.top+w+20,left:v.left}),g&&d.list.css("display","block"),d.list.el.animate({duration:200,top:v.top+w-1}))},null,"."+o),c.el.on("mouseleave",function(){e=!1,setTimeout(function(){!1===e&&d.list&&d.list.el.css("display","none")},750)},null,"."+o)}}]),a.applyIf(c.style,{float:e.floating,"padding-left":"0px","margin-right":"8px","margin-top":"4px"});var z=m;c.paramsMenu&&(c.tpl=['<div class="'+j+'" style="{labelWidth}{labelDisplay}">',"{label}","</div>",'<div class="'+k+'">','<input placeholder="{emptyText}" class="'+l+'" style="{inputWidth}" value="{value}">','<div class="'+o+'" style="">'+(c.paramsText||"&nbsp;")+"</div>","</div>",'<div class="'+s+'"></div>'],z+=" "+p,c.paramsText||(z+=" "+q)),a.applyIf(c,{padding:!1,width:250,cls:z,emptyText:"Search"}),d=new a.StringField(c)}return"right"===e.floating&&(e.sideRight+=d.width,e.sideRight+=7),c.role&&(e.roles[c.role]=d),d},initScroll:function(){var b=this;b.leftScroller=new a.Button({imageCls:!0,renderTo:b.el.dom,cls:h,height:b.height+2,minWidth:20,paddingTextWidth:0,imageWidth:20,width:0,text:!1,style:{position:"absolute",left:-1,top:-1,display:"none"},listeners:[{click:b.onPrevScrollClick,scope:b}]}),b.rightScroller=new a.Button({imageCls:!0,renderTo:b.el.dom,cls:i,height:b.height+2,minWidth:20,paddingTextWidth:0,imageWidth:20,width:0,text:!1,style:{position:"absolute",right:-1,top:-1,display:"none"},listeners:[{click:b.onNextScrollClick,scope:b}]})},getBarWidth:function(){return parseInt(this.el.css("width"))},getItemsWidth:function(){var b=0;return a.each(this.items,function(a){"none"!==a.el.css("display")&&(b+=a.el.width(),b+=parseInt(a.el.css("margin-left")),b+=parseInt(a.el.css("margin-right")),b+=parseInt(a.el.css("padding-right")),b+=parseInt(a.el.css("padding-left")))}),b},onPrevScrollClick:function(){this.scrolled+=this.tabScrollStep,this.applyScrollChanges()},onNextScrollClick:function(){this.scrolled-=this.tabScrollStep,this.applyScrollChanges()},applyScrollChanges:function(){var b=this,c=b.getItemsWidth(),d=b.getBarWidth()-parseInt(b.leftScroller.el.css("width"))-parseInt(b.rightScroller.el.css("width")),e=c-d;if(c<d)return b.scrolled=0,b.leftScroller.el.hide(),b.rightScroller.el.hide(),void b.containerEl.animate({"margin-left":"0px"},a.ANIMATE_DURATION);b.scrolled>0?(b.scrolled=0,b.leftScroller.disable(),b.rightScroller.enable()):b.scrolled<-e&&(b.scrolled=-e,b.leftScroller.enable(),b.rightScroller.disable()),b.leftScroller.el.show(),b.rightScroller.el.show(),b.containerEl.animate({"margin-left":b.scrolled+b.leftScroller.el.width()+b.tabOffSet+"px"},a.ANIMATE_DURATION)},onDocMouseUp:function(){var a=this;a.scrollInterval&&(clearTimeout(a.scrollInterval),delete a.scrollInterval)},checkScroll:function(){var a=this,b=a.getItemsWidth(),c=a.getBarWidth();a.disableScroll||(b>c?a.enableScroll():a.barScrollEnabled&&(a.leftScroller.el.hide(),a.rightScroller.el.hide()))},enableScroll:function(){var a=this;a.barScrollEnabled&&(a.leftScroller.el.show(),a.rightScroller.el.show(),0===a.scrolled&&(a.leftScroller.disable(),a.containerEl.css("margin-left",a.leftScroller.el.width()+a.tabOffSet+"px")))},initTabEdit:function(){var a=this;if(a.tabEdit)for(var b=a.items.length-1;b>-1;b--){var c=a.items[b];switch(c.type){case"number":case"string":case"date":return void c.on("tab",a.onTabLastInput,a)}}},onTabLastInput:function(d,e){var f=this,g=a.getWidget(f.el.parent().select("."+b).attr("id"));e.preventDefault(),g.leftColumns.length?setTimeout(function(){g.leftBody.el.select("."+c).item(0).dom.click()},100):setTimeout(function(){g.body.el.select("."+c).item(0).dom.click()},100)}})}(),Fancy.define("Fancy.Separator",{cls:Fancy.SEPARATOR_CLS,constructor:function(a){Fancy.apply(this,a),this.init()},init:function(){this.render()},render:function(){var a=this,b=Fancy.get(document.createElement("div"));b.addCls(a.cls),b.update("<div></div>"),a.el=Fancy.get(a.renderTo.appendChild(b.dom)),a.style&&a.el.css(a.style)}}),Fancy.define("Fancy.bar.Text",{extend:Fancy.Widget,widgetCls:Fancy.BAR_TEXT_CLS,cls:"",text:"",tipTpl:"{value}",constructor:function(a){Fancy.apply(this,a),this.Super("const",arguments)},init:function(){var a=this;a.Super("init",arguments),a.render(),a.ons()},render:function(){var a=this,b=Fancy.get(document.createElement("div"));b.addCls(a.widgetCls,a.cls),b.update(a.text),a.el=Fancy.get(a.renderTo.appendChild(b.dom)),a.style&&a.el.css(a.style),a.hidden&&a.el.css("display","none"),a.id&&a.el.attr("id",a.id),a.width&&a.el.css("width",a.width)},get:function(){return this.el.dom.innerHTML},getValue:function(){return this.get()},set:function(a){this.el.dom.innerHTML=a},ons:function(){var a=this,b=a.el;b.on("mouseover",a.onMouseOver,a),b.on("mouseout",a.onMouseOut,a),a.tip&&a.el.on("mousemove",a.onMouseMove,a)},onMouseMove:function(a){var b=this;b.tip&&b.tooltip&&b.tooltip.show(a.pageX+15,a.pageY-25)},onMouseOver:function(a){var b=this;b.fire("mouseover"),b.tip&&b.renderTip(a)},renderTip:function(a){var b=this;b.tooltip&&b.tooltip.destroy(),!0===b.tip&&(b.tip=new Fancy.Template(b.tipTpl).getHTML({value:b.get()})),b.tooltip=new Fancy.ToolTip({text:b.tip}),b.tooltip.css("display","block"),b.tooltip.show(a.pageX+15,a.pageY-25)},onMouseOut:function(){var a=this;a.fire("mouseout"),a.tooltip&&(a.tooltip.destroy(),delete a.tooltip)}}),Fancy.modules.form=!0,function(){var a=Fancy,b=a.MODAL_CLS,c=a.FIELD_NOT_VALID_CLS,d=a.FORM_CLS,e=a.FORM_BODY_CLS,f=a.PANEL_BODY_INNER_CLS,g=a.PANEL_GRID_INSIDE_CLS,h=a.PANEL_SHADOW_CLS,i=a.FIELD_BLANK_ERR_CLS,j=a.FIELD_TAB_CLS,k=a.FIELD_TAB_ACTIVE_CLS,l=a.TAB_TBAR_ACTIVE_CLS,m=a.PANEL_CLS,n=a.PANEL_TBAR_CLS,o=a.PANEL_BBAR_CLS,p=a.PANEL_SUB_TBAR_CLS,q=a.PANEL_BUTTONS_CLS,r=a.TAB_TBAR_CLS,s=a.FIELD_TEXT_CLS;a.Mixin("Fancy.form.mixin.Form",{tabScrollStep:50,init:function(){var b=this;if(b.calcFieldSize(),b.Super("init",arguments),b.addEvents("init","set","changetab"),!0!==a.fullBuilt&&!1!==a.MODULELOAD&&!1!==a.MODULESLOAD&&!0!==b.fullBuilt&&!0!==b.neededModules)return void b.loadModules();b.fire("beforerender"),b.applyDefaults(),b.preRender(),b.render(),b.scrollable&&b.checkScroll(),b.ons(),b.fire("init")},cls:"",widgetCls:d,value:"",width:200,height:300,emptyText:"",tpl:['<div class="'+e+'"></div>'],preRender:function(){var a=this;a.initRenderTo(),(a.title||a.tbar||a.bbar||a.buttons)&&a.renderPanel()},renderPanel:function(){var b=this,c={renderTo:b.renderTo,renderOuter:b.renderOuter,title:b.title,subTitle:b.subTitle,subTitleHeight:b.subTitleHeight,width:b.width,height:b.height,titleHeight:b.titleHeight,barHeight:b.barHeight,subTBarHeight:b.subTBarHeight||b.barHeight,tbarHeight:b.tbarHeight||b.barHeight,bbarHeight:b.bbarHeight||b.barHeight,buttonsHeight:b.buttonsHeight||b.barHeight,theme:b.theme,shadow:b.shadow,style:b.style||{},window:b.window,modal:b.modal,frame:b.frame,items:[b],tabs:b.tabs,draggable:b.draggable,minWidth:b.minWidth,minHeight:b.minHeight,panelBodyBorders:b.panelBodyBorders,resizable:b.resizable,tabScrollStep:b.tabScrollStep};a.each(b.buttons,function(c){a.isObject(c)&&(c.scope=c.scope||b)}),a.each(b.bbar,function(c){a.isObject(c)&&(c.scope=c.scope||b)}),a.each(b.tbar,function(c){a.isObject(c)&&(c.scope=c.scope||b)}),a.each(b.subTBar,function(c){a.isObject(c)&&(c.scope=c.scope||b)}),b.cls&&(c.cls=b.cls,delete b.cls),b.tabs&&(c.tbar=b.generateTabs(),b.height-=b.barHeight),b.bbar&&(c.bbar=b.bbar,b.height-=b.bbarHeight||b.barHeight),b.tbar&&(c.tbar=b.tbar,b.height-=b.tbarHeight||b.barHeight),b.subTBar&&(c.subTBar=b.subTBar,b.height-=b.subTBarHeight||b.barHeight),b.buttons&&(c.buttons=b.buttons,b.height-=b.buttonsHeight||b.barHeight,c.buttons=b.buttons),b.footer&&(c.footer=b.footer,b.height-=b.barHeight),b.panel=new a.Panel(c),b.bbar=b.panel.bbar,b.tbar=b.panel.tbar,b.buttons=b.panel.buttons,b.wrapped||b.panel.addCls(g),b.extraCls&&b.panel&&b.panel.addCls(b.extraCls),b.title&&(b.height-=b.titleHeight),b.subTitle&&(b.height-=b.subTitleHeight,b.height+=b.panelBodyBorders[2]),b.height-=b.panelBodyBorders[0],b.renderTo=b.panel.el.select("."+f).dom},initRenderTo:function(){var b=this,c=b.renderTo||document.body;a.isString(c)&&((c=document.getElementById(c))||(c=a.select(c).item(0))),b.renderTo=c},render:function(){var b=this,c=a.get(b.renderTo||document.body),d=a.get(document.createElement("div"));if(b.renderOuter&&!b.panel&&(d=c),!c.dom)throw new Error("[FancyGrid Error 1] - Could not find renderTo element: "+b.renderTo);d.addCls(b.cls,a.cls,b.widgetCls),Fancy.loadingStyle&&(b.panel?(b.panel.el.css("opacity",0),b.intervalStyleLoad=setInterval(function(){Fancy.loadingStyle||(clearInterval(b.intervalStyleLoad),b.panel.el.animate({opacity:1,force:!0}))},100)):(d.css("opacity",0),b.intervalStyleLoad=setInterval(function(){Fancy.loadingStyle||(clearInterval(b.intervalStyleLoad),b.el.animate({opacity:1,force:!0}))},100))),d.attr("id")||d.attr("id",b.id),d.css({width:b.width+"px",height:b.height+"px"}),d.update(b.tpl.join(" ")),b.renderOuter&&!b.panel?(b.el=d,a.isObject(b.style)&&b.el.css(b.style)):b.el=a.get(c.dom.appendChild(d.dom)),void 0===b.panel&&(b.shadow&&d.addCls(h),"default"!==b.theme&&d.addCls("fancy-theme-"+b.theme)),b._items=[],b.renderItems(),b.items=b._items,delete b._items,(b.tabs||b.tabbed)&&b.setActiveTab(),b.$tabs&&b.$prepareTabs(),b.fire("afterrender"),b.fire("render"),b.rendered=!0},generateTabs:function(){var b=this,c=[];if(b.tabs)for(var d=0,e=b.tabs.length;d<e;d++){var f={type:"tab"};a.isString(b.tabs[d])?f.text=b.tabs[d]:f=b.tabs[d],b.tabs[d]=f,void 0===b.tabs[d].handler&&(b.tabs[d].handler=function(a){return function(){b.setActiveTab(a)}}(d)),c.push(b.tabs[d])}return c},setActiveTab:function(a){var b=this,c=b.el.select("."+j),d=b.el.select("."+k);if(void 0!==a&&(b.activeTab=a),void 0===b.activeTab&&(b.activeTab=0),d.removeCls(k),c.item(b.activeTab).addCls(k),b.tabs){var e=b.panel.el.select("."+n+" ."+r);e.removeCls(l),e.item(b.activeTab).addCls(l)}b.fire("changetab",b.activeTab)},renderItems:function(b,c){var d,f=this,g=0;for(c=c||f.items,d=c.length,b=b||f.el.getByClass(e);g<d;g++){var h,i=c[g];switch(i.theme=f.theme,i.i18n=f.i18n,i.type){case"pass":case"password":h=a.form.field.String,i.type="string",i.isPassword=!0;break;case"hidden":h=a.form.field.String,i.hidden=!0;break;case"line":case"row":h=a.form.field.Line,i=f.applyDefaults(i);break;case"set":case"fieldset":i.form=f,h=a.form.field.Set,i=f.applyDefaults(i);break;case"tab":h=a.form.field.Tab,i=f.applyDefaults(i),f.$tabs=f.$tabs||[],f.$tabs.push(i.items);break;case"string":case void 0:h=a.form.field.String;break;case"number":h=a.form.field.Number;break;case"textarea":h=a.form.field.TextArea;break;case"checkbox":h=a.form.field.CheckBox;break;case"switcher":h=a.form.field.Switcher;break;case"combo":h=a.form.field.Combo;break;case"html":h=a.form.field.HTML;break;case"radio":h=a.form.field.Radio;break;case"date":h=a.form.field.Date;break;case"recaptcha":h=a.form.field.ReCaptcha;break;case"button":h=a.form.field.Button;break;case"segbutton":h=a.form.field.SegButton;break;default:throw new Error("type "+i.type+" is not set")}i.renderTo=i.renderTo||b;var j=new h(i);switch(i.type){case"line":case"row":case"set":case"fieldset":f.renderItems(j.el.select("."+s).dom,j.items);break;case"tab":f.renderItems(j.el.select(".fancy-field-tab-items").dom,j.items);break;default:f._items.push(j)}}},applyDefaults:function(b){var c=this;{if(void 0!==b){var d,e;if(b.defaults)for(d=0,e=b.items.length;d<e;d++)a.applyIf(b.items[d],b.defaults);return b}for(var f=c.items,g=0,h=f.length,i=c.defaults||{};g<h;g++)a.applyIf(f[g],i)}},ons:function(){var b=this;a.each(b.items,function(a){switch(a.type){case"line":case"row":break;case"set":case"fieldset":break;case"tab":case"button":case"segbutton":break;default:a.on("change",b.onChange,b)}}),b.responsive&&a.$(window).bind("resize",function(){b.onWindowResize(),b.intWindowResize&&clearInterval(b.intWindowResize),b.intWindowResize=setTimeout(function(){b.onWindowResize(),delete b.intWindowResize,setTimeout(function(){b.onWindowResize()},300)},30)})},onChange:function(a,b,c){this.fire("set",{name:a.name,value:b,oldValue:c})},getValues:function(){return this.get()},get:function(b){var c=this;if(b){var d;return a.each(c.items,function(a){switch(a.type){case"html":case"button":return}if(a.name===b)return d=a.get(),!0}),d}var e={};return a.each(c.items,function(a){switch(a.type){case"html":case"button":return}void 0!==a.name&&(e[a.name]=a.get())}),e},set:function(b,c){var d=this;if(a.isObject(b))for(var e in b)d.set(e,b[e]);else if(b)return a.each(d.items,function(a){a.name===b&&a.set(c)}),c},clear:function(b){var d=this;a.each(d.items,function(a){switch(a.type){case"html":case"recaptcha":case"button":return}!1!==b&&a.clear(),delete a.acceptValue,d.hasCls(c)&&(d.removeCls(c),d.css("height",parseInt(d.css("height"))-6+"px")),d.hasCls(i)&&(d.removeCls(i),d.css("height",parseInt(d.css("height"))-6+"px")),a.name&&d.params&&d.params[a.name]&&delete d.params[a.name]})},submit:function(b){var c=this,b=b||{},d=b.params||{},e=c.get();if(b.method?c.method=b.method:c.method="GET",b.failure?c.failure=b.failure:delete c.failure,b.success?c.success=b.success:delete c.success,b.url&&(c.url=b.url),c.clear(!1),!1!==c.valid())return c.params&&"wait"===c.params.recaptcha?void c.submit(b):void(c.params&&""===c.params.recaptcha||(a.applyIf(d,e),c.params=c.params||{},a.applyIf(d,e),a.applyIf(d,c.params),c.params=d,c.params["g-recaptcha-response"]=c.params.recaptcha,delete c.params.recaptcha,a.Ajax(c)))},valid:function(){var b=!0;return a.each(this.items,function(a){switch(a.type){case"field.string":case"string":case"number":case"field.number":case"textarea":case"field.textarea":break;default:return}!0===b?b=a.onBlur():a.onBlur()}),!!b},getItem:function(b,c){var d,e=!1;return a.each(this.items,function(a,c){if(a.name===b)return e=a,d=c,!0}),c?{item:e,order:d}:e},showAt:function(){var a=this.panel;a&&a.showAt.apply(a,arguments)},show:function(){var a=this,b=a.panel;setTimeout(function(){b?b.show.apply(b,arguments):a.el.show()},30)},hide:function(){var c=this;c.panel?c.panel.css({display:"none"}):c.css({display:"none"});var d=a.select("."+b);d.dom&&d.css("display","none");for(var e=0,f=c.items.length;e<f;e++)"combo"===c.items[e].type&&c.items[e].hideList()},setHeight:function(a){var b=this;b.panel&&(b.panel.css("height",a),b.buttons&&(a-=b.buttonsHeight||b.barHeight),b.bbar&&(a-=b.bbarHeight||b.barHeight),(b.tbar||b.tabs)&&(a-=b.tbarHeight||b.barHeight),b.title&&(a-=b.titleHeight),a-=b.panelBodyBorders[0],a-=b.panelBodyBorders[2]),b.css("height",a)},setWidth:function(b){var c=this;c.panel&&(c.panel.css("width",b),b-=c.panelBodyBorders[1],b-=c.panelBodyBorders[3]),c.css("width",b);var d={};a.each(c.items,function(c){if(c.lineName)return d[c.lineName]=d[c.lineName]||[],void d[c.lineName].push(c);switch(c.type){case"line":var e=b,f=0,g=0;e-=parseInt(c.css("margin-left")),e-=parseInt(c.css("margin-right")),a.each(c.items,function(a){switch(a.type){case"button":e-=a.css("width"),e-=parseInt(a.css("margin-left")),e-=parseInt(a.css("margin-right"));break;default:f++,g+=a.css("width")}});break;default:var e=b;e-=parseInt(c.css("margin-left")),e-=parseInt(c.css("margin-right")),c.setWidth(e)}}),a.each(d,function(c){var d=[],e=b,f=0;a.each(c,function(a,b){var g=parseInt(a.el.css("width"));switch(e-=parseInt(a.css("padding-left")),b===c.length-1&&(e-=parseInt(a.css("padding-right"))),a.type){case"button":return void(e-=g)}f+=g,d.push(g)});var g=[];a.each(c,function(a){switch(a.type){case"button":break;default:g.push(a)}});var h=f/100,i=e/100;a.each(d,function(a,b){var c=a/h,d=c*i;g[b].setWidth(d)})})},getHeight:function(){var a=this.panel;return a?a.getHeight():parseInt(this.css("height"))},calcFieldSize:function(){var b,c=this,d=c.width,e=c.defaults||{},f=c.maxLabelNumber;e.width=d-2*c.panelBorderWidth,a.each(c.items,function(b){switch(b.type){case"set":case"tab":"tab"===b.type&&(c.tabbed=!0);var e="set"===b.type?62:20;a.each(b.items,function(a){void 0===a.width&&(a.width=d-e),a.label&&a.label.length>f&&(f=a.label.length)}),b.defaults=b.defaults||{},b.defaults.labelWidth=b.defaults.labelWidth||8*(f+1);break;case"line":var g,h=b.items.length,i=!1,j=d;a.each(b.items,function(a){void 0===a.label&&"top"!==a.labelAlign&&(a.label=!1),a.width&&(j-=a.width,h--)}),g=(j-8-8-8)/h,a.each(b.items,function(a){a.width||(a.width=g),(a.labelWidth||a.inputWidth)&&(i=!0)}),!1===i&&a.each(b.items,function(a){"top"===a.labelAlign?a.labelWidth=g:a.labelWidth=100}),b.defaults=b.defaults||{},void 0===b.defaults.labelWidth&&(b.defaults.labelWidth=c.labelWidth);break;default:b.label&&b.label.length>f&&(f=b.label.length)}}),f++,b=6*f,b<80&&(b=80),e.labelWidth=b,c.inputWidth&&(e.inputWidth=c.inputWidth),c.defaults=e},destroy:function(){var a=this;a.el.destroy(),a.panel&&a.panel.el.destroy()},each:function(a,b){var c=this,d=c.items,e=0,f=d.length;if(b)for(;e<f;e++)a.apply(this,[d[e]]);else for(;e<f;e++)a(d[e])},loadModules:function(){var b=this,c=a.modules||{},d={},e=b.items||[];a.modules=c,a.nojQuery&&(d.dom=!0),a.isTouch&&(d.touch=!0);for(var f=0,g=e.length;f<g;f++){var h=e[f];if("date"===h.type&&(d.grid=!0,d.selection=!0,d.date=!0),h.items)for(var i=0,j=h.items.length;i<j;i++){var k=h.items[i];"date"===k.type&&(d.grid=!0,d.selection=!0,d.date=!0)}}b.neededModules={length:0};for(var l in d)void 0===a.modules[l]&&(b.neededModules[l]=!0,b.neededModules.length++);if(0===b.neededModules.length)return b.neededModules=!0,void b.init();var m=function(a){delete b.neededModules[a],0===--b.neededModules.length&&(b.neededModules=!0,b.init())};for(var l in b.neededModules)"length"!==l&&a.loadModule(l,m)},prevTab:function(){var a=this;a.activeTab--,a.activeTab<0&&(a.activeTab=0),a.setActiveTab()},nextTab:function(){var a=this,b=a.el.select("."+j).length;a.activeTab++,a.activeTab>=b&&(a.activeTab=b-1),a.setActiveTab()},onWindowResize:function(){var b,c=this,e=c.renderTo;c.panel&&(e=c.panel.renderTo),b=c.responsive?a.get(e):c.panel?c.panel.el:a.get(e),(b.hasClass(m)||b.hasClass(d))&&(b=b.parent());var f=b.width();void 0!==b.dom&&(0===f&&(f=b.parent().width()),c.responsive&&c.setWidth(f))},hideBar:function(a){var b,c,d=this;switch(a){case"tbar":b=n;break;case"subtbar":b=p;break;case"bbar":b=o;break;case"buttons":b=q;break;default:throw new Error("FancyGrid Error: bar does not exist")}if(c=d.panel.el.select("."+b),"none"!==c.css("display")){c.hide();var e=parseInt(d.panel.el.css("height"));d.panel.el.css("height",e-d.barHeight)}},showBar:function(a){var b,c,d=this;switch(a){case"tbar":b=n;break;case"subtbar":b=p;break;case"bbar":b=o;break;case"buttons":b=q;break;default:throw new Error("FancyGrid Error: bar does not exist")}if(c=d.panel.el.select("."+b),"none"==c.css("display")){c.show();var e=parseInt(d.panel.el.css("height"));d.panel.el.css("height",e+d.barHeight)}},$prepareTabs:function(){var b=this,c=0,d=0;a.each(b.items,function(a){b.$tabs[d][c]=a,c++,b.$tabs[d][c]||(c=0,d++)})},remove:function(b){var c,d=this;c=a.isString(b)?d.getItem(b,!0):{item:d.items[b],order:b},c.item.destroy(),d.items.splice(c.order,1)},checkScroll:function(){var b=this,c=b.el.select("."+e).item(0),d=parseInt(c.css("height")),f=0;a.each(b.items,function(a){f+=parseInt(a.css("height"))}),d<f&&c.css({"overflow-y":"scroll","overflow-x":"hidden"})}})}(),Fancy.Mixin("Fancy.form.mixin.PrepareConfig",{prepareConfig:function(a,b){var c=this;return a.renderOuter&&(a.renderTo=a.renderOuter),a=c.prepareConfigTheme(a,b),a=c.prepareConfigSize(a,b),a=c.prepareConfigLang(a,b),a=c.prepareConfigBars(a,b),a=c.prepareConfigDefaults(a),a=c.prepareConfigItems(a),a=c.prepareConfigFooter(a)},prepareConfigSize:function(a){var b,c=this,d=a.renderTo;return void 0===a.width&&d&&(a.responsive=!0,b=Fancy.get(d),a.width=parseInt(b.width())),void 0===a.height||"fit"===a.height&&setTimeout(function(){c.setHeightFit(),c.on("changetab",c.onChangeTab,c)}),a},prepareConfigDefaults:function(a){if(a.defaults)for(var b in a.defaults)Fancy.each(a.items,function(c){void 0===c[b]&&(c[b]=a.defaults[b])});return a},prepareConfigBars:function(a){var b=function(b){for(var c=0,d=b.length;c<d;c++)switch(b[c].type){case"date":if(!b[c].format){var e=a.lang.date;b[c].format={read:e.read,write:e.write,edit:e.edit}}}};return b(a.tbar||[]),b(a.subTBar||[]),b(a.bbar||[]),b(a.buttons||[]),a},prepareConfigItems:function(a){var b=this,c=function(a){a.theme=b.theme||"",void 0===a.labelWidth&&(a.labelWidth=b.labelWidth),void 0===a.inputWidth&&(a.inputWidth=b.inputWidth),"pass"!==a.type&&"password"!==a.type||(a.type="string",a.isPassword=!0),a.items&&Fancy.each(a.items,c)};return Fancy.each(a.items,c),a},setHeightFit:function(){var a=this,b=!!(a.title||a.subTitle||a.tbar||a.bbar||a.buttons||a.panel),c=a.panelBodyBorders,d=a.gridWithoutPanelBorders,e=a.gridBorders;a.heightFit=!0;var f=a.fieldHeight,g=a.items;if(a.$tabs){var h=a.activeTab||0;g=a.$tabs[h]}Fancy.each(g,function(a){a.hidden||(f+=parseInt(a.css("height")))}),a.title&&(f+=a.titleHeight),(a.tbar||a.tabs)&&(f+=a.tbarHeight||a.barHeight),a.bbar&&(f+=a.bbarHeight||a.barHeight),a.buttons&&(f+=a.buttonsHeight||a.barHeight),a.subTBar&&(f+=a.subTBarHeight||a.barHeight),a.footer&&(f+=a.barHeight),f+=b?c[0]+c[2]+e[0]+e[2]:d[0]+d[2]+e[0]+e[2],a.minHeight&&f<a.minHeight&&(f=a.minHeight),a.setHeight(f)},onChangeTab:function(){this.setHeightFit()}}),Fancy.define(["Fancy.Form","FancyForm"],{extend:Fancy.Widget,mixins:["Fancy.form.mixin.Form",Fancy.panel.mixin.PrepareConfig,Fancy.panel.mixin.methods,"Fancy.form.mixin.PrepareConfig"],type:"form",theme:"default",i18n:"en",maxLabelNumber:11,minWidth:200,minHeight:200,barScrollEnabled:!0,scrollable:!1,constructor:function(a,b){var c=this;Fancy.isDom(a)?(b=b||{},b.renderTo=a):b=a,b=b||{};var d=function(a){a&&Fancy.apply(b,a),b=c.prepareConfig(b,c),Fancy.applyConfig(c,b),c.Super("const",arguments)},e=function(){var a=b.i18n||c.i18n;!0===Fancy.loadLang(a,d)&&d({})};Fancy.loadStyle(),Fancy.modules.form||Fancy.fullBuilt||!1===Fancy.MODULELOAD||!1===Fancy.MODULESLOAD||!0===c.fullBuilt||!0===c.neededModules?e():Fancy.modules.grid?Fancy.loadModule("form",function(){e()}):c.loadModules(e,b)},loadModules:function(a,b){var c=this,d={form:!0};Fancy.modules=Fancy.modules||{},Fancy.nojQuery&&(d.dom=!0),Fancy.isTouch&&(d.touch=!0),b.url&&(d.ajax=!0);var e=function(a){if(a.menu)return d.menu=!0,!0};Fancy.each(b.tbar,e),Fancy.each(b.bbar,e),Fancy.each(b.buttons,e),Fancy.each(b.subTBar,e);var f=function(a){for(var b,c=0,e=a.length;c<e;c++)b=a[c],"combo"===b.type&&b.data&&b.data.proxy&&(d.ajax=!0),"date"===b.type&&(d.grid=!0,d.date=!0,d.selection=!0),b.items&&f(b.items)};f(b.items||[]),c.neededModules={length:0};for(var g in d)void 0===Fancy.modules[g]&&(c.neededModules[g]=!0,c.neededModules.length++);if(0===c.neededModules.length)return c.neededModules=!0,void a();var h=function(b){delete c.neededModules[b],0===--c.neededModules.length&&(c.neededModules=!0,a())};if(c.neededModules.dom)Fancy.loadModule("dom",function(){delete c.neededModules.dom,c.neededModules.length--;for(var a in c.neededModules)"length"!==a&&Fancy.loadModule(a,h)});else for(var g in c.neededModules)"length"!==g&&Fancy.loadModule(g,h)}}),FancyForm.get=function(a){var b=Fancy.get(a);if(b.dom){var c=b.select(".fancy-form").dom.id;return Fancy.getWidget(c)}},FancyForm.defineTheme=Fancy.defineTheme,FancyForm.defineController=Fancy.defineController,FancyForm.addValid=Fancy.addValid,!Fancy.nojQuery&&Fancy.$&&(Fancy.$.fn.FancyForm=function(a){return this.selector?a.renderTo=Fancy.$(this.selector)[0].id:a.renderTo=this.attr("id"),new Fancy.Form(a)}),function(){var a=Fancy,b=a.FIELD_NOT_VALID_CLS,c=a.FIELD_LABEL_ALIGN_TOP_CLS,d=a.FIELD_TEXT_CLS,e=a.FIELD_LABEL_CLS,f=a.FIELD_TEXTAREA_TEXT_CLS,g=a.FIELD_LABEL_ALIGN_RIGHT_CLS,h=a.FIELD_DISABLED_CLS;a.ns("Fancy.form.field"),a.form.field.Mixin=function(){},a.form.field.Mixin.prototype={padding:"8px 8px 0px 8px",inputHeight:29,labelHeight:18,failedValidCls:b,cls:"",checkValidOnTyping:!1,editable:!0,ons:function(){var a=this,b=a.el,c=a.el.getByTag("input");if(a.input=c,c.on("blur",a.onBlur,a),c.on("focus",a.onFocus,a),c.on("input",a.onInput,a),c.on("keydown",a.onKeyDown,a),b.on("mouseenter",a.onMouseOver,a),b.on("mouseleave",a.onMouseOut,a),a.on("key",a.onKey,a),a.tip&&b.on("mousemove",a.onMouseMove,a),a.format&&a.format.inputFn){switch(a.value){case"":case void 0:break;default:a.formatValue(a.value)}a.on("key",a.onKeyInputFn)}a.stopPropagation&&b.on("mousedown",function(a){a.stopPropagation()}),b.on("mousedown",function(b){a.disabled&&(b.preventDefault(),b.stopPropagation())})},onKeyInputFn:function(b,c,d){var e=this,f=d.keyCode,g=a.key;if(!e.disabled){switch(f){case g.ENTER:case g.ESC:case g.LEFT:case g.RIGHT:return}this.formatValue(c)}},formatValue:function(a){var b=this;a=this.format.inputFn(a);var c=this.input.dom.selectionStart,d=this.input.dom.value;this.input.dom.value=a,d.length<a.length&&c++,b.setCaretPosition(c)},setCaretPosition:function(a){var b=this.input.dom;if(b.createTextRange){var c=b.createTextRange();c.move("character",a),c.select()}else b.selectionStart?(b.focus(),b.setSelectionRange(a,a)):b.focus()},onMouseOver:function(a){var b=this;b.disabled||(b.fire("mouseover"),b.tip&&b.renderTip(a))},onMouseOut:function(a){var b=this;b.disabled||(b.fire("mouseout"),b.tip&&b.tooltip&&(b.tooltipToDestroy=!0,b.tooltip.destroy(),delete b.tooltip))},render:function(){var b=this,i=b.renderTo||document.body,j=b.renderAfter,k=b.renderBefore,l=a.get(document.createElement("div"));a.isString(i)&&((i=document.getElementById(i))||(i=a.select(i).item(0))),b.fire("beforerender"),l.addCls(a.cls,b.cls,b.fieldCls),l.attr("id",b.id);var m="",n="";b.itemsHTML&&(n=b.itemsHTML),"top"===b.labelAlign&&b.label&&b.labelWidth<7*b.label.length&&(b.labelWidth=7*(b.label.length+2)),b.labelWidth&&(m="width:"+b.labelWidth+"px;");var o=b.label;""===b.label?o="&nbsp;":void 0===b.label?o="&nbsp;":"right"!==b.labelAlign&&(o+=":");var p="",q="",r="";if(!1===b.label&&(p="display:none;"),b.inputLabel?r=b.inputLabel:q="display:none;","recaptcha"===b.type)l.update(b.tpl.getHTML({key:b.key}));else{var s={labelWidth:m,label:o,labelDisplay:p,inputLabelDisplay:q,inputLabel:r,emptyText:b.emptyText,value:b.value,height:b.height,itemsHTML:n,errorTextStyle:"",buttonText:b.buttonText};"set"===b.type&&delete s.height,l.update(b.tpl.getHTML(s))}if(b.el=l,b.setStyle(),!0===b.renderId&&l.attr("id",b.id),j?(j=a.get(j),l=j.after(l.dom.outerHTML).next()):k?l=k.before(l.dom.outerHTML).prev():i.appendChild(l.dom),b.el=l,"textarea"===b.type?b.input=b.el.getByTag("textarea"):b.input=b.el.getByTag("input"),b.name&&(b.input.name=b.name),b.setSize(),"top"===b.labelAlign)b.el.addCls(c),b.el.select("."+d).css("float","none");else if("right"===b.labelAlign)switch(b.el.addCls(g),b.type){case"radio":a.$(l.dom).find("."+e).insertAfter(a.$(l.dom).find("."+d+":last")),a.$(l.dom).find("."+e).css("float","right");break;case"textarea":a.$(l.dom).find("."+e).insertAfter(a.$(l.dom).find("."+f));break;case"checkbox":a.$(l.dom).find("."+e).css("float","right");break;default:a.$(l.dom).find("."+e).insertAfter(a.$(l.dom).find("."+d))}else b.type;if(b.acceptedValue=b.value,b.fire("afterrender"),b.fire("render"),"recaptcha"!==b.type&&"chat"!==b.type&&setTimeout(function(){b.input&&b.input.dom&&0===b.input.dom.value.length&&void 0===b.prevColor&&(b.prevColor=b.input.css("color"))},1),b.disabled){switch(b.type){case"hidden":break;default:b.addCls(h)}b.input&&b.input.attr("tabIndex",-1)}else b.input&&b.tabIndex&&b.input.attr("tabIndex",b.tabIndex)},onKeyDown:function(b){var c=this,d=b.keyCode,e=a.key;if(!c.disabled){switch(d){case e.BACKSPACE:case e.DELETE:switch(c.type){case"field.number":case"field.string":case"field.date":setTimeout(function(){""===c.getValue()&&c.fire("empty")},1)}break;case e.TAB:c.fire("tab",b);break;case e.ENTER:c.fire("enter",c.getValue()),"textarea"!==c.type&&(b.preventDefault(),b.stopPropagation());break;case e.UP:switch(c.type){case"number":case"field.number":this.spin&&c.spinUp()}c.fire("up",c.getValue()),"textarea"!==c.type&&(b.preventDefault(),b.stopPropagation());break;case e.DOWN:switch(c.type){case"number":case"field.number":this.spin&&c.spinDown()}c.fire("down",c.getValue()),"textarea"!==c.type&&(b.preventDefault(),b.stopPropagation());break;case e.LEFT:case e.RIGHT:b.stopPropagation();break;default:setTimeout(function(){c.input&&(0===c.input.dom.value.length?(void 0===c.prevColor&&(c.prevColor=c.input.css("color")),c.input.css("color","grey")):c.prevColor?c.input.css("color",c.prevColor):c.input.css("color"," "))},1)}setTimeout(function(){c.fire("key",c.input.dom.value,b)},1)}},onKey:function(a,b){a.disabled||a.isValid()&&!a.checkValidOnTyping||a.validate(b)},onBlur:function(){var a=this;if(a.disabled)return!0;if(a.fire("blur"),a.input){if("combo"!==a.type)return a.validate(a.input.dom.value);setTimeout(function(){a.listItemClicked||a.validate(a.input.dom.value)},100)}return!0},validate:function(b){var c=this,d=c.vtype;if(void 0===d)return!0;var e=a.isValid(d,b);return!0!==e?(c.errorText=new a.Template(e.text).getHTML(e),c.failedValid(),!1):(c.successValid(),!0)},isValid:function(){return!this.hasCls(this.failedValidCls)},onFocus:function(a){var b=this;if(b.disabled||!1===b.editable)return void this.input.blur();b.fire("focus")},blur:function(){this.input.blur()},onInput:function(){var a=this,b=a.getValue(),c=a.acceptedValue;a.disabled||(a.acceptedValue=a.get(),a.fire("input",b),a.fire("change",b,c))},get:function(){var b=this;if(b.format)if(a.isString(b.format));else{if(!a.isObject(b.format))return b.value;if(b.format.inputFn&&("number"===b.type||"field.number"===b.type))return isNaN(parseFloat(b.value))?b.value:Number(b.value)}return b.input.dom.value},getValue:function(){return this.get()},set:function(a,b){var c=this;c.value=a,c.format&&c.format.inputFn?c.formatValue(a):c.input.dom.value=a,!1!==b&&c.onInput(),c.validate(a)},setLabel:function(a){this.el.select("."+e).update(a)},setValue:function(a,b){this.set(a,b)},clear:function(){this.set(""),this.clearValid()},failedValid:function(){var a=this;a.hasCls(a.failedValidCls)?a.tooltip&&a.errorText&&a.tooltip.update(a.errorText):(!a.tooltip&&a.errorText&&(a.showErrorTip(),a.el.on("mousemove",a.onMouseMove,a),a.input.hover(function(b){a.errorText&&(a.showErrorTip(),a.tooltip.show(b.pageX+15,b.pageY-25))},function(){a.hideErrorTip()})),a.addCls(a.failedValidCls))},clearValid:function(){this.removeCls(this.failedValidCls)},successValid:function(){var a=this;a.removeCls(a.failedValidCls),a.hideErrorTip(),delete a.errorText},showErrorTip:function(){var b=this;b.tooltip||(b.tooltip=new a.ToolTip({text:b.errorText}))},hideErrorTip:function(){var a=this;a.tooltip&&(a.tooltip.destroy(),delete a.tooltip)},setInputSize:function(a){var b=this;"combo"===b.type&&b.inputContainer.css("width",a.width),a.width&&b.input.css("width",a.width),a.height&&"set"!==b.type&&b.input.css("height",a.height)},focus:function(){var a=this;a.input.focus(),setTimeout(function(){a.input.dom.selectionStart=a.input.dom.selectionEnd=1e4},0)},hide:function(){var a=this;a.fire("beforehide"),a.css("display","none"),a.fire("hide")},show:function(){this.css("display","block")},setSize:function(a,b){var c=this;if(c.type,void 0===a&&void 0===b)a=c.width,b=c.height;else if(void 0===b){var d=a;a=d.width?d.width:c.width,b=d.height?d.height:c.height}if(c.size)return void c.size({width:a,height:b});void 0!==a&&c.css("width",a),"top"===c.labelAlign?c.css("height",1.5*b):("set"!==c.type&&c.css("height",b),c.label&&c.el.select("."+e).css("height",c.inputHeight)),c.setInputSize({width:c.inputWidth,height:c.inputHeight})},setStyle:function(){var b=this,c=b.style||{},d=b.padding;d?(a.isNumber(d)?d+="px":a.isString(d),void 0===c.padding&&(c.padding=d)):c.padding="0px",b.hidden&&b.css("display","none"),b.css(c)},preRender:function(){var b=this;b.tpl&&!1===a.isObject(b.tpl)&&(b.tpl=new a.Template(b.tpl)),b.calcSize()},calcSize:function(){var b,c,d,e,f,g=this,h=g.inputHeight,i=g.padding;if(a.isString(i))switch(i=i.replace(/px/g,""),i=i.split(" "),i.length){case 1:c=Number(i[0]),i=[c,c,c,c];break;case 2:d=Number(i[0]),e=Number(i[1]),i=[d,e,d,e];break;case 3:d=Number(i[0]),e=Number(i[1]),f=Number(i[2]),i=[d,e,f,d];break;case 4:i=[Number(i[0]),Number(i[1]),Number(i[2]),Number(i[3])]}else a.isNumber(i)?i=[i,i,i,i]:!1===i&&(i=[0,0,0,0]);"top"===g.labelAlign&&(g.height*=1.5),b=g.width,"top"!==g.labelAlign&&g.label&&(b-=g.labelWidth),g.height===g.inputHeight&&!1!==g.padding&&(h-=i[0]+i[2]),"radio"!==g.type||g.column||(g.calcColumns(),1!==g.rows&&(h=(h-i[0]-i[2])*g.rows)),g.inputHeight=h,g.inputWidth=b-i[1]-i[3],g.height=h+i[0]+i[2]},setWidth:function(a){var b=this;b.width=a,b.calcSize(),b.css("width",a),b.setInputSize({width:b.inputWidth})},onMouseMove:function(a){var b=this,c=b.widget;if(!b.disabled){if(delete b.tooltipToDestroy,c){if(c.startResizing&&b.tooltip)return void b.tooltip.destroy();if(c.columndrag&&"dragging"===c.columndrag.status)return void b.tooltip.destroy()}b.tip?b.renderTip(a):b.tooltip&&b.tooltip.show(a.pageX+15,a.pageY-25)}},renderTip:function(b){var c=this,d="",e=new a.Template(c.tip||c.tooltip);c.getValue&&(d=c.getValue());var f=e.getHTML({value:d});c.tooltip?c.tooltip.update(f):c.tooltip=new a.ToolTip({text:f}),c.tooltip.show(b.pageX+15,b.pageY-25)},getInputSelection:function(){var a,b,c,d,e,f=this,g=0,h=0,i=f.input.dom;return"number"==typeof i.selectionStart&&"number"==typeof i.selectionEnd?(g=i.selectionStart,h=i.selectionEnd):(b=document.selection.createRange())&&b.parentElement()==i&&(d=i.value.length,a=i.value.replace(/\r\n/g,"\n"),c=i.createTextRange(),c.moveToBookmark(b.getBookmark()),e=i.createTextRange(),e.collapse(!1),c.compareEndPoints("StartToEnd",e)>-1?g=h=d:(g=-c.moveStart("character",-d),g+=a.slice(0,g).split("\n").length-1,c.compareEndPoints("EndToEnd",e)>-1?h=d:(h=-c.moveEnd("character",-d),h+=a.slice(0,h).split("\n").length-1))),{start:g,end:h}},enable:function(){var a=this;a.disabled=!1,a.removeCls(h),a.button&&a.button.enable(),a.input&&a.input.attr("tabIndex",a.tabIndex||0)},disable:function(){var a=this;a.disabled=!0,a.addCls(h),a.button&&a.button.disable(),a.input&&a.input.attr("tabIndex",-1)},getInputValue:function(){return this.input.dom.value}}}(),Fancy.define(["Fancy.form.field.String","Fancy.StringField"],{mixins:[Fancy.form.field.Mixin],extend:Fancy.Widget,type:"field.string",constructor:function(a){Fancy.apply(this,a),this.Super("const",arguments)},init:function(){var a=this;a.addEvents("focus","blur","input","enter","up","down","tab","change","key","empty"),a.Super("init",arguments),a.preRender(),a.render(),a.ons(),a.isPassword&&(a.input.attr({type:"password"}),a.showPassTip&&(a.el.select(".fancy-field-text").item(0).append('<div class="fancy-field-pass-tip">abc</div>'),a.passTipEl=a.el.select(".fancy-field-pass-tip").item(0),a.passTipEl.on("mousedown",function(a){a.preventDefault()}),a.passTipEl.on("click",function(){"password"!==a.input.attr("type")?(a.passTipEl.update("abc"),a.input.attr("type","password"),a.passTipEl.css("line-height","22px")):(a.passTipEl.update("***"),a.input.attr("type",""),a.passTipEl.css("line-height","28px"))}))),a.hidden&&a.css("display","none"),a.style&&a.css(a.style)},fieldCls:Fancy.FIELD_CLS,value:"",width:100,emptyText:"",tpl:['<div class="fancy-field-label" style="{labelWidth}{labelDisplay}">',"{label}","</div>",'<div class="fancy-field-text">','<input placeholder="{emptyText}" class="fancy-field-text-input" style="{inputWidth}" value="{value}">','<div class="fancy-field-error" style="{errorTextStyle}"></div>',"</div>",'<div class="fancy-clearfix"></div>']}),function(){var a=Fancy.CLEARFIX_CLS,b=Fancy.FIELD_CLS,c=Fancy.FIELD_LABEL_CLS,d=Fancy.FIELD_ERROR_CLS,e=Fancy.FIELD_TEXT_CLS,f=Fancy.FIELD_TEXT_INPUT_CLS,g=Fancy.FIELD_SPIN_CLS,h=Fancy.FIELD_SPIN_UP_CLS,i=Fancy.FIELD_SPIN_DOWN_CLS;Fancy.define(["Fancy.form.field.Number","Fancy.NumberField"],{mixins:[Fancy.form.field.Mixin],extend:Fancy.Widget,type:"field.number",allowBlank:!0,constructor:function(a){Fancy.apply(this,a),this.Super("const",arguments)},init:function(){var a=this;a.addEvents("focus","blur","input","enter","up","down","tab","change","key","empty"),a.Super("init",arguments),a.preRender(),a.render(),a.ons(),a.hidden&&a.css("display","none"),a.initSpin()},fieldCls:b,value:"",width:100,emptyText:"",step:1,tpl:['<div class="'+c+'" style="{labelWidth}{labelDisplay}">',"{label}","</div>",'<div class="'+e+'">','<input placeholder="{emptyText}" class="'+f+'" style="{inputWidth}" value="{value}">','<div class="'+g+'">','<div class="'+h+'"></div>','<div class="'+i+'"></div>',"</div>",'<div class="'+d+'" style="{errorTextStyle}"></div>',"</div>",'<div class="'+a+'"></div>'],onInput:function(){var a=this,b=a.input,c=a.get(),d=a.acceptedValue;if(a.isValid()){for(var e=b.dom.value,f="",g=0,h=e.length;g<h;g++)switch(e[g]){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":case"+":case".":f+=e[g]}isNaN(Number(f))||(a.value=f,c=f)}a.acceptedValue=Number(a.get()),a.fire("input",c),a.fire("change",Number(c),Number(d))},isNumber:function(a){return""===a||"-"===a||Fancy.isNumber(+a)},checkMinMax:function(a){var b=this;return""===a||"-"===a||(a=+a)>=b.min&&a<=b.max},setMin:function(a){this.min=a},setMax:function(a){this.max=a},initSpin:function(){var a=this;!0===a.spin&&(a.el.select("."+g).css("display","block"),a.el.select("."+h).on("mousedown",a.onMouseDownSpinUp,a),a.el.select("."+i).on("mousedown",a.onMouseDownSpinDown,a))},onMouseDownSpinUp:function(a){var b=this,c=Fancy.get(document),d=700,e=new Date;b.disabled||(a.preventDefault(),b.mouseDownSpinUp=!0,b.spinUp(),b.spinInterval=setInterval(function(){b.mouseDownSpinUp=!1,new Date-e>d&&(700===d&&(d=150),e=new Date,b.spinUp(),--d<20&&(d=20))},20),c.once("mouseup",function(){clearInterval(b.spinInterval)}),b.focus())},onMouseDownSpinDown:function(a){var b=this,c=Fancy.get(document),d=700,e=new Date;b.disabled||(a.preventDefault(),b.mouseDownSpinDown=!0,b.spinDown(),b.spinInterval=setInterval(function(){b.mouseDownSpinDown=!1,new Date-e>d&&(700===d&&(d=150),e=new Date,b.spinDown(),--d<20&&(d=20))},20),c.once("mouseup",function(){clearInterval(b.spinInterval)}),b.focus())},spinUp:function(){var a=this,b=+a.get()+a.step;Fancy.Number.isFloat(a.step)&&(b=Fancy.Number.correctFloat(b)),isNaN(b)&&(b=a.min||0),void 0!==a.max&&b>a.max?b=a.max:b<a.min&&(b=a.min),a.set(b)},spinDown:function(){var a=this,b=+a.get()-a.step;Fancy.Number.isFloat(a.step)&&(b=Fancy.Number.correctFloat(b)),isNaN(b)&&(b=a.min||0),void 0!==a.min&&b<a.min?b=a.min:b>a.max&&(b=a.max),a.set(b)}})}(),function(){var a=Fancy,b=a.CLEARFIX_CLS,c=a.FIELD_CLS,d=a.FIELD_LABEL_CLS,e=a.FIELD_TEXT_CLS,f=a.FIELD_ERROR_CLS,g=a.FIELD_TEXT_INPUT_CLS;a.define(["Fancy.form.field.Date","Fancy.DateField"],{mixins:[a.form.field.Mixin],extend:a.Widget,type:"field.date",picker:!0,i18n:"en",theme:"default",fieldCls:c,value:"",width:100,emptyText:"",tpl:['<div class="'+d+'" style="{labelWidth}{labelDisplay}">',"{label}","</div>",'<div class="'+e+'">','<input placeholder="{emptyText}" class="'+g+'" style="{inputWidth}" value="{value}">','<div class="fancy-field-picker-button"></div>','<div class="'+f+'" style="{errorTextStyle}"></div>',"</div>",'<div class="'+b+'"></div>'],constructor:function(b){a.apply(this,b),this.Super("const",arguments)},init:function(){var b=this;b.addEvents("focus","blur","input","enter","up","down","tab","change","key","showpicker"),b.initFormat(),b.Super("init",arguments),b.preRender(),b.render(),b.ons(),b.hidden&&b.css("display","none"),b.style&&b.css(b.style),a.isDate(b.value)?b.date=b.value:b.initDate(),b.changeInputValue(),b.initPicker()},initDate:function(b,c){var d=this;if(b){if("date"===a.typeOf(b))return void(d.date=b);var e;if(e=c?a.Date.parse(b,c,d.format.mode):a.Date.parse(b,d.format.read,d.format.mode),"Invalid Date"===e.toString&&(e=a.Date.parse(b,d.format.edit,d.format.mode)),"Invalid Date"===e.toString)return;return void(d.date=e)}switch(a.typeOf(b)){case"date":d.date=d.value;break;case"undefined":case"string":if(!d.value)return void delete d.date;d.date=a.Date.parse(d.value,d.format.read,d.format.mode)}},changeInputValue:function(){var b=this;if("date"!==a.typeOf(b.date)||"Invalid Date"===b.date.toString())return void(b.input.dom.value="");var c=a.Date.format(b.date,b.format.edit,void 0,b.format.mode);b.format&&b.format.inputFn&&(c=b.format.inputFn(c)),void 0===c&&(c=""),b.input.dom.value=c,b.fire("change",c)},initFormat:function(){var b=this;b.format?a.isObject(b.format)&&a.applyIf(b.format,a.i18n[b.i18n].date):b.format=a.i18n[b.i18n].date},formatValue:function(b){var c=this;if(!c.value&&b?c.value=b:!b&&c.value&&(b=c.value),c.value)if("date"===a.typeOf(c.value)){if(c.value=a.Date.format(c.value,c.format.read,void 0,c.format.mode),void 0===b){var d=a.Date.parse(c.value,c.format.edit,c.format.mode);b=a.Date.format(d,c.format.edit,void 0,c.format.mode)}c.acceptedValue=b}else{var e=a.Date.parse(c.value,c.format.read,c.format.mode);c.value=a.Date.format(e,c.format.edit,void 0,c.format.mode)}else;c.format&&c.format.inputFn&&(b=c.format.inputFn(b)),void 0===b&&(b=""),/NaN/.test(b)&&(b=""),c.input.dom.value=b},ons:function(){var a=this,b=a.el.getByTag("input");a.input=b,b.on("blur",a.onBlur,a),b.on("focus",a.onFocus,a),b.on("input",a.onInput,a),b.on("keydown",a.onKeyDown,a),a.on("key",a.onKey,a),a.on("enter",a.onEnter,a),a.on("beforehide",a.onBeforeHide,a),a.format&&a.format.inputFn&&a.on("key",a.onKeyInputFn)},initPicker:function(){var a=this;!1!==a.picker&&!1!==a.editable&&(!1===a.dateImage?(a.el.select(".fancy-field-picker-button").css("display","none"),a.input.on("click",a.onInputClick,a)):(a.pickerButton=a.el.select(".fancy-field-picker-button"),a.pickerButton.on("mousedown",a.onPickerButtonMouseDown,a),a.input.on("mousedown",a.onInputMouseDown,a)))},onInputClick:function(a){a.preventDefault(),this.toggleShowPicker()},onInputMouseDown:function(a){var b=this,c=b.picker;c&&c.el&&"none"!==c.el.css("display")&&a.stopPropagation()},onPickerButtonMouseDown:function(a){var b=this;b.disabled||(a.preventDefault(),b.toggleShowPicker())},showPicker:function(){var b=this,c=b.el,d=b.input,f=a.get(document),g=!1;!0===b.picker?(g=!0,b.renderPicker()):b.picker.monthPicker&&(b.picker.monthPicker.hide(),b.picker.monthPicker.panel.css("top","-300px"));var h=d.offset(),i=h.left,j=h.top+c.select("."+e).height(),k=b.date||new Date;"Invalid Date"===k.toString()&&(k=new Date),b.picker.setDate(k,g),a.datepicker.Manager.add(b.picker),b.picker.showAt(i,j),b.fire("showpicker"),b.docSpy||(b.docSpy=!0,f.on("click",b.onDocClick,b))},onDocClick:function(b){var c=this,d=c.picker,e=d.monthPicker,f=b.target;"input"===f.tagName.toLocaleLowerCase()||a.get(f).hasCls("fancy-field-picker-button")||d.panel.el.within(f)||e&&e.panel.el.within(f)||c.hidePicker()},hidePicker:function(){var b=this;if(!1!==b.picker&&b.picker.hide&&b.picker.hide(),b.docSpy){var c=a.get(document);b.docSpy=!1,c.un("click",b.onDocClick,b)}},toggleShowPicker:function(){var a=this;if(!0===a.picker)return void a.showPicker();"none"===a.picker.panel.el.css("display")?a.showPicker():a.hidePicker()},renderPicker:function(){var b=this;(a.fullBuilt||a.modules.grid||!1===a.MODULELOAD||!1===a.MODULESLOAD)&&(b.picker=new a.DatePicker({window:!0,date:b.date,format:b.format,theme:b.theme,minValue:b.min,maxValue:b.max,i18n:b.i18n,events:[{changedate:b.onPickerChangeDate,scope:b}]}))},get:function(){var b=this;return""===b.input.dom.value?(delete b.date,delete b.value,""):b.date?a.Date.format(b.date,b.format.write,void 0,b.format.mode):""},getDate:function(){return this.date||""},onBeforeHide:function(){this.hidePicker()},onPickerChangeDate:function(a,b,c){var d=this;!1!==c&&d.picker.hide(),d.initDate(b),d.changeInputValue()},onInput:function(){var b=this,c=b.input,d=c.dom.value,e=b.acceptedValue;"Invalid Date"!==a.Date.parse(d,b.format.edit,b.format.mode).toString()&&(b.initDate(d,b.format.edit),b.fire("input",d),b.fire("change",d,e))},isValid:function(){var b=this;return"Invalid Date"!==a.Date.parse(b.get(),b.format.edit,b.format.mode).toString()},set:function(a){var b=this;switch(a){case"":case void 0:return delete b.value,delete b.date,void b.changeInputValue()}b.initDate(a),b.changeInputValue()},isEqual:function(b){var c=this,d=a.Date.parse(b,c.format.read,c.format.mode),e=c.input.dom.value;return(b=a.Date.format(d,c.format.edit,void 0,c.format.mode))===e},onEnter:function(){var a=this,b=a.input,c=b.dom.value,d=a.acceptedValue;""===c&&(a.initDate(),a.fire("input",c),a.fire("change",c,d))}})}(),function(){var a=Fancy;a.define(["Fancy.form.field.DateRange","Fancy.DateRangeField"],{extend:a.Widget,type:"field.daterange",picker:!0,format:"m/d/Y",dateImage:!0,theme:"default",constructor:function(b){a.apply(this,b),this.Super("const",arguments)},init:function(){var a=this;a.addEvents("changedatefrom","changedateto","change"),a.preRender(),a.render(),a.initDateFields()},fieldCls:a.cls+" fancy-date-range",width:100,render:function(){var b=this,c=b.renderTo||document.body,d=a.get(document.createElement("div"));d.addCls(b.cls),b.el=a.get(a.get(c).dom.appendChild(d.dom))},preRender:function(){},initDateFields:function(){var b=this,c=b.theme;b.dateField1=new a.DateField({renderTo:b.el.dom,label:!1,dateImage:b.dateImage,width:b.width/2,padding:!1,theme:c,style:{position:"absolute",bottom:"2px",left:"3px"},format:b.format,events:[{showpicker:b.onShowPicker1,scope:b},{change:b.onChangeDate1,scope:b},{focus:b.onFocus1,scope:b},{enter:b.onEnter,scope:b}]}),b.dateField1.setInputSize({width:b.width/2}),b.dateField2=new a.DateField({renderTo:b.el.dom,label:!1,dateImage:b.dateImage,width:b.width/2,padding:!1,theme:c,style:{position:"absolute",bottom:"2px",right:"2px"},format:b.format,events:[{showpicker:b.onShowPicker2,scope:b},{change:b.onChangeDate2,scope:b},{focus:b.onFocus2,scope:b},{keydown:b.onEnter,scope:b}]}),b.dateField2.setInputSize({width:b.width/2})},onFocus1:function(){this.dateField2.hidePicker()},onFocus2:function(){this.dateField1.hidePicker()},onShowPicker1:function(){this.dateField2.hidePicker()},onShowPicker2:function(){this.dateField1.hidePicker()},onChangeDate1:function(b,c){var d=this,c=a.Date.parse(c,b.format.edit,b.format.mode);d.fire("changedatefrom",c),d.fire("change")},onChangeDate2:function(b,c){var c=a.Date.parse(c,b.format.edit,b.format.mode);this.fire("changedateto",c),this.fire("change")},onEnter:function(){this.dateField1.hidePicker(),this.dateField2.hidePicker()}})}(),Fancy.define(["Fancy.form.field.Text","Fancy.TextField"],{mixins:[Fancy.form.field.Mixin],extend:Fancy.Widget,type:"field.text",constructor:function(a){Fancy.apply(this,a),this.Super("const",arguments)},init:function(){var a=this;a.Super("init",arguments),a.preRender(),a.render(),a.hidden&&a.css("display","none"),a.style&&a.css(a.style)},fieldCls:Fancy.FIELD_CLS+" fancy-field-field-text",value:"",width:100,emptyText:"",tpl:['<div class="fancy-field-label" style="{labelWidth}{labelDisplay}">',"{label}","</div>",'<div class="fancy-field-text">','<div class="fancy-field-text-value">{value}</div>','<div class="fancy-field-error" style="{errorTextStyle}"></div>',"</div>",'<div class="fancy-clearfix"></div>'],set:function(a){this.el.select(".fancy-field-text-value").item(0).update(a)}}),Fancy.define(["Fancy.form.field.Empty","Fancy.EmptyField"],{mixins:[Fancy.form.field.Mixin],extend:Fancy.Widget,type:"field.empty",constructor:function(a){Fancy.apply(this,a),this.Super("const",arguments)},init:function(){var a=this;a.addEvents(),a.Super("init",arguments),a.preRender(),a.render(),a.style&&a.css(a.style)},ons:function(){},fieldCls:Fancy.FIELD_CLS+" "+Fancy.FIELD_EMPTY_CLS,width:100,tpl:['<div class="fancy-field-label" style="{labelWidth}{labelDisplay}">',"{label}","</div>",'<div class="fancy-field-text">','<div class="fancy-field-error" style="{errorTextStyle}"></div>',"</div>",'<div class="fancy-clearfix"></div>']}),function(){var a=Fancy,b=a.FIELD_CLS,c=a.FIELD_TEXTAREA_CLS,d=a.FIELD_LABEL_CLS,e=a.FIELD_TEXTAREA_TEXT_CLS,f=a.FIELD_TEXTAREA_TEXT_INPUT_CLS,g=a.FIELD_ERROR_CLS,h=a.CLEARFIX_CLS;a.define(["Fancy.form.field.TextArea","Fancy.TextArea"],{mixins:[a.form.field.Mixin],extend:a.Widget,type:"field.textarea",constructor:function(){this.Super("const",arguments)},init:function(){var a=this;a.addEvents("change","key"),a.Super("init",arguments),a.preRender(),a.render(),a.ons()},fieldCls:b+" "+c,value:"",width:250,height:100,labelWidth:60,inputWidth:180,minHeight:100,maxHeight:210,lineHeight:12.5,emptyText:"",tpl:['<div class="'+d+'" style="{labelWidth}{labelDisplay}">',"{label}","</div>",'<div class="'+e+'">','<textarea autocomplete="off" placeholder="{emptyText}" type="text" class="'+f+'" style="{inputWidth}height:{inputHeight}px;">{value}</textarea>','<div class="'+g+'" style="{errorTextStyle}"></div>',"</div>",'<div class="'+h+'"></div>'],ons:function(){var a=this,b=a.el.getByTag("textarea");a.input=b,b.on("blur",a.onBlur,a),b.on("focus",a.onFocus,a),b.on("input",a.onInput,a),b.on("keydown",a.onKeyDown,a),a.on("key",a.onKey,a),a.autoHeight&&b.on("input",a.onChange,a),b.on("mousedown",function(b){a.disabled&&b.preventDefault()})},preRender:function(){var b=this;b.tpl&&(b.tpl=new a.Template(b.tpl)),b.initHeight(),b.calcSize()},initHeight:function(){var a,b=this;if(b.height)a=b.height,b.maxHeight<b.height&&setTimeout(function(){b.input.css({"overflow-y":"scroll"})},1);else if(b.value){var c=b.value.match(/\n/g);c=c?c.length:1,a=c*b.lineHeight}else a=b.height;a<b.minHeight||a>b.maxHeight&&setTimeout(function(){b.input.css({"overflow-y":"scroll"})},1),b.height=a,b.inputHeight=a},calcSize:function(){var b,c,d,e,f,g=this,h=g.padding;if(a.isString(h))switch(h=h.replace(/px/g,""),h=h.split(" "),h.length){case 1:c=Number(h[0]),h=[c,c,c,c];break;case 2:d=Number(h[0]),e=Number(h[1]),h=[d,e,d,e];break;case 3:d=Number(h[0]),e=Number(h[1]),f=Number(h[2]),h=[d,e,f,d];break;case 4:h=[Number(h[0]),Number(h[1]),Number(h[2]),Number(h[3])]}else a.isNumber(h)?h=[h,h,h,h]:!1===h&&(h=[0,0,0,0]);"top"===g.labelAlign&&(g.inputHeight-=40),b=g.width,"top"!==g.labelAlign&&g.label&&(b-=g.labelWidth),g.height===g.inputHeight&&!1!==g.padding&&(g.inputHeight-=h[0]+h[2]),g.inputWidth=b-h[1]-h[3],g.height=g.inputHeight+h[0]+h[2]},onChange:function(){var a=this,b=a.input.dom.value,c=a.el.getByTag("textarea"),d=b.match(/\n/g).length*a.lineHeight;d<a.minHeight?(d=a.minHeight,c.css({"overflow-y":"hidden"})):d>a.maxHeight?(d=a.maxHeight,c.css({"overflow-y":"scroll"})):c.css({"overflow-y":"hidden"}),a.height=d}})}(),function(){var a=Fancy.CLEARFIX_CLS,b=Fancy.FIELD_CLS,c=Fancy.FIELD_LABEL_CLS,d=Fancy.FIELD_TEXT_CLS,e=Fancy.FIELD_CHECKBOX_CLS,f=Fancy.FIELD_CHECKBOX_INPUT_CLS,g=Fancy.FIELD_INPUT_LABEL_CLS,h=Fancy.FIELD_CHECKBOX_ON_CLS;Fancy.define(["Fancy.form.field.CheckBox","Fancy.CheckBox"],{mixins:[Fancy.form.field.Mixin],extend:Fancy.Widget,type:"field.checkbox",middle:!1,disabled:!1,constructor:function(a){Fancy.applyConfig(this,a),this.Super("const",arguments)},init:function(){var a=this;a.addEvents("focus","blur","input","up","down","beforechange","change","key"),a.Super("init",arguments),a.preRender(),a.render({labelWidth:a.labelWidth,labelDispay:a.labelText?"":"none",label:a.label}),a.expander&&a.addCls("fancy-checkbox-expander"),a.acceptedValue=a.value,a.set(a.value,!1),a.checkMiddle(),a.ons()},labelText:"",labelWidth:60,value:!1,editable:!0,stopIfCTRL:!1,checkedCls:h,fieldCls:b+" "+e,tpl:['<div class="'+c+'" style="{labelWidth}{labelDisplay}">',"{label}","</div>",'<div class="'+d+'">','<div class="'+f+'"></div>',"</div>",'<div class="'+g+'" style="{inputLabelDisplay}">',"{inputLabel}","</div>",'<div class="'+a+'"></div>'],ons:function(){var a=this,b=a.el;b.on("click",a.onClick,a),b.on("mousedown",a.onMouseDown,a)},onClick:function(a){var b=this,c=b.el;if(!(b.disabled||(b.fire("beforechange"),a.ctrlKey&&b.stopIfCTRL||!1===b.editable))){if(!0===b.canceledChange)return void(b.canceledChange=!1);c.toggleCls(b.checkedCls);var d=b.value;b.value=c.hasCls(b.checkedCls),b.fire("change",b.value,d),!0===b.middle&&(b.middle=!1,b.checkMiddle())}},onMouseDown:function(a){a.preventDefault()},set:function(a,b){var c=this,d=c.el;if(""===a&&(a=!1),!0===a||1===a)d.addCls(c.checkedCls),a=!0;else if(!1===a||0===a)d.removeClass(c.checkedCls),a=!1;else{if(void 0!==a)throw new Error("not right value for checkbox "+a);a=!1}c.value=a,!1!==b&&c.fire("change",c.value)},setValue:function(a,b){this.set(a,b)},getValue:function(){return this.value},get:function(){return this.getValue()},clear:function(){this.set(!1)},toggle:function(){this.set(!this.value)},destroy:function(){this.Super("destroy",arguments)},checkMiddle:function(){var a=this;a.middle?a.el.addCls("fancy-checkbox-middle"):a.el.removeCls("fancy-checkbox-middle")},setMiddle:function(a){var b=this;b.middle=a,b.checkMiddle()}})}(),Fancy.define(["Fancy.form.field.Switcher","Fancy.Switcher"],{extend:Fancy.CheckBox,type:"field.switcher",constructor:function(a){Fancy.applyConfig(this,a),this.Super("const",arguments)},init:function(){this.Super("init",arguments)},checkedCls:"fancy-switcher-on",fieldCls:Fancy.FIELD_CLS+" fancy-field-switcher",tpl:['<div class="fancy-field-label" style="{labelWidth}{labelDisplay}">',"{label}","</div>",'<div class="fancy-field-text">',"</div>",'<div class="fancy-field-input-label" style="{inputLabelDisplay}">',"{inputLabel}","</div>",'<div class="fancy-clearfix"></div>']}),function(){var a=Fancy,b=a.FIELD_CLS,c=a.FIELD_COMBO_RESULT_LIST_CLS,d=a.FIELD_COMBO_CLS,e=a.FIELD_COMBO_SELECTED_ITEM_CLS,f=a.FIELD_COMBO_FOCUSED_ITEM_CLS,g=a.FIELD_LABEL_CLS,h=a.FIELD_TEXT_CLS,i=a.CLEARFIX_CLS,j=a.FIELD_ERROR_CLS,k=a.FIELD_TEXT_INPUT_CLS,l=a.FIELD_DISABLED_CLS,m=a.FIELD_COMBO_DROPDOWN_BUTTON_CLS,n=a.FIELD_COMBO_INPUT_CONTAINER_CLS,o=a.FIELD_COMBO_LEFT_EL_CLS,p=a.FIELD_LABEL_ALIGN_TOP_CLS,q=a.FIELD_LABEL_ALIGN_RIGHT_CLS,r=a.FIELD_CHECKBOX_INPUT_CLS,s=a.FIELD_COMBO_LIST_VALUE_CLS;a.define("Fancy.combo.Manager",{singleton:!0,opened:[],add:function(a){this.hideLists(),this.opened.push(a)},hideLists:function(){a.each(this.opened,function(a){a.hideList(),a.hideAheadList()}),this.opened=[]}}),a.define(["Fancy.form.field.Combo","Fancy.Combo"],{type:"field.combo",mixins:[a.form.field.Mixin],extend:a.Widget,selectedItemCls:e,focusedItemCls:f,fieldCls:b+" "+d,width:250,labelWidth:60,listRowHeight:25,dropButtonWidth:27,leftWidth:20,maxListRows:9,emptyText:"",editable:!0,typeAhead:!0,readerRootProperty:"data",valueKey:"value",displayKey:"text",multiSelect:!1,itemCheckBox:!1,listCls:"",tpl:['<div class="'+g+'" style="{labelWidth}{labelDisplay}">',"{label}","</div>",'<div class="'+h+'">','<div class="'+n+'" style="{inputWidth}{inputHeight}">','<div class="'+o+'" style="{inputHeight}cursor:default;">&nbsp;</div>','<input placeholder="{emptyText}" class="'+k+'" style="{inputHeight}cursor:default;" value="{value}">','<div class="'+m+'">&nbsp;</div>',"</div>","</div>",'<div class="'+j+'" style="{errorTextStyle}"></div>','<div class="'+i+'"></div>'],constructor:function(){this.tags=this.tags||[],this.Super("const",arguments)},init:function(){var a=this;a.addEvents("focus","blur","input","up","down","change","key","enter","esc","empty","load"),a.Super("init",arguments),a.subSearch&&(a.editable=!1),a.loadListData()||(a.data=a.configData(a.data)),a.multiSelect&&a.data.length&&a.initMultiSelect(),a.preRender(),a.render(),a.ons(),a.applyStyle(),a.applyTheme(),setTimeout(function(){a.applyTheme()},1)},loadListData:function(){var b=this;if(!a.isObject(b.data))return!1;var c=b.data.proxy,d=b.readerRootProperty;if(!c||!c.url)throw new Error("[FancyGrid Error]: combo data url is not defined");return c.reader&&c.reader.root&&(d=c.reader.root),a.Ajax({url:c.url,params:c.params||{},method:c.method||"GET",getJSON:!0,success:function(a){if(b.data=b.configData(a[d]),b.renderList(),b.onsList(),b.multiSelect)b.initMultiSelect(),b.value&&b.updateInput();else if(b.value){var c=b.getDisplayValue(b.value);c&&(b.input.dom.value=c)}b.fire("load")}}),!0},configData:function(b){if(a.isObject(b)||0===b.length)return b;if(!a.isObject(b[0])){for(var c=[],d=0,e=b.length;d<e;d++)c.push({text:b[d],value:d});return c}return b},applyStyle:function(){var a=this;a.hidden&&a.css("display","none"),a.style&&a.css(a.style)},applyTheme:function(){var a=this;a.theme&&"default"!==a.theme&&(a.addCls("fancy-theme-"+a.theme),a.list.addCls("fancy-theme-"+a.theme),a.aheadList&&a.aheadList.addCls("fancy-theme-"+a.theme))},ons:function(){var a=this,b=a.el.select("."+m);a.input=a.el.getByTag("input"),a.inputContainer=a.el.select("."+n),a.drop=b,a.onsList(),a.input.on("blur",a.onBlur,a),a.input.on("mousedown",a.onInputMouseDown,a),a.input.on("click",a.onInputClick,a),b.on("mousedown",a.onDropMouseDown,a),b.on("click",a.onDropClick,a),a.on("key",a.onKey,a),a.typeAhead&&a.editable&&a.input.on("keydown",a.onKeyDown,a),a.on("esc",a.onEsc,a),a.on("enter",a.onEnter,a),a.on("up",a.onUp,a),a.on("down",a.onDown,a)},onSubSearchKeyDown:function(b){var c=this,d=b.keyCode,e=a.key;switch(d){case e.ESC:c.fire("esc",b);break;case e.ENTER:c.fire("enter",b);break;case e.UP:c.fire("up",b);break;case e.DOWN:c.fire("down",b)}},onKeyDown:function(b){var c=this,d=b.keyCode,e=a.key;switch(d){case e.ESC:c.fire("esc",b);break;case e.ENTER:c.fire("enter",b);break;case e.UP:c.fire("up",b);break;case e.DOWN:c.fire("down",b);break;case e.TAB:break;case e.BACKSPACE:setTimeout(function(){if(0===c.input.dom.value.length)c.value=-1,c.valueIndex=-1,c.hideAheadList(),c.multiSelect&&(c.values=[],c.clearListActive()),c.fire("empty");else{if(c.multiSelect&&c.input.dom.value.split(",").length!==c.valuesIndex.length){var a=c.getFromInput();c.set(a)}if(0===c.generateAheadData().length)return void c.hideAheadList();c.renderAheadList(),c.showAheadList()}},100);break;default:setTimeout(function(){if(0===c.generateAheadData().length)return void c.hideAheadList();c.renderAheadList(),c.showAheadList()},1)}setTimeout(function(){c.fire("key",c.input.dom.value,b)},1)},onInputClick:function(a){var b=this,c=b.list;b.disabled||!0!==b.editable&&("none"===c.css("display")?b.showList():b.hideList())},onDropClick:function(b){var c=this,d=c.list;c.disabled||("none"===d.css("display")?(a.combo.Manager.add(this),c.showList()):c.hideList(),!0===c.editable&&c.input.focus())},showList:function(){var b=this,c=b.list,d=b.input.parent().parent(),e=d.$dom.offset(),f=[e.left,e.top+d.$dom.height()],g=a.get(document),h=b.selectedItemCls,i=b.focusedItemCls;if(b.hideAheadList(),b.list&&0!==b.data.length){c.css({display:"",left:f[0]+"px",top:f[1]+3+"px",opacity:0,width:b.getListWidth(),"z-index":2e3+a.zIndex++}),b.listCls&&c.addCls(b.listCls),c.animate({opacity:1,top:f[1]},a.ANIMATE_DURATION);var j;b.clearFocused();var k=c.select("."+h);0===k.length?b.multiSelect&&b.values.length?b.valuesIndex.each(function(a,b,d){void 0===j&&(j=a),c.select("li").item(a).addCls(h)}):j=0:(b.multiSelect&&k.length!==b.valuesIndex.length&&(c.select("."+h).removeCls(h),b.valuesIndex.each(function(a,b,d){void 0===j&&(j=a),c.select("li").item(a).addCls(h)})),j=k.item(0).index()),-1===j&&(j=0),c.select("li").item(j).addCls(i),b.scrollToListItem(j),b.docSpy||(b.docSpy=!0,g.on("click",b.onDocClick,b)),!1!==b.subSearch&&b.subSearchField&&(b.subSearchField.setInputSize({width:b.getListWidth()-6,height:25}),b.subSearchField.input.focus())}},showAheadList:function(){var b=this,c=b.aheadList,d=b.input.parent().parent(),e=d.$dom.offset(),f=[e.left,e.top+d.$dom.height()],g=a.get(document);b.hideList(),c&&0!==b.data.length&&(c.css({display:"",left:f[0]+"px",top:f[1]+"px",width:b.getListWidth(),"z-index":2e3+a.zIndex++}),b.docSpy2||(b.docSpy2=!0,g.on("click",b.onDocClick,b)))},onDocClick:function(a){var b=this;if(!1===b.input.parent().parent().within(a.target)){if(!0===b.list.within(a.target))return;b.hideList(),b.hideAheadList()}},hideList:function(){var b=this;if(b.list&&(b.list.css("display","none"),b.docSpy)){var c=a.get(document);b.docSpy=!1,c.un("click",b.onDocClick,b)}},hideAheadList:function(){var b=this;if(b.aheadList&&(b.aheadList.css("display","none"),b.docSpy)){var c=a.get(document);b.docSpy=!1,c.un("click",b.onDocClick,b)}},onInputMouseDown:function(a){var b=this;if(b.disabled)return void a.preventDefault();!1===b.editable&&a.preventDefault()},onDropMouseDown:function(a){this.disabled&&a.stopPropagation(),a.preventDefault()},onsList:function(){var a=this;a.list.on("mousedown",a.onListItemMouseDown,a,"li"),a.list.on("click",a.onListItemClick,a,"li"),a.list.on("mouseenter",a.onListItemOver,a,"li"),a.list.on("mouseleave",a.onListItemLeave,a,"li"),a.selectAllText&&a.list.select(".fancy-combo-list-select-all").on("click",a.onSelectAllClick,a)},onsAheadList:function(){var a=this;a.aheadList.on("click",a.onListItemClick,a,"li")},onListItemOver:function(b){if(!this.disabled){var c=a.get(b.target);"li"===c.prop("tagName").toLocaleLowerCase()&&c.addCls(this.focusedItemCls)}},onListItemLeave:function(){this.disabled||this.clearFocused()},onListItemMouseDown:function(){var a=this;a.listItemClicked=!0,setTimeout(function(){delete a.listItemClicked},1e3)},onListItemClick:function(b){var c=this,d=a.get(b.currentTarget),e=d.attr("value"),f=c.selectedItemCls,g=c.focusedItemCls;c.disabled||(a.nojQuery&&0===e&&(e=""),c.multiSelect?(0===c.values.length&&c.clearListActive(),c.clearFocused(),d.toggleCls(f),d.hasCls(f)?(c.addValue(e),d.addCls(g)):(c.removeValue(e),c.clearFocused(),c.selectAllText&&c.list.select(".fancy-combo-list-select-all").removeCls("fancy-combo-item-selected")),c.updateInput()):(c.set(e),c.hideList()),c.editable?c.input.focus():c.onBlur())},set:function(b,c){var d,e=this,f="";if(e.multiSelect&&!a.isArray(b)&&(b=-1===b?[]:[b]),a.isArray(b)&&e.multiSelect){var g=[];e.valuesIndex.removeAll(),a.each(b,function(a,c){var d=e.getIndex(a);-1!==d&&(e.valuesIndex.add(d,b[c]),g.push(e.data[d][e.displayKey]),f=g.join(", "))}),e.values=b,d=e.getIndex(b[0]),e.value=b[0],e.valueIndex=d}else d=e.getIndex(b),-1!==d?(e.valueIndex=d,f=e.data[d][e.displayKey],e.selectItem(d)):-1!==b&&b&&b.length>0?(f="",e.value=-1,e.valueIndex=-1):f="",e.value=b;e.input.dom.value=f,!1!==c&&e.onInput(),e.left&&e.updateLeft(),Fancy.isObject(e.data)||e.validate(f)},addValue:function(a){var b=this,c=b.getIndex(a);-1===c||b.valuesIndex.get(c)||(b.value=a,b.values.push(a),b.valuesIndex.add(c,a))},removeValue:function(b){var c=this,d=-1;a.each(c.values,function(a,c){a===b&&(d=c)}),-1!==d&&(c.values.splice(d,1),c.valuesIndex.remove(c.getIndex(b))),c.values.length?c.value=c.values[c.values.length-1]:(c.value=-1,c.valueIndex=-1)},updateInput:function(a){var b=this,c=[];b.valuesIndex.each(function(a,d,e){c.push(b.data[a][b.displayKey])}),b.input.dom.value=c.join(", "),!1!==a&&b.onInput()},selectItem:function(a){var b=this;if(b.list){b.multiSelect||b.clearListActive(),b.clearFocused();b.list.select("li").item(a).addCls(b.focusedItemCls,b.selectedItemCls)}},render:function(){var b=this,c=a.get(b.renderTo||document.body).dom,d=a.get(document.createElement("div")),e=b.value,f=-1;d.attr("id",b.id),void 0===e?e="":b.multiSelect&&a.isArray(b.data)&&b.data.length>0?(e="",b.valuesIndex.each(function(a,c){-1===f&&(f=a,b.valueIndex=a),e+=b.data[a][b.displayKey]+", "}),e=e.replace(/, $/,"")):(f=b.getIndex(e),-1!==f?(b.valueIndex=f,e=b.data[f][b.displayKey]):e=""),b.fire("beforerender"),d.addCls(a.cls,b.cls,b.fieldCls);var i="";b.labelWidth&&(i="width:"+b.labelWidth+"px;");var j=b.label;""===b.label?j="&nbsp;":void 0===b.label?j="&nbsp;":"right"!==b.labelAlign&&(j+=":"),d.update(b.tpl.getHTML({labelWidth:i,labelDisplay:!1===b.label?"display: none;":"",label:!1===j?"":j,emptyText:b.emptyText,inputHeight:"height:"+b.inputHeight+"px;",value:e})),b.el=d,b.setStyle(),b.input=b.el.getByTag("input"),b.inputContainer=b.el.select("."+n),b.drop=b.el.select("."+m),b.leftTpl&&(b.left=b.el.select("."+o),b.left.css({display:"block",width:b.leftWidth})),b.setSize(),c.appendChild(d.dom),"top"===b.labelAlign?b.el.addCls(p):"right"===b.labelAlign&&(b.el.addCls(q),a.$(d.dom).find("."+g).insertAfter(a.$(d.dom).find("."+h))),b.valueIndex&&(b.acceptedValue=b.value),b.editable?b.input.css("cursor","auto"):b.input&&b.input.attr("tabIndex",-1),b.disabled&&(b.addCls(l),b.input&&b.input.attr("tabIndex",-1)),b.renderList(),b.leftTpl&&(setTimeout(function(){b.updateLeft()},1),setTimeout(function(){b.updateLeft()},500),setTimeout(function(){b.updateLeft()},1e3)),b.fire("afterrender"),b.fire("render")},renderList:function(){var b=this,d=a.get(document.createElement("div")),e=[];b.selectAllText&&e.push('<div class="fancy-combo-list-select-all"><div class="fancy-field-checkbox-input" style=""></div><span class="fancy-combo-list-select-all-text">'+b.selectAllText+"</span></div>"),!1===b.editable&&!1!==b.subSearch&&"checkbox"!==b.type&&e.push('<div class="fancy-combo-list-sub-search-container"></div>'),b.list&&b.list.destroy(),e.push(['<ul style="position: relative;">']),a.each(b.data,function(c,d){var f="",g=c[b.displayKey],h=c[b.valueKey];if(b.value===h&&(f=b.selectedItemCls),""===g||" "===g)g="&nbsp;";else if(b.listItemTpl){var i=new a.Template(b.listItemTpl);g=i.getHTML(c)}b.multiSelect&&b.itemCheckBox?e.push('<li value="'+h+'" class="'+f+'"><div class="'+r+'" style=""></div><span class="'+s+'">'+g+"</span></li>"):e.push('<li value="'+h+'" class="'+f+'"><span class="'+s+'">'+g+"</span></li>")}),e.push("</ul>"),d.addCls(a.cls,c),d.update(e.join("")),d.css({display:"none",left:"0px",top:"0px",width:b.getListWidth()}),b.data.length>b.maxListRows&&d.select("ul").item(0).css({height:b.listRowHeight*b.maxListRows+"px",overflow:"auto"}),document.body.appendChild(d.dom),b.list=d,!1===b.editable&&"checkbox"!==b.type&&!1!==b.subSearch&&(b.subSearchField=new a.StringField({renderTo:b.list.select(".fancy-combo-list-sub-search-container").item(0).dom,label:!1,style:{padding:"2px 2px 0px 2px"},events:[{change:b.onSubSearchChange,scope:b}]}),b.subSearchField.setInputSize({width:b.getListWidth()-6,height:25}),b.subSearchField.input.on("keydown",b.onSubSearchKeyDown,b)),b.applyTheme()},getListWidth:function(){var a,b=this,c=b.inputWidth+14,d=b.minListWidth;return b.input&&(a=b.input.parent().parent(),c=a.width()),d&&d>c&&(c=d),c},generateAheadData:function(){var b=this,c=b.input.dom.value.toLocaleLowerCase(),d=[];if(b.multiSelect){var e=c.split(", "),f=b.getInputSelection(),g=0;a.each(c,function(a,b){if(f.start<=b)return!0;","===c[b]&&g++}),c=e[g]}return a.each(b.data,function(a){new RegExp("^"+c).test(a[b.displayKey].toLocaleLowerCase())&&d.push(a)}),b.data.length===d.length&&(d=[]),b.aheadData=d,d},renderAheadList:function(){var b,c=this,d=['<ul style="position: relative;">'],e=!1;c.aheadList?(c.aheadList.firstChild().destroy(),b=c.aheadList,e=!0):b=a.get(document.createElement("div")),a.each(c.aheadData,function(b,e){var f="",g=b[c.displayKey],h=b[c.valueKey];if(0===e&&(f=c.selectedItemCls),""===g||" "===g)g="&nbsp;";else if(c.listItemTpl){var i=new a.Template(c.listItemTpl);g=i.getHTML(b)}d.push('<li value="'+h+'" class="'+f+'"><span class="'+s+'">'+g+"</span></li>")}),d.push("</ul>"),b.update(d.join("")),b.css({display:"none",left:"0px",top:"0px",width:c.getListWidth()}),b.css({"max-height":c.listRowHeight*c.maxListRows+"px",overflow:"auto"}),!1===e&&(b.addClass(a.cls,"fancy-combo-result-list"),document.body.appendChild(b.dom),c.aheadList=b,c.onsAheadList()),c.applyTheme()},hide:function(){var a=this;a.css("display","none"),a.hideList(),a.hideAheadList()},clear:function(){var a=this;a.multiSelect?a.set([],!1):a.set(-1,!1)},clearListActive:function(){var a=this,b=a.selectedItemCls,c=a.focusedItemCls;a.list.select("."+c).removeCls(c),a.list.select("."+b).removeCls(b)},clearFocused:function(){var a=this,b=a.focusedItemCls;a.list&&a.list.select("."+b).removeCls(b),a.aheadList&&a.aheadList.select("."+b).removeCls(b)},onInput:function(){var a=this,b=a.getValue(),c=a.acceptedValue;a.acceptedValue=a.get(),a.fire("change",b,c),a.left&&a.updateLeft()},setValue:function(a,b){this.set(a,b)},getDisplayValue:function(a,b){var c=this,d=c.getIndex(a);return b?d:c.data[d]?c.data[d][c.displayKey]:""},getValueKey:function(a,b){for(var c=this,d=0,e=c.data.length;d<e;d++)if(c.data[d][c.displayKey]===a)return b?d:c.data[d][c.valueKey]},get:function(){return this.getValue()},getValue:function(){var a=this;return a.multiSelect?a.values:-1===a.value||void 0===a.value?-1===a.value&&a.input.dom.value?a.input.dom.value:"":(a.valueKey,a.value)},size:function(a){var b=this,c=a.width,d=a.height,e=b.input,f=b.inputContainer,g=b.drop;"top"!==b.labelAlign&&(b.inputHeight=d),void 0!==d&&(b.height=d),void 0!==c&&(b.width=c),b.calcSize(),"top"===b.labelAlign?b.css({height:1.5*b.height,width:b.width}):b.css({height:b.height,width:b.width});var h=b.inputWidth,i=2;"dark"===b.theme&&(i=0);var j=h-i;b.left&&(j-=b.leftWidth),e.css({width:j,height:b.inputHeight,"margin-left":b.left?b.leftWidth:0}),f.css({width:h,height:b.inputHeight}),g.css("height",b.inputHeight)},onEnter:function(a,b){var c,d=this,e=d.getActiveList(),f=d.focusedItemCls,g=d.selectedItemCls;if(d.multiSelect){if(!e)return;var h=e.select("."+f);if(h&&h.dom||(h=e.select("."+g).last()),h&&h.dom){c=h.attr("value"),d.addValue(c);var i=d.getDisplayValue(c,!0);d.selectItem(i),d.updateInput()}}else if(e){var h=e.select("."+f);h&&h.dom||(h=e.select("."+g)),c=h.attr("value"),d.set(c)}else d.set(d.input.dom.value);d.hideList(),d.hideAheadList()},onEsc:function(a,b){var c=this;c.hideList(),c.hideAheadList()},onUp:function(a,b){var c=this,d=c.getActiveList(),e=c.focusedItemCls,f=c.selectedItemCls;if(d){d=c.getActiveList().select("ul"),b.preventDefault();var g=d.select("."+e),h=!1;g.dom||(g=d.select("."+f)),g.dom||(h=!0,g=d.lastChild()),g.length>1&&(g=g.item(0));var i=g.index(),j=d.select("li"),k=parseInt(d.css("height"));0===i||h?i=j.length-1:i--;var l=j.item(i),m=l.dom.offsetTop;m-d.dom.scrollTop>k?d.dom.scrollTop=1e4:m-d.dom.scrollTop<0&&(d.dom.scrollTop=m),c.clearFocused(),l.addClass(e)}},onDown:function(a,b){var c=this,d=c.getActiveList(),e=c.focusedItemCls,f=c.selectedItemCls;if(d){d=c.getActiveList().select("ul"),b.preventDefault();var g=d.select("."+e),h=!1;g.dom||(g=d.select("."+f)),g.dom||(h=!0,g=d.firstChild()),g.length>1&&(g=g.item(0));var i=parseInt(g.css("height")),j=g.index(),k=d.select("li"),l=parseInt(d.css("height"));j===k.length-1||h?j=0:j++;var m=k.item(j),n=m.dom.offsetTop,o=parseInt(m.css("height"));n-d.dom.scrollTop<0?d.dom.scrollTop=0:n+o+3-d.dom.scrollTop>l&&(d.dom.scrollTop=n-l+i+o),c.clearFocused(),m.addClass(e)}else c.showList()},scrollToListItem:function(a){var b=this,c=b.getActiveList().select("ul"),d=c.select("li"),e=d.item(a),f=e.dom.offsetTop;parseInt(c.css("height"));0===a?c.dom.scrollTop=0:a===d.length-1?c.dom.scrollTop=1e4:c.dom.scrollTop=f},getActiveList:function(){var a=this,b=!1;return a.list&&"none"!==a.list.css("display")?b=a.list:a.aheadList&&"none"!==a.aheadList.css("display")&&(b=a.aheadList),b},initMultiSelect:function(){var b=this,c=b.value;b.values=[],b.valuesIndex=new a.Collection,void 0!==b.value&&null!==c&&""!==c&&(a.isArray(c)?(b.values=c,b.value=c[0]):b.values=[b.value],a.each(b.values,function(a){b.valuesIndex.add(b.getIndex(a),a)}))},getIndex:function(a){for(var b=this,c=b.data,d=0,e=c.length,f=-1;d<e;d++)if(c[d][b.valueKey]==a)return d;return f},getFromInput:function(){var b=this,c=b.input.dom.value,d=c.split(","),e=[];return a.each(d,function(a){var c=a.replace(/ $/,"").replace(/^ /,""),d=b.getValueKey(c);d&&e.push(d)}),e},updateLeft:function(){var b=this,c=b.data[b.getIndex(b.getValue())];b.left.update(new a.Template(b.leftTpl).getHTML(c))},setData:function(a){var b=this;b.data=a,b.renderList(),b.onsList()},onSelectAllClick:function(a){var b=this,c=b.list.select("li"),d=b.list.select(".fancy-combo-list-select-all").item(0),e=d.hasClass("fancy-combo-item-selected");setTimeout(function(){e?d.removeCls("fancy-combo-item-selected"):d.addCls("fancy-combo-item-selected")},100),c.each(function(a,b){e?a.hasClass("fancy-combo-item-selected")&&a.dom.click():a.hasClass("fancy-combo-item-selected")||a.dom.click()})},onSubSearchChange:function(b,c){var d=this,e=d.list.select("li"),f=0,g=d.listRowHeight*d.maxListRows;c=c.toLocaleLowerCase(),a.each(d.data,function(a,b){new RegExp("^"+c).test(a[d.displayKey].toLocaleLowerCase())?(e.item(b).css("display","block"),f+=parseInt(e.item(b).css("height"))):e.item(b).css("display","none")});var h=d.list.select("ul").item(0);f>g?h.css("height",g):h.css("height",f)}})}(),function(){var a=Fancy,b=a.CLEARFIX_CLS,c=a.FIELD_CLS,d=a.FIELD_LABEL_CLS,e=a.FIELD_TEXT_CLS,f=a.FIELD_BUTTON_CLS;a.define(["Fancy.form.field.Button","Fancy.ButtonField"],{mixins:[a.form.field.Mixin],extend:a.Widget,type:"field.button",pressed:!1,constructor:function(b){a.apply(this,b),this.Super("const",arguments)},init:function(){var a=this;a.addEvents("click"),a.Super("init",arguments),a.preRender(),a.render(),a.renderButton(),a.ons(),a.hidden&&a.css("display","none"),a.style&&a.css(a.style)},fieldCls:c+" "+f,value:"",width:100,emptyText:"",tpl:['<div class="'+d+'" style="{labelWidth}{labelDisplay}">',"{label}","</div>",'<div class="'+e+'">',"</div>",'<div class="'+b+'"></div>'],renderButton:function(){var b=this;b.button=new a.Button({renderTo:b.el.select("."+e).item(0).dom,text:b.buttonText,disabled:b.disabled,pressed:b.pressed,enableToggle:b.enableToggle,imageCls:b.imageCls,handler:function(){b.disabled||(b.scope?b.handler.apply(b.scope,[b]):b.handler(b))}})},ons:function(){var a=this;a.button.on("pressedchange",function(b,c){a.fire("pressedchange",c)})},onClick:function(){var a=this;a.disabled||(a.fire("click"),a.handler&&a.handler())},setPressed:function(a){this.button.setPressed(a)}})}(),Fancy.define(["Fancy.form.field.SegButton","Fancy.SegButtonField"],{mixins:[Fancy.form.field.Mixin],extend:Fancy.Widget,type:"field.button",allowToggle:!0,constructor:function(a){Fancy.apply(this,a),this.Super("const",arguments)},init:function(){var a=this;a.addEvents("click","change"),a.Super("init",arguments),a.preRender(),a.render(),a.renderButton(),a.ons(),a.hidden&&a.css("display","none"),a.style&&a.css(a.style)},fieldCls:"fancy fancy-field fancy-field-button",value:"",width:100,emptyText:"",tpl:['<div class="fancy-field-label" style="{labelWidth}{labelDisplay}">',"{label}","</div>",'<div class="fancy-field-text">',"</div>",'<div class="fancy-clearfix"></div>'],renderButton:function(){var a=this;a.button=new Fancy.SegButton({renderTo:a.el.select(".fancy-field-text").item(0).dom,items:a.items,disabled:a.disabled,multiToggle:a.multiToggle,allowToggle:a.allowToggle})},ons:function(){var a=this;a.button.on("toggle",function(){a.disabled||a.fire("toggle")})},onClick:function(){var a=this;a.disabled||(a.fire("click"),a.handler&&a.handler())},get:function(){var a=this,b=[];return Fancy.each(a.items,function(a,c){a.pressed&&(a.value?b.push(a.value):b.push(c))}),b.toString()},clear:function(a){this.allowToggle&&Fancy.each(this.items,function(b){b.setPressed(!1,a)})}}),Fancy.define(["Fancy.form.field.Line","Fancy.FieldLine"],{mixins:[Fancy.form.field.Mixin],extend:Fancy.Widget,type:"field.line",constructor:function(a){Fancy.apply(this,a),this.Super("const",arguments)},init:function(){var a=this;a.Super("init",arguments);var b,c=0,d=a.items.length,e=Fancy.id(null,"fancy-line-");if(a.parentSet)var f=a.width/a.items.length;for(;c<d;c++){var g=a.items[c];void 0===g.width&&(g.width=f),g.style=g.style||{},g.lineName=e,"top"===g.labelAlign?(b=!0,a.parentSet&&(g.style.padding="0px"),g.label&&(g.labelWidth=g.width-16,100===g.labelWidth&&(g.labelWidth=7*(g.label.length+1+1)),g.width<g.labelWidth&&(g.labelWidth=7*(g.label.length+1+1)))):(g.style["padding-top"]="0px",!g.labelWidth&&g.label&&(g.labelWidth=7*(g.label.length+1+1))),0===c&&(g.style["padding-left"]="0px")}a.preRender(),a.render(),b&&a.css("height","48px")},fieldCls:"fancy fancy-field fancy-field-line",value:"",width:100,emptyText:"",tpl:['<div class="fancy-field-text fancy-field-line-items">',"</div>"]}),Fancy.define(["Fancy.form.field.Set","Fancy.SetField"],{mixins:[Fancy.form.field.Mixin],extend:Fancy.Widget,type:"field.set",padding:"8px 11px 0px 8px",constructor:function(a){Fancy.apply(this,a),this.Super("const",arguments)},init:function(){var a=this;a.addEvents("beforecollapse","collapse","expanded","expand","beforeexpand","beforeexpanded"),a.Super("init",arguments),Fancy.each(a.items,function(a,b){"top"===a.labelAlign&&0===b&&(a.style={"padding-left":"0px"}),"line"===a.type&&(a.padding=!1,a.parentSet=!0)}),a.preRender(),a.render(),void 0!==a.checkbox&&a.initCheckBox(),a.on("beforecollapse",a.onBeforeCollapsed,a),a.on("expanded",a.onExpanded,a)},fieldCls:"fancy-field-set",value:"",width:100,emptyText:"",tpl:["<fieldset>","<legend>",'<div class="fancy-field-checkbox-input" style="float:left;margin-top: 4px;display: none;"></div>','<div class="fancy-field-set-label" style="float:left;">{label}</div>','<div class="fancy-clearfix"></div>',"</legend>",'<div class="fancy-field-text fancy-field-set-items">',"</div>","</fieldset>"],initCheckBox:function(){var a=this,b=a.el.select(".fancy-field-checkbox-input");b.css("display",""),!0===a.checkbox&&a.addCls("fancy-checkbox-on");var c=a.el.select(".fancy-field-set-items");setTimeout(function(){!0===a.checkbox||a.fire("collapse")},1),!0===a.checkbox?(c.css("display",""),a.removeCls("fancy-set-collapsed")):(c.css("display","none"),a.addCls("fancy-set-collapsed")),b.on("click",function(){a.toggleCls("fancy-checkbox-on");var b=a.el.hasCls("fancy-checkbox-on"),c=a.el.select(".fancy-field-set-items");b?(a.fire("beforeexpanded"),a.fire("beforeexpand"),c.css("display",""),a.removeCls("fancy-set-collapsed"),a.fire("expanded"),a.fire("expand")):(a.fire("beforecollapse"),c.css("display","none"),a.addCls("fancy-set-collapsed"),a.fire("collapse"))})},onBeforeCollapsed:function(){var a=this,b=a.form,c=a.el.select(".fancy-field-set-items"),d=parseInt(c.css("height"));b.setHeight(b.getHeight()-d)},onExpanded:function(){var a=this,b=a.form,c=a.el.select(".fancy-field-set-items"),d=parseInt(c.css("height"));b.setHeight(b.getHeight()+d)}}),Fancy.define(["Fancy.form.field.Tab","Fancy.Tab"],{mixins:[Fancy.form.field.Mixin],extend:Fancy.Widget,type:"field.tab",constructor:function(a){Fancy.apply(this,a),this.Super("const",arguments)},init:function(){var a=this;a.addEvents("collapsed","expanded"),a.Super("init",arguments);for(var b=0,c=a.items.length;b<c;b++){var d=a.items[b];"top"===d.labelAlign&&0===b&&(d.style={"padding-left":"0px"})}a.preRender(),a.render()},fieldCls:"fancy fancy-field-tab",value:"",width:100,emptyText:"",tpl:['<div class="fancy-field-tab-items">',"</div>"]}),Fancy.define(["Fancy.form.field.HTML","Fancy.HTMLField"],{mixins:[Fancy.form.field.Mixin],extend:Fancy.Widget,type:"field.html",constructor:function(a){Fancy.apply(this,a),this.Super("const",arguments)},init:function(){var a=this;a.addEvents("focus","blur","input","enter","up","down","change","key"),a.Super("init",arguments),a.preRender(),a.render(),a.hidden&&a.css("display","none"),a.style&&a.css(a.style)},fieldCls:"fancy-field-html",value:"",width:100,emptyText:"",tpl:['<div class="" style="">',"{value}","</div>"],render:function(){var a=this,b=a.renderTo||document.body,c=document.createElement("div");a.fire("beforerender"),c.innerHTML=a.tpl.getHTML({value:a.value,height:a.height}),a.el=b.appendChild(c),a.el=Fancy.get(a.el),a.el.addCls(a.cls,Fancy.cls,a.fieldCls),a.acceptedValue=a.value,a.fire("afterrender"),a.fire("render")},set:function(a,b){var c=this;c.el.firstChild().update(a),!1!==b&&c.onInput()},get:function(){return this.el.firstChild().dom.innerHTML}}),Fancy.define(["Fancy.form.field.ReCaptcha","Fancy.ReCaptcha"],{type:"field.recaptcha",mixins:[Fancy.form.field.Mixin],extend:Fancy.Widget,constructor:function(a){Fancy.apply(this,a),this.Super("const",arguments)},init:function(){var a=this;a.addEvents("focus","blur","input","enter","up","down","change","key"),a.Super("init",arguments),a.tpl=new Fancy.Template(a.tpl),a.render(),a.name="recaptcha",a.hidden&&a.css("display","none"),a.style&&a.css(a.style);var b=document.createElement("script");b.type="text/javascript",b.src="https://www.google.com/recaptcha/api.js",Fancy.get(document.head).append(b)},get:function(){var a=this,b=a.el.select("form");return a.value?a.value:(a.value="wait",b.one("submit",function(b){b.preventDefault(),a.value=Fancy.$(this).serialize().replace("g-recaptcha-response=","")}),b.submit(),a.value)},fieldCls:Fancy.FIELD_CLS,value:"",width:100,tpl:['<form method="POST">','<div class="g-recaptcha" data-sitekey="{key}"></div>',"</form>"]}),function(){var a=Fancy,b=a.CLEARFIX_CLS,c=a.FIELD_CLS,d=a.FIELD_RADIO_CLS,e=a.FIELD_RADIO_COLUMN_CLS,f=a.FIELD_TEXT_CLS,g=a.FIELD_RADIO_ON_CLS,h=a.FIELD_RADIO_INPUT_CLS,i=a.FIELD_LABEL_CLS,j=a.FIELD_ERROR_CLS;a.define(["Fancy.form.field.Radio","Fancy.Radio"],{mixins:[a.form.field.Mixin],extend:a.Widget,type:"field.radio",radioRows:1,constructor:function(){this.Super("const",arguments)},init:function(){var b=this;b.addEvents("focus","blur","input","up","down","change","key"),b.Super("init",arguments);var c="";b.column&&(b.cls+=" "+e,c+='<div style="margin-left: '+b.labelWidth+'px;">'),a.each(b.items,function(a,d){var e="",i=f;b.column||0===d||(e="margin-left:10px;"),a.value===b.value&&(i+=" "+g),c+=['<div class="'+i+'" value='+a.value+">",'<div class="'+h+'" style="float:left;'+e+'"></div>','<div style="float:left;margin:7px 0 0 0;">'+a.text+"</div>","</div>"].join("")}),b.column&&(c+="</div>"),b.itemsHTML=c,b.preRender(),b.render(),b.setColumnsStyle(),b.acceptedValue=b.value,b.set(b.value),b.ons()},labelText:"",labelWidth:60,value:!1,checkedCls:g,fieldCls:c+" "+d,tpl:['<div class="'+i+'" style="{labelWidth}{labelDisplay}">',"{label}",'<div class="'+j+'" style="{errorTextStyle}"></div>',"</div>","{itemsHTML}",'<div class="'+b+'"></div>'],ons:function(){var b=this,c=this.el;c.$dom.delegate("."+f,"click",function(){b.disabled||b.set(a.get(this).attr("value"))}),c.on("mousedown",b.onMouseDown,b)},onClick:function(){var a=this,b=a.checkedCls;a.disabled||(a.addCls(b),a.toggleCls(b),a.value=a.hasCls(b),a.fire("change",a.value))},onMouseDown:function(a){this.disabled&&a.stopPropagation(),a.preventDefault()},set:function(a,b){var c=this,d=c.el,e=c.checkedCls;d.select("."+f).removeCls(e),d.select("[value="+a+"]").addCls(e),c.value=a,!1!==b&&c.fire("change",c.value)},setValue:function(a,b){this.set(a,b)},getValue:function(){return this.value},get:function(){return this.getValue()},clear:function(){this.set(!1)},calcColumns:function(){var b=this,c=0,d=b.width;"top"!==b.labelAlign&&b.label&&(d-=b.labelWidth,d-=20),a.Array.each(b.items,function(a){a.text.length>c&&(c=a.text.length)});var e=Math.floor(d/(7*c+30));b.columns&&b.columns<=e?e=b.columns:b.columns=e,b.columnWidth=Math.ceil(d/e),b.rows=Math.ceil(b.items.length/e)},setColumnsStyle:function(){var a=this;if(a.columns&&1!==a.rows){var b=a.el.select("."+f),c=a.el.select("."+f+" ."+h);b.each(function(b,d){d%a.columns==0&&c.item(d).css("margin-left","0px"),b.css("width",a.columnWidth)})}}})}(),function(){Fancy.vtypes={},Fancy.addValid=function(a,b){Fancy.vtypes[a]=b},Fancy.isValid=function(a,b){var c;if(Fancy.isString(a)?c=Fancy.vtypes[a]:Fancy.isObject(a)&&(a.type?(c=Fancy.vtypes[a.type],Fancy.applyIf(a,c)):c=a),c.before){var d=c.before,e=[a];Fancy.isString(d)?e.push(d):Fancy.isArray(d)&&(e=e.concat(d)),e.reverse();for(var f=0,g=e.length;f<g;f++)if(c=Fancy.isObject(e[f])?e[f]:Fancy.vtypes[e[f]],c.re){if(!1===c.re.test(b))return c}else if(c.fn&&!1===c.fn.apply(c,[b]))return c}else if(c.re){if(!1===c.re.test(b))return c}else if(!1===c.fn.apply(c,[b]))return c;return!0}}(),Fancy.addValid("notempty",{text:"Must be present",fn:function(a){return null!==a&&void 0!==a&&0!==String(a).length}}),Fancy.addValid("notnan",{text:"Must be numeric",fn:function(a){return!isNaN(a)}}),Fancy.addValid("min",{before:["notempty","notnan"],text:"Must be must be at least {param}",fn:function(a){return a>=this.param}}),Fancy.addValid("max",{before:["notempty","notnan"],text:"Must be no more than {param}",fn:function(a){return a<=this.param}}),Fancy.addValid("range",{before:["notempty","notnan"],text:"Must be between {min} and {max}",fn:function(a){return a>=this.min&&a<=this.max}}),Fancy.addValid("email",{before:"notempty",re:/^(")?(?:[^\."])(?:(?:[\.])?(?:[\w\-!#$%&'*+\/=?\^_`{|}~]))*\1@(\w[\-\w]*\.){1,5}([A-Za-z]){2,6}$/,text:"Is not a valid email address"}),Fancy.modules.grid=!0,Fancy.Mixin("Fancy.grid.mixin.PrepareConfig",{prepareConfig:function(a,b){var c=this;return a._plugins=a._plugins||[],a.renderOuter&&(a.renderTo=a.renderOuter),a=c.generateColumnsFromData(a,b),a=c.copyColumns(a,b),a=c.prepareConfigScroll(a,b),a=c.prepareConfigData(a,b),a=c.prepareConfigTheme(a,b),a=c.prepareConfigLang(a,b),a=c.prepareConfigSpark(a,b),a=c.prepareConfigPaging(a,b),a=c.prepareConfigInfinite(a,b),a=c.prepareConfigBars(a),a=c.prepareConfigTBar(a),a=c.prepareConfigSubTBar(a),a=c.prepareConfigExpander(a),a=c.prepareConfigColumnMinMaxWidth(a),a=c.prepareConfigGrouping(a),a=c.prepareConfigGroupHeader(a),a=c.prepareConfigSorting(a),a=c.prepareConfigEdit(a),a=c.prepareConfigSelection(a),a=c.prepareConfigLoadMask(a,b),a=c.prepareConfigDefaults(a),a=c.prepareConfigFilter(a,b),a=c.prepareConfigSearch(a),a=c.prepareConfigSummary(a),a=c.prepareConfigState(a,b),a=c.prepareConfigExporter(a),a=c.prepareConfigSmartIndex(a),a=c.prepareConfigActionColumn(a),a=c.prepareConfigWidgetColumn(a),a=c.prepareConfigChart(a,b),a=c.prepareConfigCellTip(a),a=c.prepareConfigHeaderCellTip(a),a=c.prepareConfigColumnsWidth(a),a=c.prepareConfigSize(a,b),a=c.prepareConfigContextMenu(a,b),a=c.prepareConfigColumns(a),a=c.prepareConfigColumnsResizer(a),a=c.prepareConfigFooter(a),a=c.prepareConfigDD(a)},copyColumns:function(a,b){return a.columns&&(a.columns=Fancy.Array.copy(a.columns,!0)),b.columns&&(b.columns=Fancy.Array.copy(b.columns)),a},generateColumnsFromData:function(a,b){if(!a.columns&&a.data&&a.data.length&&Fancy.isArray(a.data[0])){var c=a.data[0]||a.data[0],d=[],e=[];Fancy.each(c,function(a,b){d.push({index:"autoIndex"+b}),e.push("autoIndex"+b)}),a.columns=d,a.data={items:a.data,fields:e},b.data=a.data}return a},prepareConfigScroll:function(a,b){return Fancy.isIE&&!1!==b.nativeScroller&&(a.nativeScroller=!0),a},prepareConfigSpark:function(a,b){var c=this;return Fancy.each(a.columns,function(b){var d=b.sparkConfig;if(d&&d.legend)switch(d.legend.type){case"tbar":case"bbar":case"buttons":var e=d.legend.type,f=b.index;a[e]=a[e]||[],a[e]=a[e].concat(c._generateLegendBar(d.title,f,d.legend.style,b))}}),a},_generateLegendBar:function(a,b,c,d){for(var e=0,f=a.length,g=[],h=this,i={length:0},j=function(b){var c,d=h;Fancy.each(h.columns,function(a,b){a.index===h.columns[b].index&&(c=b)}),(b.hasCls("fancy-legend-item-disabled")||a.length-1!==i.length)&&(b.toggleCls("fancy-legend-item-disabled"),b.hasCls("fancy-legend-item-disabled")?(i[b.index]=!0,d.disableLegend(c,b.index),i.length++):(d.enableLegend(c,b.index),delete i[b.index],i.length--))};e<f;e++){var k=b[e];Fancy.isString(d.index)&&(k=d.index+"."+e);var l={handler:j,index:k,imageColor:Fancy.COLORS[e],text:a[e]};0===e&&c&&(l.style=c),g.push(l)}return g},prepareConfigData:function(a,b){if(a.data||(a.data=[]),Fancy.isArray(a.data)&&0===a.data.length&&a.columns){var c=[],d={};Fancy.each(a.columns,function(a){if(a.index)if(/\./.test(a.index)){var b=a.index.split(".");d[b[0]]||(c.push(b[0]),d[b[0]]=!0)}else c.push(a.index||a.key);a.columns&&Fancy.each(a.columns,function(a){a.index&&c.push(a.index||a.key)})}),a.data={fields:c,items:[]}}return a},prepareConfigLoadMask:function(a){return a._plugins.push({type:"grid.loadmask"}),a},reConfigStore:function(a){var b=this,c=b.store,d=b.getFieldsFromData(a),e="Fancy.model."+Fancy.id();Fancy.define(e,{extend:Fancy.Model,fields:d}),b.model=e,c.model=e,b.fields=d,c.fields=d,c.setModel()},prepareConfigDefaults:function(a){return a.defaults=a.defaults||{},void 0===a.defaults.type&&(a.defaults.type="string"),Fancy.each(a.defaults,function(b,c){Fancy.each(a.columns,function(b){switch(b.type){case"select":case"order":case"expand":case"rowdrag":return}void 0===b[c]&&(b[c]=a.defaults[c]),"width"===c&&b.flex&&delete b.width})}),a},prepareConfigColumnMinMaxWidth:function(a){return Fancy.each(a.columns,function(a){void 0===a.width&&!a.flex&&a.minWidth&&(a.width=a.minWidth)}),a},prepareConfigCellTip:function(a){return Fancy.each(a.columns,function(b){if(b.cellTip)return a._plugins.push({type:"grid.celltip"}),!0}),a},prepareConfigHeaderCellTip:function(a){return Fancy.each(a.columns,function(b){if(b.headerCellTip)return a._plugins.push({type:"grid.headercelltip"}),!0}),a},prepareConfigDD:function(a){if(a.gridToGrid){var b={type:"grid.dragdrop"};Fancy.apply(b,a.gridToGrid),a._plugins.push(b)}if(a.rowDragDrop){var b={type:"grid.rowdragdrop"};Fancy.apply(b,a.rowDragDrop),a._plugins.push(b)}return a},prepareConfigColumns:function(a){for(var b=a.columns,c=[],d=[],e=0,f=b.length,g=!1,h=!1,i=!1,j=0,k=0,l=0;e<f;e++){var m=b[e];switch(m.draggable&&(g=!0),"tree"===m.type&&(h=!0),"rowdrag"!==m.type&&!m.rowdrag||a.rowDragDrop||(a.rowDragDrop=!0),m.headerCheckBox&&(m.sortable=!1),m.autoHeight&&(i=!0),m.select&&(this.checkboxRowSelection=!0,this.multiSelect=!0,j++),m.type){case"select":this.checkboxRowSelection=!0,this.multiSelect=!0,b[e].index="$selected",b[e].editable=!0,j++;break;case"order":b[e].editable=!1,b[e].sortable=!1,b[e].index="$order",b[e].cellAlign="right",k++;break;case"rowdrag":b[e].editable=!1,b[e].sortable=!1,b[e].resizable=!1,b[e].width=30,b[e].index="$rowdrag",l++;break;case"checkbox":void 0===m.cellAlign&&(m.cellAlign="center");break;case"currency":void 0===m.format&&(m.format="number");break;case"string":case"number":case"text":case"date":case"combo":case"tree":!1!==m.ellipsis&&(m.ellipsis=!0)}m.locked?(c.push(m),b.splice(e,1),e--,f--):m.rightLocked&&(d.push(m),b.splice(e,1),e--,f--)}if(i&&a._plugins.push({type:"grid.rowheight"}),g&&a._plugins.push({type:"grid.columndrag"}),h){var n={type:"grid.tree"};a.singleExpand&&(n.singleExpand=a.singleExpand),a._plugins.push(n),a.isTreeData=!0}return a.leftColumns=c,a.rightColumns=d,a},prepareConfigColumnsWidth:function(a){var b,c=a.columns,d=a.width,e=[],f=[],g=100,h=50,i=g,j=0,k=!1,l=!1,m=!1,n=Fancy.get(a.renderTo||document.body);if((a.width<1||void 0===a.width)&&"body"!==n.prop("tagName").toLocaleLowerCase()&&(m=n.closest(".tab-pane"))&&m.css({display:"block",visibility:"hidden"}),void 0!==d&&"fit"!==d||(d=Fancy.get(a.renderTo||document.body).width()),d-=2*a.panelBorderWidth,!1!==a.flexScrollSensitive)d-=a.bottomScrollHeight;else{var o=this.theme;Fancy.isString(a.theme)?o=a.theme:Fancy.isObject(a.theme)&&a.theme.name&&(o=a.theme.name),"bootstrap-no-borders"!==o&&(d-=1)}Fancy.each(c,function(b,c){switch(b.flex&&(a.hasFlexColumns=!0),b.type){case"select":void 0===b.width&&(b.width=35);break;case"order":void 0===b.width&&(b.width=40);break;case"rowdrag":void 0===b.width&&(b.width=30);break;case"expand":void 0===b.width&&(b.width=38)}if(b.locked&&(k=!0),b.rightLocked&&(l=!0),b.hidden)return void(void 0===b.width&&(b.width=100));void 0===b.width?(b.flex&&(j+=b.flex,f.push(c)),e.push(c)):Fancy.isNumber(b.width)&&(d-=b.width)}),a.hasFlexColumns&&a._plugins.push({type:"grid.columnresizer"}),k&&l&&(d-=2);var p=parseInt(d/e.length);p<h&&(p=h),p>g&&(i=g),p<h&&(i=h);var q=!1,r=d;if(Fancy.each(e,function(a){b=c[a],void 0===b.flex&&(r-=i)}),j){var s=parseInt(r/j);Fancy.each(f,function(a){r-=s*c[a].flex})}return r<0&&(q=!0),Fancy.each(e,function(a){b=c[a],void 0===b.flex&&(b.width=i,d-=i)}),j&&(Fancy.each(f,function(a){b=c[a],b.width=q?i*b.flex:d/j*b.flex,b.width=parseInt(b.width),b.minWidth&&b.width<b.minWidth&&(b.width=b.minWidth)}),r>=1&&Fancy.each(f,function(a){if(r<1)return!0;b=c[a],b.width+=1,r-=1})),m&&m.css({display:"",visibility:""}),a},prepareConfigActionRender:function(a){return function(b){return Fancy.each(a.items,function(a){var c=a.text||"",d=Fancy.styleToString(a.style),e=a.cls||"";b.value+=['<div class="fancy-grid-column-action-item '+e+'" style="'+d+'">',c,"</div>"].join(" "),a.render&&(b=a.render(b))}),b}},prepareConfigSmartIndex:function(a){return Fancy.each(a.columns,function(a){if(/\+|\-|\/|\*|\[|\./.test(a.index)){var b=a.index;switch(b){case"xAxis.categories":case"yAxis.categories":case"zAxis.categories":return}b=b.replace(/(\w+)/g,function(a,b,c,d){return"."===d[c-1]?b:isNaN(Number(b))?"data."+b:b}),b="return "+b+";",a.smartIndexFn=new Function("data",b)}}),a},prepareConfigActionColumn:function(a){for(var b=this,c=a.columns,d=0,e=c.length;d<e;d++){var f=c[d];if("action"===f.type){f.sortable=!1,f.editable=!1,f.render=b.prepareConfigActionRender(f);var g=f.items;if(void 0!==g&&0!==g.length)for(var h,i=0,j=g.length;i<j;i++)switch(h=g[i],h.action){case"remove":void 0===h.handler&&(h.handler=function(a,b){a.remove(b)});break;case"dialog":!function(a){if(void 0===a.handler){for(var d=[],e=0,f=c.length,g=87;e<f;e++){var h=c[e];switch(h.type){case"action":continue}d.push({label:h.title||"",type:h.type,name:h.index}),g+=38}a.handler=function(c,e){a.dialog?(a.dialog.show(),a.dialog.set(e.data)):a.dialog=new FancyForm({window:!0,draggable:!0,modal:!0,title:{text:"Edit",tools:[{text:"Close",handler:function(){this.hide()}}]},width:300,height:g,items:d,buttons:["side",{text:"Clear",handler:function(){this.clear()}},{text:"Save",handler:function(){var a=this.get();a.id&&(b.getById(a.id).set(a),b.update())}}],events:[{init:function(){this.show(),this.set(e.data)}}]})}}}(h)}}}return a},prepareConfigWidgetColumn:function(a){for(var b=this,c=a.columns,d=0,e=c.length;d<e;d++){var f=c[d];f.widget&&(f.render=function(a){var c,d=a.cell.select("."+Fancy.FIELD_CLS),e=a.cell.dom,f=a.column,g={vtype:f.vtype,style:{padding:"0px","margin-top":"-10px","margin-left":"-1px"},label:!1,renderTo:e,value:a.value,emptyText:f.emptyText};if(d.length)c=Fancy.getWidget(d.dom.id),c.get()!=a.value&&c.set(a.value);else{var h=a.column.width,f=a.column,i=f.index;switch(a.column.type){case"number":case"currency":Fancy.apply(g,{spin:f.spin,min:f.min,max:f.max,events:[{change:function(c,d){b.set(a.rowIndex,i,d),b.updater.updateRow()}}]}),c=new Fancy.NumberField(g);break;case"string":case"image":Fancy.apply(g,{events:[{change:function(c,d){b.set(a.rowIndex,i,d),b.updater.updateRow()}}]}),c=new Fancy.StringField(g);break;case"combo":Fancy.apply(g,{displayKey:a.column.displayKey,valueKey:a.column.displayKey,padding:!1,checkValidOnTyping:!0,data:a.column.data,events:[{change:function(c,d){b.set(a.rowIndex,i,d),b.updater.updateRow()}}]}),c=new Fancy.Combo(g)}switch(a.column.type){case"number":case"string":case"currency":case"image":c.setInputSize({width:h+1,height:33});break;case"combo":c.size({width:h+1,height:33})}}return a})}return a},prepareConfigSorting:function(a){return(a.defaults||{}).sortable?(a._plugins.push({type:"grid.sorter"}),a):(Fancy.each(a.columns,function(b){b.sortable&&a._plugins.push({type:"grid.sorter"})}),a)},prepareConfigSelection:function(a){var b=!1,c={type:"grid.selection"},d=!1;if((a.trackOver||a.columnTrackOver||a.cellTrackOver)&&(b=!0),a.selModel){b=!0;var e=!1,f=!1,g=!0,h=!1,i=!0,j=!1,k=!0;if(Fancy.isObject(a.selModel)){e=!!a.selModel.checkOnly;var l=!1,m=!1;if(Fancy.each(a.columns,function(a){"tree"===a.type&&(l=!0),a.select&&(m=!0),"select"===a.type&&(m=!0)}),l&&m&&(e=!0),!a.selModel.type)throw new Error("FancyGrid Error 5: Type for selection is not set");void 0!==a.selModel.mouseMoveSelection&&(k=a.selModel.mouseMoveSelection),f=!0===a.selModel.memory,a.selModel.disabled&&(d=!0),a.selModel.selectLeafsOnly&&(h=!0),void 0!==a.selModel.allowDeselect&&(j=!0),void 0!==a.selModel.keyNavigation&&(i=a.selModel.keyNavigation),a.selModel=a.selModel.type}"rows"===a.selModel&&(a.multiSelect=!0),a.selection=a.selection||{},a.selection.selModel=a.selModel,a.selection[a.selModel]=!0,a.selection.checkOnly=e,a.selection.memory=f,a.selection.memoryPerformance=g,a.selection.disabled=d,a.selection.selectLeafsOnly=h,a.selection.keyNavigation=i,a.selection.allowDeselect=j,a.selection.mouseMoveSelection=k}return a.selection&&(b=!0,Fancy.isObject(a.selection)&&Fancy.apply(c,a.selection)),!0===b&&a._plugins.push(c),a},prepareConfigEdit:function(a){var b=a.defaults||{},c={type:"grid.edit"},d=!1,e=b.editable;return void 0!==a.clicksToEdit&&(c.clicksToEdit=a.clicksToEdit),e&&(d||a._plugins.push(c),a._plugins.push({type:"grid.celledit"}),d=!0),a.rowEdit&&a._plugins.push({type:"grid.rowedit"}),Fancy.each(a.columns,function(b){switch(void 0===b.index&&void 0===b.key&&(b.editable=!1),b.type){case"image":b.sortable=!1;break;case"sparklineline":case"sparklinebar":case"sparklinetristate":case"sparklinediscrete":case"sparklinebullet":case"sparklinepie":case"sparklinebox":b.editable=!1,b.sortable=!1}b.editable&&!1===d&&(a._plugins.push(c),a._plugins.push({type:"grid.celledit"}))}),a},prepareConfigExpander:function(a){if(a.expander){var b=a.expander;Fancy.apply(b,{type:"grid.expander"}),a.expanded={},a.grouping&&(b.expanded=!1),a._plugins.push(b)}return a},prepareConfigGrouping:function(a){if(a.grouping){var b=a.grouping;Fancy.apply(b,{type:"grid.grouping"}),a.expanded={},a._plugins.push(b)}return a},prepareConfigSummary:function(a){if(a.summary){var b=a.summary;!0===b&&(b={}),Fancy.apply(b,{type:"grid.summary"}),a._plugins.push(b)}return a},prepareConfigContextMenu:function(a){if(a.contextmenu){var b=a.contextmenu;Fancy.isArray(a.contextmenu)&&Fancy.each(a.contextmenu,function(b){"export"===b&&(a.exporter=!0)}),!0===b&&(b={}),Fancy.isArray(b)&&(b={items:b}),Fancy.apply(b,{type:"grid.contextmenu"}),a._plugins.push(b)}return a},prepareConfigExporter:function(a){if(a.exporter){var b=a.exporter;!0===b&&(b={}),Fancy.apply(b,{type:"grid.exporter"}),a._plugins.push(b)}return a},prepareConfigFilter:function(a,b){var c=a.columns,d=!1,e=!1,f=!1,g={type:"grid.filter"};return a.filter&&(!0===a.filter&&(d=!0,a.filter={}),Fancy.apply(g,a.filter)),Fancy.each(c,function(a){a.filter&&(d=!0,a.filter.header&&(e=!0,a.grouping&&(f=!0)))}),g.header=e,g.groupHeader=f,d&&a._plugins.push(g),a},prepareConfigSearch:function(a){var b={type:"grid.search"},c=!1;return a.searching&&(c=!0,Fancy.apply(b,a.searching)),c&&a._plugins.push(b),a},prepareConfigGroupHeader:function(a){var b=a.columns,c=0,d=b.length,e=[],f=!1,g=[];if(Fancy.each(b,function(a){a.columns&&(f=!0,e.push(a))}),f){for(c=0;c<d;c++){var h=b[c];if(h.columns){for(var i=0,j=h.columns.length,k=h.text||h.title||"  ";i<j;i++)h.locked&&(h.columns[i].locked=!0),h.rightLocked&&(h.columns[i].rightLocked=!0),h.columns[i].grouping=k,h.defaults&&(Fancy.applyIf(h.columns[i],h.defaults),h.defaults.width&&h.columns[i].flex&&delete h.columns[i].width);g=g.concat(h.columns)}else g=g.concat(b.slice(c,c+1))}a.columns=g,a._plugins.push({type:"grid.groupheader",groups:e}),a.isGroupedHeader=!0}return a},prepareConfigPaging:function(a,b){var c=this,d=a.lang,e=a.paging,f="bbar";if(!e)return a;if(void 0!==e.barType)switch(e.barType){case"bbar":case"tbar":case"both":f=e.barType;break;case!1:case"none":f="none";break;default:throw new Error("[FancyGrid Error]: - not supported bar type for paging")}return a._plugins.push({i18n:b.i18n,type:"grid.paging",barType:f}),"both"===f?(a.tbar=c.generatePagingBar(e,d),a.bbar=c.generatePagingBar(e,d)):"none"===f||(a[f]=c.generatePagingBar(e,d)),a},prepareConfigInfinite:function(a,b){return a.infinite?(a.nativeScroller=!1,a._plugins.push({type:"grid.infinite"}),a):a},generatePagingBar:function(a,b){var c=this,d=[],e="fancy-bar-button-disabled",f="material"===c.theme?8:3,g={float:"left","margin-right":"5px","margin-top":f+"px"};if(d.push({imageCls:"fancy-paging-first",disabledCls:e,role:"first",handler:function(){c.paging.firstPage()},style:{float:"left","margin-left":"5px","margin-right":"5px","margin-top":f+"px"}}),d.push({imageCls:"fancy-paging-prev",disabledCls:e,role:"prev",handler:function(){c.paging.prevPage()},style:g}),d.push("|"),d.push({type:"text",text:b.paging.page}),d.push({type:"number",label:!1,padding:!1,style:{float:"left","margin-left":"-1px","margin-right":"8px","margin-top":f+1+"px"},role:"pagenumber",min:1,width:30,listeners:[{enter:function(a){0===parseInt(a.getValue())&&a.set(1);var b=parseInt(a.getValue())-1,d=c.paging.setPage(b);b!==d&&a.set(d)}},{up:function(a,b){var d=c.store.pages;Number(b)>d&&a.set(d)}}]}),d.push({type:"text",text:"",role:"ofText"}),d.push("|"),d.push({imageCls:"fancy-paging-next",disabledCls:e,role:"next",style:g,handler:function(){c.paging.nextPage()}}),d.push({imageCls:"fancy-paging-last",disabledCls:e,role:"last",style:g,handler:function(){c.paging.lastPage()}}),Fancy.isObject(a)&&!0===a.refreshButton&&(d.push("|"),d.push({imageCls:"fancy-paging-refresh",disabledCls:e,role:"refresh",style:g,handler:function(){c.paging.refresh()}})),a&&Fancy.isArray(a.pageSizeData)){for(var h=a.pageSizeData,i=[],j=0,k=h.length,l=0;j<k;j++)i.push({index:j,value:h[j]}),a.pageSize===h[j]&&(l=j);var m=Fancy.Object.copy(g);m["margin-top"]=f+1+"px",d.push({editable:!1,width:50,type:"combo",role:"size",style:m,data:i,displayKey:"value",valueKey:"index",value:l,subSearch:!1,events:[{change:function(a,b){c.scroll(0,0),c.paging.setPageSize(h[b])}},{render:function(a){c.store.on("changepages",function(){if(c.store.pageSize!==Number(a.input.dom.value)){var b;Fancy.each(a.data,function(a){if(a.value===c.store.pageSize)return b=a.index,!0}),void 0!==b&&a.setValue(b,!1)}})}}]})}return d.push("side"),d.push({type:"text",role:"info",text:""}),d},prepareConfigState:function(a){if(a.stateful){var b={};Fancy.isObject(a.stateful)&&(b=a.stateful);var c=a.state||{},d=a.stateId||this.getStateName(),e=localStorage.getItem(d);if(e){e=JSON.parse(e);for(var f in e)Fancy.isString(e[f])&&(e[f]=JSON.parse(e[f]));var g=e.columns;g&&(Fancy.each(g,function(b,c){Fancy.each(b,function(c,d){if("FUNCTION"===c||"OBJECT"===c||"ARRAY"===c){var e=b.index;Fancy.each(a.columns,function(a){if(a.index===e)return b[d]=a[d],!0})}})}),a.columns=g);for(var f in e)"columns"!==f&&(c[f]=e[f])}a._plugins.push({type:"grid.state",stateful:!0,startState:c,log:b})}else a.state&&a._plugins.push({type:"grid.state",startState:a.state});return a},prepareConfigColumnsResizer:function(a){if((a.defaults||{}).resizable)return a._plugins.push({type:"grid.columnresizer"}),a;var b=[].concat(a.columns).concat(a.leftColumns).concat(a.rightColumns);return Fancy.each(b,function(b){b.resizable&&a._plugins.push({type:"grid.columnresizer"})}),a},prepareConfigBars:function(a){var b=function(b){for(var c=0,d=b.length;c<d;c++)switch(b[c].type){case"date":if(!b[c].format){var e=a.lang.date;b[c].format={read:e.read,write:e.write,edit:e.edit}}}};return b(a.tbar||[]),b(a.subTBar||[]),b(a.bbar||[]),b(a.buttons||[]),a},prepareConfigTBar:function(a){var b=this,c=a.tbar;if(c)for(var d=0,e=c.length;d<e;d++){switch(c[d].type){case"search":a.searching=a.searching||{},a.filter=a.filter||!0}switch(c[d].action){case"add":void 0===c[d].handler&&(c[d].handler=function(){b.insert(0,{}),b.scroll(0)});break;case"undo":void 0===c[d].handler&&(c[d].handler=function(){b.undo()});break;case"undoall":void 0===c[d].handler&&(c[d].handler=function(){b.undoAll()});break;case"redo":void 0===c[d].handler&&(c[d].handler=function(){b.redo()});break;case"remove":void 0===c[d].handler&&(c[d].disabled=!0,c[d].handler=function(){Fancy.each(b.getSelection(),function(a){b.remove(a)}),b.selection.clearSelection()},c[d].events=[{render:function(){var a=this;setTimeout(function(){var b=Fancy.getWidget(a.el.parent().parent().parent().select("."+Fancy.GRID_CLS).dom.id);b.on("select",function(){0===b.getSelection().length?a.disable():a.enable()}),b.on("clearselect",function(){a.disable()})},10)}}])}}return a},prepareConfigSubTBar:function(a){var b=a.subTBar;if(b)for(var c=0,d=b.length;c<d;c++)switch(b[c].type){case"search":a.searching=a.searching||{},a.filter=a.filter||!0}return a},prepareConfigChart:function(a){var b=a.data,c=b.chart;return Fancy.isObject(c)&&(c=[c]),b&&b.chart&&(a._plugins.push({type:"grid.chartintegration",chart:c,toChart:!!b.items||!!b.proxy}),Fancy.each(c,function(b){var c=b.type;switch(c){case"highchart":case"highcharts":a._plugins.push({type:"grid.highchart"});break;case void 0:throw new Error("[FancyGrid Error] - type of chart is undefined");default:throw new Error("[FancyGrid Error] - type of chart "+c+" does not exist")}})),a},prepareConfigSize:function(a,b){var c,d,e=this,f=a.renderTo,g=!!(a.title||a.subTitle||a.tbar||a.bbar||a.buttons||a.panel),h=a.panelBodyBorders,i=a.gridWithoutPanelBorders,j=a.gridBorders;if(void 0===a.width){if(f){if(a.responsive=!0,d=Fancy.get(f),a.width=parseInt(d.width()),a.width<1&&"body"!==d.prop("tagName").toLocaleLowerCase()){var k=d.closest(".tab-pane");k?(k.css({display:"block",visibility:"hidden"}),a.width=parseInt(d.width()),k.css({display:"",visibility:""})):a.width=d.parent().width()}0===a.width&&(a.width=parseInt(d.parent().width()))}}else if("fit"===a.width){var l=0,m=!1;this.fitWidth=!0,Fancy.each(a.columns,function(a){a.hidden||(l+=a.width),a.locked&&(m=!0)}),a.title||a.subTitle?l+=h[1]+h[3]+j[1]+j[3]:l+=i[1]+i[3]+j[1]+j[3],m&&l--,a.width=l}if(void 0===a.height){if(f){a.responsiveHeight=!0;var n=parseInt(d.height());n<50&&(n=parseInt(d.parent().css("height"))),a.height=n}}else if("fit"===a.height){var c=0,o=1;Fancy.each(a.columns,function(a){a.grouping&&(o<2&&(o=2),a.filter&&a.filter.header&&o<3&&(o=3)),a.filter&&a.filter.header&&o<2&&(o=2)}),Fancy.isArray(a.data)?c=a.data.length:a.data&&Fancy.isArray(a.data.items)&&(c=a.data.items.length);var n=c*a.cellHeight;a.title&&(n+=a.titleHeight),a.tbar&&(n+=a.tbarHeight||a.barHeight),a.tabs&&(n+=a.barHeight),a.bbar&&(n+=e.bbarHeight||a.barHeight),a.buttons&&(n+=a.buttonsHeight||a.barHeight),a.subTBar&&(n+=a.subTBarHeight||a.barHeight),a.footer&&(n+=a.barHeight),!1!==a.header&&(n+=a.cellHeaderHeight*o),n+=g?h[0]+h[2]+j[0]+j[2]:i[0]+i[2]+j[0]+j[2],a.minHeight&&n<a.minHeight&&(n=a.minHeight),a.heightFit=!0,a.height=n}return g&&!a.title&&(a.panelBodyBorders=[0,0,0,0],setTimeout(function(){e.panel&&e.panel.css("border-bottom-width",0)},1)),a}}),Fancy.Mixin("Fancy.grid.mixin.ActionColumn",{initActionColumnHandler:function(){var a=this;a.on("cellclick",a.onCellClickColumnAction,a)},onCellClickColumnAction:function(a,b){var c,d,e=this,f=b.column,g=f.items;"action"===f.type&&(c=e.getActiveActionColumnItem(b),g&&void 0!==c&&(d=g[c],d.handler&&d.handler(e,b)))},getActiveActionColumnItem:function(a){for(var b=Fancy.get(a.cell),c=a.e.target,d=b.select("."+Fancy.GRID_COLUMN_ACTION_ITEM_CLS),e=0,f=d.length;e<f;e++)if(d.item(e).within(c))return e}}),Fancy.Mixin("Fancy.grid.mixin.Edit",{remove:function(a,b,c){var d=this,e=d.store,f="remove";if(!d.store)return void setTimeout(function(){d.remove(a,b)},100);if(b&&(f="removeAt"),Fancy.isArray(a))for(var g=0,h=a.length;g<h;g++)e[f](a[g],c);else e[f](a);!1!==c&&d.setSidesHeight()},removeAt:function(a){this.remove(a,!0)},removeRow:function(a){this.remove(a,!0)},removeRowById:function(a){this.remove(a)},removeRowByID:function(a){this.remove(a)},removeAll:function(){var a=this;a.store.removeAll(),a.update(),a.scroller.update(),a.paging&&a.paging.updateBar(),a.grouping&&a.grouping.reGroup()},add:function(a){var b=this;if(!b.store)return void setTimeout(function(){b.add(a)},100);if(Fancy.isArray(a))for(var c=0,d=a.length;c<d;c++)b.add(a[c]);else b.store.add(a),b.setSidesHeight()},insert:function(a,b,c){var d=this,e=d.store;if(!d.store)return void setTimeout(function(){d.insert(a,b,c)},100);if(Fancy.isArray(b)){for(var f=b.length-1;-1!==f;f--)d.insert(b[f],a,c);return void(!1!==c&&d.setSidesHeight())}if(Fancy.isArray(a)){for(var f=a.length-1;-1!==f;f--)d.insert(a[f],0,c);return void(!1!==c&&d.setSidesHeight())}if(Fancy.isObject(a)&&void 0===b)b=a,a=0;else if(Fancy.isObject(a)&&Fancy.isNumber(b)){var g=b;b=a,a=g}d.paging&&"server"!==e.proxyType&&(a+=e.showPage*e.pageSize),e.insert(a,b,c),!1!==c&&d.setSidesHeight()},set:function(a,b,c){var d=this,e=d.store;if(!d.store)return void setTimeout(function(){d.set(a,b,c)},100);Fancy.isObject(b)&&void 0===c?e.setItemData(a,b,c):e.set(a,b,c)},setById:function(a,b,c){var d=this,e=d.store,f=e.getRow(a);if(void 0===f){if(void 0===e.getById(a))return!1;f=-1}if(!d.store)return setTimeout(function(){-1===f?d.setById(f,b,c):d.set(f,b,c)},100),f;if(Fancy.isObject(b)&&void 0===c)for(var g in b){var h=d.getColumnByIndex(g);if(h&&"date"===h.type){var i=h.format,j=Fancy.Date.parse(b[g],i.read,i.mode),k=Fancy.Date.parse(e.getById(a).get(g),i.edit,i.mode);+j==+k&&delete b[g]}e.setItemData(f,b,c,a),-1===f&&e.getById(a).set(b)}else e.set(f,b,c,a),-1===f&&e.getById(a).set(b,c);return f},undo:function(){var a=this,b=a.store,c=b.undoActions.splice(b.undoActions.length-1,1)[0];switch(c.type){case"edit":a.setById(c.id,c.key,c.oldValue);var d=c.value;c.value=c.oldValue,c.oldValue=d,b.redoActions.push(c),a.fire("undo");break;case"insert":b.undoStoppped=!0,a.remove(c.id),b.undoStoppped=!1,b.redoActions.push(c);break;case"remove":b.undoStoppped=!0,a.insert(c.rowIndex,c.data),b.undoStoppped=!1,b.redoActions.push(c)}},redo:function(){var a=this,b=a.store,c=b.redoActions.splice(b.redoActions.length-1,1)[0];switch(b.redoing=!0,c.type){case"edit":a.setById(c.id,c.key,c.oldValue);break;case"insert":a.insert(c.rowIndex,c.data);break;case"remove":a.remove(c.id)}delete b.redoing},undoAll:function(){for(var a=this,b=a.store,c=0,d=b.undoActions.length;c<d;c++)a.undo()}}),function(){var a,b=Fancy,c=b.TOUCH_CLS,d=b.HIDDEN_CLS,e=b.GRID_CLS,f=b.GRID_CENTER_CLS,g=b.GRID_LEFT_CLS,h=b.GRID_RIGHT_CLS,i=b.GRID_HEADER_CLS,j=b.GRID_BODY_CLS,k=b.PANEL_BODY_INNER_CLS,l=b.GRID_UNSELECTABLE_CLS,m=b.GRID_LEFT_EMPTY_CLS,n=b.GRID_RIGHT_EMPTY_CLS,o=b.GRID_COLUMN_SORT_ASC,p=b.GRID_COLUMN_SORT_DESC,q=b.PANEL_CLS,r=b.PANEL_TBAR_CLS,s=b.PANEL_SUB_TBAR_CLS,t=b.PANEL_BBAR_CLS,u=b.PANEL_BUTTONS_CLS,v=b.ANIMATE_DURATION;b.Mixin("Fancy.grid.mixin.Grid",{tabScrollStep:50,waitingForFilters:!1,tpl:['<div class="'+g+" "+m+'"></div>','<div class="'+f+'"></div>','<div class="'+h+" "+n+'"></div>','<div class="fancy-grid-editors"></div>'],initStore:function(){var a,c,d,e=this,f=e.getFieldsFromData(e.data),g="Fancy.model."+b.id(),h=e.data,i=!1,j=e.state;e.data.items&&(h=e.data.items),a=e.data.remoteSort,c=e.data.remoteFilter,d=e.data.remotePage,d&&(d="server"),b.define(g,{extend:b.Model,fields:f}),e.grouping&&void 0!==e.grouping.collapsed&&(i=e.grouping.collapsed);var k={widget:e,model:g,data:h,paging:e.paging,remoteSort:a,remoteFilter:c,pageType:d,collapsed:i,multiSort:e.multiSort};e.multiSortLimit&&(k.multiSortLimit=e.multiSortLimit),e.infinite&&(k.infinite=!0),j&&j.filters&&(k.filters=j.filters),h.pageSize&&(k.pageSize=h.pageSize),e.store=new b.Store(k),e.model=g,e.fields=f,e.store.filters&&setTimeout(function(){e.filter.filters=e.store.filters,e.filter.updateStoreFilters()},1)},initTouch:function(){var a=this;b.isTouch&&window.FastClick&&(a.panel?(FastClick.attach(a.panel.el.dom),a.panel.addCls(c)):(FastClick.attach(a.el.dom),a.addCls(c)))},initElements:function(){var a=this;!1!==a.header&&(a.leftHeader=new b.grid.Header({widget:a,side:"left"}),a.header=new b.grid.Header({widget:a,side:"center"}),a.rightHeader=new b.grid.Header({widget:a,side:"right"})),a.leftBody=new b.grid.Body({widget:a,side:"left"}),a.body=new b.grid.Body({widget:a,side:"center"}),a.rightBody=new b.grid.Body({widget:a,side:"right"}),a.leftEl=a.el.select("."+g),a.centerEl=a.el.select("."+f),a.rightEl=a.el.select("."+h)},getFieldsFromData:function(a){var b=this,c=a.items||a;if(a.fields)return b.isTreeData&&(a.fields.push("$deep"),a.fields.push("leaf"),a.fields.push("parentId"),a.fields.push("expanded"),a.fields.push("child"),a.fields.push("filteredChild")),a.fields;if(!c)throw new Error("FancyGrid Error 4: Data is empty and not set fields of data to build model");var d=c[0],e=[];for(var f in d)e.push(f);return b.isTreeData&&(e.push("$deep"),e.push("leaf"),e.push("parentId"),e.push("expanded"),e.push("child")),e},render:function(){var a=this,c=Fancy.get(a.renderTo||document.body),d=b.get(document.createElement("div")),e=a.panelBodyBorders;if(a.renderOuter&&(d=c),!c.dom)throw new Error("[FancyGrid Error 1] - Could not find renderTo element: "+a.renderTo);d.addCls(b.cls,a.widgetCls,a.cls),Fancy.loadingStyle&&(a.panel?(a.panel.el.css("opacity",0),a.intervalStyleLoad=setInterval(function(){Fancy.loadingStyle||(clearInterval(a.intervalStyleLoad),a.panel.el.animate({opacity:1,force:!0}))},100)):(d.css("opacity",0),a.intervalStyleLoad=setInterval(function(){Fancy.loadingStyle||(clearInterval(a.intervalStyleLoad),a.el.animate({opacity:1,force:!0}))},100))),d.attr("role","grid"),d.attr("id",a.id),void 0===a.panel&&a.shadow&&d.addCls("fancy-panel-shadow"),!1===a.columnLines&&d.addCls("fancy-grid-disable-column-lines"),!1===a.rowLines&&d.addCls("fancy-grid-disable-row-lines"),"default"===a.theme||a.panel||d.addCls("fancy-theme-"+a.theme),a.treeFolder&&d.addCls("fancy-grid-tree-folder");var f=0;a.panel&&(f=e[1]+e[3]),d.css({width:a.width-f+"px",height:a.height-0+"px"}),a.initTpl(),d.update(a.tpl.getHTML({})),a.renderOuter?a.el=d:a.el=b.get(c.dom.appendChild(d.dom)),a.setHardBordersWidth(),setTimeout(function(){Fancy.nojQuery&&a.el.addCls(Fancy.GRID_ANIMATION_CLS)},100),a.rendered=!0},setHardBordersWidth:function(){var a=this,b=a.panel?a.gridBorders:a.gridWithoutPanelBorders;a.wrapped&&(b=a.gridBorders),a.css({"border-top-width":b[0],"border-right-width":b[1],"border-bottom-width":b[2],"border-left-width":b[3]})},update:function(a){var b=this;if(!b.store.loading){b.expander&&b.expander.reSet();var c="default";if(a&&a.type&&(c=a.type),b.updater.update(c),b.fire("update"),b.heightFit&&b.fitHeight(),b.setBodysHeight(),b.paging&&b.paging.update(),a&&a.flash){var d=b.store.changed;for(var e in d){var f=d[e],g=b.getRowById(e);if(void 0!==g)for(var h in f)switch(h){case"length":break;default:var i=b.getColumnOrderByKey(h);switch(a.flash){case!0:b.flashCell(g,i.order,i.side);break;case"plusminus":b.flashCell(g,i.order,i.side,{type:"plusminus",delta:f[h].value-f[h].originValue})}}}b.clearDirty()}else b.scroller.update()}},getColumnsWidth:function(a){var b=this;switch(a){case"center":case void 0:return b.getCenterFullWidth();case"left":return b.getLeftFullWidth();case"right":return b.getRightFullWidth()}},setSides:function(){var a=this,b=a.leftColumns,c=a.rightColumns,d=a.getLeftFullWidth(),e=a.getCenterFullWidth(),k=a.getRightFullWidth(),l=a.gridBorders,o=a.panelBodyBorders,p=a.gridWithoutPanelBorders;b.length>0&&a.leftEl.removeCls(m),c.length>0&&a.rightEl.removeCls(n),e=a.wrapped?a.width-l[1]-l[3]:a.panel?a.width-l[1]-l[3]-o[1]-o[3]:a.width-p[1]-p[3],0===d&&0===k||(0===k?e-=d:0===d?e-=k:a.width>d+e+k?e-=d:e-=d+k),a.leftEl.css({width:d+"px"}),a.centerEl.css({left:d+"px",width:e+"px"}),a.header&&(a.el.select("."+g+" ."+i).css({width:d+"px"}),a.el.select("."+f+" ."+i).css({width:e+"px"})),a.el.select("."+f+" ."+j).css({width:e+"px"}),a.width>d+e+k?a.rightEl.css({right:"0px"}):a.rightEl.css({left:"",right:"0px"}),a.rightEl.css({width:k}),a.header&&a.el.select("."+h+" ."+i).css({width:k+"px"}),a.startWidths={center:e,left:d,right:k}},setColumnsPosition:function(){var a=this;a.body.setColumnsPosition(),a.leftBody.setColumnsPosition(),a.rightBody.setColumnsPosition()},setSidesHeight:function(a){var b=this,c=b.store,d=1,e=b.cellHeaderHeight;!1!==b.header&&(d+=e,b.filter&&b.filter.header&&(b.groupheader?b.filter.groupHeader&&(d+=e):d+=e),b.groupheader&&(b.filter&&b.filter.header,d+=e)),b.grouping&&(d+=b.grouping.groups.length*b.groupRowHeight),b.expander&&(d+=b.expander.plusHeight),b.summary&&(d+=b.summary.topOffSet),b.rowheight&&b.rowheight.totalHeight&&(a=b.rowheight.totalHeight),d+=a||c.getLength()*b.cellHeight-1,b.paging&&b.summary&&"bottom"===b.summary.position&&(d=b.height),b.leftEl.css({height:d+"px"}),b.centerEl.css({height:d+"px"}),b.rightEl.css({height:d+"px"})},setBodysHeight:function(){var a=this;a.body.setHeight(),a.leftBody.setHeight(),a.rightBody.setHeight()},preRender:function(){var a=this;(a.title||a.subTitle||a.tbar||a.bbar||a.buttons||a.panel)&&a.renderPanel()},renderPanel:function(){var a=this,c={renderTo:a.renderTo,renderOuter:a.renderOuter,title:a.title,subTitle:a.subTitle,width:a.width,height:a.height,titleHeight:a.titleHeight,subTitleHeight:a.subTitleHeight,barHeight:a.barHeight,subTBarHeight:a.subTBarHeight||a.barHeight,tbarHeight:a.tbarHeight||a.barHeight,bbarHeight:a.bbarHeight||a.barHeight,buttonsHeight:a.buttonsHeight||a.barHeight,theme:a.theme,shadow:a.shadow,style:a.style||{},window:a.window,modal:a.modal,frame:a.frame,items:[a],draggable:a.draggable,resizable:a.resizable,minWidth:a.minWidth,minHeight:a.minHeight,panelBodyBorders:a.panelBodyBorders,barContainer:a.barContainer,barScrollEnabled:a.barScrollEnabled,tabScrollStep:a.tabScrollStep},d=a.panelBodyBorders;a.bbar&&(c.bbar=a.bbar,a.height-=a.bbarHeight||a.barHeight),a.tbar&&(c.tbar=a.tbar,a.height-=a.tbarHeight||a.barHeight),a.subTBar&&(c.subTBar=a.subTBar,a.height-=a.subTBarHeight||a.barHeight),a.buttons&&(c.buttons=a.buttons,a.height-=a.buttonsHeight||a.barHeight),a.footer&&(c.footer=a.footer,a.height-=a.barHeight),a.panel=new b.Panel(c),a.bbar=a.panel.bbar,a.tbar=a.panel.tbar,a.subTBar=a.panel.subTBar,a.buttons=a.panel.buttons,a.wrapped||a.panel.addCls("fancy-panel-grid-inside"),a.title&&(a.height-=a.titleHeight),a.subTitle&&(a.height-=a.subTitleHeight,a.height+=d[2]),a.height-=d[0]+d[2],a.renderTo=a.panel.el.select("."+k).dom,a.resizable&&a.panel.on("resize",function(){a.setBodysHeight()})},getBodyHeight:function(){var a=this,b=a.height,c=1,d=a.gridBorders,e=a.gridWithoutPanelBorders;return a.groupheader&&(c=2),a.filter&&a.filter.header&&(a.groupheader?a.filter.groupHeader&&c++:c++),!1!==a.header&&(b-=a.cellHeaderHeight*c),a.panel?b-=d[0]+d[2]:b-=e[0]+e[2],a.summary&&(b-=a.summary.topOffSet,b-=a.summary.bottomOffSet),b},ons:function(){var a=this,c=a.store,d=b.get(document);c.on("change",a.onChangeStore,a),c.on("set",a.onSetStore,a),c.on("insert",a.onInsertStore,a),c.on("remove",a.onRemoveStore,a),c.on("beforesort",a.onBeforeSortStore,a),c.on("sort",a.onSortStore,a),c.on("beforeload",a.onBeforeLoadStore,a),c.on("load",a.onLoadStore,a),d.on("mouseup",a.onDocMouseUp,a),d.on("click",a.onDocClick,a),d.on("mousemove",a.onDocMove,a),c.on("servererror",a.onServerError,a),c.on("serversuccess",a.onServerSuccess,a),a.responsive&&a.once("render",a.initResponsiveness,a),a.on("activate",a.onActivate,a),a.on("deactivate",a.onDeActivate,a)},onServerError:function(a,b,c,d){this.fire("servererror",b,c,d)},onServerSuccess:function(a,b,c){this.fire("serversuccess",b,c)},onChangeStore:function(){!1!==this.$onChangeUpdate&&this.update()},onBeforeLoadStore:function(){this.fire("beforeload")},onRemoveStore:function(a,b,c){this.fire("remove",b,c)},onInsertStore:function(a,b){this.fire("insert",b)},onLoadStore:function(){var a=this;setTimeout(function(){a.fire("load")},1)},onSetStore:function(a,b){this.fire("set",b)},onBeforeSortStore:function(a,b){this.fire("beforesort",b)},onSortStore:function(a,b){this.fire("sort",b)},getCellsViewHeight:function(){var a=this,b=a.store,c=0,e=0;return a.grouping&&(c+=a.grouping.plusScroll),a.expander&&(c+=a.expander.plusScroll),!a.scroller.scrollBottomEl||a.scroller.scrollBottomEl.hasCls(d)||(e=a.scroller.cornerSize),(a.rowheight?a.rowheight.totalHeight:a.cellHeight*b.dataView.length)+e+c},onDocMouseUp:function(a){this.fire("docmouseup")},onDocClick:function(a){this.fire("docclick",a)},onDocMove:function(a){this.fire("docmove",a)},getCenterViewWidth:function(){var a=this,b=a.centerEl.width();if(0===b){for(var c=0,d=a.columns,e=0,f=d.length;e<f;e++){var g=d[e];g.hidden||(c+=g.width)}return c}return b},getCenterFullWidth:function(){for(var a=this,b=0,c=a.columns,d=0,e=c.length;d<e;d++){var f=c[d];f.hidden||(b+=f.width)}return b},getLeftFullWidth:function(){for(var a=this,b=0,c=a.leftColumns,d=0,e=c.length;d<e;d++){var f=c[d];f.hidden||(b+=f.width)}return b},getRightFullWidth:function(){for(var a=this,b=0,c=a.rightColumns,d=0,e=c.length;d<e;d++){var f=c[d];f.hidden||(b+=f.width)}return b},getColumns:function(a){var b,c=this;switch(a){case"left":b=c.leftColumns;break;case"center":b=c.columns;break;case"right":b=c.rightColumns}return b},setColumns:function(a,b){var c=this;switch(b){case"left":c.leftColumns=a;break;case"center":case void 0:c.columns=a;break;case"right":c.rightColumns=a}},getBody:function(a){var b,c=this;switch(a){case"left":b=c.leftBody;break;case"center":b=c.body;break;case"right":b=c.rightBody}return b},getHeader:function(a){var b,c=this;switch(a){case"left":b=c.leftHeader;break;case"center":b=c.header;break;case"right":b=c.rightHeader}return b},getHeaderCell:function(a,c){var d,e,f=this;if(b.isString(a)){var g=f.getColumnOrderByKey(a);e=f.getHeader(g.side),d=e.getCell(g.order)}else c=c||"center",e=f.getHeader(c),d=e.getCell(a);return d},getDomRow:function(a){for(var b=this,c=b.leftBody,d=b.body,e=b.rightBody,f=b.leftColumns,g=b.columns,h=b.rightColumns,i=0,j=f.length,k=[];i<j;i++)k.push(c.getDomCell(a,i));for(i=0,j=g.length;i<j;i++)k.push(d.getDomCell(a,i));for(i=0,j=h.length;i<j;i++)k.push(e.getDomCell(a,i));return k},initTextSelection:function(){var a=this;a.body,a.leftBody,a.rightBody;!1===a.textSelection&&a.addCls(l)},setTrackOver:function(a,b){var c=this;switch(a){case"cell":c.cellTrackOver=b;break;case"column":c.columnTrackOver=b;break;case"row":c.trackOver=b}},setSelModel:function(a){var b=this,c=b.selection;c.cell=!1,c.cells=!1,c.row=!1,c.rows=!1,c.column=!1,c.columns=!1,c[a]=!0,c.selModel=a,b.multiSelect="rows"===a,c.clearSelection()},getSelection:function(a){return this.selection.getSelection(a)},clearSelection:function(){this.selection.clearSelection()},destroy:function(){var a=this,c=a.store,d=b.get(document);d.un("mouseup",a.onDocMouseUp,a),d.un("click",a.onDocClick,a),d.un("mousemove",a.onDocMove,a),a.body.destroy(),a.leftBody.destroy(),a.rightBody.destroy(),a.header.destroy(),a.leftHeader.destroy(),a.rightHeader.destroy(),a.scroller.destroy(),a.el.destroy(),a.panel&&a.panel.el.destroy(),c.destroy()},clearData:function(){var a=this;a.setData([]),a.update(),a.scroller.update()},showAt:function(){var a=this;a.panel&&a.panel.showAt.apply(a.panel,arguments)},show:function(){var a=this;setTimeout(function(){a.panel?a.panel.show.apply(a.panel,arguments):a.el.show()},30)},hide:function(){var a=this;if(a.panel?a.panel.hide.apply(a.panel,arguments):a.el.hide(),a.celledit){var b=a.celledit.activeEditor;b&&b.hide()}},initDateColumn:function(){var a=this,c=function(c){for(var d=0,e=c.length;d<e;d++){var f=c[d];if("date"===f.type){f.format=f.format||{};var g={type:"date"};b.applyIf(g,a.lang.date),b.applyIf(f.format,g)}}return c};a.columns=c(a.columns),a.leftColumns=c(a.leftColumns),a.rightColumns=c(a.rightColumns)},stopEditor:function(){this.edit.stopEditor()},getById:function(a){return this.store.getById(a)},get:function(a,b){var c=this,d=c.store;return void 0!==b?d.get(a,b):void 0===a?d.get():d.getItem(a)},getRowById:function(a){return this.store.getRow(a)},getTotal:function(){return this.store.getTotal()},getViewTotal:function(){return this.store.getLength()},getDataView:function(){return this.store.getDataView()},getData:function(){return this.store.getData()},selectRow:function(a,b,c){this.selection.selectRow(a,b,c)},deSelectRow:function(a){this.selection.selectRow(a,!1,!0)},selectById:function(a,b,c){this.selection.selectById(a,b,c)},selectColumn:function(a){var b,c,d=this,e=d.leftColumns||[],f=d.columns||[],g=d.rightColumns||[],h=function(b){for(var d=0,e=b.length;d<e;d++){if(b[d].index===a)return c=d,!0}return!1};h(e)?b="left":h(f)?b="center":h(g)&&(b="right"),b&&d.selection.selectColumn(c,b)},getColumnByIndex:function(a){for(var b=this,c=b.leftColumns||[],d=b.columns||[],e=b.rightColumns||[],f=c.concat(d).concat(e),g=0,h=f.length;g<h;g++){var i=f[g];if(i.index===a)return i}},getColumnOrderByKey:function(a){var c,d=this,e=d.leftColumns||[],f=d.columns||[],g=d.rightColumns||[],h="";return b.each(f,function(b,d){b.index===a&&(h="center",c=d)}),h||(b.each(e,function(b,d){b.index===a&&(h="left",c=d)}),h||b.each(g,function(b,d){b.index===a&&(h="right",c=d)})),{side:h,order:c}},load:function(a){this.store.loadData(a)},save:function(){this.store.save()},onWindowResize:function(){var a,c=this,d=c.renderTo;c.panel&&(d=c.panel.renderTo),a=c.responsive?b.get(d):c.panel?c.panel.el:b.get(d),(a.hasClass(q)||a.hasClass(e))&&(a=a.parent());var f=a.width();if(void 0!==a.dom){if(0===f&&(f=a.parent().width()),c.responsive?c.setWidth(f):c.fitWidth,c.responsiveHeight){var g=parseInt(a.height());0===g&&(g=parseInt(a.parent().height())),c.setHeight(g)}c.setBodysHeight(),c.updateColumnsWidth(),c.scroller.scrollDelta(0),c.scroller.update()}},updateColumnsWidth:function(){var a=this,b=function(a,b,c){Fancy.each(a,function(a,c){if(!a.hidden&&a.flex)b.getCell(c)})};b(a.columns,a.header,"center"),b(a.leftColumns,a.leftHeader,"left"),b(a.rightColumns,a.rightHeader,"right")},setWidth:function(a){var b,c=this,d=c.el,e=c.gridBorders,g=c.gridWithoutPanelBorders,h=c.panelBodyBorders,i=c.body,j=c.header,k=function(a){for(var b=0,c=a.length,d=0;b<c;b++){a[b].hidden||(d+=a[b].width)}return d},l=k(c.leftColumns),m=k(c.rightColumns),n=a-l-m-h[1]-h[3];c.wrapped?(b=a,n=a-l-m,n-=e[1]+e[3],c.css({width:b})):c.panel?(n=a-l-m-h[1]-h[3],c.panel.el.width(a),n-=e[1]+e[3],b=a-h[1]-h[3],c.css({width:b})):(n=a-l-m-g[1]-g[3],d.css("width",a)),n<100&&(n=100),d.select("."+f).css("width",n),j.css("width",n),i.css("width",n),c.hasFlexColumns&&(c.reCalcColumnsWidth(),c.columnresizer.updateColumnsWidth()),c.scroller.setScrollBars()},getWidth:function(){var a=this;return a.panel?parseInt(a.panel.css("width")):parseInt(a.css("width"))},getHeight:function(){var a=this;return a.panel?parseInt(a.panel.css("height")):parseInt(a.css("height"))},setHeight:function(a,b){var c=this,d=c.gridBorders,e=c.panelBodyBorders;c.panel&&!1!==b&&c.panel.setHeight(a),c.title&&(a-=c.titleHeight),c.subTitle&&(a-=c.subTitleHeight),c.footer&&(a-=c.barHeight),c.bbar&&(a-=c.bbarHeight||c.barHeight),c.tbar&&(a-=c.tbarHeight||c.barHeight),c.subTBar&&(a-=c.subTBarHeight||c.barHeight),c.buttons&&(a-=c.buttonsHeight||c.barHeight);var f=a;c.header&&(f-=c.cellHeaderHeight,c.groupheader&&(f-=c.cellHeaderHeight)),c.panel&&(f-=e[0]+e[2]),f-=d[0]+d[2],c.body&&c.body.css("height",f),c.leftBody&&c.leftBody.css("height",f),c.rightBody&&c.rightBody.css("height",f),c.el.css("height",a),c.height=a,c.scroller.update()},find:function(a,b,c){return this.store.find(a,b,c)},findItem:function(a,b){return this.store.findItem(a,b)},each:function(a,b){this.store.each(a,b)},onActivate:function(){var c=this,d=b.get(document);a&&a.id!==c.id&&a.fire("deactivate"),setTimeout(function(){d.on("click",c.onDeactivateClick,c)},100),a=c},onDeActivate:function(){var a=this,c=b.get(document);a.activated=!1,c.un("click",a.onDeactivateClick,a)},onDeactivateClick:function(a){for(var c=this,d=0,e=20,f=b.get(a.target);d<e;d++){if(!f.dom)return;if(!f.dom.tagName||"body"===f.dom.tagName.toLocaleLowerCase())return void c.fire("deactivate");if(void 0===f.hasCls)return void c.fire("deactivate");if(f.hasCls(c.widgetCls))return;f=f.parent()}},search:function(a,b){this.searching.search(a,b)},stopSelection:function(){var a=this;a.selection&&a.selection.stopSelection()},enableSelection:function(a){var b=this;b.selection&&b.selection.enableSelection(a)},hideColumn:function(a,c){var d=this;if(!(void 0!==c||b.isArray(c)||b.isArray(a)||(c=a,a=this.getSideByColumnIndex(c))))throw new Error("[FancyGrid Error] - column does not exist");if(void 0===c&&(c=a,a=void 0),b.isArray(c))return d._tempSumColumnsWidth=0,d._tempColumnsNumber=c.length,b.each(c,function(b,c){a?(d._tempColumnsNumber--,d.hideColumn(a,b)):(d._tempColumnsNumber--,d.hideColumn(b))}),delete d._tempColumnsNumber,void delete d._tempSumColumnsWidth;var e,f,d=this,g=d.getBody(a),h=d.getHeader(a),i=d.getColumns(a),j=0,k=i.length,l=d.centerEl,m=d.leftEl,n=d.leftHeader,o=d.rightEl,p=d.rightHeader;if(b.isNumber(c)){if(f=i[c],f.hidden)return;e=c,f.hidden=!0}else for(;j<k;j++)if(f=i[j],f.index===c){if(f.hidden)return;e=j,f.hidden=!0;break}void 0!==d._tempSumColumnsWidth&&(d._tempSumColumnsWidth+=f.width),h.hideCell(e),g.hideColumn(e),d.rowedit&&d.rowedit.hideField(e,a);var q=f.width;if(d._tempSumColumnsWidth&&(q=d._tempSumColumnsWidth),!d._tempColumnsNumber)switch(a){case"left":m.animate({width:parseInt(m.css("width"))-q},v),n.el.animate({width:parseInt(n.css("width"))-q},v),l.animate({left:parseInt(l.css("left"))-q},v),l.animate({width:parseInt(l.css("width"))+q},v),d.body.el.animate({width:parseInt(d.body.css("width"))+q},v),d.header.el.animate({width:parseInt(d.header.css("width"))+q},v);break;case"right":o.animate({width:parseInt(o.css("width"))-q},v),p.el.animate({width:parseInt(p.css("width"))-q},v),l.animate({width:parseInt(l.css("width"))+q},v),d.body.el.animate({width:parseInt(d.body.css("width"))+q},v),d.header.el.animate({width:parseInt(d.header.css("width"))+q},v)}d.grouping&&d.grouping.updateGroupRows(),d.onWindowResize(),d.fire("columnhide",{column:f,side:a,orderIndex:e})},showColumn:function(a,c){var d=this;if(!(void 0!==c||b.isArray(c)||b.isArray(a)||(c=a,a=this.getSideByColumnIndex(c))))throw new Error("[FancyGrid Error] - column does not exist");if(void 0===c&&(c=a,a=void 0),b.isArray(c)){switch(d._tempSumColumnsWidth=0,d._tempColumnsNumber=c.length,a){case"left":d._tempUsedSide="left";break;case"right":d._tempUsedSide="right"}return b.each(c,function(b,c){a?(d._tempColumnsNumber--,d.showColumn(a,b)):(d._tempColumnsNumber--,d.showColumn(b))}),delete d._tempColumnsNumber,delete d._tempSumColumnsWidth,void delete d._tempUsedSide}var e,f,d=this,g=d.getBody(a),h=d.getHeader(a),i=d.getColumns(a),j=0,k=i.length,l=d.centerEl,m=d.leftEl,n=d.leftHeader,o=d.rightEl,p=d.rightHeader;if(b.isNumber(c)){if(f=i[c],!f.hidden)return;e=c,f.hidden=!1}else for(;j<k;j++)if(f=i[j],f.index===c){if(!f.hidden)return;e=j,delete f.hidden;break}void 0!==d._tempSumColumnsWidth&&(d._tempSumColumnsWidth+=f.width),h.showCell(e),g.showColumn(e),d.rowedit&&d.rowedit.showField(e,a);var q=f.width;if(d._tempSumColumnsWidth&&(q=d._tempSumColumnsWidth),!d._tempColumnsNumber)switch(a){case"left":m.animate({width:parseInt(m.css("width"))+q}),n.el.animate({width:parseInt(n.css("width"))+q}),l.animate({left:parseInt(l.css("left"))+q}),l.animate({width:parseInt(l.css("width"))-q}),d.body.el.animate({width:parseInt(d.body.css("width"))-q}),d.header.el.animate({width:parseInt(d.header.css("width"))-q});break;case"right":o.animate({width:parseInt(o.css("width"))+q}),p.el.animate({width:parseInt(p.css("width"))+q}),l.animate({width:parseInt(l.css("width"))-q}),d.body.el.animate({width:parseInt(d.body.css("width"))-q}),d.header.el.animate({width:parseInt(d.header.css("width"))-q})}d.grouping&&d.grouping.updateGroupRows(),d.onWindowResize(),d.fire("columnshow",{column:f,side:a,orderIndex:e})},removeColumn:function(a,c){var d,e=this,f=e.leftEl,g=e.leftHeader,h=e.leftBody,i=e.centerEl,j=e.body,k=e.header,l=e.rightEl,m=e.rightBody,n=e.rightHeader;if(void 0===c&&(c="center"),b.isString(a)){var o=e.getColumns(c);if(b.each(o,function(b,c){if(b.index===a)return a=c,!0}),b.isString(a)&&"center"===c&&(o=e.getColumns("left"),b.each(o,function(b,d){if(b.index===a)return a=d,c="left",!0}),b.isString(a)&&(o=e.getColumns("right"),b.each(o,function(b,d){if(b.index===a)return a=d,c="right",!0}),b.isString(a))))throw new Error("FancyGrid Error 7: Column was not found for method removeColumn")}switch(c){case"left":d=e.leftColumns[a],e.leftColumns.splice(a,1),g.removeCell(a),g.reSetIndexes(),h.removeColumn(a),f.css("width",parseInt(f.css("width"))-d.width),i.css("left",parseInt(i.css("left"))-d.width),i.css("width",parseInt(i.css("width"))+d.width),j.css("width",parseInt(j.css("width"))+d.width),k.css("width",parseInt(k.css("width"))+d.width);break;case"center":d=e.columns[a],e.columns.splice(a,1),k.removeCell(a),k.reSetIndexes(),j.removeColumn(a);break;case"right":d=e.rightColumns[a],e.rightColumns.splice(a,1),n.removeCell(a),n.reSetIndexes(),m.removeColumn(a),l.css("right",parseInt(l.css("right"))-d.width),i.css("width",parseInt(i.css("width"))+d.width),k.css("width",parseInt(k.css("width"))+d.width),j.css("width",parseInt(j.css("width"))+d.width)}return d.grouping&&delete d.grouping,e.summary&&e.summary.removeColumn(a,c),d},insertColumn:function(a,c,d,e){var f=this,g=f.leftEl,h=f.leftBody,i=f.leftHeader,j=f.centerEl,k=f.body,l=f.header,o=f.rightEl,p=f.rightBody,q=f.rightHeader;switch(d=d||"center"){case"center":delete a.rightLocked,delete a.locked,f.columns.splice(c,0,a),l.insertCell(c,a),l.reSetIndexes(),k.insertColumn(c,a);break;case"left":a.locked=!0;var r=0,s=0;0===f.leftColumns.length&&(b.nojQuery||(r=1),f.leftEl.removeCls(m)),b.nojQuery||(s=0),f.leftColumns.splice(c,0,a),i.insertCell(c,a),i.reSetIndexes(),i.css("width",parseInt(i.css("width"))+s),h.insertColumn(c,a),g.css("width",parseInt(g.css("width"))+a.width),j.css("width",parseInt(j.css("width"))-a.width),j.css("left",parseInt(j.css("left"))+a.width+r),k.el.css("width",parseInt(k.el.css("width"))-a.width),l.el.css("width",parseInt(l.el.css("width"))-a.width);break;case"right":a.rightLocked=!0;var r=0,t=0;0===f.rightColumns.length&&(b.nojQuery||(r=1,t=2),f.rightEl.removeCls(n)),f.rightColumns.splice(c,0,a),q.insertCell(c,a),q.reSetIndexes(),p.insertColumn(c,a),o.css("width",parseInt(o.css("width"))+a.width),j.css("width",parseInt(j.css("width"))-a.width-r),k.css("width",parseInt(k.css("width"))-a.width-t),l.css("width",parseInt(l.css("width"))-a.width-t)}if(a.menu&&(a.menu=!0),f.grouping){switch(d){case"left":1===f.leftColumns.length&&f.grouping.softRenderGroupedRows("left");break;case"right":1===f.rightColumns.length&&f.grouping.softRenderGroupedRows("right")}f.grouping.updateGroupRows(),f.grouping.setCellsPosition(c,d)}a.rowEditor&&("left"===d&&c--,f.rowedit.moveEditor(a,c,d,e)),f.summary&&f.summary.insertColumn(c,d),f.header.destroyMenus(),f.leftHeader.destroyMenus(),f.rightHeader.destroyMenus(),f.sorter&&f.sorter.updateSortedHeader()},addColumn:function(a,b,c){var d=this;if(b=b||"center",a.type||(a.type="string"),a.width||(a.width=d.defaultColumnWidth),void 0===c){c=d.getColumns(b).length}d.insertColumn(a,c,b),d.scroller.update()},disableLegend:function(a,b){var c=this;c.columns[a].disabled=c.columns[a].disabled||{},c.columns[a].disabled[b]=!0,c.update()},enableLegend:function(a,b){var c=this;c.columns[a].disabled=c.columns[a].disabled||{},delete c.columns[a].disabled[b],c.update()},fitHeight:function(){var a=this,b=a.store,c=a.panelBodyBorders,d=a.gridBorders,e=b.getLength()*a.cellHeight,f=1,g=a.columns.concat(a.leftColumns||[]).concat(a.rightColumns||[]);Fancy.each(g,function(a){a.grouping&&(f<2&&(f=2),a.filter&&a.filter.header&&f<3&&(f=3)),a.filter&&a.filter.header&&f<2&&(f=2)}),a.getCenterFullWidth()>a.getCenterViewWidth()&&!a.nativeScroller&&!Fancy.isIE&&(e+=a.bottomScrollHeight),a.title&&(e+=a.titleHeight),a.tbar&&(e+=a.tbarHeight||a.barHeight),a.summary&&(e+=a.cellHeight),a.bbar&&(e+=a.bbarHeight||a.barHeight),a.buttons&&(e+=a.buttonsHeight||a.barHeight),a.subTBar&&(e+=a.subTBarHeight||a.barHeight),a.footer&&(e+=a.barHeight),!1!==a.header&&(e+=a.cellHeaderHeight*f),a.grouping&&(e+=a.grouping.groups.length*a.groupRowHeight),a.panel?e+=c[0]+c[2]+d[0]+d[2]:e+=d[0]+d[2],a.setHeight(e)},addFilter:function(a,c,d,e){var f=this,g=f.filter.filters[a],h=!1===f.waitingForFilters;if(b.isFunction(c)&&(d="fn"),d=d||"",void 0===g&&(g={}),b.isDate(c)){var i=this.getColumnByIndex(a).format;g.type="date",g.format=i,c=Number(c)}g[d]=c,f.filter.filters[a]=g,h&&(f.WAIT_FOR_APPLYING_ALL_FILTERS?f.filter.updateStoreFilters(!1):f.filter.updateStoreFilters()),!1!==e&&f.filter.addValuesInColumnFields(a,c,d)},clearFilter:function(a,b,c){var d=this,e=d.store,f=!1===d.waitingForFilters;void 0===a||null===a?(d.filter.filters={},e.filters={}):void 0===b||null===b?e.filters&&e.filters[a]&&(d.filter.filters[a]={},e.filters[a]={}):d.filter&&d.filter.filters&&d.filter.filters[a]&&void 0!==d.filter.filters[a][b]&&(delete d.filter.filters[a][b],delete e.filters[a][b]),d.searching&&void 0===a&&void 0===b&&(d.searching.clearBarField(),d.search(""),d.expander&&d.expander.reSet()),f&&(e.changeDataView(),d.update()),d.filter&&!1!==c&&d.filter.clearColumnsFields(a,b),f&&(d.fire("filter",e.filters),d.setSidesHeight())},updateFilters:function(){var a=this;delete a.waitingForFilters,a.filter.updateStoreFilters()},updateFilter:function(){this.updateFilters()},showLoadMask:function(a){this.loadmask.show(a)},hideLoadMask:function(){this.loadmask.hide()},prevPage:function(){this.paging.prevPage()},nextPage:function(){this.paging.nextPage()},setPage:function(a){a--,a<0&&(a=0),this.paging.setPage(a)},firstPage:function(){this.paging.firstPage()},lastPage:function(){this.paging.lastPage()},setPageSize:function(a){this.paging.setPageSize(a)},getPage:function(){return this.store.showPage+1},getPages:function(){return this.store.pages},getPageSize:function(){return this.store.pageSize},refresh:function(){this.paging.refresh()},scroll:function(a,b,c){var d=this,e=d.scroller;void 0!==b&&b>0&&(b=-b);var f=e.getScrollHeight();a>f&&(a=f,d.nativeScroller&&e.isRightScrollable()&&(a+=17));var g=e.getScrollWidth();Math.abs(b)>g&&(b=-g),!1===e.isBottomScrollable()?b=0:d.nativeScroller&&e.isRightScrollable()&&(b-=17),e.scroll(a,b,c),e.scrollBottomKnob(),e.scrollRightKnob()},getDataFiltered:function(){return this.store.filteredData},reCalcColumnsWidth:function(){var a=this;if(a.hasFlexColumns){var b,c=a.scroller,d=a.getCenterViewWidth(),e=a.columns,f=0,g=0,h=e.length,i=d;for(!1!==a.flexScrollSensitive&&c.isRightScrollable()&&!c.nativeScroller&&(i-=a.bottomScrollHeight);g<h;g++){var j=e[g];j.hidden||(j.flex?f+=j.flex:i-=j.width)}if(0!==f)for(b=i/f,g=0;g<h;g++){var j=e[g];j.hidden||j.flex&&(j.width=Math.floor(j.flex*b),j.minWidth&&j.width<j.minWidth&&(j.width=j.minWidth),j.minWidth&&j.width<j.minWidth?j.width=j.minWidth:j.width<a.minColumnWidth&&(j.width=a.minColumnWidth))}}},getDisplayedData:function(a){var c=this,d=c.getViewTotal(),e=[],f=0,g=c.leftColumns,h=c.columns,i=c.rightColumns;a&&(d=c.getTotal());for(var j=function(a){if(void 0!==a.index&&"$selected"!==a.index&&!a.hidden)switch(a.type){case"order":k.push(f+1);break;default:if(a.render){var b=c.get(f),d=c.get(f,a.index);b&&b.data&&(b=b.data),k.push(a.render({value:d,data:b}).value)}else k.push(c.get(f,a.index))}};f<d;f++){var k=[];b.each(g,j),b.each(h,j),b.each(i,j),e.push(k)}return e},getAllDisplayedData:function(){for(var a=this,c=a.getViewTotal(),d=[],e=0,f=a.leftColumns,g=a.columns,h=a.rightColumns,i=function(b){if(void 0!==b.index&&"$selected"!==b.index&&!b.hidden)switch(b.type){case"order":j.push(e+1);break;default:if(b.render){var c=a.get(e),d=a.get(e,b.index);j.push(b.render({value:d,data:c}).value)}else j.push(a.get(e,b.index))}};e<c;e++){var j=[];b.each(f,i),b.each(g,i),b.each(h,i),d.push(j)}return d},setData:function(a){var b=this,c=b.store;c.setData(a),c.isTree&&c.initTreeData(),b.setSidesHeight()},exportToExcel:function(a){var b=this;b.exporter&&b.exporter.exportToExcel(a)},getDataAsCsv:function(a){var b=this;if(b.exporter)return b.exporter.getDataAsCsv(a)},getDataAsCSV:function(a){return this.getDataAsCsv(a)},exportToCSV:function(a){var b=this;if(b.exporter)return b.exporter.exportToCSV(a)},exportToCsv:function(a){return this.exportToCSV(a)},disableSelection:function(){this.selection.disableSelection()},setParams:function(a){var c=this,d=c.store;d.proxy&&(d.proxy.params=d.proxy.params||{},b.apply(d.proxy.params,a))},setUrl:function(a){var c=this,d=c.store;if(b.isString(a)){if(d.proxy&&d.proxy.api)if("rest"===d.proxy.type)for(var e in d.proxy.api)d.proxy.api[e]=a;else d.proxy.api.read=a}else d.proxy&&d.proxy.api&&b.apply(d.proxy.api,a)},getSideByCell:function(a){var b,c=this;return c.centerEl.within(a)?b="center":c.leftEl.within(a)?b="left":c.rightEl.within(a)&&(b="right"),b},addChild:function(a,c){var d=this,e=d.store;if(void 0===c)a.$deep=1,void 0===a.child&&(a.child=[]),d.add(a);else{b.isNumber(a)&&(a=d.getById(a));var f=!1;!0===a.get("leaf")&&(a.set("leaf",!1),a.set("expanded",!0),a.set("child",[]),f=!0);var g=a.get("$deep"),h=a.get("child"),i=d.getRowById(a.id)+h.length+1;if(c.$deep=g+1,c.parentId=a.id,f){var j=a.get("parentId");if(j){var k=d.getById(j);b.each(k.data.child,function(b){if(b.id===a.id)return b.leaf=!1,b.expanded=!0,b.child=[c],!0})}}h.push(new e.model(c)),a.set("child",h),!0===a.get("expanded")&&d.insert(i,c)}},expand:function(a){var c,d=this;switch(b.typeOf(a)){case"number":case"string":c=d.getById(a)}!0!==c.get("expanded")&&d.tree.expandRow(c)},collapse:function(a){var c,d=this;switch(b.typeOf(a)){case"number":case"string":c=d.getById(a)}!1!==c.get("expanded")&&d.tree.collapseRow(c)},collapseAll:function(){var a=this,c=a.findItem("$deep",1);b.each(c,function(b){a.collapse(b.id)})},expandAll:function(){var a=this,c=a.findItem("expanded",!1);b.each(c,function(b){a.expand(b.id)}),c=a.findItem("expanded",!1),c.length&&a.expandAll()},copy:function(a){var b=this;b.selection&&b.selection.copy(a)},sort:function(a,b){var c,d,e=this,f=e.getColumnByIndex(a),g=e.getColumnOrderByKey(a);if(g.side)if(c=e.getHeader(g.side),d=c.getCell(g.order),b){switch(b=b||"ASC",d=c.getCell(g.order),b=b.toLocaleLowerCase()){case"asc":d.removeCls(p),d.addCls(o);break;case"desc":d.removeCls(o),d.addCls(p);break;case"drop":d.removeCls(o),d.removeCls(p);break;default:throw new Error("[FancyGrid Error]: sorting type is not right - "+b)}e.sorter.sort(b,a,g.side,f,d)}else d.dom.click()},flashRow:function(a){var c=this,d=c.getDomRow(a);b.each(d,function(a){a=b.get(a),a.addCls("fancy-grid-cell-flash")}),setTimeout(function(){b.each(d,function(a){a=b.get(a),a.addCls("fancy-grid-cell-animation")})},200),setTimeout(function(){b.each(d,function(a){a=b.get(a),a.removeCls("fancy-grid-cell-flash"),a.removeCls("fancy-grid-cell-animation")})},700)},flashCell:function(a,b,c,d){var e=this,c=c||"center",f=e.getBody(c),g=700,h=Fancy.isObject(a)?a:f.getCell(a,b);if(d)switch(d.duration&&(g=d.duration),d.type){case"plusminus":d.delta>0?(h.addCls("fancy-grid-cell-flash-plus"),setTimeout(function(){h.removeCls("fancy-grid-cell-flash-plus"),h.removeCls("fancy-grid-cell-animation")},g)):(h.addCls("fancy-grid-cell-flash-minus"),setTimeout(function(){h.removeCls("fancy-grid-cell-flash-minus"),h.removeCls("fancy-grid-cell-animation")},g))}else h.addCls("fancy-grid-cell-flash"),setTimeout(function(){h.removeCls("fancy-grid-cell-flash"),h.removeCls("fancy-grid-cell-animation")},700);setTimeout(function(){h.addCls("fancy-grid-cell-animation")},200)},scrollToRow:function(a){var b=this,c=b.body.getCell(a,0);b.scroller.scrollToCell(c.dom,!1,!0),b.scroller.update(),b.flashRow(a)},getStateSorters:function(){var a=this,c={},d=JSON.parse(localStorage.getItem(a.getStateName()));if(d){if(!d.sorters)return{};var e=JSON.parse(d.sorters);return b.each(e,function(a){c[a.key]=a}),c}},getStateName:function(){var a=this,b=a.id,c=location.host+"-"+location.pathname;return a.stateId?a.stateId:b+c},setWidthFit:function(){var a=this,b=a.panelBodyBorders,c=a.gridWithoutPanelBorders,d=a.gridBorders,e=0,f=!1,g=[].concat(a.leftColumns).concat(a.columns).concat(a.rightColumns);Fancy.each(g,function(a){a.hidden||(e+=a.width),a.locked&&(f=!0)}),a.panel?e+=b[1]+b[3]+d[1]+d[3]:e+=c[1]+c[3]+d[1]+d[3],f&&e--,a.setWidth(e)},setColumnTitle:function(a,b,c){var d,e,f=this,c=c||"center",g=f.getHeader(c),h=g.getColumns();Fancy.isString(a)&&(a=f.getColumnOrderByKey(a).order),e=h[a],e.title=b,d=g.getCell(a),d.select("."+Fancy.GRID_HEADER_CELL_TEXT_CLS).item(0).update(b),f.fire("columntitlechange",{orderIndex:a,index:e.index,value:b,side:c})},clearDirty:function(){var a=this;a.store.clearDirty(),a.body.clearDirty(),a.leftBody.clearDirty(),a.rightBody.clearDirty()},hideBar:function(a){var b,c,d=this;switch(a){case"tbar":b=r;break;case"subtbar":b=s;break;case"bbar":b=t;break;case"buttons":b=u;break;default:throw new Error("FancyGrid Error: bar does not exist")}if(c=d.panel.el.select("."+b),"none"!==c.css("display")){c.hide();var e=parseInt(d.panel.el.css("height"));d.panel.el.css("height",e-d.barHeight)}},showBar:function(a){var b,c,d=this;switch(a){case"tbar":b=r;break;case"subtbar":b=s;break;case"bbar":b=t;break;case"buttons":b=u;break;default:throw new Error("FancyGrid Error: bar does not exist")}if(c=d.panel.el.select("."+b),"none"==c.css("display")){c.show();var e=parseInt(d.panel.el.css("height"));d.panel.el.css("height",e+d.barHeight)}},initResponsiveness:function(){var a=this,c=function(){a.onWindowResize(),a.intWindowResize&&clearInterval(a.intWindowResize),a.intWindowResize=setTimeout(function(){a.onWindowResize(),delete a.intWindowResize,setTimeout(function(){a.onWindowResize()},300)},30)};"ResizeObserver"in window?(setTimeout(function(){var b=new ResizeObserver(c),d=a.el.parent().dom;d&&b.observe(d)},100),b.$(window).bind("resize",c)):b.$(window).bind("resize",c)},getNumOfVisibleCells:function(){var a=this;if(!a.numOfVisibleCells)try{a.numOfVisibleCells=Math.ceil(a.getBodyHeight()/a.cellHeaderHeight)}catch(b){a.numOfVisibleCells=0}return a.numOfVisibleCells},getSideByColumnIndex:function(a){var c,d=this;return b.each(d.columns,function(b){b.index===a&&(c="center")}),b.each(d.leftColumns,function(b){b.index===a&&(c="left")}),b.each(d.rightColumns,function(b){b.index===a&&(c="right")}),c}})}(),Fancy.define(["Fancy.Grid","FancyGrid"],{extend:Fancy.Widget,mixins:["Fancy.grid.mixin.Grid",Fancy.panel.mixin.PrepareConfig,Fancy.panel.mixin.methods,"Fancy.grid.mixin.PrepareConfig","Fancy.grid.mixin.ActionColumn",Fancy.grid.mixin.Edit],plugins:[{type:"grid.updater"},{type:"grid.scroller"},{type:"grid.licence"}],type:"grid",theme:"default",i18n:"en",emptyText:"",prefix:"fancy-grid-",cls:"",widgetCls:Fancy.GRID_CLS,header:!0,shadow:!0,striped:!0,columnLines:!0,rowLines:!0,textSelection:!1,width:200,height:200,minWidth:200,minHeight:200,minColumnWidth:30,defaultColumnWidth:100,emptyValue:"&nbsp;",frame:!0,draggable:!1,activated:!1,multiSort:!1,tabEdit:!0,dirtyEnabled:!0,barScrollEnabled:!0,startResizing:!1,constructor:function(a,b){var c=this;Fancy.isDom(a)?(b=b||{},b.renderTo=a):b=a,b=b||{};var d=function(a){a&&Fancy.apply(b,a),b.id&&(c.id=b.id),c.initId(),b=c.prepareConfig(b,c),Fancy.applyConfig(c,b),c.Super("const",arguments)},e=function(){var a=b.i18n||c.i18n;!0===Fancy.loadLang(a,d)&&d({})};Fancy.modules.grid||Fancy.fullBuilt||!1===Fancy.MODULELOAD||!1===Fancy.MODULESLOAD?e():Fancy.nojQuery?Fancy.loadModule("dom",function(){Fancy.loadModule("grid",function(){e()})}):Fancy.loadModule("grid",function(){e()})},init:function(){var a=this;if(a.addEvents("beforerender","afterrender","render","show","hide","destroy"),a.addEvents("headercellclick","headercellmousemove","headercellmousedown","headercellenter","headercellleave","docmouseup","docclick","docmove","beforeinit","init","columnresize","columnclick","columndblclick","columnenter","columnleave","columnmousedown","columntitlechange","cellclick","celldblclick","cellenter","cellleave","cellmousedown","beforecellmousedown","rowclick","rowdblclick","rowenter","rowleave","rowtrackenter","rowtrackleave","beforecolumndrag","columndrag","columnhide","columnshow","scroll","nativescroll","remove","insert","set","update","beforesort","sort","beforeload","load","servererror","serversuccess","select","selectrow","deselectrow","clearselect","activate","deactivate","beforeedit","startedit","changepage","changepagesize","dropitems","dragrows","collapse","expand","treecollapse","treeexpand","lockcolumn","rightlockcolumn","unlockcolumn","filter","contextmenu","statechange"),Fancy.loadStyle(),!0!==Fancy.fullBuilt&&!1!==Fancy.MODULELOAD&&!1!==Fancy.MODULESLOAD&&!0!==a.fullBuilt&&!0!==a.neededModules&&"datepicker"!==a.wtype&&"monthpicker"!==a.wtype)return void a.loadModules();a.initStore(),a.initPlugins(),a.ons(),a.initDateColumn(),a.fire("beforerender"),a.preRender(),a.render(),a.initElements(),a.initActionColumnHandler(),a.fire("render"),a.fire("afterrender"),a.setSides(),a.setSidesHeight(),a.setColumnsPosition(),a.update(),a.initTextSelection(),a.initTouch(),a.fire("beforeinit"),setTimeout(function(){a.inited=!0,a.fire("init"),a.setBodysHeight()},1)},loadModules:function(){var a=this,b={},c=a.columns||[],d=a.leftColumns||[],e=a.rightColumns||[];Fancy.modules=Fancy.modules||{},Fancy.nojQuery&&(b.dom=!0),Fancy.isTouch&&(b.touch=!0),a.summary&&(b.summary=!0,a.summary.options&&(b.menu=!0)),a.exporter&&(b.exporter=!0,b.excel=!0),a.paging&&(b.paging=!0),(a.filter||a.searching)&&(b.filter=!0),a.data&&a.data.proxy&&(b.edit=!0),a.clicksToEdit&&(b.edit=!0),a.defaults&&a.defaults.editable&&(b.edit=!0),(a.stateful||a.state)&&(b.state=!0),Fancy.isObject(a.data)&&(a.data.proxy&&(b["server-data"]=!0,Fancy.nojQuery&&(b.ajax=!0)),a.data.chart&&(b["chart-integration"]=!0)),a.expander&&(b.expander=!0),a.isGroupedHeader&&(b["grouped-header"]=!0),a.grouping&&(b.grouping=!0),a.summary&&(b.summary=!0),a.exporter&&(b.exporter=!0,b.excel=!0),(a.trackOver||a.columnTrackOver||a.cellTrackOver||a.selection)&&(b.selection=!0),a.contextmenu&&(b.menu=!0),a.infinite&&(b.infinite=!0);var f=function(a){if(a.menu)return b.menu=!0,!0};Fancy.each(a.events,function(a){for(var c in a)"contextmenu"===c&&(b.menu=!0)}),Fancy.each(a.controls,function(a){"contextmenu"===a.event&&(b.menu=!0)}),Fancy.each(a.tbar,f),Fancy.each(a.bbar,f),Fancy.each(a.buttons,f),Fancy.each(a.subTBar,f);var g=c.concat(d).concat(e);Fancy.each(g,function(c){switch(!0===c.draggable&&(b["column-drag"]=!0),!0===c.sortable&&(b.sort=!0),!0===c.editable&&(b.edit=!0),c.menu&&(b.menu=!0),c.filter&&(b.filter=!0),c.type){case"select":a.checkboxRowSelection=!0,b.selection=!0;break;case"combo":c.data&&c.data.proxy&&(b.ajax=!0);break;case"progressbar":case"progressdonut":case"grossloss":case"hbar":b.spark=!0;break;case"tree":b.tree=!0;break;case"date":b.date=!0,b.selection=!0}}),Fancy.isArray(a.tbar)&&Fancy.each(a.tbar,function(a){switch(a.action){case"add":case"remove":b.edit=!0}}),a.gridToGrid&&(b.dd=!0),a.rowDragDrop&&(b.dd=!0),a.neededModules={length:0};for(var h in b)void 0===Fancy.modules[h]&&(a.neededModules[h]=!0,a.neededModules.length++);if(0===a.neededModules.length)return a.neededModules=!0,void a.init();var i=function(b){delete a.neededModules[b],0===--a.neededModules.length&&(a.neededModules=!0,a.init())};if(a.neededModules.dom)Fancy.loadModule("dom",function(b){if(delete a.neededModules[b],0===--a.neededModules.length)a.neededModules=!0,a.init();else for(var c in a.neededModules)"length"!==c&&Fancy.loadModule(c,i)});else for(var h in a.neededModules)"length"!==h&&Fancy.loadModule(h,i)},lockColumn:function(a,b){var c=this;if(1===c.columns.length)return!1;Fancy.isString(a)&&Fancy.each(c.columns,function(b,c){if(b.index===a)return a=c,!0});var d=c.removeColumn(a,b);c.insertColumn(d,c.leftColumns.length,"left"),c.header&&c.leftHeader.reSetCheckBoxes(),c.body.reSetIndexes(),c.leftBody.reSetIndexes(),c.fire("lockcolumn",{column:d}),c.update()},rightLockColumn:function(a,b){var c=this;if(1===c.columns.length)return!1;Fancy.isString(a)&&Fancy.each(c.columns,function(b,c){if(b.index===a)return a=c,!0});var d=c.removeColumn(a,b);c.insertColumn(d,0,"right"),c.body.reSetIndexes(),c.rightBody.reSetIndexes(),c.fire("rightlockcolumn",{column:d}),c.update()},unLockColumn:function(a,b){var c,d=this;switch(void 0===b&&(Fancy.isString(a)?(Fancy.each(d.leftColumns,function(c,d){if(c.index===a)return b="left",a=d,!0}),void 0===b&&Fancy.each(d.rightColumns,function(c,d){if(c.index===a)return b="right",a=d,!0})):b="left"),b){case"left":Fancy.isString(a)&&Fancy.each(d.leftColumns,function(b,c){if(b.index===a)return a=c,!0}),c=d.removeColumn(a,b),d.insertColumn(c,0,"center","left"),0===d.leftColumns.length&&(d.leftEl.addCls(Fancy.GRID_LEFT_EMPTY_CLS),d.centerEl.css("left","0px"));break;case"right":if(Fancy.isString(a)&&Fancy.each(d.rightColumns,function(b,c){if(b.index===a)return a=c,!0}),c=d.removeColumn(a,b),d.insertColumn(c,d.columns.length,"center","right"),0===d.rightColumns.length){d.rightEl.addCls(Fancy.GRID_RIGHT_EMPTY_CLS);var e=parseInt(d.body.el.css("width"));d.body.el.css("width",e+2)}}"left"===b&&d.grouping&&0===d.leftColumns.length&&d.grouping.insertGroupEls(),d.body.reSetIndexes(),d.leftBody.reSetIndexes(),d.rightBody.reSetIndexes(),d.fire("unlockcolumn",{column:c})},moveColumn:function(a,b,c,d,e){var f,g=this;if(e){for(var h=0,i=e.end-e.start+1,j=e.cell.attr("index"),k=g.getHeader(b),l=e.cell.dom.outerHTML;h<i;h++)g.moveColumn(a,b,e.end-h,d);var m=g.getColumns(b),n=k.el.select("."+Fancy.GRID_HEADER_CELL_CLS);for(h=d,i=h+(e.end-e.start+1);h<i;h++){var o=m[h],p=n.item(h);o.grouping=j,p.attr("group-index",j)}return k.el.append(l),void k.fixGroupHeaderSizing()}if("center"===a)switch(f=g.removeColumn(c,"center"),b){case"left":g.insertColumn(f,d,"left","center");break;case"right":g.insertColumn(f,d,"right","center")}else if("left"===a)switch(f=g.removeColumn(c,"left"),b){case"center":g.insertColumn(f,d,"center","left");break;case"right":g.insertColumn(f,d,"right","left")}else if("right"===a)switch(f=g.removeColumn(c,"right"),b){case"center":g.insertColumn(f,d,"center","right");break;case"left":g.insertColumn(f,d,"left","right")}g.groupheader&&(g.header.fixGroupHeaderSizing(),g.leftColumns&&g.leftHeader.fixGroupHeaderSizing(),g.rightColumns&&g.rightHeader.fixGroupHeaderSizing()),g.getHeader(a).reSetCheckBoxes(),g.getHeader(b).reSetCheckBoxes(),g.update()},updateColumnsVisibilty:function(){var a=this;a.columns&&(a.header&&a.header.updateCellsVisibility(),a.body.updateColumnsVisibility()),a.leftColumns&&(a.leftHeader&&a.leftHeader.updateCellsVisibility(),a.leftBody.updateColumnsVisibility()),a.rightColumns&&(a.rightHeader&&a.rightHeader.updateCellsVisibility(),a.rightBody.updateColumnsVisibility())}}),FancyGrid.get=function(a){var b=Fancy.get(a);if(b.dom){var c=b.select("."+Fancy.GRID_CLS).item(0);if(c.dom){var d=c.dom.id;return Fancy.getWidget(d)}}},FancyGrid.defineTheme=Fancy.defineTheme,FancyGrid.defineController=Fancy.defineController,FancyGrid.addValid=Fancy.addValid,!Fancy.nojQuery&&Fancy.$&&(Fancy.$.fn.FancyGrid=function(a){return this.selector?a.renderTo=$(this.selector)[0].id:a.renderTo=this.attr("id"),new Fancy.Grid(a)}),Fancy.define("Fancy.grid.plugin.Updater",{extend:Fancy.Plugin,ptype:"grid.updater",inWidgetName:"updater",constructor:function(a){Fancy.applyConfig(this,a),this.Super("const",arguments)},init:function(){},update:function(a){var b=this.widget;a=a||"",b.leftBody.update(a),b.body.update(a),b.rightBody.update(a)},updateRow:function(a){var b=this.widget;b.leftBody.updateRows(a),b.body.updateRows(a),b.rightBody.updateRows(a)}}),function(){var a=Fancy,b="fancy-scroll-right-inner",c="fancy-scroll-bottom-inner",d="fancy-scroll-top-inner",e="fancy-scroll-right-hover",f="fancy-scroll-bottom-hover",g="fancy-scroll-top-hover",h="fancy-scroll-right-active",i="fancy-scroll-bottom-active",j="fancy-scroll-top-active",k=a.HIDDEN_CLS,l=a.GRID_COLUMN_CLS,m=a.GRID_CENTER_CLS;a.define("Fancy.grid.plugin.Scroller",{extend:a.Plugin,ptype:"grid.scroller",inWidgetName:"scroller",rightKnobDown:!1,bottomKnobDown:!1,minRightKnobHeight:35,minBottomKnobWidth:35,cornerSize:12,scrollLeft:0,scrollTop:0,constructor:function(){this.Super("const",arguments)},init:function(){this.Super("init",arguments),this.ons()},ons:function(){var b=this,c=b.widget,d=a.getMouseWheelEventName();c.once("render",function(){b.render(),c.leftBody.el.on(d,b.onMouseWheel,b),c.nativeScroller&&(c.leftBody.el.on(d,b.onMouseWheelLeft,b),c.rightBody.el.on(d,b.onMouseWheelRight,b)),c.body.el.on(d,b.onMouseWheel,b),c.rightBody.el.on(d,b.onMouseWheel,b),c.once("init",b.onGridInit,b),c.nativeScroller?(c.body.el.on("scroll",b.onNativeScrollBody,b),c.leftBody.el.on("scroll",b.onNativeScrollLeftBody,b),c.rightBody.el.on("scroll",b.onNativeScrollRightBody,b)):(c.panel&&c.panel.on("resize",b.onPanelResize,b),c.body.el.on("scroll",b.onScrollBodyBugFix,b))}),b.on("render",b.onRender,b),c.store.on("change",b.onChangeStore,b)},destroy:function(){var b=this,c=b.widget,d=c.leftBody,e=c.body,f=c.rightBody,g=a.get(document),h=a.getMouseWheelEventName();g.un("mouseup",b.onMouseUpDoc,b),g.un("mousemove",b.onMouseMoveDoc,b),d.el.un(h,b.onMouseWheel,b),e.el.un(h,b.onMouseWheel,b),f.el.un(h,b.onMouseWheel,b),c.nativeScroller||(b.scrollBottomEl.un("mousedown",b.onMouseDownBottomSpin,b),b.scrollRightEl.un("mousedown",b.onMouseDownRightSpin,b)),a.isTouch&&(d.el.un("touchstart",b.onBodyTouchStart,b),d.el.un("touchmove",b.onBodyTouchMove,b),e.el.un("touchstart",b.onBodyTouchStart,b),e.el.un("touchmove",b.onBodyTouchMove,b),f.el.un("touchstart",b.onBodyTouchStart,b),f.el.un("touchmove",b.onBodyTouchMove,b),g.un("touchend",b.onMouseUpDoc,b))},onGridInit:function(){var b=this,c=b.widget,d=c.store,e=a.get(document);b.setScrollBars(),e.on("mouseup",b.onMouseUpDoc,b),e.on("mousemove",b.onMouseMoveDoc,b),c.on("columnresize",b.onColumnResize,b),c.on("lockcolumn",b.onLockColumn,b),c.on("rightlockcolumn",b.onRightLockColumn,b),c.on("unlockcolumn",b.onUnLockColumn,b),d.on("changepages",b.onChangePages,b),c.on("columndrag",b.onColumnDrag,b),setTimeout(function(){b.update()},1)},render:function(){var e=this,f=e.widget,g=f.body,h=a.get(document.createElement("div")),i=a.get(document.createElement("div")),j=a.get(document.createElement("div"));f.nativeScroller?f.el.addCls("fancy-grid-native-scroller"):(h.addCls("fancy-scroll-right"),i.addCls("fancy-scroll-bottom",k),h.update(['<div class="'+b+'"></div>'].join(" ")),h.select("."+b).css("margin-top",f.knobOffSet),i.update(['<div class="'+c+'"></div>'].join(" ")),a.get(g.el.append(h.dom)),e.scrollRightEl=g.el.select(".fancy-scroll-right"),a.get(g.el.append(i.dom)),e.scrollBottomEl=g.el.select(".fancy-scroll-bottom"),f.doubleHorizontalScroll&&(j.addCls("fancy-scroll-top",k),j.update(['<div class="'+d+'"></div>'].join(" ")),a.get(g.el.append(j.dom)),e.scrollTopEl=g.el.select(".fancy-scroll-top"))),e.fire("render")},onMouseWheel:function(b){var c=this,d=c.widget,e=a.getWheelDelta(b.originalEvent||b);0!=c.isRightScrollable()&&(d.stopProp&&b.stopPropagation(),d.nativeScroller||(c.scrollDelta(e)&&b.preventDefault(),c.scrollRightKnob()))},onRender:function(){var b=this,c=b.widget;!0!==c.nativeScroller&&(b.scrollRightEl.hover(function(){!0!==b.bottomKnobDown&&b.scrollRightEl.addCls(e)},function(){b.scrollRightEl.removeCls(e)}),b.scrollBottomEl.hover(function(){!0!==b.rightKnobDown&&b.scrollBottomEl.addCls(f)},function(){b.scrollBottomEl.removeCls(f)}),c.doubleHorizontalScroll&&b.scrollTopEl.hover(function(){!0!==b.bottomKnobDown&&b.scrollTopEl.addCls(g)},function(){!0!==b.bottomKnobDown&&b.scrollTopEl.removeCls(g)}),b.initRightScroll(),b.initBottomScroll()),a.isTouch&&b.initTouch()},initTouch:function(){var b=this,c=b.widget,d=c.leftBody,e=c.body,f=c.rightBody,g=a.get(document);d.el.on("touchstart",b.onBodyTouchStart,b),d.el.on("touchmove",b.onBodyTouchMove,b),e.el.on("touchstart",b.onBodyTouchStart,b),e.el.on("touchmove",b.onBodyTouchMove,b),f.el.on("touchstart",b.onBodyTouchStart,b),f.el.on("touchmove",b.onBodyTouchMove,b),g.on("touchend",b.onMouseUpDoc,b)},onBodyTouchStart:function(a){var b=this,c=b.widget,a=a.originalEvent||a,d=a.changedTouches[0];c.nativeScroller||(b.rightKnobDown=!0,b.bottomKnobDown=!0,b.mouseDownXY={x:d.pageX,y:d.pageY},b.rightKnobTop=parseInt(b.rightKnob.css("margin-top")),b.scrollRightEl.addCls(h),b.bottomKnobLeft=parseInt(b.bottomKnob.css("margin-left")),b.scrollBottomEl.addCls(i),c.doubleHorizontalScroll&&b.scrollTopEl.addCls(j))},onBodyTouchEnd:function(){this.onMouseUpDoc()},onBodyTouchMove:function(a){var b=this,a=a.originalEvent||a,c=a.changedTouches[0],d=!0;if(b.nativeScroller)b.onMouseMoveDoc({pageX:c.pageX,pageY:c.pageY});else{var e=b.scrollLeft,f=b.scrollTop;b.onMouseMoveDoc({pageX:c.pageX,pageY:c.pageY}),d=e!==b.scrollLeft||f!==b.scrollTop}!0===b.rightKnobDown&&d&&a.preventDefault(),!0===b.bottomKnobDown&&d&&a.preventDefault()},initRightScroll:function(){var a=this;a.rightKnob=a.scrollRightEl.select("."+b),a.scrollRightEl.on("mousedown",a.onMouseDownRightSpin,a)},initBottomScroll:function(){var a=this,b=a.widget;a.bottomKnob=a.scrollBottomEl.select("."+c),a.scrollBottomEl.on("mousedown",a.onMouseDownBottomSpin,a),b.doubleHorizontalScroll&&(a.topKnob=a.scrollTopEl.select("."+d),a.scrollTopEl.on("mousedown",a.onMouseDownBottomSpin,a))},onMouseDownRightSpin:function(b){var c=this,d=c.widget;a.isTouch||(Fancy.nojQuery&&(d.panel?d.panel.el.select("."+Fancy.GRID_ANIMATION_CLS).removeCls(Fancy.GRID_ANIMATION_CLS):d.el.removeCls(Fancy.GRID_ANIMATION_CLS)),b.preventDefault(),c.rightKnobDown=!0,c.mouseDownXY={x:b.pageX,y:b.pageY},c.rightKnobTop=parseInt(c.rightKnob.css("margin-top")),c.scrollRightEl.addCls(h))},onMouseDownBottomSpin:function(b){var c=this,e=c.widget,f=a.get(b.target);b.preventDefault(),Fancy.nojQuery&&(e.panel?e.panel.el.select("."+Fancy.GRID_ANIMATION_CLS).removeCls(Fancy.GRID_ANIMATION_CLS):e.el.removeCls(Fancy.GRID_ANIMATION_CLS)),c.bottomKnobDown=!0,c.mouseDownXY={x:b.pageX,y:b.pageY},c.bottomKnobLeft=parseInt(c.bottomKnob.css("margin-left")),c.scrollBottomEl.addCls(i),f.hasClass()&&c.scrollTopEl.addCls(d)},onMouseUpDoc:function(){var a=this,b=a.widget;if(!1===a.rightKnobDown&&!1===a.bottomKnobDown)return void(b.nativeScroller&&Fancy.nojQuery&&b.addCls(Fancy.GRID_ANIMATION_CLS));Fancy.nojQuery&&b.addCls(Fancy.GRID_ANIMATION_CLS),a.scrollRightEl.removeCls(h),a.scrollBottomEl.removeCls(i),a.rightKnobDown=!1,a.bottomKnobDown=!1,b.doubleHorizontalScroll&&(a.scrollTopEl.removeCls(j),a.scrollTopEl.removeCls(g))},onMouseMoveDoc:function(b){var c,d,e,f,g=this,h=g.widget,i=!1,j=!1,k=h.knobOffSet,l=b.pageX,m=b.pageY;g.rightKnobDown&&(a.isTouch?(d=g.mouseDownXY.y-m,e=d+g.rightKnobTop):(d=m-g.mouseDownXY.y,e=d+g.rightKnobTop),e<g.knobOffSet&&(e=g.knobOffSet),g.bodyViewHeight<e+g.rightKnobHeight&&(e=g.bodyViewHeight-g.rightKnobHeight),e<0&&(e=0),i=g.rightScrollScale*e,h.doubleHorizontalScroll&&"none"!==g.scrollBottomEl.css("display")&&e<g.cornerSize&&(e=g.cornerSize),g.rightKnob.css("margin-top",e+k+"px"),g.scroll(i)),g.bottomKnobDown&&(a.isTouch?(c=g.mouseDownXY.x-l,d=g.mouseDownXY.y-m,f=c+g.bottomKnobLeft):(c=l-g.mouseDownXY.x,d=m-g.mouseDownXY.y,f=c+g.bottomKnobLeft),f<1&&(f=1),g.bodyViewWidth-2<f+g.bottomKnobWidth&&(f=g.bodyViewWidth-g.bottomKnobWidth-2),g.bottomScrollScale<0&&f<0&&(f=0,g.bottomScrollScale=0),g.bottomKnob.css("margin-left",f+"px"),j=Math.ceil(g.bottomScrollScale*(f-1)),h.doubleHorizontalScroll&&g.topKnob.css("margin-left",f+"px"),g.scroll(!1,j))},setScrollBars:function(a){var b=this,c=b.widget;c.rowheight&&void 0===a||(setTimeout(function(){b.checkRightScroll(a)},1),b.checkBottomScroll()||b.scrollTop&&!c.infinite&&c.scroll(!1,0),c.nativeScroller||(b.checkCorner(),b.setRightKnobSize(a),b.setBottomKnobSize()))},checkRightScroll:function(a){var b=this,c=b.widget,d=c.body,e=c.gridBorders,f=c.getBodyHeight(),g=(a||c.getCellsViewHeight())-e[0]-e[2];c.nativeScroller?f>=g?d.el.css("overflow-y","hidden"):d.el.css("overflow-y","scroll"):f>=g?b.scrollRightEl.addCls(k):b.scrollRightEl.removeCls(k)},isRightScrollable:function(){var a=this.widget;return a.nativeScroller?"scroll"===a.body.el.css("overflow-y"):!this.scrollRightEl.hasCls(k)},isBottomScrollable:function(){var a=this.widget;return a.nativeScroller?"scroll"===a.body.el.css("overflow-x"):!this.scrollBottomEl.hasCls(k)},setRightKnobSize:function(b){var c=this,d=c.widget;if(!d.nativeScroller){var e=d.getBodyHeight()-(c.corner?c.cornerSize:0)-2,f=(b||d.getCellsViewHeight())-(c.corner?c.cornerSize:0),g=f-e,h=100-g/(e/100),i=e*(h/100),j=d.knobOffSet;i<c.minRightKnobHeight&&(i=c.minRightKnobHeight,d.doubleHorizontalScroll&&(i+=c.minRightKnobHeight)),!1===c.corner&&(e-=j),c.rightKnob.stop(),c.rightKnob.animate({height:i},a.ANIMATE_DURATION),c.rightKnobHeight=i,c.bodyViewHeight=e,c.rightScrollScale=(f-e)/(e-i)}},checkBottomScroll:function(){var a,b=this,c=b.widget,d=c.body,e=c.getCenterViewWidth(),f=c.getCenterFullWidth()-2;return c.nativeScroller?e>f?(a=!1,d.el.css("overflow-x","hidden")):(a=!0,d.el.css("overflow-x","scroll")):e>f?(a=!1,b.scrollBottomEl.addCls(k),c.doubleHorizontalScroll&&b.scrollTopEl.addCls(k)):(a=!0,b.scrollBottomEl.removeCls(k),c.doubleHorizontalScroll&&b.scrollTopEl.removeCls(k)),a},checkCorner:function(){var a=this;a.widget.nativeScroller||(a.corner=!a.scrollRightEl.hasCls(k)&&!a.scrollBottomEl.hasCls(k))},setBottomKnobSize:function(){var b=this,c=b.widget;if(!c.nativeScroller){var d=c.getCenterViewWidth()-(b.corner?b.cornerSize:0),e=c.getCenterFullWidth()-(b.corner?b.cornerSize:0),f=e-d,g=100-f/(e/100),h=d*(g/100)-2;h<b.minBottomKnobWidth&&(h=b.minBottomKnobWidth),b.bottomKnob.stop(),b.bottomKnob.animate({width:h},a.ANIMATE_DURATION),c.doubleHorizontalScroll&&(b.topKnob.stop(),b.topKnob.animate({width:h},a.ANIMATE_DURATION)),b.bottomKnobWidth=h,b.bodyViewWidth=d,b.bottomScrollScale=(d-e)/(d-h-2-1)}},scroll:function(a,b,c){var d,e=this,f=e.widget;if(b>0&&(b=0),f.nativeScroller)return null!==a&&void 0!==a&&(f.body.el.dom.scrollTop=a),null!==b&&void 0!==b&&(f.body.el.dom.scrollLeft=Math.abs(b),f.header&&f.header.scroll(b,!0)),void f.fire("scroll");f.leftBody.scroll(a),d=f.body.scroll(a,b,c),f.rightBody.scroll(a),void 0!==d.scrollTop&&(e.scrollTop=Math.abs(d.scrollTop)),void 0!==d.scrollLeft&&(e.scrollLeft=Math.abs(d.scrollLeft)),f.fire("scroll")},scrollDelta:function(a){var b,c=this,d=c.widget;if(d.leftBody.wheelScroll(a),b=d.body.wheelScroll(a),d.rightBody.wheelScroll(a),void 0!==b)return c.scrollTop=Math.abs(b.newScroll),d.fire("scroll"),b.scrolled},scrollRightKnob:function(){var a=this,b=a.widget,c=a.getScroll(),d=c/a.rightScrollScale+b.knobOffSet;a.rightKnob&&(b.doubleHorizontalScroll&&(d+=a.cornerSize),b.infinite||a.rightKnob.css("margin-top",d+"px"))},scrollBottomKnob:function(){var a=this,b=a.widget,c=a.getBottomScroll(),d=c/a.bottomScrollScale+b.knobOffSet;0===c&&(d=-1),a.bottomKnob&&(a.bottomKnob.css("margin-left",-d+"px"),b.doubleHorizontalScroll&&a.topKnob.css("margin-left",-d+"px"))},getScroll:function(){var a=this,b=a.widget;return b.nativeScroller?b.body.el.dom.scrollTop:Math.abs(parseInt(b.body.el.select("."+l).item(0).css("top")))},getBottomScroll:function(){var a=this,b=a.widget;return b.nativeScroller?b.body.el.dom.scrollLeft:Math.abs(parseInt(b.body.el.select("."+l).item(0).css("left")))},update:function(a){var b=this,c=b.widget;b.setScrollBars(a),b.checkScroll(a),c.infinite||b.scrollRightKnob(),b.scrollBottomKnob()},onChangeStore:function(){this.update()},onColumnResize:function(){var a=this;a.setScrollBars(),setTimeout(function(){a.setScrollBars()},Fancy.ANIMATE_DURATION+20)},getScrollHeight:function(){var a=this,b=a.widget,c=b.getBodyHeight()-(a.corner?a.cornerSize:0),d=b.getCellsViewHeight()-(a.corner?a.cornerSize:0);return c>d?c:d-c},getScrollWidth:function(){var a=this,b=a.widget,c=b.getCenterViewWidth()-(a.corner?a.cornerSize:0),d=b.getCenterFullWidth()-(a.corner?a.cornerSize:0);return c>d?c:d-c},checkScroll:function(b){var c=this,d=c.widget,e=c.getScroll(),f=d.getBodyHeight()-(c.corner?c.cornerSize:0),g=(b||d.getCellsViewHeight())-(c.corner?c.cornerSize:0),h=d.getCenterFullWidth(),i=d.getCenterViewWidth();if(h<c.scrollLeft+i)return void setTimeout(function(){var a=h-(c.scrollLeft+i);c.scrollLeft+a<0?d.scroll(c.scrollTop,0,!0):d.scroll(c.scrollTop,c.scrollLeft+a,!0)},a.nojQuery?10:a.ANIMATE_DURATION);e&&g<f&&(c.scroll(0),d.nativeScroller||c.scrollRightKnob())},scrollToCell:function(b,c,d){if(void 0!==b){var e=this,f=e.widget,g=f.cellHeight,h=a.get(b),i=h.parent(),j=Number(h.attr("index")),k=Number(i.attr("index")),l=e.getScroll(),n=g*(j+1),o=f.getBodyHeight(),p=e.getBottomScroll(),q=f.getSideByCell(b),r=f.getColumnsWidth(q),s=parseInt(f.body.el.css("width")),t=0,u=i.parent().parent().hasCls(m);if(!f.nativeScroller||c){if(0===j&&0===k)return 0===e.scrollLeft||"row"!==f.selModel&&"rows"!==f.selModel?e.scroll(0,0):e.scroll(0),e.scrollBottomKnob(),void e.scrollRightKnob();if(f.grouping&&(n+=f.grouping.getSpecialRowsAbove(j)*f.groupRowHeight),f.expander&&(n+=f.expander.getBeforeHeight(j)),d){var v=f.getCellsViewHeight();l=n-g,v-l<o&&(l-=Math.abs(v-l-o)),e.scroll(l)}else n-l>o?(l=n-o+5,e.scroll(l)):n-l<f.cellHeight&&(l-=g,l<0&&(l=0),e.scroll(l));if(u){for(var w=f.columns,x=0;x<=k;x++)t+=w[x].width;t-p>s?w[x]?e.scroll(l,-(p+(t-p)-s)):e.scroll(l,-(r-s)):t-p<w[k].width?(p=-(t-w[k].width),p>0&&(p=0),e.scroll(l,p)):0!==p&&0===k&&e.scroll(l,0),e.scrollBottomKnob()}e.scrollRightKnob()}}},onNativeScrollBody:function(){var a=this,b=a.widget,c=b.body.el.dom.scrollTop,d=b.body.el.dom.scrollLeft;b.header&&b.header.scroll(-d),b.leftBody&&(b.leftBody.el.dom.scrollTop=c),b.rightBody&&(b.rightBody.el.dom.scrollTop=c),b.leftColumns.length&&b.leftBody.el.dom.scrollTop!==b.body.el.dom.scrollTop?b.body.el.dom.scrollTop=b.leftBody.el.dom.scrollTop:b.rightColumns.length&&b.rightBody.el.dom.scrollTop!==b.body.el.dom.scrollTop&&(b.body.el.dom.scrollTop=b.rightBody.el.dom.scrollTop),Fancy.nojQuery&&(b.panel?b.panel.el.select("."+Fancy.GRID_ANIMATION_CLS).removeCls(Fancy.GRID_ANIMATION_CLS):b.el.removeCls(Fancy.GRID_ANIMATION_CLS)),b.fire("nativescroll")},onNativeScrollLeftBody:function(){var a=this.widget;a.leftBody.el.dom.scrollTop!==a.body.el.dom.scrollTop&&this.onNativeScrollBody()},onNativeScrollRightBody:function(){var a=this.widget;a.rightBody.el.dom.scrollTop!==a.body.el.dom.scrollTop&&this.onNativeScrollBody()},onMouseWheelLeft:function(b){var c=this.widget,d=a.getWheelDelta(b.originalEvent||b),e=d*c.cellHeight;c.leftBody.el.dom.scrollTop-=e,c.body.el.dom.scrollTop-=e,c.rightBody.el.dom.scrollTop-=e},onMouseWheelRight:function(b){var c=this.widget,d=a.getWheelDelta(b.originalEvent||b),e=d*c.cellHeight;c.leftBody.el.dom.scrollTop-=e,c.body.el.dom.scrollTop-=e,c.rightBody.el.dom.scrollTop-=e},onLockColumn:function(){var b=this;b.update(),b.widget.setColumnsPosition(),setTimeout(function(){b.update(),b.widget.setColumnsPosition()},a.ANIMATE_DURATION)},onColumnDrag:function(b,c){var d=this;d.widget,a.nojQuery&&setTimeout(function(){d.update()},a.ANIMATE_DURATION)},onRightLockColumn:function(){var b=this;b.update(),b.widget.setColumnsPosition(),setTimeout(function(){b.update(),b.widget.setColumnsPosition()},a.ANIMATE_DURATION)},onUnLockColumn:function(){var b=this;b.update(),b.widget.setColumnsPosition(),setTimeout(function(){b.update(),b.widget.setColumnsPosition()},a.ANIMATE_DURATION)},onPanelResize:function(){this.widget.scroll(0,0)},onChangePages:function(){var a=this;!a.widget.nativeScroller&&a.scrollTop&&setTimeout(function(){a.scrollDelta(0)},1)},onScrollBodyBugFix:function(){var a=this,b=a.widget,c=b.body,d=c.el.dom.scrollLeft;c.el.dom.scrollLeft=a.scrollLeft,b.scroll(a.scrollTop,-a.scrollLeft-d)}})}(),function(){var a=Fancy,b=a.GRID_COLUMN_SORT_ASC,c=a.GRID_COLUMN_SORT_DESC,d=a.GRID_COLUMN_RESIZER_CLS,e=a.FIELD_CLS,f=a.GRID_CENTER_CLS,g=a.GRID_LEFT_CLS,h=a.GRID_RIGHT_CLS;a.define("Fancy.grid.plugin.Sorter",{extend:a.Plugin,ptype:"grid.sorter",inWidgetName:"sorter",constructor:function(){this.Super("const",arguments)},init:function(){this.Super("init",arguments),this.ons()},ons:function(){var a=this;a.widget.once("render",function(){a.onsHeaders()})},onsHeaders:function(){var a=this;a.widget.on("headercellclick",a.onHeaderCellClick,a)},onHeaderCellClick:function(f,g){var h,i,j,k,l=this,m=l.widget,n=m.columndrag,o=a.get(g.cell),p=g.side,q=g.index,r=g.e,s=r.target;if((!n||"dragging"!==n.status)&&"input"!==s.tagName.toLocaleLowerCase()){var t=o.select("."+e);t.length>0&&!0===t.item(0).within(s)||o.hasCls(d)||m.startResizing||(i=m.getColumns(p),h=o.hasCls(b)?"desc":o.hasCls(c)?m.multiSort?"asc":"drop":"asc",j=i[q],k=j.index,!1!==j.headerClickSort&&l.sort(h,k,p,j,o))}},sort:function(d,e,f,g,h){var i,j=this,k=j.widget,l=k.store,m=k.getColumns(f),n=0,o=m.length,p=k.getHeader(f);if(k.sorting=!0,!g||!h)for(;n<o;n++)if(m[n].index===e){g=m[n],h=p.getCell(n);break}if(!0===g.sortable){switch(k.multiSort?j.clearHeaderMultiSortCls(d,h):j.clearHeaderSortCls(),d){case"asc":h.addCls(b);break;case"desc":h.addCls(c)}i=g.type;var q,r;if(g.format)if(a.isString(g.format))switch(g.format){case"date":q=k.lang.date.read,g.format.mode&&(r=g.format.mode)}else switch(g.type){case"date":q=g.format.read,g.format.mode&&(r=g.format.mode)}k.grouping&&l.remoteSort&&l.once("load",function(){k.grouping.reGroup()}),l.sort(d,i,e,{smartIndexFn:g.smartIndexFn,format:q,mode:r,sorter:g.sorter}),delete k.sorting}},clearHeaderMultiSortCls:function(a,d){var e,i,j=this,k=j.widget,l=k.store;switch(a.toLocaleUpperCase()){case"ASC":d.removeCls(c);break;case"DESC":d.removeCls(b)}if(e=k.el.select("."+b),i=k.el.select("."+c),!(e.length+i.length<l.multiSortLimit)){for(var m,n=0,o=e.length;n<o;n++){var p,q,r,s=e.item(n),t=s.parent().parent(),u=s.attr("index");t.hasCls(f)?p="center":t.hasCls(g)?p="left":t.hasCls(h)&&(p="right"),q=k.getColumns(p),r=q[u].index;var v=l.sorters[0];v.key===r&&(m=s)}for(var n=0,o=i.length;n<o;n++){var p,q,r,s=i.item(n),t=s.parent().parent(),u=s.attr("index");t.hasCls(f)?p="center":t.hasCls(g)?p="left":t.hasCls(h)&&(p="right"),q=k.getColumns(p),r=q[u].index;var v=l.sorters[0];v.key===r&&(m=s)}m.removeCls(b),m.removeCls(c)}},clearHeaderSortCls:function(){var a=this.widget.el;a.select("."+b).removeCls(b),a.select("."+c).removeCls(c)},updateSortedHeader:function(){var d,e=this,f=e.widget,g=f.store;e.clearHeaderSortCls(),a.each(g.sorters,function(a,e){var g=f.getColumnOrderByKey(a.key),h="ASC"===a.dir?b:c;if(g.side){d=f.getHeader(g.side);var i=d.getCell(g.order);i&&i.addCls(h)}})}})}(),Fancy.define("Fancy.grid.plugin.Paging",{extend:Fancy.Plugin,ptype:"grid.paging",inWidgetName:"paging",barType:"bbar",constructor:function(){this.Super("const",arguments)},init:function(){this.Super("init",arguments),this.ons()},ons:function(){var a=this,b=a.widget,c=b.store;c.on("change",a.onChangeStore,a),c.on("remove",a.onChangeStore,a),c.on("filter",a.onChangeStore,a),b.on("render",a.onRenderGrid,a),b.on("docmove",a.onDocMouseMove,a)},setPageSize:function(a){this.widget.store.setPageSize(a)},nextPage:function(){this.widget.store.nextPage()},lastPage:function(){this.widget.store.lastPage()},prevPage:function(){this.widget.store.prevPage()},firstPage:function(){this.widget.store.firstPage()},onChangeStore:function(a){var b,c=this,d=c.widget,e=d.store,f=d.panel;switch(c.barType){case"both":b=f._bbar.roles.pagenumber,b.setValue(e.showPage+1),b=f._tbar.roles.pagenumber,b.setValue(e.showPage+1),c.updateBar("tbar"),c.updateBar("bbar");break;case"none":case!1:break;default:b=f["_"+c.barType].roles.pagenumber,b.setValue(e.showPage+1),c.updateBar()}d.setSidesHeight(),void 0===c.$prevPage?d.fire("changepage",a.showPage):c.$prevPage!==a.showPage&&d.fire("changepage",a.showPage),c.$prevPage=a.showPage},setPage:function(a){var b=this,c=b.widget,d=c.store;return a<0?a=0:a>d.pages&&(a=d.pages),d.setPage(a),a},refresh:function(){var a=this,b=a.widget,c=b.store;b.showLoadMask(),setTimeout(function(){c.refresh(),"server"!==c.pageType&&b.hideLoadMask()},200)},updateBar:function(a){var b=this,c=b.widget,d=c.store,e=d.showPage,f=d.pageSize,g=d.pages,h=c.panel,a=a||b.barType,i=h["_"+a],j=i.roles,k=j.pagenumber,l=j.ofText,m=j.info,n=j.first,o=j.prev,p=j.next,q=j.last,r=e*f+1,s=r+f-1,t=d.getTotal()||0,u=c.lang;s>t&&(s=t),0===s&&(r=0),r>s&&(s=r),k.setValue(d.showPage+1),l.el.update(Fancy.String.format(u.paging.of,[g||1])),m.el.update(Fancy.String.format(u.paging.info,[r,s,t])),0===e?(n.disable(),o.disable()):(n.enable(),o.enable()),g-1===e||0===g?(q.disable(),p.disable()):(q.enable(),p.enable()),parseInt(c.el.css("width"))<350&&(m.hide(),i.checkScroll())},onRenderGrid:function(){var a=this;switch(a.barType){case"both":a.updateBar("tbar"),a.updateBar("bbar");break;case"none":case!1:break;default:a.updateBar()}},onDocMouseMove:function(){var a=this,b=a.widget;"none"===b.el.css("display")||b.panel&&b.panel.el&&"none"===b.panel.el.css("display")?a.wasHidden||(Fancy.combo.Manager.hideLists(),a.wasHidden=!0):a.wasHidden=!1},update:function(){var a=this,b=a.widget,c=b.store;c.calcPages(),a.onChangeStore(c)}}),Fancy.define("Fancy.grid.plugin.LoadMask",{extend:Fancy.Plugin,ptype:"grid.loadmask",inWidgetName:"loadmask",cls:"fancy-loadmask",innerCls:"fancy-loadmask-inner",imageCls:"fancy-loadmask-image",textCls:"fancy-loadmask-text",constructor:function(){this.Super("const",arguments)},init:function(){this.Super("init",arguments),this.ons()},ons:function(){var a=this,b=a.widget,c=b.store;b.once("render",function(){a.render(),c.loading&&a.onBeforeLoad(),b.on("beforeload",a.onBeforeLoad,a),b.on("load",a.onLoad,a)})},render:function(){var a,b,c=this,d=c.widget,e=d.el,f=e,g=Fancy.get(document.createElement("div")),h=d.lang;d.panel&&(f=d.panel.el),a=f.width(),b=f.height(),g.addCls(c.cls),"default"!==d.theme&&g.addCls("fancy-theme-"+d.theme),g.css({width:a,height:b,opacity:0}),g.update(['<div class="'+c.innerCls+'"><div class="'+c.imageCls+'"></div><div class="'+c.textCls+'">'+h.loadingText+"</div></div>"].join(" ")),c.el=Fancy.get(f.dom.appendChild(g.dom)),c.innerEl=c.el.select("."+c.innerCls),c.textEl=c.el.select("."+c.textCls);var i=c.innerEl.width(),j=c.innerEl.height();c.innerEl.css({left:a/2-i/2,top:b/2-j/2}),!0!==d.store.loading?g.css("display","none"):g.css("display","block")},onBeforeLoad:function(){this.show()},onLoad:function(){this.hide()},show:function(a){var b=this,c=b.el,d=b.widget,e=d.lang;if(c.stop(),c.css("opacity",1),b.el.css("display","block"),b.updateSize(),a)return b.textEl.update(a),void b.el.css("display","block");b.loaded=!1,setTimeout(function(){!0!==b.loaded&&(b.textEl.update(e.loadingText),b.el.css("display","block"))},50)},hide:function(){var a=this,b=a.el;b.stop(),b.css("opacity",1),b.animate({opacity:0,force:!0},{complete:function(){a.loaded=!0,b.css("display","none")}})},updateSize:function(){var a=this,b=a.widget,c=b.getWidth(),d=b.getHeight();a.el.css({height:d,width:c});var e=Math.abs(a.innerEl.width()),f=Math.abs(a.innerEl.height()),g=c/2-e/2,h=d/2-f/2;a.innerEl.css({left:g,top:h})}}),function(){var a=Fancy,b=a.get,c=a.FIELD_CLS,d=a.GRID_RESIZER_LEFT_CLS,e=a.GRID_RESIZER_RIGHT_CLS,f=a.GRID_HEADER_CELL_TRIGGER_CLS,g=a.GRID_HEADER_CELL_TRIGGER_IMAGE_CLS,h=a.GRID_HEADER_CELL_CLS,i=a.GRID_COLUMN_RESIZER_CLS,j=a.GRID_COLUMN_CLS,k=a.GRID_HEADER_CELL_GROUP_LEVEL_2_CLS,l=a.GRID_STATE_RESIZE_COLUMN_CLS,m=a.ANIMATE_DURATION;a.define("Fancy.grid.plugin.ColumnResizer",{extend:a.Plugin,ptype:"grid.columnresizer",inWidgetName:"columnresizer",constructor:function(){this.Super("const",arguments)},init:function(){var a=this,b=a.widget;a.Super("init",arguments),b.header&&b.on("render",function(){a.render(),a.ons()})},ons:function(){var a=this,b=a.widget;b.on("headercellmousemove",a.onCellMouseMove,a),b.on("headercellmousedown",a.onHeaderCellMouseDown,a),b.on("docclick",a.onDocClick,a),b.on("docmove",a.onDocMove,a),b.on("docmouseup",a.onDocMouseUp,a)},onCellMouseMove:function(a,d){var e=this,h=e.widget,i=d.e,j=b(d.cell),k=i.offsetX,l=j.width(),m=b(i.target),n=m.hasCls(f),o=m.hasCls(g),p=j.select("."+f).item(0),q=j.select("."+g).item(0),r=b(i.target).closest("."+c).hasCls(c),s=parseInt(p.css("width")),t=parseInt(q.css("width")),u=l,v=7;if(n&&(u=s),o&&(u=t),!h.startResizing){if(o)return void e.removeCellResizeCls(d.cell);if("left"===d.side&&d.index===h.leftColumns.length-1&&u-k<v+2&&(v+=2),!n&&!o&&"right"===d.side&&0===d.index&&k<v)e.isColumnResizable(d)&&(r||e.addCellResizeCls(d.cell));else if(!n&&!o&&k<v&&"center"===d.side&&0===d.index&&h.leftColumns.length)d.side="left",d.index=h.leftColumns.length-1,e.isColumnResizable(d)&&(r||e.addCellResizeCls(d.cell));else if(n||o||!(u-k<v||k<v)||0===d.index)u-k<v?o?t-k>2?e.removeCellResizeCls(d.cell):e.addCellResizeCls(d.cell):e.isColumnResizable(d)&&e.addCellResizeCls(d.cell):e.removeCellResizeCls(d.cell);else{var w=k<v;e.isColumnResizable(d,w)&&(r||e.addCellResizeCls(d.cell))}}},addCellResizeCls:function(a){var c=this,d=c.widget,e=d.columndrag;e&&"dragging"===e.status||(b(a).addCls(i),b(a).select("."+f).addCls(i))},removeCellResizeCls:function(a){b(a).removeClass(i),b(a).select("."+f).item(0).removeClass(i)},onHeaderCellMouseDown:function(d,e){var h=this,i=h.widget,d=e.e,j=b(d.target),k=b(e.cell),l=d.offsetX,m=k.width(),n=k.select("."+c),o=j.hasCls(f),p=j.hasCls(g),q=k.select("."+f).item(0),r=k.select("."+g).item(0),s=parseInt(q.css("width")),t=parseInt(r.css("width")),u=m,v=7;if(o&&(u=s),p)return void(u=t);n.length>0&&n.item(0).within(j.dom)||("left"===e.side&&e.index===i.leftColumns.length-1&&u-l<v+2&&(v+=2),!o&&!p&&"right"===e.side&&0===e.index&&l<v?(i.startResizing=!0,a.apply(h,{cell:e.cell,activeSide:e.side,clientX:d.clientX,columnIndex:e.index,moveLeftResizer:!0})):l<7&&"center"===e.side&&0===e.index&&i.leftColumns.length?(i.startResizing=!0,e.side="left",e.index=i.leftColumns.length-1,a.apply(h,{cell:h.getCell(e),activeSide:e.side,clientX:d.clientX,columnIndex:e.index})):!o&&!p&&l<v&&0!==e.index?(i.startResizing=!0,a.apply(h,{cell:h.getPrevCell(e),activeSide:e.side,clientX:d.clientX,columnIndex:e.index-1})):u-l<v&&(i.startResizing=!0,a.apply(h,{cell:e.cell,activeSide:e.side,clientX:d.clientX,columnIndex:e.index})),i.startResizing&&h.isColumnResizable())},isColumnResizable:function(a,b){var c,d,e,f=this,g=f.widget;if(a){if(c=g.getColumns(a.side),e=a.index,b&&(e--,d=c[e],e>0&&c[e].hidden&&e--),isNaN(e))return;return d=c[e],!(0===e&&d.hidden&&("center"!==a.side||!g.leftColumns))&&(!d.hidden&&!0===d.resizable)}c=g.getColumns(f.activeSide),!0!==c[f.columnIndex].resizable&&(g.startResizing=!1,delete f.cell,delete f.activeSide,delete f.clientX,delete f.columnIndex)},getMinColumnWidth:function(){var a,b,c=this,d=c.widget,e=d.minCellWidth;return void 0===c.columnIndex?e:(a=d.getColumns(c.activeSide),b=a[c.columnIndex],b.minWidth?b.minWidth:e)},getMaxColumnWidth:function(){var a,b,c=this,d=c.widget;return void 0!==c.columnIndex&&(a=d.getColumns(c.activeSide),b=a[c.columnIndex],!!b.maxWidth&&b.maxWidth)},onDocClick:function(){this.widget.startResizing=!1},onDocMove:function(a,b){this.widget.startResizing&&this.moveResizeEls(b)},render:function(){var a=this,c=a.widget,f=b(document.createElement("div")),g=b(document.createElement("div"));f.addCls(d),g.addCls(e),a.leftEl=b(c.el.dom.appendChild(f.dom)),a.rightEl=b(c.el.dom.appendChild(g.dom))},moveResizeEls:function(c){var d=this,e=d.widget,f=b(d.cell),g=parseInt(f.css("left")),h=d.getMinColumnWidth(),i=d.getMaxColumnWidth();switch(e.header.hideMenu&&e.header.hideMenu(),e.el.addCls(l),a.get(document.body).addCls(l),d.activeSide){case"left":break;case"center":g+=parseInt(e.leftEl.css("width"));break;case"right":g+=parseInt(e.leftEl.css("width")),g+=parseInt(e.centerEl.css("width"))}var j=c.clientX,k=j-d.clientX,m=f.width()+k;m<h&&(m=h),i&&m>i&&(m=i),d.deltaWidth=f.width()-m,d.moveLeftResizer?(k=j-d.clientX,m=f.width()-k,m<h&&(m=h),d.deltaWidth=f.width()-m,d.leftEl.css({display:"block",left:g+k+"px"}),d.rightEl.css({display:"block",left:g+f.width()-1+"px"})):(d.leftEl.css({display:"block",left:g+"px"}),d.rightEl.css({display:"block",left:g+m+"px"})),d.cellWidth=m},onDocMouseUp:function(){var b=this,c=b.widget;!1!==c.startResizing&&(c.el.removeCls(l),a.get(document.body).removeCls(l),b.leftEl.css({display:"none"}),b.rightEl.css({display:"none"}),b.fixSidesWidth(),c.startResizing=!1,b.moveLeftResizer=!1,delete b.cellWidth,c.scroller.update())},fixSidesWidth:function(){var c,d,e,f,g=this,i=g.widget,l=g.cellWidth,n=g.columnIndex,o=g.deltaWidth,p=i.leftEl,q=i.centerEl,r=i.rightEl,s=i.leftHeader.el,t=i.header.el,u=i.rightHeader.el,v=i.body.el,w={},x={},y=g.minCenterWidth;if(void 0!==l){var z=1;switch(a.nojQuery&&(z=0),g.activeSide){case"left":if((f=parseInt(q.css("width"))+o+z)<y)return;e=i.leftColumns[n],i.leftColumns[g.columnIndex].width=l,c=i.leftBody.el.select("."+j),d=i.leftHeader.el.select("."+h);var A=c.item(n);A.animate({width:l},m),A.css("overflow","");for(var B=g.columnIndex+1,C=d.length,D=0,E=B;D<E;D++){var F=d.item(D),G=F.attr("group-index");G&&(x[G]=!0)}for(;B<C;B++){var H=c.item(B),F=d.item(B);H.animate({left:parseInt(H.css("left"))-o-z},m),F.hasCls(k)&&x[F.attr("index")]||F.animate({left:parseInt(F.css("left"))-o-z},m)}p.animate({width:parseInt(p.css("width"))-o-z},m),s.animate({width:parseInt(s.css("width"))-o-z+"px"},m),i.columns.length&&(q.animate({left:parseInt(q.css("left"))-o-z,width:f},m),t.animate({width:parseInt(t.css("width"))+o+z},m),v.animate({width:parseInt(v.css("width"))+o+z},m));break;case"center":e=i.columns[n],i.columns[g.columnIndex].width=l,c=i.body.el.select("."+j),d=i.header.el.select("."+h);var A=c.item(n);A.animate({width:l},m),A.css("overflow","");for(var B=g.columnIndex+1,C=d.length,D=0,E=B;D<E;D++){var F=d.item(D),G=F.attr("group-index");G&&(x[G]=!0)}for(;B<C;B++){var H=c.item(B),F=d.item(B),I=parseInt(H.css("left"))-o-z,J=parseInt(F.css("left"))-o-z;F.attr("group-index")&&(w[F.attr("group-index")]={}),H.animate({left:I},m),F.hasCls(k)&&x[F.attr("index")]||F.animate({left:J},m)}break;case"right":if((f=parseInt(q.css("width"))+o+z)<y)return;e=i.rightColumns[n],i.rightColumns[g.columnIndex].width=l,c=i.rightBody.el.select("."+j),d=i.rightHeader.el.select("."+h);var A=c.item(n);A.animate({width:l+"px"},m),A.css("overflow","");for(var B=g.columnIndex+1,C=d.length,D=0,E=B;D<E;D++){var F=d.item(D),G=F.attr("group-index");G&&(x[G]=!0)}for(;B<C;B++){var H=c.item(B),F=d.item(B);H.animate({left:parseInt(H.css("left"))-o-z},m),F.hasCls(k)&&x[F.attr("index")]||F.animate({left:parseInt(F.css("left"))-o-z},m)}r.animate({width:parseInt(r.css("width"))-o-z},m),u.animate({width:parseInt(u.css("width"))-o-z+"px"},m),i.columns.length&&(q.animate({width:f},m),t.animate({width:parseInt(t.css("width"))+o+z},m),v.animate({width:parseInt(v.css("width"))+o+z},m))}var K,L=b(g.cell),M=L.attr("group-index");if(L.animate({width:l+"px"},m),M)K=i.el.select("[index='"+M+"']"),K.animate({width:parseInt(K.css("width"))-o-z},m);else for(var N in w)K=i.el.select("[index='"+N+"']"),K.css("left",parseInt(K.css("left"))-(w[N].delta||0)-z);if(i.fire("columnresize",{cell:L.dom,width:l,column:e,side:g.activeSide}),/sparkline/.test(e.type))switch(g.activeSide){case"left":i.leftBody.updateRows(void 0,n);break;case"center":i.body.updateRows(void 0,n);break;case"right":i.rightBody.updateRows(void 0,n)}else switch(e.type){case"progressbar":case"hbar":i.update()}}},getPrevCell:function(b){var c,d=this,e=d.widget;switch(b.side){case"left":c=e.leftHeader;break;case"center":c=e.header;break;case"right":c=e.rightHeader}var f=c.el.select("."+h).item(b.index-1).dom;return"none"===a.get(f).css("display")&&0!==b.index?(b.cell=f,b.index--,d.getPrevCell(b)):f},getCell:function(a){var b,c=this,d=c.widget;switch(a.side){case"left":b=d.leftHeader;break;case"center":b=d.header;break;case"right":b=d.rightHeader}return b.el.select("."+h).item(a.index).dom},updateColumnsWidth:function(a){for(var b=this,c=b.widget,a=a||"center",d=c.getHeader(a),e=c.getColumns(a),f=0,g=e.length;f<g;f++){var h=e[f];h.hidden||b.setColumnWidth(f,h.width,a)}d.setCellsPosition()},setColumnWidth:function(a,c,d){var e,f,g=this,h=g.widget,i=h.getColumns(d),j=h.getHeader(d),k=h.getBody(d),l=b(k.getDomColumn(a)),m=j.getCell(a),n=parseInt(l.css("left"));l.css("width",c),m.css("width",c),i[a+1]&&(n+=c,f=b(k.getDomColumn(a+1)),f.css("left",n),e=j.getCell(a+1),e.css("left",n))}})}(),Fancy.modules["column-drag"]=!0,function(){var a=Fancy,b=a.get(document),c=a.HIDDEN_CLS,d=a.GRID_HEADER_CELL_CLS,e=a.GRID_HEADER_CELL_TEXT_CLS,f=a.GRID_HEADER_CELL_TRIGGER_CLS,g=a.GRID_HEADER_CELL_TRIGGER_IMAGE_CLS,h=a.GRID_HEADER_CELL_GROUP_LEVEL_1_CLS,i=a.GRID_HEADER_CELL_GROUP_LEVEL_2_CLS,j=a.GRID_STATE_DRAG_COLUMN_CLS,k=a.FIELD_TEXT_INPUT_CLS,l=a.FIELD_CHECKBOX_INPUT_CLS;a.define("Fancy.grid.plugin.ColumnDrag",{extend:a.Plugin,ptype:"grid.columndrag",inWidgetName:"columndrag",activeSide:void 0,activeCell:void 0,activeIndex:void 0,activeColumn:void 0,inCell:void 0,inIndex:void 0,inSide:void 0,ok:!1,status:"none",constructor:function(){this.Super("const",arguments)},init:function(){var a=this,b=a.widget;a.Super("init",arguments),b.on("render",function(){a.ons(),a.initHint()})},ons:function(){var a=this;a.widget.el.on("mousedown",a.onMouseDownCell,a,"div."+d)},onMouseDownCell:function(c){var e=this,j=e.widget,m=Fancy.get(c.currentTarget),n=Number(m.attr("index")),o=j.getSideByCell(m),p=j.getColumns(o),q=p[n],r=a.get(c.target);q&&q.titleEditable||r.hasCls(f)||r.hasCls(g)||r.hasCls(k)||r.hasCls(l)||(m.hasCls(i)&&(e.activeCellTopGroup=e.getGroupStartEnd(m,o),e.activeCellTopGroup.cell=m),j.startResizing||(e.activeCellTopGroup||!1!==q.draggable)&&(m.hasCls(h)&&(e.activeUnderGroup=!0),e.activeSide=o,e.inSide=o,e.activeCell=m,e.inCell=m,e.activeIndex=Number(m.attr("index")),e.inIndex=e.activeIndex,e.activeColumn=p[e.activeIndex],e.mouseDownX=c.pageX,e.mouseDownY=c.pageY,b.once("mouseup",e.onMouseUp,e),b.on("mousemove",e.onMouseMove,e),j.el.on("mouseleave",e.onMouseLeave,e),j.el.on("mouseenter",e.onMouseEnterCell,e,"div."+d),j.el.on("mousemove",e.onMouseMoveCell,e,"div."+d)))},onMouseLeave:function(){this.hideHint()},onMouseUp:function(){var c=this,e=c.widget,f=!1;if(b.un("mousemove",c.onMouseMove,c),e.el.un("mouseleave",c.onMouseLeave,c),e.el.un("mouseenter",c.onMouseEnterCell,c,"div."+d),e.el.un("mousemove",c.onMouseMoveCell,c,"div."+d),c.ok){if(c.fire("beforecolumndrag"),c.inSide===c.activeSide)c.dragColumn(c.inSide);else if("center"===c.activeSide){var g=c.inIndex;"right"===c.okPosition&&g++,e.moveColumn(c.activeSide,c.inSide,c.activeIndex,g,c.activeCellTopGroup)}else{var g=c.inIndex;"right"===c.okPosition&&g++,e.moveColumn(c.activeSide,c.inSide,c.activeIndex,g,c.activeCellTopGroup)}f=!0}var h={column:c.activeColumn,fromSide:c.activeSide,toSide:c.inSide};delete c.inUpGroupCell,delete c.inUnderGroup,delete c.activeCellTopGroup,delete c.activeUnderGroup,delete c.activeSide,delete c.activeCell,delete c.activeIndex,delete c.activeColumn,delete c.mouseDownX,delete c.mouseDownY,c.ok=!1,delete c.okPosition,a.tip.hide(),setTimeout(function(){c.status="none"},1),c.removeDragState(),"dragging"===c.status&&setTimeout(function(){c.status="none",f&&(e.fire("columndrag",h),e.sorter&&e.sorter.updateSortedHeader())},10),c.hideHint(),setTimeout(function(){e.updateColumnsVisibilty()},100),e.scroller.update()},onMouseMove:function(b){var c=this,d=c.widget,h=d.header,i=d.leftHeader,j=d.rightHeader,k=b.pageX,l=b.pageY,m=d.getColumns(c.activeSide),n=a.get(b.target);if(!n.hasCls(f)&&!n.hasCls(g)&&(Math.abs(k-c.mouseDownX)>10||Math.abs(l-c.mouseDownY))){if(c.activeCellTopGroup?(a.tip.update(c.activeCellTopGroup.cell.select("."+e).item(0).dom.innerHTML||"&nbsp;"),c.status="dragging",c.addDragState()):(a.tip.update(c.activeColumn.title||"&nbsp;"),c.status="dragging",c.addDragState()),1===m.length&&"center"===c.activeSide)return a.tip.hide(),setTimeout(function(){c.status="none"},1),void c.removeDragState();a.tip.show(b.pageX+15,b.pageY+15),h.hideMenu&&(h.hideMenu(),d.leftColumns&&i.hideMenu()&&i.hideMenu(),d.rightColumns&&j.hideMenu()&&j.hideMenu())}},addDragState:function(){this.widget.el.addClass(j)},removeDragState:function(){this.widget.el.removeClass(j)},onMouseEnterCell:function(a){var b=this,c=b.widget,d=Fancy.get(a.currentTarget),e=c.getSideByCell(d);b.hideHint(),d.hasCls(h)?b.inUnderGroup=!0:delete b.inUnderGroup,d.hasCls(i)?b.inUpGroupCell=d:delete b.inUpGroupCell,b.inSide=e,b.inCell=d,b.inIndex=Number(d.attr("index"))},onMouseMoveCell:function(a){var b=this,c=b.widget,d=b.inCell,e=parseInt(d.css("width")),g=d.select("."+f),h=Fancy.get(a.target),i=g.within(h)||h.hasClass(f),j=b.activeUnderGroup!==b.inUnderGroup&&!0===b.inUnderGroup,k=b.activeUnderGroup!==b.inUnderGroup&&!0===b.activeUnderGroup;if(1===c.getColumns(b.activeSide).length&&"center"===b.activeSide)return b.ok=!1,void b.hideHint();if(b.activeCellTopGroup)if(b.inUpGroupCell);else{var l=b.activeCellTopGroup.start,m=b.activeCellTopGroup.end;b.activeSide!==b.inSide?(b.ok=!0,a.offsetX>e/2||i?b.showHint("right"):b.showHint("left")):isNaN(b.inIndex)?b.hideHint():b.inIndex<l?a.offsetX>e/2?b.inIndex+1===l?b.hideHint():(b.ok=!0,b.showHint("right")):(b.ok=!0,b.showHint("left")):b.inIndex>m?a.offsetX<e/2?b.inIndex===m+1?b.hideHint():(b.ok=!0,b.showHint("left")):(b.ok=!0,b.showHint("right")):b.hideHint()}else if(b.inUpGroupCell){var n=b.getGroupStartEnd(),l=n.start,m=n.end;b.activeSide!==b.inSide?(b.ok=!0,a.offsetX>e/2||i?b.showHint("right"):b.showHint("left")):a.offsetX>e/2?b.activeIndex>m&&b.activeIndex-1===m?b.hideHint():(b.ok=!0,b.showHint("right")):b.activeIndex<l&&b.activeIndex+1===l?b.hideHint():(b.ok=!0,b.showHint("left"))}else b.activeSide!==b.inSide?(b.ok=!0,a.offsetX>e/2||i?b.showHint("right"):b.showHint("left")):b.activeIndex===b.inIndex?b.ok=!1:b.activeIndex<b.inIndex?a.offsetX>e/2||i?(b.ok=!0,b.showHint("right")):a.offsetX<e/2&&b.activeIndex+1!==b.inIndex?(b.ok=!0,b.showHint("left")):b.activeIndex+1===b.inIndex&&(j||k)?(b.ok=!0,b.showHint("left")):(b.ok=!1,b.hideHint()):b.activeIndex>b.inIndex&&(a.offsetX<e/2?i?j||k?(b.ok=!0,b.showHint("right")):b.activeIndex-1===b.inIndex||b.inUpGroupCell?(b.ok=!1,b.hideHint()):(b.ok=!0,b.showHint("right")):(b.ok=!0,b.showHint("left")):a.offsetX>e/2?b.activeIndex-1===b.inIndex&&(j||k)?(b.ok=!0,b.showHint("right")):b.activeIndex-1!==b.inIndex||b.activeUnderGroup?(b.ok=!0,b.showHint("right")):(b.ok=!1,b.hideHint()):(b.ok=!1,b.hideHint()))},showHint:function(b){var d=this,e=d.widget,f=e.cellHeaderHeight,g=d.inCell,h=d.topEl,i=d.bottomEl,j=g.offset(),k=parseInt(g.css("width")),l=parseInt(g.css("height"));d.okPosition=b,h.removeCls(c),i.removeCls(c);var m=0;"right"===b&&(m+=k),h.css({left:j.left+m-Math.ceil(parseInt(h.css("width"))/2),top:j.top-parseInt(h.css("height"))});var n=j.top+l;if(d.inUpGroupCell){var o=e.header.calcRows();n=j.top+o*f}if(i.css({left:j.left+m-Math.ceil(parseInt(i.css("width"))/2),top:n}),e.window){var p=1e3+a.zIndex++;h.css("z-index",p),i.css("z-index",p)}},hideHint:function(){var a=this;a.topEl.addCls(c),a.bottomEl.addCls(c)},initHint:function(){var b=this,d=b.widget,e="fancy-theme-"+d.theme,f=a.get(document.body).dom,g=a.get(document.createElement("div")),h=a.get(document.createElement("div"));g.addCls("fancy-drag-hint-top",c,e),h.addCls("fancy-drag-hint-bottom",c,e),b.topEl=a.get(f.appendChild(g.dom)),b.bottomEl=a.get(f.appendChild(h.dom))},dragColumn:function(a){var b=this,c=b.widget,d=c.getHeader(a),e=c.getBody(a),f=b.activeIndex,g=b.inIndex,h=b.okPosition,i=c.getColumns(a),j=i[f],k=d.calcRows();if(b.activeCellTopGroup){var l=b.activeCellTopGroup.start,m=b.activeCellTopGroup.end,n=i.splice(l,m-l+1),g=b.inIndex;"right"===h&&g++,i=b.inIndex<l?Fancy.Array.insert(i,g,n):Fancy.Array.insert(i,g-n.length,n),c.setColumns(i,a)}else if(b.inUpGroupCell){var o=b.getGroupStartEnd();g=o.start,"right"===h&&(g=o.end+1)}else if("right"===h)if(b.inUnderGroup){var p=i[g].grouping,q=i[g+1];q&&q.grouping===p&&g++}else g++;if(c.groupheader&&!b.activeCellTopGroup){var r=i[g];r&&r.grouping&&b.inUnderGroup?(j.grouping=r.grouping,j.filter&&j.filter.header&&k<3&&delete j.filter):delete j.grouping}b.activeCellTopGroup||(i.splice(f,1),f<g&&g--,i.splice(g,0,j)),e.clearColumnsStyles(),d.updateTitles(),d.updateCellsSizes(),d.reSetCheckBoxes(),c.groupheader&&(c.header.fixGroupHeaderSizing(),c.leftColumns&&c.leftHeader.fixGroupHeaderSizing(),c.rightColumns&&c.rightHeader.fixGroupHeaderSizing(),d.reSetGroupIndexes()),setTimeout(function(){d.reSetColumnsAlign(),d.reSetColumnsCls(),e.reSetColumnsAlign(),e.reSetColumnsCls(),e.updateColumnsSizes()},100),c.update()},getGroupStartEnd:function(b,c){var d=this,e=d.widget,f=e.getHeader(c||d.inSide),g=(b||d.inUpGroupCell).attr("index"),h=f.el.select('[group-index="'+g+'"]'),i=[];return h.each(function(a){i.push(Number(a.attr("index")))}),{start:a.Array.min(i),end:a.Array.max(i)}}})}(),Fancy.modules["chart-integration"]=!0,Fancy.define("Fancy.grid.plugin.ChartIntegration",{extend:Fancy.Plugin,ptype:"grid.chartintegration",inWidgetName:"chartintegration",constructor:function(){this.Super("const",arguments)},init:function(){var a=this;a.Super("init",arguments),a.initKeys(),a.initBind(),a.ons()},initKeys:function(){for(var a=this,b=a.chart,c=0,d=b.length;c<d;c++){var e,f=b[c],g=f.fields,h=0,i={};if(Fancy.isString(g))i=g;else for(e=g.length;h<e;h++)i[g[h]]=!0;b[c].keys=i}},ons:function(){var a=this,b=a.widget,c=b.store;b.once("render",function(){a.toChart?a.renderToChart():a.readDataFromChart(),c.on("set",a.onSet,a),c.on("sort",a.onSort,a)})},renderToChart:function(){for(var a=this,b=a.widget,c=a.chart,d=0,e=c.length;d<e;d++){var f=c[d];switch(f.type){case"highchart":case"highcharts":b.highchart.setData(f)}}},onSet:function(a,b){for(var c=this,d=c.widget,e=c.chart,f=0,g=e.length,h=b.key;f<g;f++){var i=e[f],j=i.type;if(!0===i.keys[h])switch(j){case"highchart":case"highcharts":d.highchart.set(i,b)}}},onSort:function(a,b){for(var c=this,d=c.widget,e=c.chart,f=0,g=e.length;f<g;f++){var h=e[f];switch(h.type){case"highchart":case"highcharts":if(!1!==h.sortBind){var i=d.highchart.sort(h,b);e[f].categories=i.original}}}},readDataFromChart:function(){var a,b=this,c=b.widget,d=c.store,e=b.chart,f=e[0],g=f.type;switch(g){case"highchart":case"highcharts":a=c.highchart.getData(f)}c.reConfigStore(a),d.setData(a)},initBind:function(){for(var a,b=this,c=b.chart,d=0,e=c.length;d<e;d++)a=c[d],a.bind&&b.chartBind(a)},chartBind:function(a){var b=this,c=b.widget,d=a.bind;c.on(d.event,b.onBindEvent,{chart:a})},onBindEvent:function(a,b){var c=this,d=a,e=c.chart,f=e.bind,g=f.series,h=b.data,i=e.id;switch(f.action){case"add":var j=d.highchart.doesSeriesExist(i,h[g.name]),k=d.highchart.getNumberSeries(i);if(!1!==j&&1!==k)return void d.highchart.removeSeries(i,j);e.maxToShow&&e.maxToShow<=k&&d.highchart.removeLastSeries(i),d.highchart.isTreeMap(i)?d.highchart.setSeriesData(i,{data:h[g.data]}):d.highchart.addSeries(i,{name:h[g.name],data:h[g.data]})}}}),Fancy.define("Fancy.grid.plugin.HighChart",{extend:Fancy.Plugin,ptype:"grid.highchart",inWidgetName:"highchart",constructor:function(){this.Super("const",arguments)},init:function(){this.Super("init",arguments),this.ons()},ons:function(){},setData:function(a){var b=this,c=b.widget,d=c.store,e=d.getDataView(),f=a.fields,g=0,h=e.length,i=0,j=f.length,k=b.getChart(a.id),l=k.series,m=a.read;if(m&&void 0!==m.rowIndex&&(e=[e[m.rowIndex]],j=1),Fancy.isString(f))for(;i<j;i++){var n=e[i][f],o=l[i],p=[],g=0,h=n.length;if(a.names)for(;g<h;g++){var q={name:a.names[g],value:n[g]};p.push(q)}else for(;g<h;g++)p.push(n[g]);if(!o)break;o.setData(p),a.name&&o.update({name:e[i][a.name]})}else for(;i<j;i++){var r=f[i],o=l[i],p=[];for(g=0;g<h;g++)p.push(e[g][r]);o.setData(p)}},setSeriesData:function(a,b){this.getChart(a).series[0].setData(b.data)},set:function(a,b){var c,d=this.getFieldsMap(a),e=this.getChart(a.id),f=e.series;c=f[d[b.key]],c.data[b.rowIndex].update(Number(b.value))},sort:function(a){var b=this,c=b.widget,d=c.store,e=b.getChart(a.id),f=a.categories?a.categories:e.xAxis[0].categories,g=d.order,h=[],i=0,j=g?g.length:f.length;if(g)for(;i<j;i++)h.push(f[g[i]]);else for(;i<j;i++)h.push(f[i]);return e.xAxis[0].update({categories:h},!0),b.update(a),{original:f,newCategories:h}},update:function(a){for(var b,c=this,d=c.widget,e=d.store,f=e.getDataView(),g=a.fields,h=0,i=f.length,j=0,k=c.getChart(a.id),l=k.series,m=[],n=0,o=g.length;n<o;n++){var p=g[n];h=0;for(var q=[];h<i;h++)q.push(f[h][p]);m.push(q)}for(b=l.length;j<b;j++){l[j].setData(m[j],!1)}k.redraw()},getData:function(a){for(var b=this,c=b.getChart(a.id),d=d=a.fields,e=0,f=d.length,g=c.series,h=g[0].data.length,i=[];e<f;e++)for(var j=d[e],k=0,l=g[e];k<h;k++)void 0===i[k]&&(i[k]={}),i[k][j]=l.data[k].y;var m=b.getColumnsChartIndexes();for(e=0,f=m.length;e<f;e++){var n=m[e],o=n.split("."),p=c[o[0]][0][o[1]];for(k=0,h=p.length;k<h;k++)i[k][n]=p[k]}return i},getColumnsChartIndexes:function(){for(var a=this.widget,b=[],c=a.columns,d=0,e=c.length;d<e;d++){var f=c[d].index;/xAxis\../.test(f)&&b.push(f)}return b},getFieldsMap:function(a){for(var b={},c=a.fields,d=0,e=c.length;d<e;d++)b[c[d]]=d;return b},addSeries:function(a,b){this.getChart(a).addSeries(b)},getNumberSeries:function(a){return this.getChart(a).series.length},removeLastSeries:function(a){var b=this.getChart(a);b.series[b.series.length-1].remove()},removeSeries:function(a,b){this.getChart(a).series[b].remove()},doesSeriesExist:function(a,b){for(var c=this,d=c.getChart(a),e=0,f=d.series.length;e<f;e++)if(d.series[e].name===b)return e;return!1},isTreeMap:function(a){var b=this.getChart(a);return void 0!==b.series[0]&&"treemap"===b.series[0].type},getChart:function(a){var b,c=Highcharts.charts;return c.forEach(function(c,d){c.renderTo.id===a&&(b=c)}),b}}),Fancy.modules.edit=!0,Fancy.define("Fancy.grid.plugin.Edit",{extend:Fancy.Plugin,ptype:"grid.edit",inWidgetName:"edit",clicksToEdit:2,tabColumnsSupport:{date:!0,combo:!0,image:!0,number:!0,string:!0,text:!0},constructor:function(){this.Super("const",arguments)},init:function(){var a=this,b=a.widget,c=b.store;a.addEvents("tab"),a.Super("init",arguments),b.once("render",function(){a.ons(),c.on("beforeupdate",a.onStoreCRUDBeforeUpdate,a),c.on("update",a.onStoreCRUDUpdate,a),c.on("beforedestroy",a.onStoreCRUDBeforeDestroy,a),c.on("destroy",a.onStoreCRUDDestroy,a),c.on("create",a.onCreate,a)})},ons:function(){var a=this,b=a.widget,c=b.store,d="cell"+a.getClickEventName();b.on("cellclick",a.onClickCell,a),c.on("set",a.onStoreSet,a),a.on("tab",a.onTab,a),b.once("init",function(){"cell"!==d&&b.on(d,a.onClickCellToEdit,a)}),b.on("activate",a.onGridActivate,a),b.on("deactivate",a.onGridDeActivate,a)},onGridActivate:function(){Fancy.get(document).on("keydown",this.onKeyDown,this)},onGridDeActivate:function(){Fancy.get(document).un("keydown",this.onKeyDown,this)},onKeyDown:function(a){var b=a.keyCode,c=Fancy.key;switch(b){case c.TAB:this.fire("tab",a)}},onTab:function(a,b){var a=this,c=a.widget;if(a.activeCellEditParams){b.preventDefault();var d=a.getNextCellEditParam();c.celledit&&(c.celledit.hideEditor(),!1!==c.tabEdit&&setTimeout(function(){c.celledit.edit(d)},100))}},getNextCellEditParam:function(){for(var a,b,c,d,e=this,f=e.widget,g=f.store,h=e.activeCellEditParams,i=f.leftColumns,j=h.columnIndex,k=h.rowIndex,l=h.side,m=f.getColumns(l),n=m[j+1],o=0,p=20;o<p;o++){var q=e.getNextCellInfo({side:l,columnIndex:j,rowIndex:k});if(l=q.side,j=q.columnIndex,k=q.rowIndex,m=f.getColumns(l),n=m[q.columnIndex],e.tabColumnsSupport[n.type]&&!0===n.editable)break}return a=f.getBody(l),b=a.getCell(k,j).dom,b||(l="center",i.length&&(l="left"),k=0,j=0,a=f.getBody(l),b=a.getCell(k,j).dom),c=n.index,d=g.getId(k),{id:g.getId(k),side:l,column:n,cell:b,columnIndex:j,rowIndex:k,value:g.get(k,c),data:g.get(k),item:g.getById(d)}},getNextCellInfo:function(a){var b=this,c=b.widget,d=a.side,e=c.getColumns(d),f=a.columnIndex,g=a.rowIndex,h=e[f+1],i=c.rightColumns,j=c.leftColumns;if(h)f++;else switch(d){case"left":d="center",f=0;break;case"center":i.length?(d="right",f=0):j.length?(d="left",f=0,g++):(f=0,g++);break;case"right":j.length?(d="left",f=0,g++):(d="center",f=0,g++)}return{side:d,rowIndex:g,columnIndex:f}},getClickEventName:function(){switch(this.clicksToEdit){case 1:return"click";case 2:return"dblclick";case!1:return""}},stopEditor:function(){this.stopped=!0},onClickCell:function(a,b){var c=this.widget,d=b.column;d.editable&&("checkbox"===d.type||"switcher"===d.type)&&c.celledit&&c.celledit.onCheckBoxChange(b)},onClickCellToEdit:function(a,b){var c=this,d=c.widget,e=b.column;d.rowedit||d.celledit&&d.celledit.hideEditor(),d.rowedit?d.rowedit.edit(b):e.editable&&"checkbox"!==e.type&&"switcher"!==e.type&&d.celledit&&d.celledit.edit(b)},onStoreSet:function(a,b){this.widget.updater.updateRow(b.rowIndex)},onStoreCRUDBeforeUpdate:function(){var a=this,b=a.widget,c=a.activeCellEditParams;c&&b.updater.updateRow(c.rowIndex)},onStoreCRUDUpdate:function(a,b,c,d){delete a.changed[b],this.clearDirty()},onStoreCRUDBeforeDestroy:function(){},onStoreCRUDDestroy:function(){this.widget.store.loadData(),this.clearDirty()},clearDirty:function(){var a=this.widget;setTimeout(function(){a.leftBody.clearDirty(),a.body.clearDirty(),a.rightBody.clearDirty()},500)},onCreate:function(a,b){var c=this,d=c.widget;d.updater.update(),d.fire("insert",b),c.clearDirty()}}),function(){var a=Fancy,b=a.GRID_CELL_CLS;a.define("Fancy.grid.plugin.CellEdit",{extend:a.Plugin,ptype:"grid.celledit",inWidgetName:"celledit",editorsCls:"fancy-grid-editors",constructor:function(){this.Super("const",arguments)},init:function(){this.Super("init",arguments),this.ons()},ons:function(){var a=this,b=a.widget;b.once("render",function(){a.initEditorContainer(),a.checkAutoInitEditors(),b.on("scroll",a.onScroll,a),b.on("nativescroll",a.onNativeScroll,a),b.on("docclick",a.onDocClick,a),b.on("headercellmousedown",a.onHeaderCellMouseDown,a)})},onDocClick:function(c,d){var e=this,f=e.activeCellEditParams,g=e.activeEditor,h=!0,i=d.target,j=a.get(i);if(void 0!==g&&"date"!==f.column.type){if("combo"!==f.column.type){return void(j.closest("."+b).dom||g.el.within(i)||g.hide())}!1===g.el.within(i)&&!1===g.list.within(i)&&!0!==e.comboClick&&(h=!1),!1===h&&g.hide(),e.comboClick=!1}},initEditorContainer:function(){var a=this,b=a.widget;a.editorsContainer=b.el.select("."+a.editorsCls)},edit:function(a){var b=this,c=b.widget,d=c.store,e=a.column;"$selected"!==e.index&&(b.activeCellEditParams=a,c.edit.activeCellEditParams=a,e.editor=b.generateEditor(e),d.infiniteScrolledToRow||c.scroller.scrollToCell(a.cell),b.showEditor(a))},generateEditor:function(b){var c,d,e=this,f=e.widget,g={position:"absolute",left:"0px",top:"0px",display:"none",padding:"0px"},h=b.type,i=b.vtype,j=f.theme;if(b.editor)return b.editor;d=e.editorsContainer.dom;var k={renderTo:d,label:!1,style:g,checkValidOnTyping:!0};switch(h){case"combo":var l="text",m="text",n=b.data,o=[{change:e.onComboChange,scope:e}];if(b.editorEvents)for(var p=0,q=b.editorEvents.length;p<q;p++)o.push(b.editorEvents[p]);void 0!==b.displayKey&&(l=b.displayKey,m=l),"default"===j&&(j=void 0),b.minListWidth&&(k.minListWidth=b.minListWidth),b.subSearch&&(k.subSearch=b.subSearch),Fancy.apply(k,{theme:j,data:n,displayKey:l,valueKey:m,value:0,padding:!1,vtype:i,events:o}),b.emptyText&&(k.emptyText=b.emptyText),b.displayTpl&&(k.displayTpl=b.displayTpl),b.listItemTpl&&(k.listItemTpl=b.listItemTpl),b.leftTpl&&(k.leftTpl=b.leftTpl),b.leftWidth&&(k.leftWidth=b.leftWidth),c=new a.Combo(k);break;case"text":c=new a.TextArea({renderTo:d,label:!1,style:g,vtype:i,checkValidOnTyping:!0,events:[{enter:e.onEditorEnter,scope:e},{beforehide:e.onEditorBeforeHide,scope:e},{blur:e.onBlur,scope:e}]});break;case"image":case"string":case"tree":case"color":c=new a.StringField({renderTo:d,label:!1,style:g,vtype:i,format:b.format,checkValidOnTyping:!0,events:[{enter:e.onEditorEnter,scope:e},{beforehide:e.onEditorBeforeHide,scope:e},{blur:e.onBlur,scope:e}]});break;case"number":case"currency":a.apply(k,{vtype:i,format:b.format,events:[{enter:e.onEditorEnter,scope:e},{beforehide:e.onEditorBeforeHide,scope:e},{blur:e.onBlur,scope:e}]}),void 0!==b.spin&&(k.spin=b.spin),void 0!==b.step&&(k.step=b.step),void 0!==b.min&&(k.min=b.min),void 0!==b.max&&(k.max=b.max),c=new a.NumberField(k);break;case"date":c=new a.DateField({renderTo:d,label:!1,style:g,format:b.format,lang:f.lang,i18n:f.i18n,vtype:i,theme:j,checkValidOnTyping:!0,events:[{enter:e.onEditorEnter,scope:e},{beforehide:e.onEditorBeforeHide,scope:e},{blur:e.onBlur,scope:e}]});break;default:throw new Error("[FancyGrid error] - type "+h+" editor does not exit")}return c},showEditor:function(a){var b=this,c=b.widget,d=a.column,e=d.type,f=d.editor,g=a.cell,h=b.getCellPosition(g),i=b.getCellSize(g);if(c.fire("beforeedit",a),!0===c.edit.stopped)return void(c.edit.stopped=!1);"combo"===e&&(b.comboClick=!0),b.activeEditor=f,b.setEditorValue(a),0===a.rowIndex&&i.height++,d.minEditorWidth&&i.width<d.minEditorWidth&&(i.width=d.minEditorWidth),b.setEditorSize(i),f.show(),f.el.css(h),f.focus(),"combo"===e&&void 0!==a.value&&f.set(a.value,!1),c.fire("startedit",a)},setEditorSize:function(a){var b=this;"field.combo"===b.activeEditor.wtype?b.activeEditor.size(a):b.activeEditor.setInputSize({width:a.width,height:a.height})},hideEditor:function(){var a,b,c,d=this,e=d.widget,f=e.store,g=d.activeCellEditParams,h=d.activeEditor;h&&(c=g.column,b=h.get(),"server"===f.proxyType&&"combo"!==c.type&&(a=d.getActiveColumnKey(),""===(b=d.prepareValue(b))&&null===f.get(g.rowIndex,a)||f.set(g.rowIndex,a,b)),h.hide(),h.hideErrorTip()),delete d.activeEditor,e.el.dom.scrollTop&&(e.el.dom.scrollTop=0)},getCellPosition:function(b){var c=this,d=c.widget,e=d.gridBorders,f=a.get(b),g=f.offset(),h=d.el.offset();return{left:parseInt(g.left)-parseInt(h.left)-2+"px",top:parseInt(g.top)-parseInt(h.top)-(e[0]+e[2])+"px"}},getCellSize:function(b){var c=this,d=c.widget,e=a.get(b),f=e.width(),g=e.height(),h=2;return a.nojQuery&&2===d.panelBorderWidth&&(h=1),f+=parseInt(e.css("border-right-width"))*h,g+=parseInt(e.css("border-bottom-width"))*h,{width:f,height:g}},setEditorValue:function(b){var c=this,d=c.activeEditor;switch(b.column.type){case"combo":-1!==d.valueIndex&&d.set(d.getValueKey(b.value),!1);break;case"date":b.value||(b.value="");var e=b.column.format,f=a.Date.parse(b.value,e.read,e.mode);d.set(f);break;default:d.set(b.value)}},onEditorEnter:function(a,b){this.hideEditor()},onHeaderCellMouseDown:function(){this.hideEditor()},onKey:function(a,b){},setValue:function(a){var b,c=this,d=c.widget,e=d.store,f=c.activeCellEditParams,g=c.activeEditor;void 0!==g&&!1!==g.isValid()&&"server"!==e.proxyType&&(d.rowheight&&setTimeout(function(){d.update()},1),b=c.getActiveColumnKey(),a=c.prepareValue(a),"field.date"===g.type&&g.isEqual(e.get(f.rowIndex,b))||e.set(f.rowIndex,b,a))},onEditorBeforeHide:function(a){a.isValid()&&this.setValue(a.getValue())},onScroll:function(){this.hideEditor()},onNativeScroll:function(){this.hideEditor()},onBlur:function(a){var b=this;if(!b.activeEditor||a.id===b.activeEditor.id){if(!0===a.mouseDownSpinUp||a.mouseDownSpinDown)return;b.hideEditor()}},prepareValue:function(b){var c=this,d=c.getActiveColumnType(),e=c.activeCellEditParams,f=e.column,g=f.format;if(g&&g.beforeSaveFn){return b=c.activeEditor.input.dom.value,g.beforeSaveFn(b)}switch(d){case"number":case"currency":if(g&&g.inputFn){var h="",i=0,j=b.length;if(a.isNumber(b))return b;for(;i<j;i++)isNaN(Number(b[i]))||(h+=b[i]);b=h}else""!==b&&(b=Number(b));break;case"date":if(f.format&&f.format.read){var k=f.editor.getDate();b&&(b=a.Date.format(k,f.format.read,void 0,f.format.mode))}}return b},getActiveColumnType:function(){return this.activeCellEditParams.column.type},getActiveColumnKey:function(){return this.activeCellEditParams.column.index},onCheckBoxChange:function(a){var b=this,c=b.widget,d=a.column,e=d.index,f=c.store,g=b.checkBoxChangedValue;b.activeEditor&&b.hideEditor(),void 0!==b.checkBoxChangedValue&&(delete b.checkBoxChangedValue,b.activeCellEditParams=a,c.edit.activeCellEditParams=a,f.set(a.rowIndex,e,g))},onComboChange:function(a,b){var c=this,d=c.widget,e=d.store,f=c.activeCellEditParams,g=c.getActiveColumnKey(),h=a.getDisplayValue(b);e.set(f.rowIndex,g,h),c.hideEditor()},checkAutoInitEditors:function(){var b=this,c=b.widget;a.each(c.columns,function(a){a.editorAutoInit&&(a.editor=b.generateEditor(a))})}})}(),function(){var a=Fancy,b=a.each,c=a.GRID_CELL_CLS,d=a.FIELD_CLS,e=a.GRID_ROW_EDIT_CLS,f=a.GRID_ROW_EDIT_BUTTONS_CLS,g=a.GRID_ROW_EDIT_BUTTON_UPDATE_CLS,h=a.GRID_ROW_EDIT_BUTTON_CANCEL_CLS,i=a.ANIMATE_DURATION;a.define("Fancy.grid.plugin.RowEdit",{extend:a.Plugin,ptype:"grid.rowedit",inWidgetName:"rowedit",rendered:!1,constructor:function(){this.Super("const",arguments)},init:function(){this.Super("init",arguments),this.ons()},ons:function(){var a=this,b=a.widget;b.on("scroll",a.onScroll,a),b.on("columnresize",a.onColumnResize,a),b.on("lockcolumn",a.onLockColumn,a),b.on("rightlockcolumn",a.onRightLockColumn,a),b.on("unlockcolumn",a.onUnLockColumn,a),b.on("beforecolumndrag",a.onBeforeColumnDrag,a),b.on("columndrag",a.onColumnDrag,a),b.grouping&&(b.on("collapse",a.onCollapse,a),b.on("expand",a.onExpand,a))},onCollapse:function(){this.hide()},onExpand:function(){this.hide()},edit:function(a){var b=this,c=b.widget,d=a.column;d&&"$selected"===d.index||(c.scroller.scrollToCell(a.cell),b.showEditor(a))},showEditor:function(b){var c=this,d=c.widget;if(d.fire("beforeedit",b),!0===d.edit.stopped)return void(d.edit.stopped=!1);c.changed={};for(var e in b.data)null===b.data[e]&&(b.data[e]="");if(c.rendered){var f="none"===c.el.css("display");c.show(),c.changePosition(b.rowIndex,!f),f?c.setValues(b):setTimeout(function(){c.setValues(b)},a.ANIMATE_DURATION)}else c.render(),c.changePosition(b.rowIndex,!1),c.setValues(b);c.setSizes()},render:function(){var a=this,b=a.widget;b.leftColumns&&(a.leftEl=a.renderTo(b.leftBody.el,b.leftColumns)),b.columns&&(a.el=a.renderTo(b.body.el,b.columns)),b.rightColumns&&(a.rightEl=a.renderTo(b.rightBody.el,b.rightColumns)),a.renderButtons(),a.rendered=!0},renderTo:function(b,c,f,g,h){var i,j,k,l,m=this,n=m.widget,o=a.get(document.createElement("div")),p=0,q=c.length,r=n.theme,s={float:"left",margin:"0px",padding:"0px"};if(g){var t=b.select("."+d);switch(p=f,q=f+1,g){case"right":t.length&&(l=t.item(f));break;case"left":t.length&&(k=t.item(f));break;case"center":switch(h){case"left":l=t.item(0);break;case"right":k=t.item(t.length-1)}}}else o.addCls(e),i=a.get(b.dom.appendChild(o.dom));for(-1===p&&(p=0,q=1);p<q;p++){j=c[p];var u=j.width,v={index:j.index,label:!1,style:s,width:u,vtype:j.vtype,format:j.format,stopPropagation:!0,theme:r,checkValidOnTyping:!0,events:[{change:m.onFieldChange,delay:100,scope:m},{empty:m.onFieldEmpty,delay:100,scope:m},{enter:m.onFieldEnter,scope:m}]};switch(g){case"left":k?v.renderAfter=k:v.renderTo=b.dom;break;case"right":l?v.renderBefore=l:v.renderTo=b.dom;break;case"center":switch(h){case"left":v.renderBefore=t.item(0);break;case"right":v.renderAfter=t.item(t.length-1)}break;default:v.renderTo=i.dom}var w;if(!1===j.editable)switch(j.type){case"string":case"number":w=new a.TextField(v);break;default:w=new a.EmptyField(v)}else switch(j.type){case"date":j.format&&(v.format=j.format),w=new a.DateField(v);break;case"image":case"string":case"text":case"color":w=new a.StringField(v);break;case"number":case"currency":j.spin&&(v.spin=j.spin),j.step&&(v.step=j.step),j.min&&(v.min=j.min),j.max&&(v.max=j.max),w=new a.NumberField(v);break;case"combo":a.apply(v,{data:j.data,value:-1,padding:!1}),j.displayKey?(v.displayKey=j.displayKey,v.valueKey=j.displayKey):(v.displayKey="text",v.valueKey="text"),j.minListWidth&&(v.minListWidth=j.minListWidth),j.subSearch&&(v.subSearch=j.subSearch),w=new a.Combo(v);break;case"checkbox":var x;switch(j.cellAlign){case"left":x=7;break;case"center":x=(j.width-20-2)/2;break;case"right":x=(j.width-20)/2+11}a.apply(v,{renderId:!0,value:!1,style:{padding:"0px",display:"inline-block","padding-left":x,float:"left",margin:"0px"}}),w=new a.CheckBox(v);break;case"switcher":var x;switch(j.cellAlign){case"left":case void 0:x=7;break;case"center":x=(j.width-20-2)/2;break;case"right":x=(j.width-20)/2+11}a.apply(v,{renderId:!0,value:!1,style:{padding:"0px",display:"inline-block","padding-left":x,float:"left",margin:"0px"}}),w=new a.Switcher(v);break;default:w=new a.EmptyField(v)}j.rowEditor=w}return i},renderButtons:function(){var b,c=this,d=c.widget,e=d.lang,i=a.get(document.createElement("div"));i.addCls(f),b=a.get(d.body.el.dom.appendChild(i.dom)),c.buttonsEl=b,c.buttonUpdate=new a.Button({cls:g,renderTo:b.dom,text:e.update,events:[{click:c.onClickUpdate,scope:c}]}),c.buttonCancel=new a.Button({cls:h,renderTo:b.dom,text:e.cancel,events:[{click:c.onClickCancel,scope:c}]})},setSizes:function(){var a=this,b=a.widget;b.leftColumns&&a._setSizes(b.leftBody.el.select("."+c+'[index="0"]'),b.leftColumns,"left"),b.columns&&a._setSizes(b.body.el.select("."+c+'[index="0"]'),b.columns),b.rightColumns&&a._setSizes(b.rightBody.el.select("."+c+'[index="0"]'),b.rightColumns,"right"),a.setElSize()},setElSize:function(){var a=this.widget,b=a.getCenterViewWidth(),c=a.getCenterFullWidth();b<c&&this.el.css("width",c)},_setSizes:function(a,b,c){for(var d,e,f,g,h=this,i=0,j=b.length,k=1,l=2;i<j;i++)d=b[i],f=a.item(i).dom,e=h.getCellSize(f),(g=d.rowEditor)&&("left"!==c&&"right"!==c||i!==j-1||e.width--,"left"===c&&"select"===d.type&&e.width--,e.height-=1,i===j-1?g.el.css("width",e.width-2):g.el.css("width",e.width-1),g.el.css("height",e.height),e.width-=2*k,e.width-=2*l,e.height-=2*l,h.setEditorSize(g,e))},getCellSize:function(b){var c=a.get(b),d=c.width(),e=c.height(),f=2;return a.nojQuery&&(f=1),d+=parseInt(c.css("border-right-width"))*f,e+=parseInt(c.css("border-bottom-width"))*f,{width:d,height:e}},setEditorSize:function(a,b){"field.combo"===a.wtype?(a.size(b),a.el.css("width",b.width+5)):a.setInputSize({width:b.width,height:b.height})},changePosition:function(b,c){var d=this,e=d.widget,f=e.scroller.getScroll(),g=e.scroller.getBottomScroll(),h=e.cellHeight*b-1-f,j=0;e.grouping&&(j+=e.grouping.getOffsetForRow(b),h+=j),d.leftEl&&(!1!==c?d.leftEl.animate({top:h},i):d.leftEl.css("top",h)),d.el&&(!1!==c?d.el.animate({top:h},i):d.el.css("top",h)),d.rightEl&&(!1!==c?d.rightEl.animate({top:h},i):d.rightEl.css("top",h));var k=e.getViewTotal()-3<b,l=h;b<3&&(k=!1),k?e.grouping?e.getViewTotal()-3<b-e.grouping.getSpecialRowsUnder(b)?l=h-parseInt(d.buttonsEl.css("height"))+1:(l=h+e.cellHeight,k=!1):l=h-parseInt(d.buttonsEl.css("height"))+1:l=h+e.cellHeight,a.nojQuery&&(l+=1),!1!==c?d.buttonsEl.animate({top:l},i):d.buttonsEl.css("top",l),d.el.css("left",-g),d.changeButtonsLeftPos(),d.activeRowIndex=b},changeButtonsLeftPos:function(){var a=this,b=a.widget,c=b.getCenterViewWidth(),d=parseInt(a.buttonsEl.css("width"));a.buttonsEl.css("left",(c-d)/2)},setValues:function(a){var b=this,c=b.widget;c.leftColumns&&b._setValues(a.data,c.leftColumns),c.columns&&b._setValues(a.data,c.columns),c.rightColumns&&b._setValues(a.data,c.rightColumns),b.activeId=a.id,b.activeRowIndex=a.rowIndex},_setValues:function(a,c){b(c,function(b){var c=b.rowEditor;if(c)switch(b.type){case"action":case"button":case"order":case"select":case"expand":case"rowdrag":break;default:c.set(a[b.index],!1)}})},onScroll:function(){var a=this,b=a.widget;!1!==a.rendered&&(b.infinite&&a.hide(),void 0!==a.activeRowIndex&&a.changePosition(a.activeRowIndex,!1))},onColumnResize:function(){var b=this;!1!==b.rendered&&(a.nojQuery?setTimeout(function(){b.setSizes()},400):setTimeout(function(){b.setSizes()},i))},onClickUpdate:function(){var a=this,b=a.widget,c=b.store,d=a.prepareChanged(),e=c.getRow(a.activeId);c.setItemData(e,d),b.update(),a.hide()},prepareChanged:function(){var b=this,c=b.widget,d=b.changed;for(var e in d){var f=c.getColumnByIndex(e);switch(f.type){case"date":var g=a.Date.parse(d[e],f.format.edit,f.format.mode),h=a.Date.format(g,f.format.read,f.format.mode);d[e]=h}}return d},onClickCancel:function(){this.hide()},hide:function(){var a=this;a.el&&(a.leftEl&&a.leftEl.hide(),a.el.hide(),a.rightEl&&a.rightEl.hide(),a.buttonsEl.hide())},show:function(){var a=this;a.leftEl&&("none"===a.leftEl.css("display")&&a.leftEl.css("opacity",0),a.leftEl.show(),a.leftEl.animate({opacity:1},i)),"none"===a.el.css("display")&&a.el.css("opacity",0),a.el.show(),a.el.animate({opacity:1},i),a.rightEl&&("none"===a.rightEl.css("display")&&a.rightEl.css("opacity",0),a.rightEl.show(),a.rightEl.animate({opacity:1},i)),"none"===a.buttonsEl.css("display")&&a.buttonsEl.css("opacity",0),a.buttonsEl.show(),a.buttonsEl.animate({opacity:1},i)},onFieldChange:function(a,b,c){var d=this;a.isValid()?d.changed[a.index]=b:delete d.changed[a.index]},onFieldEmpty:function(a){var b=this;a.vtype&&!a.isValid()?delete b.changed[a.index]:b.changed[a.index]=""},onFieldEnter:function(){var a=this,b=a.widget,c=b.store,d=c.getRow(a.activeId);c.setItemData(d,a.changed),b.update(),a.hide()},hideField:function(a,b){var c=this.widget,d=c.getColumns(b),e=d[a];e.rowEditor&&e.rowEditor.hide()},showField:function(a,b){var c=this.widget,d=c.getColumns(b),e=d[a];e.rowEditor&&e.rowEditor.show()},moveEditor:function(a,b,c,d){var f,g=this,h=g.widget,i=h.store,j=h.getColumns(c),k=a.rowEditor,l=h.getBody(c),m=l.el.select("."+e),n=i.getById(g.activeId),o=n.get(a.index);m.dom&&(void 0===g.activeId&&(o=i.ge1t(g.activeRowIndex)[a.index]),k.destroy(),g.renderTo(m,j,b,c,d),f=g.getField(b,c),a.rowEditor=f,f.set(o),g.setSizes(),g.changeButtonsLeftPos(),g.reSetColumnsEditorsLinks())},getField:function(b,c){var f=this.widget,g=f.getBody(c);switch(c){case"left":b++}return a.getWidget(g.el.select("."+e+" ."+d).item(b).attr("id"))},reSetColumnsEditorsLinks:function(){var c=this,f=c.widget,g=f.body.el.select("."+e+" ."+d);b(f.columns,function(b,c){b.rowEditor=a.getWidget(g.item(c).attr("id"))}),g=f.leftBody.el.select("."+e+" ."+d),b(f.leftColumns,function(b,c){b.rowEditor=a.getWidget(g.item(c).attr("id"))}),g=f.rightBody.el.select("."+e+" ."+d),b(f.rightColumns,function(b,c){b.rowEditor=a.getWidget(g.item(c).attr("id"))})},onBeforeColumnDrag:function(){var a=this;a.destroyEls(),a.hide()},onColumnDrag:function(){var a=this;a.destroyEls(),a.hide()},onLockColumn:function(){var a=this;a.destroyEls(),a.hide()},onRightLockColumn:function(){var a=this;a.destroyEls(),a.hide()},onUnLockColumn:function(){var a=this;a.destroyEls(),a.hide()},destroyEls:function(){var b=this,c=b.widget;b.rendered&&(b.rendered=!1,c.leftColumns&&(a.each(c.leftColumns,function(a){a.rowEditor.destroy(),delete a.rowEditor}),b.leftEl.destroy()),c.columns&&(a.each(c.columns,function(a){a.rowEditor.destroy(),delete a.rowEditor}),b.el.destroy()),c.rightColumns&&(a.each(c.rightColumns,function(a){a.rowEditor.destroy(),delete a.rowEditor}),b.rightEl.destroy()))}})}(),Fancy.define("Fancy.grid.plugin.Infinite",{extend:Fancy.Plugin,ptype:"grid.infinite",inWidgetName:"infinite",constructor:function(){this.Super("const",arguments)},init:function(){this.Super("init",arguments),this.ons()},ons:function(){var a=this,b=a.widget;b.store}}),Fancy.modules.selection=!0,function(){var a=Fancy,b=a.GRID_CELL_CLS,c=a.GRID_CELL_OVER_CLS,d=a.GRID_CELL_SELECTED_CLS,e=a.GRID_CELL_ACTIVE_CLS,f=a.GRID_COLUMN_CLS,g=a.GRID_COLUMN_OVER_CLS,h=a.GRID_COLUMN_SELECT_CLS,i=a.GRID_COLUMN_SELECTED_CLS,j=a.GRID_ROW_OVER_CLS,k=(a.GRID_HEADER_CLS,a.GRID_HEADER_CELL_SELECT_CLS),l=a.GRID_HEADER_CELL_TEXT_CLS,m=a.GRID_COLUMN_TREE_EXPANDER_CLS,n=a.FIELD_CHECKBOX_CLS,o=a.FIELD_CHECKBOX_ON_CLS,p=a.FIELD_CHECKBOX_INPUT_CLS,q=a.GRID_COPY_TEXTAREA,r=a.FIELD_CHECKBOX_MIDDLE_CLS;a.define("Fancy.grid.plugin.Selection",{extend:a.Plugin,ptype:"grid.selection",inWidgetName:"selection",mixins:["Fancy.grid.selection.mixin.Navigation"],enabled:!0,checkboxRow:!1,checkOnly:!1,memory:!1,disabled:!1,selectLeafsOnly:!1,keyNavigation:!0,allowDeselect:!1,constructor:function(){this.Super("const",arguments)},init:function(){var a=this;a.Super("init",arguments),a.memory&&a.initMemory(),a.ons()},ons:function(){var b=this,c=b.widget;c.once("render",function(){b.initTrackOver(),b.initColumnTrackOver(),b.initCellTrackOver(),b.initCellSelection(),b.initRowSelection(),b.initColumnSelection(),b.keyNavigation&&b.initNavigation(),b.initCopyKeys(),c.on("changepage",b.onChangePage,b),c.on("load",b.onLoad,b),a.nojQuery&&b.initFixTrackOver(),b.initCopyEl()}),c.on("sort",b.onSort,b),c.on("columndrag",b.onColumnDrag,b),c.on("lockcolumn",b.onColumnLock,b),c.on("rightlockcolumn",b.onColumnRightLock,b),c.on("unlockcolumn",b.onUnColumnLock,b),c.on("filter",b.onFilter,b),c.on("expand",b.onExpand,b),c.on("collapse",b.onCollapse,b),c.on("dragrows",b.onDragRows,b),c.on("remove",b.onRemoveRows,b),c.on("treeexpand",b.onTreeExpand,b),c.on("treecollapse",b.onTreeCollapse,b)},initMemory:function(){var b=this,c=b.widget;b.memory={all:!1,exceptedLength:0,selectedLength:0,excepted:{},selected:{},tree:{selected:{},allSelected:{},selectedLength:{}},addDirtyParent:function(d,e,f){if("rows"===b.selModel){var g=c.getById(d),h=g.get("child");if(h)!1!==f?(delete b.memory.tree.selected[d],e&&(b.memory.tree.allSelected[d]||b.memory.tree.selected[d]||b.memory.tree.selectedLength[e]++),b.memory.tree.allSelected[d]=!0,b.memory.tree.selectedLength[d]=h.length,b.memory.clearChild(h)):(h&&(b.memory.tree.selected[d]=!0),b.memory.tree.selectedLength[d]||(b.memory.tree.selectedLength[d]=1));else if(e){b.memory.tree.selected[e]=!0,b.memory.tree.selectedLength[e]=b.memory.tree.selectedLength[e]||0,b.memory.tree.selectedLength[e]++;var i=c.getById(e),j=i.get("child");j.length===b.memory.tree.selectedLength[e]&&(b.memory.tree.allSelected[e]=!0,delete b.memory.tree.selected[e])}if(e){var i=c.getById(e);i.data.parentId&&b.memory.addDirtyParent(e,i.data.parentId,!1),h.length&&b.memory.addDirtyParent(e,i.data.parentId,!1)}if(h){var k=0;a.each(h,function(a){var c=a.id;if(!c)return!0;b.memory.tree.allSelected[c]&&k++}),h.length===k&&(delete b.memory.tree.selected[d],b.memory.tree.allSelected[d]=!0)}}},removeDirtyParent:function(a,d){if("rows"===b.selModel){var e,f=c.getById(d);if(f&&(e=f.get("child")),b.memory.tree.allSelected[a]&&(delete b.memory.tree.allSelected[a],delete b.memory.tree.selectedLength[a]),b.memory.selected[a]&&(delete b.memory.selected[a],b.memory.selectedLength--),delete b.memory.tree.selected[a],b.memory.tree.allSelected[d]&&(delete b.memory.tree.allSelected[d],b.memory.tree.selectedLength[d]=e.length,1!==e.length?b.memory.tree.selected[d]=!0:delete b.memory.tree.selected[d]),b.memory.tree.selectedLength[d]&&b.memory.tree.selectedLength[d]--,0===b.memory.tree.selectedLength[d]){delete b.memory.tree.selected[d],delete b.memory.tree.selectedLength[d];var g=f.get("parentId");g&&b.memory.removeDirtyParent(d,g)}}},clearChild:function(c){a.Array.each(c,function(a){var c=a.id;if(b.memory.tree.selectedLength[c]){b.memory.selected[c]=!0,delete b.memory.tree.allSelected[c],delete b.memory.tree.selected[c],delete b.memory.tree.selectedLength[c];var d=a.get("child");d&&b.memory.clearChild(d)}})},setAll:function(){var d=c.store.filteredDataMap;if(d){b.memory.selectedLength=0;for(var e in d)b.memory.add(e);b.memory.excepted={},b.memory.all=!0,b.memory.exceptedLength=0}else a.apply(b.memory,{all:!0,exceptedLength:0,selectedLength:0,excepted:{},selected:{}})},clearAll:function(){a.apply(b.memory,{all:!1,exceptedLength:0,selectedLength:0,excepted:{},selected:{}})},add:function(a){var d=c.getById(a);d&&d.set("$selected",!0),b.row&&b.memory.clearAll(),b.memory.selected[a]||(b.memory.selected[a]=!0,b.memory.selectedLength++),!0===b.memory.excepted[a]&&(delete b.memory.excepted[a],b.memory.exceptedLength--)},remove:function(a){var d=c.getById(a);d&&d.set("$selected",!1),!0===b.memory.selected[a]&&(delete b.memory.selected[a],b.memory.selectedLength--),!0===b.memory.all&&(b.memory.excepted[a]||(b.memory.excepted[a]=!0,b.memory.exceptedLength++));var e=c.getTotal();b.memory.exceptedLength===e&&b.memory.clearAll()},has:function(a){return!!b.memory.selected[a]&&!b.memory.excepted[a]}}},initTrackOver:function(){var a=this,b=a.widget;b.on("rowenter",a.onRowEnter,a),b.on("rowleave",a.onRowLeave,a)},initCellTrackOver:function(){var a=this,b=a.widget;b.on("cellenter",a.onCellEnter,a),b.on("cellleave",a.onCellLeave,a)},initColumnTrackOver:function(){var a=this,b=a.widget;b.on("columnenter",a.onColumnEnter,a),b.on("columnleave",a.onColumnLeave,a)},onCellEnter:function(b,d){var e=this.widget;!e.cellTrackOver||e.startResizing||a.isTouch||a.get(d.cell).addCls(c)},onCellLeave:function(b,d){var e=this.widget;e.cellTrackOver&&!e.startResizing&&a.get(d.cell).removeCls(c)},onColumnEnter:function(b,c){var d=this,e=d.widget,f=e.columndrag,h=e.scroller;f&&"dragging"===f.status||a.isTouch||e.startResizing||!e.columnTrackOver||h.bottomKnobDown||h.rightKnobDown||!1===c.column.trackOver||d.keyNavigating||a.get(c.columnDom).addCls(g)},onColumnLeave:function(b,c){var d=this.widget;d.startResizing||d.columnTrackOver&&a.get(c.columnDom).removeCls(g)},onRowEnter:function(b,c){var d=this,e=d.widget,f=e.columndrag,g=e.scroller;if((!f||"dragging"!==f.status)&&!a.isTouch&&!e.startResizing&&!1!==this.enabled&&e.trackOver&&!g.bottomKnobDown&&!g.rightKnobDown&&!d.keyNavigating){var h=e.getDomRow(c.rowIndex);a.each(h,function(b){a.get(b).addCls(j)}),e.fire("rowtrackenter",c)}},onRowLeave:function(b,c){var d=this.widget;if(!d.startResizing&&!1!==this.enabled&&d.trackOver){var e=d.getDomRow(c.rowIndex);a.each(e,function(b){a.get(b).removeCls(j)}),d.fire("rowtrackleave",c)}},onChangePage:function(){this.memory||this.clearSelection()},onLoad:function(){var a=this;a.memory||a.clearSelection()},initCellSelection:function(){var a=this,b=a.widget;b.on("cellclick",a.onCellClick,a),b.on("cellmousedown",a.onCellMouseDownCells,a),b.on("cellenter",a.onCellEnterSelection,a)},initRowSelection:function(){var a=this,b=a.widget;b.checkboxRowSelection&&(a.checkboxRow=!0,setTimeout(function(){"rows"===a.selModel&&a.renderHeaderCheckBox()},1)),b.on("rowclick",a.onRowClick,a),b.on("cellmousedown",a.onCellMouseDownRows,a),b.on("cellclick",a.onCellClickRows,a),b.on("rowenter",a.onRowEnterSelection,a),b.on("columndrag",a.onColumnDrag,a)},onCellMouseDownRows:function(b,c){var f=this,g=f.widget,h=g.store,i=a.get(c.e.target),j=c.column,k=h.isTree&&f.memory,l=a.get(document.body);if(f.stopOneTick&&delete f.stopOneTick,(!f.checkOnly||a.get(c.e.target).hasClass(p))&&!f.disabled){if(f.selectLeafsOnly&&!c.data.leaf)return void(f.stopOneTick=!0);if(f.rows&&f.enabled&&(!f.checkOnly||"$selected"===c.column.index||c.column.select)&&("tree"!==j.type||!i.hasCls(m))){if(!f.selectLeafsOnly&&!c.data.leaf&&i.hasClass(p)){var o=a.getWidget(i.parent().parent().attr("id")),q=!o.get();f.selectNodesChilds(c.id,q)}document.activeElement&&document.activeElement.blur();var r=c.e,s=r.target,t=r.ctrlKey,u=c.rowIndex,v=g.getDomRow(u);if((t||f.allowDeselect)&&g.multiSelect)a.get(v[0]).hasCls(d)?(f.domDeSelectRow(u),f.checkboxRow&&f.deSelectCheckBox(u),k&&(f.memory.removeDirtyParent(c.id,c.data.parentId),l.once("mouseup",function(){setTimeout(function(){f.updateSelectCheckBoxes()},100)}))):(f.domSelectRow(u),f.checkboxRow&&f.selectCheckBox(u),k&&f.memory.addDirtyParent(c.id,c.data.parentId));else if("$selected"===c.column.index||c.column.select){var w=a.getWidget(a.get(c.cell).select("."+n).attr("id"));w.el.within(s)?!0===w.get()?(f.domDeSelectRow(u),k&&(f.memory.removeDirtyParent(c.id,c.data.parentId),l.once("mouseup",function(){setTimeout(function(){f.updateSelectCheckBoxes()},100)}))):(f.domSelectRow(u),k&&f.memory.addDirtyParent(c.id,c.data.parentId)):(f.clearSelection(),f.domSelectRow(u),f.checkboxRow&&f.selectCheckBox(u),k&&f.memory.addDirtyParent(c.id,c.data.parentId))}else f.clearSelection(),f.domSelectRow(u),f.checkboxRow&&f.selectCheckBox(u),k&&f.memory.addDirtyParent(c.id,c.data.parentId);f.isMouseDown=!0,f.startRowSelection=u,a.$(document).one("mouseup",function(){delete f.isMouseDown,delete f.startCellSelection}),f.clearActiveCell(),a.get(c.cell).addCls(e),g.fire("select",f.getSelection()),k&&f.updateTreeSelection()}}},selectCheckBox:function(c){var d=this,e=d.widget;e.el.select("."+h+" ."+b+'[index="'+c+'"] .'+n).each(function(b){a.getWidget(b.attr("id")).set(!0)}),"rows"===e.selModel&&d.updateHeaderCheckBox()},deSelectCheckBox:function(c){var d=this,e=d.widget,f=e.store,g=e.el.select("."+h+" ."+b+'[index="'+c+'"] .'+n),i=f.get(c,"id");i&&(d.memory&&d.memory.remove(i),g.each(function(b){a.getWidget(b.attr("id")).set(!1)}),d.updateHeaderCheckBox())},domSelectRow:function(b){if(this.widget.inited){var c,e=this,f=e.widget,g=f.store,h=g.get(b,"id"),i=!1;f.startResizing||(e.memory&&(f.sorting||f.filtering||e.deselectingAll||f.draggingRows||e.memory.add(h)),c=f.getDomRow(b),a.each(c,function(b){b=a.get(b),b.hasClass(d)?i=!0:b.addCls(d)}),!1===i&&f.fire("selectrow",b,f.get(b)))}},domDeSelectRow:function(b){if(this.widget.inited){var c,e=this,f=e.widget,g=f.store,h=g.get(b,"id"),i=!0;e.memory&&(f.filtering||e.deselectingAll||f.draggingRows||f.sorting||e.memory.remove(h)),c=f.getDomRow(b),a.each(c,function(b){b=a.get(b),b.hasClass(d)?b.removeCls(d):i=!1}),i&&f.fire("deselectrow",b,f.get(b))}},onColumnEnterSelection:function(b,c){var d=this,f=d.widget;if(d.columns&&!0===d.isMouseDown){var g={columnIndex:d.startColumnColumnIndex,side:d.startColumnSide},h={columnIndex:c.columnIndex,side:c.side};if(g.side===h.side){switch(g.side){case"center":d.clearSelection("right"),d.clearSelection("left");break;case"left":d.clearSelection("center"),d.clearSelection("right");break;case"right":d.clearSelection("center"),d.clearSelection("left")}d.selectColumns(g.columnIndex,h.columnIndex,g.side)}else"center"===g.side&&"right"===h.side?(d.selectColumns(g.columnIndex,f.columns.length,"center"),d.selectColumns(0,h.columnIndex,"right")):"center"===g.side&&"left"===h.side?(d.selectColumns(0,g.columnIndex,"center"),d.selectColumns(h.columnIndex,f.leftColumns.length,"left")):"left"===g.side&&"center"===h.side?(d.clearSelection("right"),d.selectColumns(g.columnIndex,f.leftColumns.length,"left"),d.selectColumns(0,h.columnIndex,"center")):"left"===g.side&&"right"===h.side?(d.selectColumns(g.columnIndex,f.leftColumns.length,"left"),d.selectColumns(0,f.columns.length,"center"),d.selectColumns(0,h.columnIndex,"right")):"right"===g.side&&"center"===h.side?(d.clearSelection("left"),d.selectColumns(0,g.columnIndex,"right"),d.selectColumns(h.columnIndex,f.columns.length,"center")):"right"===g.side&&"left"===h.side&&(d.selectColumns(0,g.columnIndex,"right"),d.selectColumns(0,f.columns.length,"center"),d.selectColumns(h.columnIndex,f.leftColumns.length,"left"));d.clearActiveCell(),a.get(c.cell).addCls(e)}},onRowEnterSelection:function(b,c){var d=this,f=d.widget;if(!f.startResizing&&!1!==d.enabled&&d.rows&&!0===d.isMouseDown&&d.mouseMoveSelection){var g=d.startRowSelection,h=c.rowIndex,i={};g>h&&(g=c.rowIndex,h=d.startRowSelection);for(var j=g,k=h+1;j<k;j++)i[j]=!0;var l=d.getSelectedRowByColumn(c.columnIndex,c.side),m={},n={};for(var o in i)!0!==l[o]&&(m[o]=!0);for(var o in l)!0!==i[o]&&(n[o]=!0);for(var o in m)d.domSelectRow(o),d.checkboxRow&&d.selectCheckBox(o);for(var o in n)d.domDeSelectRow(o),d.checkboxRow&&d.deSelectCheckBox(o);d.clearActiveCell(),a.get(c.cell).addCls(e),f.fire("select",d.getSelection())}},getSelectedRowByColumn:function(a,b){var c,e=this.widget;switch(b){case"left":c=e.leftBody;break;case"center":c=e.body;break;case"right":c=e.rightBody}var g=c.el.select("."+f+'[index="'+a+'"][grid="'+e.id+'"]'),h=g.select("."+d),i={};return h.each(function(a){i[Number(a.attr("index"))]=!0}),i},getSelectedRow:function(){var a=this.widget,b=a.body,c=b.el.select("."+d);return 0===c.length?-1:Number(c.item(0).attr("index"))},getSelectedRows:function(){var a=this.widget,b=a.body,c=b.el.select("."+f+'[index="0"][grid="'+a.id+'"]'),e=c.select("."+d),g=[];return e.each(function(a){g.push(Number(a.attr("index")))}),g},initColumnSelection:function(){var a=this,b=a.widget;a.selectedColumns=[],b.on("columnclick",a.onColumnClick,a),b.on("columnmousedown",a.onColumnMouseDown,a),b.on("columnenter",a.onColumnEnterSelection,a)},onColumnClick:function(b,c){var d=this;if(d.column&&!1!==c.column.selectable){var f=a.get(c.columnDom);d.column&&(d.selectedColumns[0]=c),d.clearSelection(),f.addCls(i),a.get(c.cell).addCls(e)}},onRowClick:function(b,c){var f=this,g=f.widget,h=(g.store,c.rowIndex),i=a.get(c.e.target);if(!f.disabled&&f.row&&!1!==c&&(!f.checkOnly||"$selected"===c.column.index||c.column.select)&&(!f.selectLeafsOnly||c.data.leaf)){var j=c.column,k=!0;if("tree"!==j.type||!i.hasCls(m)){"action"===j.type&&j.items&&a.each(j.items,function(a){"remove"===a.action&&(k=!1)});var l=a.get(c.cell).hasClass(d);if(a.get(c.cell).addCls(e),"$selected"===c.column.index||c.column.select){var o=a.getWidget(a.get(c.cell).select("."+n).attr("id")),p=o.get();if(o.el.within(i))f.clearSelection(),!0===p?(f.selectCheckBox(h),f.domSelectRow(h)):f.deSelectCheckBox(h);else{if(f.checkOnly)return;f.clearSelection(),!0!==p?(f.selectCheckBox(h),f.domSelectRow(h)):f.deSelectCheckBox(h)}g.fire("select",f.getSelection())}else k&&(f.clearSelection(),f.allowDeselect&&l||(f.domSelectRow(h),f.selectCheckBox(h)),g.fire("select",f.getSelection()))}}},onCellClickRows:function(b,c){var d=this,e=d.widget;if(!d.disabled&&d.rows&&d.enabled&&(!d.checkOnly||"$selected"===c.column.index||c.column.select)){var f=c.e,g=f.ctrlKey,h=c.rowIndex;if((g||d.allowDeselect)&&e.multiSelect);else if("$selected"===c.column.index||c.column.select){var i=a.getWidget(a.get(c.cell).select("."+n).attr("id"));!0!==i.middle&&(!0===i.get()?d.selectCheckBox(h):d.deSelectCheckBox(h))}}},selectRow:function(c,d,e){var g=this,h=g.widget,i=h.leftBody,j=h.body,k=h.rightBody;if(void 0===d&&(d=!0),e=e||!1,!h.startResizing){if(!g.row&&!g.rows)throw new Error("[FancyGrid Error] - row selection was not enabled");e||g.clearSelection(),d?g.domSelectRow(c):g.domDeSelectRow(c),a.each(h.columns,function(a,e){if("select"===a.type||a.select){var g=j.el.select("."+f+'[index="'+e+'"] .'+b+'[index="'+c+'"] .'+n),h=Fancy.getWidget(g.attr("id"));h&&h.set(d)}}),a.each(h.leftColumns,function(a,e){if("select"===a.type||a.select){var g=i.el.select("."+f+'[index="'+e+'"] .'+b+'[index="'+c+'"] .'+n),h=Fancy.getWidget(g.attr("id"));h&&h.set(d)}}),a.each(h.rightColumns,function(a,e){if("select"===a.type||a.select){var g=k.el.select("."+f+'[index="'+e+'"] .'+b+'[index="'+c+'"] .'+n),h=Fancy.getWidget(g.attr("id"));h&&h.set(d)}}),h.fire("select",g.getSelection())}},selectById:function(a,b,c){var d=this,e=d.widget,f=e.find("id",String(a))[0];void 0!==f?d.selectRow(f,b,c):(f=e.find("id",Number(a))[0],void 0!==f?d.selectRow(f,b,c):d.memory&&(!0===b||void 0===b?d.memory.add(a):d.memory.remove(a)))},onCellClick:function(b,c){var f=this,g=f.widget;f.cell&&(f.clearSelection(),a.get(c.cell).addCls(d,e),g.fire("select",f.getSelection()))},clearSelection:function(a){var e=this,f=e.widget;if(e.checkboxRow){var g=f.el.select("."+h+" ."+o),j={};g.each(function(a){var c=a.closest("."+b).attr("index");j[c]||(j[c]=!0,e.deSelectCheckBox(c))})}if(e.memory&&e.memory.clearAll(),a)switch(a){case"left":f.leftBody.el.select("."+d).removeCls(d),f.leftBody.el.select("."+i).removeCls(i),f.leftBody.el.select("."+c).removeCls(c);break;case"center":f.body.el.select("."+d).removeCls(d),f.body.el.select("."+i).removeCls(i),f.body.el.select("."+c).removeCls(c);break;case"right":f.rightBody.el.select("."+d).removeCls(d),f.rightBody.el.select("."+i).removeCls(i),f.rightBody.el.select("."+c).removeCls(c)}else f.el.select("."+d).removeCls(d),f.el.select("."+i).removeCls(i),f.el.select("."+c).removeCls(c);e.clearActiveCell(),f.fire("clearselect"),f.fire("select",f.getSelection())},onSort:function(){var a=this;if(a.clearActiveCell(),a.memory)return void a.updateSelection();a.clearSelection()},onCellEnterSelection:function(b,c){var d=this,f=d.widget,g=f.columndrag,h=0;if((!g||"dragging"!==g.status)&&d.cells&&!0===d.isMouseDown){d.prevCellsSelection=c.cell,d.prevCellRowIndex=c.rowIndex,d.prevCellColumnIndex=c.columnIndex,d.prevCellSide=c.side;var i={rowIndex:d.startCellRowIndex,columnIndex:d.startCellColumnIndex,side:d.startCellSide},j={rowIndex:c.rowIndex,columnIndex:c.columnIndex,side:c.side};c.rowIndex<d.startCellRowIndex&&(i.rowIndex=c.rowIndex,j.rowIndex=d.startCellRowIndex),d.startCellSide===c.side?(c.columnIndex<d.startCellColumnIndex&&(i.columnIndex=c.columnIndex,j.columnIndex=d.startCellColumnIndex),h=d.selectCells(i,j,i.side),"left"===d.startCellSide?(d.clearSelection("center"),d.clearSelection("right")):"center"===d.startCellSide?(d.clearSelection("left"),d.clearSelection("right")):"right"===d.startCellSide&&(d.clearSelection("left"),d.clearSelection("center"))):"left"===d.startCellSide?(h=d.selectCells(i,{rowIndex:c.rowIndex,columnIndex:f.leftColumns.length-1},"left"),"center"===c.side?(h+=d.selectCells({columnIndex:0,rowIndex:i.rowIndex},j,"center"),d.clearSelection("right")):"right"===c.side&&(h+=d.selectCells({columnIndex:0,rowIndex:i.rowIndex},{columnIndex:f.columns.length-1,rowIndex:j.rowIndex},"center"),h+=d.selectCells({columnIndex:0,rowIndex:i.rowIndex},j,"right"))):"center"===d.startCellSide?"left"===c.side?(h+=d.selectCells({columnIndex:0,rowIndex:i.rowIndex},{rowIndex:j.rowIndex,columnIndex:i.columnIndex},"center"),h+=d.selectCells({columnIndex:j.columnIndex,rowIndex:i.rowIndex},{rowIndex:j.rowIndex,columnIndex:f.leftColumns.length-1},"left")):"right"===c.side&&(h+=d.selectCells({columnIndex:i.columnIndex,rowIndex:i.rowIndex},{columnIndex:f.columns.length-1,rowIndex:j.rowIndex},"center"),h+=d.selectCells({columnIndex:0,rowIndex:i.rowIndex},{columnIndex:j.columnIndex,rowIndex:j.rowIndex},"right")):"right"===d.startCellSide&&(h+=d.selectCells({columnIndex:0,rowIndex:i.rowIndex},{columnIndex:i.columnIndex,rowIndex:j.rowIndex},"right"),"center"===c.side?(h+=d.selectCells({columnIndex:j.columnIndex,rowIndex:i.rowIndex},{columnIndex:f.columns.length-1,rowIndex:j.rowIndex},"center"),d.clearSelection("left")):"left"===c.side&&(h+=d.selectCells({columnIndex:0,rowIndex:i.rowIndex},{columnIndex:f.columns.length-1,rowIndex:j.rowIndex},"center"),h+=d.selectCells({columnIndex:j.columnIndex,rowIndex:i.rowIndex},{columnIndex:f.leftColumns.length-1,rowIndex:j.rowIndex},"left"))),d.endCellRowIndex=j.rowIndex,d.clearActiveCell(),a.get(c.cell).addCls(e),f.fire("select",d.getSelection())}},onColumnMouseDown:function(b,c){var d=this,f=d.widget;if(d.columns&&!1!==c.column.selectable&&d.enabled){document.activeElement&&document.activeElement.blur();var g=a.get(c.columnDom);d.isMouseDown=!0,d.startColumnColumnIndex=c.columnIndex,d.startColumnSide=c.side,d.clearSelection(),g.addCls(i),a.$(document).one("mouseup",function(){delete d.isMouseDown}),a.get(c.cell).addCls(e),f.fire("select",d.getSelection())}},onCellMouseDownCells:function(b,c){var f=this,g=f.widget;if(g.celledit&&g.celledit.hideEditor(),f.cells&&f.enabled){document.activeElement&&document.activeElement.blur();var h=a.get(c.cell);f.clearSelection(),g.el.select("."+e).removeCls(e),h.addCls(d,e),f.isMouseDown=!0,f.startCellSelection=c.cell,f.startCellRowIndex=c.rowIndex,f.startCellColumnIndex=c.columnIndex,f.startCellSide=c.side,a.$(document).one("mouseup",function(){delete f.isMouseDown,delete f.startCellSelection}),g.fire("select",f.getSelection())}},selectCells:function(a,b,c){var e,f,g,h=this,i=h.widget,j=i.body,k=i.leftBody,l=i.rightBody,m=a.rowIndex,n=b.rowIndex+1,o=h.getSelectedCells(c||"center"),p={},q={},r={};for(m=a.rowIndex,n=b.rowIndex+1;m<n;m++)for(p[m]=p[m]||{},f=a.columnIndex,g=b.columnIndex+1;f<g;f++)p[m][f]=!0;for(var s in p)if(void 0===o[s])q[s]=p[s];else for(var t in p[s])!0!==o[s][t]&&(q[s]=q[s]||{},q[s][t]=!0);for(var s in o)if(void 0===p[s])r[s]=o[s];else for(var t in o[s])!0!==p[s][t]&&(r[s]=r[s]||{},r[s][t]=!0);switch(c){case"left":e=k;break;case"center":e=j;break;case"right":e=l;break;default:e=j}for(var s in q)for(var t in q[s]){var u=e.getCell(s,t);u.addCls(d)}for(var s in r)for(var t in r[s]){var u=e.getCell(s,t);u.removeCls(d)}},getSelectedCells:function(a){for(var b=this,c=b.widget,e=c.getBody(a||"center"),f=e.el.select("."+d),g={},h=0,i=f.length;h<i;h++){var j=f.item(h),k=Number(j.parent().attr("index")),l=Number(j.attr("index"));g[l]=g[l]||{},g[l][k]=!0}return g},getNumberSelectedCells:function(){return this.widget.el.select("."+d).length},getSelectedColumns:function(a){for(var b=this.widget,c=b.getBody(a),d={},e=c.el.select("."+i),f=0,g=e.length;f<g;f++)d[e.item(f).attr("index")]=!0;return d},selectColumns:function(a,b,c){var d=this,e=d.getSelectedColumns(c||"center"),f={},g={},h={},i=a,j=b;for(j<i&&(i=b,j=a),j++;i<j;i++)f[i]=!0;for(var k in f)!0!==e[k]&&(g[k]=!0);for(var k in e)!0!==f[k]&&(h[k]=!0);for(var k in g)d.selectColumn(k,c);for(var k in h)d.deselectColumn(k,c)},selectColumn:function(b,c){var d=this.widget,e=d.getBody(c||"center");a.get(e.getDomColumn(b)).addCls(i)},deselectColumn:function(b,c){var d=this.widget,e=d.getBody(c||"center");a.get(e.getDomColumn(b)).removeCls(i)},getSelection:function(b){var c,d=this,e=d.widget,f=e.store,g={};switch(d.selModel){case"row":g.row=d.getSelectedRow(),-1!==g.row?(g.items=[f.get(g.row)],g.rows=[g.row]):(g.items=[],g.rows=[]);break;case"rows":if(g.rows=d.getSelectedRows(),d.memory&&d.memory.all)c=d.memory.excepted,f.filteredDataMap?g.items=Fancy.Array.copy(f.filteredData):g.items=Fancy.Array.copy(f.data);else if(g.items=[],d.memory&&!Fancy.Object.isEmpty(d.memory.selected)){var h=d.memory.selected;if(f.filteredDataMap)for(var i in h)f.filteredDataMap[i]&&g.items.push(f.getById(i));else for(var i in h)g.items.push(f.getById(i))}else for(var j=0,k=g.rows.length;j<k;j++)g.items.push(f.get(g.rows[j]));break;case"cells":case"cell":g.items=d.getSelectedData()}if(c){var l=[];a.each(g.items,function(b,d){a.isObject(b.data)&&(g.items[d]=b.data);var e=g.items[d].id;c[e]||l.push(g.items[d])}),g.items=l}else a.each(g.items,function(b,c){b&&a.isObject(b.data)&&(g.items[c]=b.data)});return b?g:g.items||[]},renderHeaderCheckBox:function(){var a=this,b=this.widget;b.header&&(a._renderHeaderCheckBox(b.leftHeader,b.leftColumns),a._renderHeaderCheckBox(b.header,b.columns),a._renderHeaderCheckBox(b.rightHeader,b.rightColumns))},_renderHeaderCheckBox:function(b,c){var d=this,e=d.widget,f=d.memory,g=e.getSelection();a.each(c,function(c,h){if(("$selected"===c.index||c.select)&&!1!==c.headerCheckBox){var i=b.getCell(h);i.addCls(k);var j=i.firstChild(),m=!d.disabled,o=i.select("."+l);if(c.select?o.update(c.title||""):o.update(""),j.select("."+n).length){a.getWidget(j.select("."+n).item(0).attr("id")).destroy()}var p=!1;d.memory?f.all&&(p=!0):g.length===e.getViewTotal()&&0!==g.length&&(p=!0),c.headerCheckBox=new a.CheckBox({renderTo:j.dom,renderBefore:c.select?o:void 0,renderId:!0,value:p,label:!1,editable:m,disabled:d.disabled,style:{padding:"0px",display:"inline-block"},events:[{change:function(a,b){b?(f&&f.setAll(),d.selectAll()):(f&&f.clearAll(),d.deSelectAll()),d.updateHeaderCheckBox()}}]})}})},selectAll:function(){var c=this,d=c.widget,e=d.store,f=d.el.select("."+k+" ."+n),g=0,i=d.getViewTotal();for(c.memory&&e.isTree&&(c.memory.tree.selected={},c.memory.tree.allSelected={},c.memory.tree.selectedLength={},c.updateTreeSelection()),c.selectingAll=!0;g<i;g++){for(var j=d.el.select("."+h+" ."+b+'[index="'+g+'"] .'+n),l=0,m=j.length;l<m;l++){a.getWidget(j.item(l).attr("id")).setValue(!0)}c.domSelectRow(g)}f.each(function(b){a.getWidget(b.attr("id")).setValue(!0,!1)}),d.fire("select",d.getSelection()),setTimeout(function(){delete c.selectingAll},1)},deSelectAll:function(){var c=this,d=c.widget,e=d.store,f=0,g=d.getViewTotal();for(c.memory&&e.isTree&&(c.memory.tree.selected={},c.memory.tree.allSelected={},c.memory.tree.selectedLength={},c.updateTreeSelection()),c.deselectingAll=!0;f<g;f++){d.el.select("."+h+" ."+b+'[index="'+f+'"] .'+n).each(function(b){a.getWidget(b.attr("id")).setValue(!1)}),c.domDeSelectRow(f)}c.updateHeaderCheckBox(),d.fire("clearselect"),d.fire("select",d.getSelection()),delete c.deselectingAll},updateHeaderCheckBox:function(){var b=this,c=b.widget,d=c.getTotal();c.el.select("."+k+" ."+n).each(function(c){var e=a.getWidget(c.attr("id"));b.memory?b.memory.selectedLength>0||b.memory.all?b.memory.selectedLength===d?(e.setValue(!0,!1),e.setMiddle(!1)):b.memory.all&&0===b.memory.exceptedLength?(e.setValue(!0,!1),e.setMiddle(!1)):(e.setMiddle(!0),e.setValue(!1,!1)):(e.setMiddle(!1),e.setValue(!1,!1)):b.selectingAll?e.setValue(!0,!1):e.setValue(!1,!1)})},stopSelection:function(){this.enabled=!1},enableSelection:function(a){var b=this;if(!0===b.disabled&&b.enableHeaderCheckBoxes(),b.disabled=!1,b.disabled=!1,void 0!==a)return void(this.enabled=a);this.enabled=!0},initFixTrackOver:function(){var a=this,b=a.widget;b.columns&&(b.body.el.on("mouseleave",a.onBodyMouseLeave,a),b.body.el.on("mouseenter",a.onBodyMouseEnter,a)),b.leftColumns&&(b.leftBody.el.on("mouseleave",a.onLeftBodyMouseLeave,a),b.leftBody.el.on("mouseenter",a.onLeftBodyMouseEnter,a)),b.rightColumns&&(b.rightBody.el.on("mouseleave",a.onRightBodyMouseLeave,a),b.rightBody.el.on("mouseenter",a.onRightBodyMouseEnter,a))},onBodyMouseLeave:function(){var a=this,b=a.widget;a.clearBodyTrackCls(b.body)},onBodyMouseEnter:function(){var a=this;a.rowTrackFixInBody=!0,setTimeout(function(){a.rowTrackFixInBody=!1},30)},onLeftBodyMouseLeave:function(){var a=this,b=a.widget;a.clearBodyTrackCls(b.leftBody)},onLeftBodyMouseEnter:function(){var a=this;a.rowTrackFixInBody=!0,setTimeout(function(){a.rowTrackFixInBody=!1},30)},onRightBodyMouseLeave:function(){var a=this,b=a.widget;a.clearBodyTrackCls(b.rightBody)},onRightBodyMouseEnter:function(){var a=this;a.rowTrackFixInBody=!0,setTimeout(function(){a.rowTrackFixInBody=!1},30)},clearBodyTrackCls:function(a){var b=this,d=b.widget;d.cellTrackOver&&a.el.select("."+c).removeCls(c),d.trackOver&&(delete a.prevCellOver,b.rowTrackFixInterval&&(clearInterval(b.rowTrackFixInterval),delete b.rowTrackFixInterval),b.rowTrackFixInterval=setTimeout(function(){b.rowTrackFixInBody||d.el.select("."+j).removeCls(j)},20))},onColumnLock:function(){var b,c=this,d=c.widget;if(c.cells||c.cell||c.column||c.columns)return void c.clearSelection();b=c.getSelection(!0),a.each(b.rows,function(a){d.selectRow(a,!0,"rows"===d.selModel)},100),setTimeout(function(){c.renderHeaderCheckBox()},100)},onColumnRightLock:function(){var b,c=this,d=c.widget;if(c.cells||c.cell||c.column||c.columns)return void c.clearSelection();setTimeout(function(){b=c.getSelection(!0),a.each(b.rows,function(a){d.selectRow(a,!0,"rows"===d.selModel)})},100),setTimeout(function(){c.renderHeaderCheckBox()},100)},onUnColumnLock:function(){var b,c=this,d=c.widget;if(c.cells||c.cell||c.column||c.columns)return void c.clearSelection();setTimeout(function(){b=c.getSelection(!0),a.each(b.rows,function(a){d.selectRow(a,!0,"rows"===d.selModel)})},100),setTimeout(function(){c.renderHeaderCheckBox()},100)},disableSelection:function(){var a=this;a.disabled=!0,a.enableHeaderCheckBoxes(!1)},enableHeaderCheckBoxes:function(b){var c=this,d=c.widget,e=d.body,g=d.leftBody,h=d.rightBody,i="enable";!1===b&&(i="disable"),a.each(d.columns,function(b,c){"select"===b.type&&b.headerCheckBox&&(b.headerCheckBox[i](),e.el.select("."+f+'[index="'+c+'"] .'+n).each(function(b){a.getWidget(b.attr("id"))[i]()}))}),a.each(d.leftColumns,function(b,c){"select"===b.type&&b.headerCheckBox&&(b.headerCheckBox[i](),g.el.select("."+f+'[index="'+c+'"] .'+n).each(function(b){a.getWidget(b.attr("id"))[i]()}))}),a.each(d.rightColumns,function(b,c){"select"===b.type&&b.headerCheckBox&&(b.headerCheckBox[i](),h.el.select("."+f+'[index="'+c+'"] .'+n).each(function(b){a.getWidget(b.attr("id"))[i]()}))})},onFilter:function(){var b=this,c=b.widget;b.clearActiveCell(),b.memory||b.clearSelection(),"rows"===b.selModel&&(a.each(c.leftColumns,function(d,e){if("select"===d.type){var f=c.leftHeader.getCell(e),g=a.getWidget(f.select("."+n).attr("id"));g&&(b.memory&&b.memory.all||g.set(!1,!1))}}),a.each(c.columns,function(d,e){if("select"===d.type){var f=c.header.getCell(e),g=a.getWidget(f.select("."+n).attr("id"));g&&(b.memory&&b.memory.all||g.set(!1,!1))}}),a.each(c.rightColumns,function(d,e){if("select"===d.type){var f=c.rightHeader.getCell(e),g=a.getWidget(f.select("."+n).attr("id"));g&&(b.memory&&b.memory.all||g.set(!1,!1))}}))},onExpand:function(){var a=this;a.clearActiveCell(),a.memory||a.clearSelection()},onCollapse:function(){var a=this;a.clearActiveCell(),a.memory||a.clearSelection()},getActiveCell:function(){var a=this,b=a.widget,c=b.el.select("."+e);return c.dom||(c=b.el.select("."+d),c=c.dom?c.item(0):b.body.getCell(0,0)),c},getActiveCellInfo:function(){var a=this,b=a.widget,c=a.getActiveCell();return{side:b.getSideByCell(c),rowIndex:Number(c.attr("index")),columnIndex:Number(c.parent().attr("index"))}},clearActiveCell:function(){this.widget.el.select("."+e).removeCls(e)},initCopyEl:function(){var b=this,c=b.widget,d=a.get(document.createElement("textarea"));d.addCls(q),d.attr("aria-hidden","true"),b.copyEl=a.get(c.el.dom.appendChild(d.dom))},copy:function(b){var c,d=this,e=d.widget,f=d.copyEl;switch(d.selModel){case"cells":case"cell":var g=d.getSelectedData(b),h="";a.each(g,function(a){h+=a.join("\t")+"\n"}),f.dom.value=h;break;case"rows":case"row":c=d.getSelection();var i=[].concat(e.leftColumns).concat(e.columns).concat(e.rightColumns),h="";if(b){var j=[];a.each(i,function(a){switch(a.index){case"$selected":case"$rowdrag":return}j.push(a.index||"")}),h+=j.join("\t")+"\n"}a.each(c,function(b){var c=[];a.each(i,function(a){switch(a.index){case"$selected":case"$rowdrag":return}a.index&&c.push(b[a.index])}),h+=c.join("\t")+"\n"}),f.dom.value=h;break;case"columns":case"column":var g=[],k=e.getDataView(),l=function(c){var f=e.getColumns(c),h=d.getSelectedColumns(c);for(var i in h){var j=f[i];b&&(g.push([]),g[0].push(j.title||"")),j.index&&a.each(k,function(a,c){b&&c++,void 0===g[c]&&(g[c]=[]),g[c].push(a[j.index])})}};e.leftColumns&&l("left"),e.columns&&l("center"),e.rightColumns&&l("right");var h="";a.each(g,function(a){h+=a.join("\t")+"\n"}),f.dom.value=h}f.dom.select(),f.dom.focus(),document.execCommand("copy")},initCopyKeys:function(){var a=this;Fancy.get(document).on("keydown",a.onKeyDownCopy,a)},onKeyDownCopy:function(a){var b=this,c=b.widget,d=a.keyCode,e=Fancy.key;if(!1!==c.activated&&a.ctrlKey)switch(d){case e.C:if(c.celledit&&c.celledit.activeEditor)return;if(c.textSelection)return;b.copy();break;case e.V:}},onColumnDrag:function(){var a=this;setTimeout(function(){a.renderHeaderCheckBox()},100)},disableSelectionMove:function(){this.mouseMoveSelection=!1},getSelectedData:function(a){var b=this,c=b.widget,d=[],e=function(e){var f=c.getColumns(e),g=b.getSelectedCells(e),h=0,i=!1;for(var j in g){var k=c.get(j),l=g[j];if(!i&&a){d.push([]);for(var m in l){var n=f[m];n.index,d[0].push(n.title||"")}h++,i=!0}for(var m in l){var n=f[m];d[h]||(d[h]=[]),n.index&&d[h].push(k.get(n.index))}h++}};return e("left"),e("center"),e("right"),d},selectNodesChilds:function(b,c){var d=this,e=d.widget,f=e.getById(b);!1===c&&d.memory&&d.memory.remove(b),f.set("$selected",c);var g=function(f){a.each(f,function(a,f){if(a.$selected=c,!a.id)return!0;var h=e.getRowById(a.id);void 0!==h&&e.selectRow(h,c,!0),!1===c&&d.memory&&d.memory.remove(b),a.data&&a.data.child&&g(a.data.child)})};g(f.data.child)},clearOverCells:function(){this.widget.el.select("."+c).removeCls(c)},onDragRows:function(){this.clearActiveCell()},onRemoveRows:function(){var a=this;a.rows&&(a._interval&&clearInterval(a._interval),a._interval=setTimeout(function(){a.updateHeaderCheckBox(),delete a._interval},1))},onTreeExpand:function(){var a=this,b=a.widget;a.memory?(a.updateSelection(),a.updateTreeSelection()):b.clearSelection()},onTreeCollapse:function(){var a=this,b=a.widget;a.memory?(a.updateSelection(),a.updateTreeSelection()):b.clearSelection()},updateSelection:function(){var a=this,b=a.widget,c=b.body;if(a.memory){c.el.select("."+f+'[index="0"] .'+d).each(function(c){var d=c.attr("index"),e=b.get(d),f=e.id;a.memory.has(f)||a.domDeSelectRow(d)});for(var e in a.memory.selected){var g=b.getRowById(e);void 0!==g&&a.domSelectRow(g)}}},updateSelectCheckBoxes:function(){var c=this,d=c.widget;if(c.memory){d.el.select("."+h+" ."+o).each(function(e){var f=e.closest("."+b).attr("index"),g=d.get(f),h=g.id;if(!c.memory.has(h)){a.getWidget(e.attr("id")).set(!1,!1),c.domDeSelectRow(f)}})}},updateTreeSelection:function(){var c=this,e=c.widget;for(var g in c.memory.tree.selected){var i=e.getRowById(g),j=e.el.select("."+h+" ."+b+'[index="'+i+'"] .'+n);c.memory.tree.allSelected[g]?j.each(function(b){var d=b.attr("id"),e=a.getWidget(d);setTimeout(function(){e.set(!0,!1),e.setMiddle(!1),c.memory.add(g),c.domSelectRow(i)},200)}):j.each(function(b){var c=b.attr("id");a.getWidget(c).setMiddle(!0)})}e.el.select("."+f+"."+h+" ."+r).each(function(f){var g=f.closest("."+b),h=g.attr("index"),i=e.get(h,"id"),j=a.getWidget(f.attr("id"));c.memory.tree.selected[i]||(j.setMiddle(!1),c.memory.tree.allSelected[i]?j.setMiddle(!1):j.set(!1,!1)),c.memory.tree.allSelected[i]&&setTimeout(function(){j.set(!0,!1),j.setMiddle(!1),c.memory.add(i),c.domSelectRow(h)},200),j.hasCls(o)&&(j.removeCls(r),c.domSelectRow(h),c.memory.add(i),c.memory.removeDirtyParent(i)),g.hasCls(d)&&!j.hasCls(o)&&j.set(!0,!1)})}})}(),function(){var a=Fancy,b=a.GRID_CELL_ACTIVE_CLS,c=a.GRID_CELL_SELECTED_CLS;a.Mixin("Fancy.grid.selection.mixin.Navigation",{initNavigation:function(){this.addEvents("up","down","left","right"),this.onsNav()},onsNav:function(){var a=this;Fancy.get(document).on("keydown",a.onKeyDown,a)},onKeyDown:function(b){var c=this,d=c.widget,e=b.keyCode,f=Fancy.key;if(!1!==d.activated){if(!c.keyNavigating){a.get(document).once("keyup",function(){delete c.keyNavigating})}switch(e){case f.TAB:break;case f.UP:c.keyNavigating=!0,b.preventDefault(),c.moveUp();break;case f.DOWN:c.keyNavigating=!0,b.preventDefault(),c.moveDown();break;case f.LEFT:c.keyNavigating=!0,b.preventDefault(),c.moveLeft();break;case f.RIGHT:c.keyNavigating=!0,b.preventDefault(),c.moveRight();break;case f.PAGE_UP:b.preventDefault(),c.scrollPageUP();break;case f.PAGE_DOWN:b.preventDefault(),c.scrollPageDOWN();break;case f.ENTER:if(d.celledit&&!c.activeEditor&&(d.selection&&"cell"===d.selection.selModel||"cells"===d.selection.selModel)){var g=d.selection.getActiveCell();if(g){var h=d.selection.getActiveCellInfo(),i=d.getColumns(h.side);if(h.column=i[h.columnIndex],!1===h.column.editable)return;h.cell=g.dom;var j=d.get(h.rowIndex);h.item=j,h.data=j.data,h.column.smartIndexFn?h.value=h.column.smartIndexFn(h.data):h.value=d.store.get(h.rowIndex,h.column.index),d.celledit.edit(h)}}}}},moveRight:function(){var a,d=this,e=d.widget,f=d.getActiveCellInfo(),g=e.getBody(f.side);if(f.columnIndex++,a=g.getCell(f.rowIndex,f.columnIndex),!a.dom)switch(f.side){case"left":e.columns&&(f.columnIndex=0,g=e.getBody("center"),f.side="center",a=g.getCell(f.rowIndex,f.columnIndex));break;case"center":e.rightColumns&&e.rightColumns.length&&(f.columnIndex=0,g=e.getBody("right"),f.side="right",a=g.getCell(f.rowIndex,f.columnIndex));break;case"right":return}if(a.dom){switch(f.side){case"left":var h=e.leftColumns[f.columnIndex];if(h.hidden){for(var i=f.columnIndex,j=e.leftColumns.length,k=!1;i<j;i++)if(h=e.leftColumns[i],!h.hidden){k=!0,f.columnIndex=i;break}if(!k){f.columnIndex--;for(var i=f.columnIndex,j=e.columns.length,k=!1;i<j;i++)if(h=e.columns[i],!h.hidden){k=!0,f.columnIndex=i;break}k&&(f.side="center",g=e.getBody(f.side))}a=g.getCell(f.rowIndex,f.columnIndex)}break;case"center":var h=e.columns[f.columnIndex];if(h.hidden){for(var i=f.columnIndex,j=e.columns.length,k=!1;i<j;i++)if(h=e.columns[i],!h.hidden){k=!0,f.columnIndex=i;break}k||f.columnIndex--,a=g.getCell(f.rowIndex,f.columnIndex)}break;case"right":var h=e.rightColumns[f.columnIndex];if(h.hidden){for(var i=f.columnIndex,j=e.rightColumns.length,k=!1;i<j;i++)if(h=e.rightColumns[i],!h.hidden){k=!0,f.columnIndex=i;break}k||f.columnIndex--,a=g.getCell(f.rowIndex,f.columnIndex)}}switch(d.selModel){case"cell":case"cells":d.clearSelection(),a.addCls(b,c),e.scroller.scrollToCell(a.dom,!0);break;case"column":case"columns":d.clearSelection(),d.selectColumn(f.columnIndex,f.side),a.addCls(b,c),e.scroller.scrollToCell(a.dom,!0)}}},moveLeft:function(){var a,d,e=this,f=e.widget,g=e.getActiveCellInfo(),h=f.getBody(g.side);if(--g.columnIndex<0)switch(g.side){case"left":return;case"center":if(!f.leftColumns||!f.leftColumns.length)return;g.columnIndex=f.leftColumns.length-1,h=f.getBody("left"),g.side="left",a=h.getCell(g.rowIndex,g.columnIndex);var i=f.leftColumns[g.columnIndex];if(i.hidden)for(var j=g.columnIndex-1,k=!1;j>=0;j--)if(i=f.leftColumns[j],!i.hidden){k=!0,g.columnIndex=j;break}a=h.getCell(g.rowIndex,g.columnIndex);break;case"right":f.columns&&f.columns.length&&(g.columnIndex=f.columns.length-1,h=f.getBody("center"),g.side="center",a=h.getCell(g.rowIndex,g.columnIndex))}else{switch(g.side){case"left":var i=f.leftColumns[g.columnIndex];if(i.hidden){for(var j=g.columnIndex-1,k=!1;j>=0;j--)if(i=f.leftColumns[j],!i.hidden){k=!0,g.columnIndex=j;break}k||g.columnIndex++}break;case"center":var i=f.columns[g.columnIndex];if(i.hidden){for(var j=g.columnIndex-1,k=!1;j>=0;j--)if(i=f.columns[j],!i.hidden){k=!0,g.columnIndex=j;break}if(!k&&(g.columnIndex++,f.leftColumns)){for(var j=f.leftColumns.length-1,k=!1;j>=0;j--)if(i=f.leftColumns[j],!i.hidden){k=!0,g.columnIndex=j;break}k&&(d="left",h=f.getBody(d))}}break;case"right":var i=f.rightColumns[g.columnIndex];if(i.hidden){for(var j=g.columnIndex-1,k=!1;j>=0;j--)if(i=f.rightColumns[j],!i.hidden){k=!0,g.columnIndex=j;break}if(!k){g.columnIndex++;var j=f.columns.length-1,k=!1;for(d="center",h=f.getBody(d);j>=0;j--)if(i=f.columns[j],!i.hidden){k=!0,g.columnIndex=j;break}}}}a=h.getCell(g.rowIndex,g.columnIndex)}if(a.dom)switch(e.selModel){case"cell":case"cells":e.clearSelection(),a.addCls(b,c),f.scroller.scrollToCell(a.dom,!0);break;case"column":case"columns":e.clearSelection(),e.selectColumn(g.columnIndex,g.side),a.addCls(b,c),f.scroller.scrollToCell(a.dom,!0)}},moveUp:function(){var a,d=this,e=d.widget,f=d.getActiveCellInfo(),g=e.getBody(f.side);if(!(--f.rowIndex<0)&&(a=g.getCell(f.rowIndex,f.columnIndex),a.dom))switch(d.selModel){case"cell":case"cells":d.clearSelection(),a.addCls(b,c),e.scroller.scrollToCell(a.dom,!0);break;case"row":case"rows":d.clearSelection(),d.selectRow(f.rowIndex),a.addCls(b,c),e.scroller.scrollToCell(a.dom,!0),"rows"===d.selModel&&d.updateHeaderCheckBox()}},moveDown:function(){var a,d=this,e=d.widget,f=d.getActiveCellInfo(),g=e.getBody(f.side);if(f.rowIndex++,a=g.getCell(f.rowIndex,f.columnIndex),a.dom)switch(d.selModel){case"cell":case"cells":d.clearSelection(),a.addCls(b,c),e.scroller.scrollToCell(a.dom,!0);break;case"row":case"rows":d.clearSelection(),d.selectRow(f.rowIndex),a.addCls(b,c),e.scroller.scrollToCell(a.dom,!0),"rows"===d.selModel&&d.updateHeaderCheckBox()}},scrollPageUP:function(){var a=this,b=a.widget,c=parseInt(b.body.el.height()),d=b.scroller,e=d.scrollTop-c;e<0&&(e=0),b.scroll(e)},scrollPageDOWN:function(){var a=this,b=a.widget,c=b.gridBorders,d=b.getBodyHeight()-c[0]-c[2],e=b.getCellsViewHeight()-c[0]-c[2],f=b.scroller,g=f.scrollTop+d;g>e-d&&(g=e-d),g<0&&(g=0),b.scroll(g)}})}(),Fancy.modules.expander=!0,function(){var a=Fancy,b=a.get,c=a.GRID_CELL_CLS,d=a.GRID_COLUMN_CLS,e=a.GRID_ROW_EXPAND_CLS,f=a.GRID_ROW_EXPAND_OVER_CLS,g=a.GRID_ROW_EXPAND_SELECTED_CLS,h=a.GRID_ROW_OVER_CLS;a.define("Fancy.grid.plugin.Expander",{extend:a.Plugin,ptype:"grid.expander",inWidgetName:"expander",plusScroll:0,enabledCollapse:!0,constructor:function(){this.Super("const",arguments)},init:function(){var a=this;a.Super("init",arguments),a._expanded={},a._expandedIds={},a.expandedGroups={},a.initTpl(),a.ons()},ons:function(){var a=this,b=a.widget,c=b.store;b.on("scroll",a.onScroll,a),b.on("beforesort",a.onBeforeSort,a),b.on("changepage",a.onChangePage,a),b.on("filter",a.onFilter,a),b.on("columnresize",a.onColumnReSize,a),b.on("rowdblclick",a.onRowDBlClick,a),b.on("rowtrackenter",a.onRowTrackOver,a),b.on("rowtrackleave",a.onRowTrackLeave,a),b.on("collapse",a.onGroupCollapse,a),b.on("expand",a.onGroupExpand,a),b.on("remove",a.onRemove,a),b.on("render",function(){b.el.on("mouseenter",a.onExpandRowMouseEnter,a,"div."+e),b.el.on("mouseleave",a.onExpandRowMouseLeave,a,"div."+e)}),b.on("select",a.onSelect,a),b.on("clearselect",a.onClearSelect,a),c.on("beforeinsert",a.onBeforeInsert,a),b.on("columndrag",a.onColumnDrag,a),b.on("lockcolumn",a.onLockColumn,a),b.on("rightlockcolumn",a.onRightLockColumn,a),b.on("unlockcolumn",a.onUnLockColumn,a),a.expanded&&(c.proxyType?b.once("load",function(){a.expandAll()}):b.on("init",function(){a.expandAll()}))},expand:function(b){var e=this,f=e.widget,g=f.get(b).id;void 0===e._expandedIds[g]?(e._expandedIds[g]={},e.expandRow(Number(b),g),e.addMargin(Number(b)+1,g)):e.showRow(Number(b),g),delete e._expandedIds[g].hidden,e.reSetTop(),e.reSetPlusScroll();for(var h=f.el.select("."+d+'[grid="'+f.id+'"] .'+c+'[index="'+b+'"] .fancy-checkbox-expander'),i=0,j=h.length;i<j;i++){var k=a.getWidget(h.item(i).attr("id"));!1===k.get()&&k.set(!0,!1)}e.changeSidesSize(),e.onSelect()},collapse:function(a){var b=this,c=b.widget,d=c.scroller,e=c.get(a).id;b.collapseRow(Number(a),e),b.clearMargin(Number(a)+1,e),delete b._expandedIds[e],b.reSetTop(),b.reSetPlusScroll(),b.changeSidesSize(),d.scrollDelta(1),d.scrollRightKnob()},collapseRow:function(b,e){var f=this,g=f.widget,h=f._expandedIds[e];f._expandedIds[e].timeOutCheckHeight1&&(clearTimeout(f._expandedIds[e].timeOutCheckHeight1),delete f._expandedIds[e].timeOutCheckHeight1),f._expandedIds[e].timeOutCheckHeight2&&(clearTimeout(f._expandedIds[e].timeOutCheckHeight2),delete f._expandedIds[e].timeOutCheckHeight2),f._expandedIds[e].timeOutCheckHeight3&&(clearTimeout(f._expandedIds[e].timeOutCheckHeight3),delete f._expandedIds[e].timeOutCheckHeight3),f._expandedIds[e].timeOutCheckHeight4&&(clearTimeout(f._expandedIds[e].timeOutCheckHeight4),delete f._expandedIds[e].timeOutCheckHeight4),h.el.hide(),h.hidden=!0,g.leftColumns&&h.leftEl.hide(),g.rightColumns&&h.rightEl.hide();for(var i=g.el.select("."+d+'[grid="'+g.id+'"] .'+c+'[index="'+b+'"] .fancy-checkbox-expander'),j=0,k=i.length;j<k;j++){var l=a.getWidget(i.item(j).attr("id"));!0===l.get()&&(l.set(!1,!1),l.collapsedTime=new Date)}},_hideAllSideExpandedRow:function(){var a=this,b=a.widget;for(var c in a._expandedIds){var d=a._expandedIds[c];d.el.hide(),d.hidden=!0,b.leftColumns&&d.leftEl.hide(),b.rightColumns&&d.rightEl.hide()}},expandAll:function(){for(var a=this.widget,b=a.getViewTotal(),c=0;c<b;c++)this.expand(c)},expandRow:function(a,c){var d,f,g=this,h=g.widget,i=b(document.createElement("div")),j=h.getById(c),k=g.prepareData(j),l=-h.scroller.scrollLeft||0,m=h.getCenterFullWidth();if(g.tpl&&(d=g.tpl.getHTML(k),i.update(d)),i.addCls(e),i.css({left:l,width:m}),i.attr("index",a),h.body.el.dom.appendChild(i.dom),g.render){g.render(i.dom,k,h.getCenterFullWidth());var n=function(){var b=parseInt(i.css("height"));f!==b&&g._expandedIds[c]&&(g._expandedIds[c].height=b,o.css("height",b),p.css("height",b),g.addMargin(Number(a)+1,c))};g._expandedIds[c].timeOutCheckHeight1=setTimeout(n,100),g._expandedIds[c].timeOutCheckHeight2=setTimeout(n,500),g._expandedIds[c].timeOutCheckHeight3=setTimeout(n,1e3),g._expandedIds[c].timeOutCheckHeight4=setTimeout(n,3e3)}if(f=parseInt(i.css("height")),g._expandedIds[c].rowIndex=a,g._expandedIds[c].el=i,g._expandedIds[c].height=f,g._expandedIds[c].width=m,h.leftColumns){var o=b(document.createElement("div"));o.css("left","0px"),o.css("height",f),o.css("width",h.getLeftFullWidth()),o.attr("index",a),o.addCls(e),h.leftBody.el.dom.appendChild(o.dom),g._expandedIds[c].leftEl=o}if(h.rightColumns){var p=b(document.createElement("div"));p.css("left","0px"),p.css("height",f),p.css("width",h.getRightFullWidth()),p.attr("index",a),p.addCls(e),h.rightBody.el.dom.appendChild(p.dom),g._expandedIds[c].rightEl=p}setTimeout(function(){h.scroller.update()},100)},addMargin:function(a,b){var e=this,f=e.widget,g=e._expandedIds[b].height;f.el.select("."+d+'[grid="'+f.id+'"] .'+c+'[index="'+a+'"]').css("margin-top",g)},clearMargin:function(a){var b=this.widget;b.el.select("."+d+'[grid="'+b.id+'"] .'+c+'[index="'+a+'"]').css("margin-top","0")},onBeforeSort:function(){this.reSet()},onChangePage:function(){this.reSet()},onFilter:function(){this.reSet()},onRemove:function(){this.reSet()},reSet:function(){var a=this,b=a.widget;if(!1!==a.enabledCollapse){for(var c in a._expandedIds){var d=a._expandedIds[c];d.el.destroy(),a.clearMargin(Number(d.rowIndex)+1,c)}a._hideAllSideExpandedRow(),a._expandedIds={},a.reSetTop(),a.reSetPlusScroll(),a.changeSidesSize(),b.scroller.scrollDelta(1),b.setSidesHeight(),setTimeout(function(){b.setSidesHeight()},100)}},showRow:function(a,b){var c=this,d=c.widget,e=c._expandedIds[b];e.el.show(),d.leftColumns&&e.leftEl.show(),d.rightColumns&&e.rightEl.show(),c.addMargin(a+1,b)},getBeforeHeight:function(a){var b=0;for(var c in this._expandedIds){var d=this._expandedIds[c];d.rowIndex<a&&!d.hidden&&"none"!==d.el.css("display")&&(b+=d.height)}return b},reSetTop:function(a){var b=this,c=b.widget,d=c.cellHeight,e=-c.scroller.scrollTop||0,f=-c.scroller.scrollLeft||0;if(c.grouping){b.expandedGroups={};var g=c.grouping.expanded;for(var h in g)b.expandedGroups[h]=b.expandedGroups[h]||{}}for(var h in b._expandedIds){var i=b._expandedIds[h];if("none"!==i.el.css("display")){var j=b.getBeforeHeight(i.rowIndex),k=b.getDisplayedRowsBefore(i,h),l=e+k*d+j;if(c.grouping){var m=h,n=c.grouping.getGroupById(m),o=c.grouping.getGroupOrderIndex(n);"none"!==i.el.css("display")&&(b.expandedGroups[n]=b.expandedGroups[n]||{},b.expandedGroups[n][h]=i,l+=(o+1)*c.groupRowHeight)}i.el.css({top:l,left:f}),c.leftColumns&&i.leftEl.css("top",l),c.rightColumns&&i.rightEl.css("top",l)}}c.grouping&&!1!==a&&(c.grouping.setPositions(),c.grouping.setExpanderCellsPosition())},getDisplayedRowsBefore:function(a,b){var c=this.widget;if(c.grouping){var d=0;return"none"!==a.el.css("display")&&(d=c.store.getRow(b)),d+1}return a.rowIndex+1},onScroll:function(){this.reSetTop()},reSetPlusScroll:function(){var a=this,b=a.widget;a.plusScroll=a.getPlusHeight(),b.scroller.setRightKnobSize(),setTimeout(function(){!1===b.scroller.isRightScrollable()&&b.scroller.scroll(0)},1)},getPlusHeight:function(){var a=this,b=0;for(var c in a._expandedIds){var d=a._expandedIds[c];d.hidden||"none"===d.el.css("display")||(b+=d.height)}return a.plusHeight=b,a.plusHeight},onColumnReSize:function(){var a=this,b=a.widget;for(var c in a._expandedIds){var d=a._expandedIds[c],e=b.getCenterFullWidth();d.el.css("width",e)}},prepareData:function(a){var b=this,c=b.widget,d=a.data;return b.dataFn&&(d=b.dataFn(c,d)),d},changeSidesSize:function(){var a=this.widget;a.setSidesHeight(),a.scroller.checkRightScroll()},onRowDBlClick:function(a,b){var c=this,d=c.widget,e=Number(b.rowIndex),f=b.id,g=c._expandedIds[f];if(d.edit)return void d.un("rowdblclick",c.onRowDBlClick,c);void 0===g?c.expand(e):!0===g.hidden&&"none"===g.el.css("display")?c.expand(e):c.collapse(e)},onRowTrackOver:function(a,b){var c=this,d=c.widget,e=c._expandedIds[b.id];e&&(e.el.addCls(f),d.leftColumns&&e.leftEl.addCls(f),d.rightColumns&&e.rightEl.addCls(f))},onRowTrackLeave:function(a,b){var c=this,d=c.widget,e=c._expandedIds[b.id];e&&(e.el.removeCls(f),d.leftColumns&&e.leftEl.removeCls(f),d.rightColumns&&e.rightEl.removeCls(f))},onExpandRowMouseEnter:function(a){var g=this,i=g.widget,j=i.scroller,k=b(a.currentTarget),l=k.attr("index");i.el.select("."+e+'[index="'+l+'"]').addCls(f),!i.trackOver||j.bottomKnobDown||j.rightKnobDown||i.el.select("."+d+'[grid="'+i.id+'"] .'+c+'[index="'+l+'"]').addCls(h)},onExpandRowMouseLeave:function(a){var g=this,i=g.widget,j=i.scroller,k=b(a.currentTarget),l=k.attr("index");i.el.select("."+e+'[index="'+l+'"]').removeCls(f),!i.trackOver||j.bottomKnobDown||j.rightKnobDown||i.el.select("."+d+'[grid="'+i.id+'"] .'+c+'[index="'+l+'"]').removeCls(h)},onSelect:function(){var a=this,b=a.widget,c=b.selection;if(c&&(c.row||c.rows)){a.onClearSelect(),c=b.getSelection(!0);for(var d=c.rows,f=0,h=d.length;f<h;f++){var i=d[f];b.el.select("."+e+'[index="'+i+'"]').addCls(g)}}},onClearSelect:function(){var a=this,b=a.widget,c=b.selection;if(c.row||c.rows){c=b.getSelection(!0);for(var d={},f=c.rows,h=0,i=f.length;h<i;h++)d[f[h]]=!0;for(var j=b.el.select("."+g),h=0,i=j.length;h<i;h++){var k=j.item(h).attr("index");d[k]||b.el.select("."+e+'[index="'+k+'"]').removeCls(g)}}},onGroupCollapse:function(a,b,c){var d=this,e=d.widget,f=d.expandedGroups;if(f[c]){var g=f[c];for(var h in g){var i=g[h];d._expandedIds[h]&&delete d._expandedIds[h],i.el.hide(),i.leftEl.dom&&i.leftEl.hide(),i.rightEl.dom&&i.rightEl.hide()}}d.reSetTop(!1),d.reSetIndexes(),setTimeout(function(){e.grouping.setExpanderCellsPosition()},1)},onGroupExpand:function(a,b,c){var d=this,e=d.widget;d.reSetTop(!1),d.reSetIndexes(),setTimeout(function(){e.grouping.setExpanderCellsPosition()},1)},reSetIndexes:function(){var a=this,b=a.widget,c=b.store;for(var d in a._expandedIds)a._expandedIds[d].rowIndex=c.getRow(d)},onAdd:function(){this.reSet()},onBeforeInsert:function(){this.reSet()},onColumnDrag:function(){this.reSet(),this.clearExpandedCheckBoxes()},onLockColumn:function(){this.reSet(),this.clearExpandedCheckBoxes()},onRightLockColumn:function(){this.reSet(),this.clearExpandedCheckBoxes()},onUnLockColumn:function(){this.reSet(),this.clearExpandedCheckBoxes()},clearExpandedCheckBoxes:function(){this.widget.el.select(".fancy-checkbox-expander.fancy-checkbox-on").each(function(a){var b=a.attr("id");Fancy.getWidget(b).setValue(!1,!1)})}})}(),Fancy.modules["grouped-header"]=!0,Fancy.define("Fancy.grid.plugin.GroupHeader",{extend:Fancy.Plugin,ptype:"grid.groupheader",inWidgetName:"groupheader",constructor:function(){this.Super("const",arguments)},init:function(){this.Super("init",arguments),this.ons()},ons:function(){}}),Fancy.modules.grouping=!0,function(){var a=Fancy,b=Fancy.each,c=a.GRID_ROW_GROUP_INNER_CLS,d=a.GRID_ROW_GROUP_CLS,e=a.GRID_ROW_GROUP_COLLAPSED_CLS,f=a.GRID_CELL_CLS;a.define("Fancy.grid.plugin.Grouping",{extend:a.Plugin,ptype:"grid.grouping",inWidgetName:"grouping",tpl:"{text}:{number}",sortGroups:"asc",_renderFirstTime:!0,constructor:function(){this.Super("const",arguments)},init:function(){var a=this,b=a.widget;a.Super("init",arguments),a._expanded={},a.initTpl(),a.initGroups(),a.initOrder(),a.calcPlusScroll(),a.configParams(),a.ons(),!a.collapsed&&b.store.data&&setTimeout(function(){b.store.changeDataView({doNotFired:!0}),b.update()},100)},ons:function(){var a=this,b=a.widget,c=b.store;b.once("render",function(){a.renderGroupedRows(),a.update(),b.el.on("click",a.onClick,a,"div."+d),b.el.on("mousedown",a.onMouseDown,a,"div."+d),b.on("scroll",a.onScroll,a),b.on("columnresize",a.onColumnResize,a),c.on("insert",a.onInsert,a),c.on("remove",a.onRemove,a),b.on("columndrag",a.onColumnDrag,a)})},onInsert:function(){this.reGroup()},onRemove:function(){var a=this,c=a.widget,d=c.store,e=a.groups;if(a.initGroups(),a.update(),a.updateGroupRowsText(),e.length>a.groups.length){var f;b(e,function(b,c){if(b!==a.groups[c])return f=b,!0}),delete d.expanded[f],delete a.expanded[f],delete a._expanded[f]}},initGroups:function(a){var b,c=this,d=c.widget,e=d.store;b=e.initGroups(a),c.groups=b.groups,c.groupsCounts=b._groups},getGroupById:function(a){return this.widget.store.groupMap[a]},getGroupOrderIndex:function(a){for(var b=this.groups,c=0,d=b.length;c<d;c++)if(b[c]===a)return c},initOrder:function(){var c,d,e=this,f=e.widget,g=f.store,h=[],i={},j=[];if(e.order&&0!==e.order.length)switch(a.typeOf(e.order)){case"string":break;case"array":h=e.order}else{switch(h=e.groups,c=0,d=h.length,b(h,function(a){var b=a.toLocaleUpperCase();i[b]=a,j.push(b)}),e.sortGroups){case"asc":case"ASC":case!0:j=j.sort();break;case"desc":case"DESC":j=j.sort().reverse()}for(;c<d;c++)h[c]=i[j[c]]}e.groups=h,g.changeOrderByGroups(h,e.by)},calcPlusScroll:function(){var a=this.widget;this.plusScroll=this.groups.length*a.groupRowHeight},configParams:function(){var a=this,c=a.widget,d=c.store;a.expanded=a.expanded||{},d.expanded=d.expanded||{},a.collapsed?d.collapsed=!0:b(a.groups,function(b){void 0===a.expanded[b]&&(d.expanded[b]=!0,a.expanded[b]=!0,a._expanded[b]=!0)})},renderGroupedRows:function(){var a,c=this,d=c.widget,e=d.body,f=d.leftBody,g=d.rightBody,h=d.groupRowHeight,i=d.getCenterFullWidth(),j=d.getLeftFullWidth(),k=d.getRightFullWidth(),l=0;b(c.groups,function(b){var d=c.groupsCounts[b];j?(a=c.generateGroupRow(b,d,!0,l),a.css("width",j),a.css("height",h),f.el.dom.appendChild(a.dom),a=c.generateGroupRow(b,d,!1,l),a.css("width",i),a.css("height",h),e.el.dom.appendChild(a.dom)):(a=c.generateGroupRow(b,d,!0,l),a.css("width",i),a.css("height",h),e.el.dom.appendChild(a.dom)),k&&(a=c.generateGroupRow(b,d,!1,l),a.css("width",k),a.css("height",h),g.el.dom.appendChild(a.dom)),c.collapsed&&(l+=h)})},softRenderGroupedRows:function(a){var f,g,h,i=this,j=i.widget,k=j.body,l=j.leftBody,m=j.rightBody;switch(a){case"left":if(l.el.select("."+d).length){var n=k.el.select("."+c);return void(n.length&&n.destroy())}h=k.el.select("."+d),f=j.getLeftFullWidth(),b(i.groups,function(a,b){var d=i.groupsCounts[a],g=h.item(b),j=parseInt(g.css("top")),k=i.generateGroupRow(a,d,!0,j);g.hasClass(e)||k.removeCls(e),g.select("."+c).destroy(),k.css("width",f),l.el.dom.appendChild(k.dom)});break;case"right":if(m.el.select("."+d).length)return;g=j.getRightFullWidth(),h=k.el.select("."+d),b(i.groups,function(a,b){var c=i.groupsCounts[a],d=h.item(b),e=parseInt(d.css("top")),f=i.generateGroupRow(a,c,!1,e);f.css("width",g),m.el.dom.appendChild(f.dom)})}},removeGroupRows:function(){var a=this,b=a.widget,c=b.columns,e=b.leftColumns,f=b.rightColumns,g=b.body,h=b.leftBody,i=b.rightBody;c.length&&g.el.select("."+d).remove(),e.length&&h.el.select("."+d).remove(),f.length&&i.el.select("."+d).remove()},removeLastGroupRow:function(){var a=this,b=a.widget,c=b.columns,e=a.groups,f=e.length,g=b.leftColumns,h=b.rightColumns,i=b.body,j=b.leftBody,k=b.rightBody;if(c.length){i.el.select("."+d).item(f).remove()}g.length&&j.el.select("."+d).item(f).remove(),h.length&&k.el.select("."+d).item(f).remove()},removeCells:function(){var a=this,b=a.widget,c=b.columns,d=b.leftColumns,e=b.rightColumns,g=b.body,h=b.leftBody,i=b.rightBody;c.length&&g.el.select("."+f).remove(),d.length&&h.el.select("."+f).remove(),e.length&&i.el.select("."+f).remove()},generateGroupRow:function(b,f,g,h){var i=this,j=a.get(document.createElement("div"));if(j.addCls(d),j.attr("group",b),g){var k=i.tpl.getHTML({text:b,number:f});j.update('<div class="'+c+'"> '+k+"</div>")}return i.collapsed?(j.css("top",h+"px"),j.addCls(e)):j.css("top","0px"),j},insertGroupEls:function(){var a=this,b=a.widget,e=b.leftBody,f=b.body;b.leftColumns.length?e.el.select("."+d).each(function(b,d){var e=a.groups[d];b.update('<div class="'+c+'">'+e+"</div>")}):f.el.select("."+d).each(function(b,d){var e=a.groups[d],f=a.groupsCounts[e],g=a.tpl.getHTML({text:e,number:f});b.update('<div class="'+c+'">'+g+"</div>")})},onClick:function(b){var c,f=this,g=f.widget,h=a.get(b.currentTarget),i=h.attr("group");try{g.el.select("."+d+'[group="'+i+'"]').toggleCls(e)}catch(b){h.toggleCls(e)}c=h.hasCls(e),c?f.collapse(f.by,i):f.expand(f.by,i),f.update()},fastCollapse:function(){},onMouseDown:function(a){a.preventDefault()},onScroll:function(){this.setPositions()},collapse:function(a,b){var c=this,d=c.widget;d.store.collapse(a,b),delete c._expanded[b],delete c.expanded[b],d.fire("collapse",a,b)},expand:function(a,b){var c=this,d=c.widget;d.store.expand(a,b),c._expanded[b]=!0,c.expanded[b]=!0,d.fire("expand",a,b)},setPositions:function(){var a=this,c=a.widget,e=c.store,f=-c.scroller.scrollTop||0,g=c.leftBody.el.select("."+d),h=c.body.el.select("."+d),i=c.rightBody.el.select("."+d);b(a.groups,function(b,d){if(g.length&&g.item(d).css("top",f+"px"),h.length&&h.item(d).css("top",f+"px"),i.length&&i.item(d).css("top",f+"px"),c.expander){var j=c.expander.expandedGroups[b];for(var k in j){var l=j[k];f+=parseInt(l.el.css("height"))}}if(f+=c.groupRowHeight,!0===a._expanded[b])if(c.rowheight){var m=e.getItemsByGroup(b),n=c.rowheight.getRowsHeight(m);if(isNaN(f))return!0;f+=n}else f+=a.groupsCounts[b]*c.cellHeight})},setCellsPosition:function(a,c){for(var d,e,f=this,g=f.widget,h=0,i=f.groups.length,j=0,k=g.body,l=g.leftBody,m=g.rightBody,n=0,o=g.groupRowHeight,p=[],q={},r={},s=f.by;h<i;h++){var t=f.groups[h];if(!0===f._expanded[t]){if(p.push(n),q[n]=!0,void 0===c||"center"===c)if(j=0,d=g.columns.length,void 0!==a&&(j=a,d=a+1),g.expander){var u=g.get(n),v=u.get(s),w=g.expander.expandedGroups,x=f.getGroupOrderIndex(t),y=0;for(var z in w){var A=f.getGroupOrderIndex(z);if(!(x<=A)){var B=w[z];for(var C in B){var D=B[C];if("none"!==D.el.css("display")&&!r[C]){var E=n-1;n<0&&(n=0),E=g.get(E);var F=E.get(s);v!==F?E.id===C&&(r[C]=!0,y+=parseInt(D.el.css("height"))):(r[C]=!0,y+=parseInt(D.el.css("height")))}}}}for(o+=y,e=k.getCell(n,j);j<d;j++)e=k.getCell(n,j),e.css("margin-top",o+"px")}else for(;j<d;j++)e=k.getCell(n,j),e.css("margin-top",o+"px");if(void 0===c||"left"===c)for(j=0,d=g.leftColumns.length,void 0!==a&&(j=a,d=a+1);j<d;j++)e=l.getCell(n,j),e.css("margin-top",o+"px");if(void 0===c||"right"===c)for(j=0,d=g.rightColumns.length,void 0!==a&&(j=a,d=a+1);j<d;j++)e=m.getCell(n,j),e.css("margin-top",o+"px");n+=f.groupsCounts[t],o=g.groupRowHeight}else o+=g.groupRowHeight}if(f._renderFirstTime)f._renderFirstTime=!1;else{var G=[];b(f.prevRows,function(a){!0!==q[a]&&G.push(a)}),f.clearMargins(G)}f.prevRows=p},setExpanderCellsPosition:function(){var a,c,d=this,e=d.widget,f=e.store,g=f.dataView,h=e.body,i=e.leftBody,j=e.rightBody,k=e.expander.expandedGroups,l=d.groupsCounts,m=e.groupRowHeight,n=0,o=0;b(d.groups,function(f){if(!0===d._expanded[f]){for(var p=n+l[f];n<p;n++)if(c=g[n]){var q=c.id,r=k[f][q];o&&(m+=o,o=0),r&&(o=parseInt(r.el.css("height"))),b(e.columns,function(b,c){a=h.getCell(n,c),a.css("margin-top",m+"px")}),b(e.leftColumns,function(b,c){a=i.getCell(n,c),a.css("margin-top",m+"px")}),b(e.rightColumns,function(b,c){a=j.getCell(n,c),a.css("margin-top",m+"px")}),m=0}m=e.groupRowHeight}else m+=e.groupRowHeight})},clearMargins:function(a){var c=this;if(void 0!==(a=a||c.prevRows)){var d,e=c.widget,f=e.body,g=e.leftBody,h=e.rightBody;b(a,function(a){b(e.columns,function(b,c){if(d=f.getCell(a,c),void 0===d.dom)return!0;d.css("margin-top","0px")}),b(e.leftColumns,function(b,c){if(d=g.getCell(a,c),void 0===d.dom)return!0;d.css("margin-top","0px")}),b(e.rightColumns,function(b,c){if(d=h.getCell(a,c),void 0===d.dom)return!0;d.css("margin-top","0px")})})}},onColumnResize:function(){this.updateGroupRows()},updateGroupRows:function(){var a=this,b=a.widget,c=b.leftColumns,e=b.rightColumns,f=b.body,g=b.leftBody,h=b.rightBody,i=0;i+=b.getCenterFullWidth(),f.el.select("."+d).css("width",i+"px"),i+=b.getLeftFullWidth(),c.length&&g.el.select("."+d).css("width",i+"px"),i+=b.getRightFullWidth(),e.length&&h.el.select("."+d).css("width",i+"px")},update:function(a){var b=this,c=b.widget,d=c.store;a||!0!==d.loading&&!1!==d.autoLoad||d.data.length?a&&d.data.length&&d.loadedTimes>1?b.reGroup():(b.setPositions(),c.update(),c.scroller.update(),b.setCellsPosition(),c.setSidesHeight()):d.on("load",function(){b.initGroups(),b.initOrder(),b.calcPlusScroll(),b.configParams(),d.changeDataView({doNotFired:!0}),b.renderGroupedRows(),b.update(!0)},b)},getOffsetForRow:function(a){var c=this,d=c.widget,e=0,f=0;return b(c.groups,function(b){if(e+=d.groupRowHeight,!0===c._expanded[b]&&(f+=c.groupsCounts[b]),a<f)return!0}),e},getSpecialRowsUnder:function(a){var c=this,d=c.widget,e=0,f=0,g=0;return b(c.groups,function(b){a<f&&g++,e+=d.groupRowHeight,!0===c._expanded[b]&&(f+=c.groupsCounts[b])}),g},getSpecialRowsAbove:function(a){var b=this,c=b.widget,d=c.get(a),e=b.getGroupById(d.id),f=0;return Fancy.each(b.groups,function(a){if(f++,e===a)return!0}),f},reGroup:function(){var a=this,b=a.widget,c=b.store,d="data";a.expanded={},a._expanded={},b.store.expanded={},b.store.dataView=[],a.collapsed=!0,b.store.filteredData&&(d="filteredData"),a.removeGroupRows(),a.removeCells(),a.initGroups(d),c.remoteFilter&&a.initOrder(),a.calcPlusScroll(),a.configParams(),a.renderGroupedRows(),b.setSidesHeight()},scrollLeft:function(a){this.widget.body.el.select("."+d).css("left",a)},updateGroupRowsText:function(){var a=this,f=a.widget,g=a.groups,h=f.leftBody,i=f.body,j=f.rightBody,k=h.el.select("."+c),l=i.el.select("."+c),m=h.el.select("."+d),n=i.el.select("."+d),o=j.el.select("."+d);b(g,function(b,c){var d,g=a.groupsCounts[b],h=a.tpl.getHTML({text:b,number:g});f.leftColumns.length?(k.item(c).update(h),d=m.item(c),d.attr("group",b),a.expanded[b]?d.removeClass(e):d.addClass(e)):(l.item(c).update(h),d=n.item(c),a.expanded[b]?d.removeClass(e):d.addClass(e)),n.item(c).attr("group",b),f.rightColumns.length&&o.item(c).attr("group",b)}),g.length<i.el.select("."+d).length&&setTimeout(function(){a.removeLastGroupRow()},10)},onColumnDrag:function(){var a=this,b=a.widget,c=b.el.select("."+d),f=b.el.select("."+d+":not(."+e+")"),g={};if(f.each(function(a){g[a.attr("group")]=!0}),!b.leftColumns.length&&c.length){c.destroy(),a.renderGroupedRows(),a.update();for(var h in g){b.el.select("."+d+'[group="'+h+'"]').removeCls(e)}}},getGroupRowsHeight:function(){var b=this,c=b.widget,d=0;return a.each(b.groupsCounts,function(a){a&&d++}),d*c.groupRowHeight}})}(),Fancy.modules["column-drag"]=!0,function(){var a=Fancy,b=a.get(document),c=a.HIDDEN_CLS,d=a.GRID_HEADER_CELL_CLS,e=a.GRID_HEADER_CELL_TEXT_CLS,f=a.GRID_HEADER_CELL_TRIGGER_CLS,g=a.GRID_HEADER_CELL_TRIGGER_IMAGE_CLS,h=a.GRID_HEADER_CELL_GROUP_LEVEL_1_CLS,i=a.GRID_HEADER_CELL_GROUP_LEVEL_2_CLS,j=a.GRID_STATE_DRAG_COLUMN_CLS,k=a.FIELD_TEXT_INPUT_CLS,l=a.FIELD_CHECKBOX_INPUT_CLS;a.define("Fancy.grid.plugin.ColumnDrag",{extend:a.Plugin,ptype:"grid.columndrag",inWidgetName:"columndrag",activeSide:void 0,activeCell:void 0,activeIndex:void 0,activeColumn:void 0,inCell:void 0,inIndex:void 0,inSide:void 0,ok:!1,status:"none",constructor:function(){this.Super("const",arguments)},init:function(){var a=this,b=a.widget;a.Super("init",arguments),b.on("render",function(){a.ons(),a.initHint()})},ons:function(){var a=this;a.widget.el.on("mousedown",a.onMouseDownCell,a,"div."+d)},onMouseDownCell:function(c){var e=this,j=e.widget,m=Fancy.get(c.currentTarget),n=Number(m.attr("index")),o=j.getSideByCell(m),p=j.getColumns(o),q=p[n],r=a.get(c.target);q&&q.titleEditable||r.hasCls(f)||r.hasCls(g)||r.hasCls(k)||r.hasCls(l)||(m.hasCls(i)&&(e.activeCellTopGroup=e.getGroupStartEnd(m,o),e.activeCellTopGroup.cell=m),j.startResizing||(e.activeCellTopGroup||!1!==q.draggable)&&(m.hasCls(h)&&(e.activeUnderGroup=!0),e.activeSide=o,e.inSide=o,e.activeCell=m,e.inCell=m,e.activeIndex=Number(m.attr("index")),e.inIndex=e.activeIndex,e.activeColumn=p[e.activeIndex],e.mouseDownX=c.pageX,e.mouseDownY=c.pageY,b.once("mouseup",e.onMouseUp,e),b.on("mousemove",e.onMouseMove,e),j.el.on("mouseleave",e.onMouseLeave,e),j.el.on("mouseenter",e.onMouseEnterCell,e,"div."+d),j.el.on("mousemove",e.onMouseMoveCell,e,"div."+d)))},onMouseLeave:function(){this.hideHint()},onMouseUp:function(){var c=this,e=c.widget,f=!1;if(b.un("mousemove",c.onMouseMove,c),e.el.un("mouseleave",c.onMouseLeave,c),e.el.un("mouseenter",c.onMouseEnterCell,c,"div."+d),e.el.un("mousemove",c.onMouseMoveCell,c,"div."+d),c.ok){if(c.fire("beforecolumndrag"),c.inSide===c.activeSide)c.dragColumn(c.inSide);else if("center"===c.activeSide){var g=c.inIndex;"right"===c.okPosition&&g++,e.moveColumn(c.activeSide,c.inSide,c.activeIndex,g,c.activeCellTopGroup)}else{var g=c.inIndex;"right"===c.okPosition&&g++,e.moveColumn(c.activeSide,c.inSide,c.activeIndex,g,c.activeCellTopGroup)}f=!0}var h={column:c.activeColumn,fromSide:c.activeSide,toSide:c.inSide};delete c.inUpGroupCell,delete c.inUnderGroup,delete c.activeCellTopGroup,delete c.activeUnderGroup,delete c.activeSide,delete c.activeCell,delete c.activeIndex,delete c.activeColumn,delete c.mouseDownX,delete c.mouseDownY,c.ok=!1,delete c.okPosition,a.tip.hide(),setTimeout(function(){c.status="none"},1),c.removeDragState(),"dragging"===c.status&&setTimeout(function(){c.status="none",f&&(e.fire("columndrag",h),e.sorter&&e.sorter.updateSortedHeader())},10),c.hideHint(),setTimeout(function(){e.updateColumnsVisibilty()},100),e.scroller.update()},onMouseMove:function(b){var c=this,d=c.widget,h=d.header,i=d.leftHeader,j=d.rightHeader,k=b.pageX,l=b.pageY,m=d.getColumns(c.activeSide),n=a.get(b.target);if(!n.hasCls(f)&&!n.hasCls(g)&&(Math.abs(k-c.mouseDownX)>10||Math.abs(l-c.mouseDownY))){if(c.activeCellTopGroup?(a.tip.update(c.activeCellTopGroup.cell.select("."+e).item(0).dom.innerHTML||"&nbsp;"),c.status="dragging",c.addDragState()):(a.tip.update(c.activeColumn.title||"&nbsp;"),c.status="dragging",c.addDragState()),1===m.length&&"center"===c.activeSide)return a.tip.hide(),setTimeout(function(){c.status="none"},1),void c.removeDragState();a.tip.show(b.pageX+15,b.pageY+15),h.hideMenu&&(h.hideMenu(),d.leftColumns&&i.hideMenu()&&i.hideMenu(),d.rightColumns&&j.hideMenu()&&j.hideMenu())}},addDragState:function(){this.widget.el.addClass(j)},removeDragState:function(){this.widget.el.removeClass(j)},onMouseEnterCell:function(a){var b=this,c=b.widget,d=Fancy.get(a.currentTarget),e=c.getSideByCell(d);b.hideHint(),d.hasCls(h)?b.inUnderGroup=!0:delete b.inUnderGroup,d.hasCls(i)?b.inUpGroupCell=d:delete b.inUpGroupCell,b.inSide=e,b.inCell=d,b.inIndex=Number(d.attr("index"))},onMouseMoveCell:function(a){var b=this,c=b.widget,d=b.inCell,e=parseInt(d.css("width")),g=d.select("."+f),h=Fancy.get(a.target),i=g.within(h)||h.hasClass(f),j=b.activeUnderGroup!==b.inUnderGroup&&!0===b.inUnderGroup,k=b.activeUnderGroup!==b.inUnderGroup&&!0===b.activeUnderGroup;if(1===c.getColumns(b.activeSide).length&&"center"===b.activeSide)return b.ok=!1,void b.hideHint();if(b.activeCellTopGroup)if(b.inUpGroupCell);else{var l=b.activeCellTopGroup.start,m=b.activeCellTopGroup.end;b.activeSide!==b.inSide?(b.ok=!0,a.offsetX>e/2||i?b.showHint("right"):b.showHint("left")):isNaN(b.inIndex)?b.hideHint():b.inIndex<l?a.offsetX>e/2?b.inIndex+1===l?b.hideHint():(b.ok=!0,b.showHint("right")):(b.ok=!0,b.showHint("left")):b.inIndex>m?a.offsetX<e/2?b.inIndex===m+1?b.hideHint():(b.ok=!0,b.showHint("left")):(b.ok=!0,b.showHint("right")):b.hideHint()}else if(b.inUpGroupCell){var n=b.getGroupStartEnd(),l=n.start,m=n.end;b.activeSide!==b.inSide?(b.ok=!0,a.offsetX>e/2||i?b.showHint("right"):b.showHint("left")):a.offsetX>e/2?b.activeIndex>m&&b.activeIndex-1===m?b.hideHint():(b.ok=!0,b.showHint("right")):b.activeIndex<l&&b.activeIndex+1===l?b.hideHint():(b.ok=!0,b.showHint("left"))}else b.activeSide!==b.inSide?(b.ok=!0,a.offsetX>e/2||i?b.showHint("right"):b.showHint("left")):b.activeIndex===b.inIndex?b.ok=!1:b.activeIndex<b.inIndex?a.offsetX>e/2||i?(b.ok=!0,b.showHint("right")):a.offsetX<e/2&&b.activeIndex+1!==b.inIndex?(b.ok=!0,b.showHint("left")):b.activeIndex+1===b.inIndex&&(j||k)?(b.ok=!0,b.showHint("left")):(b.ok=!1,b.hideHint()):b.activeIndex>b.inIndex&&(a.offsetX<e/2?i?j||k?(b.ok=!0,b.showHint("right")):b.activeIndex-1===b.inIndex||b.inUpGroupCell?(b.ok=!1,b.hideHint()):(b.ok=!0,b.showHint("right")):(b.ok=!0,b.showHint("left")):a.offsetX>e/2?b.activeIndex-1===b.inIndex&&(j||k)?(b.ok=!0,b.showHint("right")):b.activeIndex-1!==b.inIndex||b.activeUnderGroup?(b.ok=!0,b.showHint("right")):(b.ok=!1,b.hideHint()):(b.ok=!1,b.hideHint()))},showHint:function(b){var d=this,e=d.widget,f=e.cellHeaderHeight,g=d.inCell,h=d.topEl,i=d.bottomEl,j=g.offset(),k=parseInt(g.css("width")),l=parseInt(g.css("height"));d.okPosition=b,h.removeCls(c),i.removeCls(c);var m=0;"right"===b&&(m+=k),h.css({left:j.left+m-Math.ceil(parseInt(h.css("width"))/2),top:j.top-parseInt(h.css("height"))});var n=j.top+l;if(d.inUpGroupCell){var o=e.header.calcRows();n=j.top+o*f}if(i.css({left:j.left+m-Math.ceil(parseInt(i.css("width"))/2),top:n}),e.window){var p=1e3+a.zIndex++;h.css("z-index",p),i.css("z-index",p)}},hideHint:function(){var a=this;a.topEl.addCls(c),a.bottomEl.addCls(c)},initHint:function(){var b=this,d=b.widget,e="fancy-theme-"+d.theme,f=a.get(document.body).dom,g=a.get(document.createElement("div")),h=a.get(document.createElement("div"));g.addCls("fancy-drag-hint-top",c,e),h.addCls("fancy-drag-hint-bottom",c,e),b.topEl=a.get(f.appendChild(g.dom)),b.bottomEl=a.get(f.appendChild(h.dom))},dragColumn:function(a){var b=this,c=b.widget,d=c.getHeader(a),e=c.getBody(a),f=b.activeIndex,g=b.inIndex,h=b.okPosition,i=c.getColumns(a),j=i[f],k=d.calcRows();if(b.activeCellTopGroup){var l=b.activeCellTopGroup.start,m=b.activeCellTopGroup.end,n=i.splice(l,m-l+1),g=b.inIndex;"right"===h&&g++,i=b.inIndex<l?Fancy.Array.insert(i,g,n):Fancy.Array.insert(i,g-n.length,n),c.setColumns(i,a)}else if(b.inUpGroupCell){var o=b.getGroupStartEnd();g=o.start,"right"===h&&(g=o.end+1)}else if("right"===h)if(b.inUnderGroup){var p=i[g].grouping,q=i[g+1];q&&q.grouping===p&&g++}else g++;if(c.groupheader&&!b.activeCellTopGroup){var r=i[g];r&&r.grouping&&b.inUnderGroup?(j.grouping=r.grouping,j.filter&&j.filter.header&&k<3&&delete j.filter):delete j.grouping}b.activeCellTopGroup||(i.splice(f,1),f<g&&g--,i.splice(g,0,j)),e.clearColumnsStyles(),d.updateTitles(),d.updateCellsSizes(),d.reSetCheckBoxes(),c.groupheader&&(c.header.fixGroupHeaderSizing(),c.leftColumns&&c.leftHeader.fixGroupHeaderSizing(),c.rightColumns&&c.rightHeader.fixGroupHeaderSizing(),d.reSetGroupIndexes()),setTimeout(function(){d.reSetColumnsAlign(),d.reSetColumnsCls(),e.reSetColumnsAlign(),e.reSetColumnsCls(),e.updateColumnsSizes()},100),c.update()},getGroupStartEnd:function(b,c){var d=this,e=d.widget,f=e.getHeader(c||d.inSide),g=(b||d.inUpGroupCell).attr("index"),h=f.el.select('[group-index="'+g+'"]'),i=[];return h.each(function(a){i.push(Number(a.attr("index")))}),{start:a.Array.min(i),end:a.Array.max(i)}}})}(),Fancy.modules.summary=!0,function(){var a=Fancy,b=a.GRID_CELL_CLS,c=a.GRID_CELL_INNER_CLS,d=a.GRID_CELL_EVEN_CLS,e=a.GRID_ROW_SUMMARY_CLS,f=a.GRID_ROW_SUMMARY_CONTAINER_CLS,g=a.GRID_ROW_SUMMARY_BOTTOM_CLS,h=a.GRID_COLUMN_SPARKLINE_CLS,i=a.GRID_COLUMN_SPARKLINE_BULLET_CLS,j=a.GRID_COLUMN_SPARK_PROGRESS_DONUT_CLS,k=a.GRID_COLUMN_GROSSLOSS_CLS,l=a.ANIMATE_DURATION;a.define("Fancy.grid.plugin.Summary",{extend:a.Plugin,ptype:"grid.summary",inWidgetName:"summary",position:"top",sumDisplayed:!0,topOffSet:0,bottomOffSet:0,striped:!1,constructor:function(){this.Super("const",arguments)},init:function(){this.Super("init",arguments),this.ons()},ons:function(){var a=this,b=a.widget;b.once("render",function(){a.calcOffSets(),a.options&&a.initOptions()}),b.once("init",function(){a.render(),a.update(),b.on("update",function(){a.update()}),b.on("set",function(){a.update()})}),b.on("columnresize",function(){a.onColumnResize()},a),b.on("columnhide",a.onColumnHide,a),b.on("columnshow",a.onColumnShow,a),a.sumDisplayed&&b.on("changepage",a.onChangePage,a),b.on("columndrag",a.onColumnDrag,a)},render:function(){var a,b=this,c=b.widget,d=c.centerEl,e=c.leftEl,h=c.rightEl,i=c.body,j=c.leftBody,k=c.rightBody,l=c.getCenterFullWidth(),m=c.getLeftFullWidth(),n=c.getRightFullWidth(),o="top"===b.position?"before":"after";d.select("."+f).length||d.select("."+g).length||(a=b.generateRow("center"),a.css("width",c.startWidths.center),a.firstChild().css("width",l),a.css("height",c.cellHeight),a.firstChild().css("height",c.cellHeight),b.el=a,i.el[o](a.dom)),m&&(e.select("."+f).length||e.select("."+g).length||(a=b.generateRow("left"),"bottom"===b.position?a.css("width",m):a.css("width",m-2),a.firstChild().css("width",m),a.css("height",c.cellHeight),b.leftEl=a,j.el[o](a.dom))),n&&(h.select("."+f).length||h.select("."+g).length||(a=b.generateRow("right"),"bottom"===b.position?a.css("width",n):a.css("width",n-1),a.firstChild().css("width",n),a.css("height",c.cellHeight),b.rightEl=a,k.el[o](a.dom)))},generateRow:function(d){var h=this,i=h.widget,j=i.cellHeight,k=i.getColumnsWidth(d),l=a.get(document.createElement("div")),m="";a.each(i.getColumns(d),function(a,d){m+=['<div index="'+d+'" style="width:'+a.width+"px;height:"+j+"px;"+(a.cellAlign?"text-align:"+a.cellAlign+";":"")+'" class="'+b+'">','<div class="'+c+'"></div>',"</div>"].join("")});var n=['<div style="position: relative;" class="'+e+'">',m,"</div>"].join("");return l.update(n),l.css("width",k+"columnsWidth"),l.addCls(f),"bottom"===h.position&&l.addCls(g),l},calcPlusScroll:function(){var a=this,b=a.widget;a.plusScroll=a.groups.length*b.groupRowHeight},scrollLeft:function(a){this.el.firstChild().css("left",a)},update:function(){var a=this,c=a.widget;if(a.updateSide("center"),c.leftColumns.length&&a.updateSide("left"),c.rightColumns.length&&a.updateSide("right"),a.striped&&"bottom"===a.position){var e=c.el.select("."+g+" ."+b);c.getViewTotal()%2==1?e.addCls(d):e.removeCls(d)}},getEl:function(a){var b=this;switch(a){case"center":return b.el;case"left":return b.leftEl;case"right":return b.rightEl;default:return b.el}},updateSide:function(b){var d=this,e=d.widget,f=e.getBody(b),g=e.store,l=d.getEl(b).select("."+c),m="data";d.sumDisplayed&&(m="dataView"),a.each(e.getColumns(b),function(b,c){if(!b.summary)return void l.item(c).update("");var d=b.index,n=g.getColumnOriginalValues(d,{smartIndexFn:b.smartIndexFn,dataProperty:m}),o="",p=l.item(c).parent();switch(a.typeOf(b.summary)){case"string":o="none"===b.summary?"&nbsp;":a.Array[b.summary](n);break;case"object":o=a.Array[b.summary.type](n),b.summary.fn&&(o=b.summary.fn(o,b.summary.type));break;case"function":o=b.summary(n)}switch(b.type){case"sparklineline":case"sparklinebar":case"sparklinetristate":case"sparklinebullet":case"sparklinebox":case"sparklinepie":case"sparklinediscrete":p.addCls(h);var q,r=b.width,s=e.cellHeight-1,t=r-20,u=b.type.replace("sparkline","");switch(u){case"line":case"pie":case"box":q="width";break;case"bullet":q="width",s-=11,p.addCls(i);break;case"discrete":q="width",t=r,s-=2;break;case"bar":case"tristate":q="barWidth"}var v=b.sparkConfig||{},w={type:u,fillColor:"transparent",height:s};a.apply(w,v),"bar"!==u&&"tristate"!==u||(t=r-20,t/=o.length),w[q]=t,l.item(c).$dom.sparkline(o,w);break;case"progressdonut":p.addCls(j);var w=b.sparkConfig||{};a.apply(w,{renderTo:l.item(c).dom,value:o}),w.size||w.height||w.width||(w.size=e.cellHeaderHeight-6),a.get(w.renderTo).update(""),new a.spark.ProgressDonut(w);break;case"grossloss":p.addCls(k);var w=b.sparkConfig||{};w.showOnMax&&(w.maxValue=Math.max.apply(Math,n)),o>50&&(o=50),a.apply(w,{renderTo:l.item(c).dom,value:o,column:b}),new a.spark.GrossLoss(w);break;default:b.format&&(o=f.format(o,b.format)),l.item(c).update(o)}})},onColumnResize:function(){var a=this,b=a.widget;a.updateSizes("center"),b.leftColumns.length&&a.updateSizes("left"),b.rightColumns.length&&a.updateSizes("right"),a.update()},onColumnHide:function(a,b){var c=this,d=c.widget;c.updateSizes("center"),d.leftColumns.length&&c.updateSizes("left"),d.rightColumns.length&&c.updateSizes("right"),c.update()},onColumnShow:function(a,b){var c=this,d=c.widget;c.updateSizes("center"),d.leftColumns.length&&c.updateSizes("left"),d.rightColumns.length&&c.updateSizes("right"),c.update()},updateSizes:function(c){var d=this,e=d.widget,f=d.getEl(c),g=f.select("."+b),h=0,i=e.getColumns(c);switch(a.each(i,function(a,b){h+=a.width;var c=g.item(b);a.hidden,c.animate({width:a.width},l)}),f.firstChild().animate({width:h},l),c){case"center":d.el.animate({width:h},l);break;case"left":"bottom"===d.position?d.leftEl.animate({width:h},l):d.leftEl.animate({width:h-2},l);break;case"right":"bottom"===d.position?d.rightEl.animate({width:h},l):d.rightEl.animate({width:h-1},l)}},calcOffSets:function(){var a=this,b=a.widget;switch(a.position){case"top":a.topOffSet=b.cellHeight;break;case"bottom":a.bottomOffSet=b.cellHeight;break;case"both":a.topOffSet=b.cellHeight,a.bottomOffSet=b.cellHeight}},removeColumn:function(a,c){this.getEl(c).select("."+b).item(a).destroy(),this.updateSizes(c)},insertColumn:function(d,e){var f=this,g=f.widget,h=g.getColumns(e);"left"!==e&&"right"!==e||1!==h.length||f.render();var h=g.getColumns(e),i=h[d],j=f.getEl(e),k=j.select("."+b),l=k.item(d-1),m=a.get(document.createElement("div"));0===d&&(l=k.item(0)),m.css({width:i.width,height:g.cellHeight}),m.addCls(b),m.update('<div class="'+c+'"></div>'),0===d?l.before(m.dom):l.after(m.dom),f.updateSizes(e),f.updateSide(e)},onChangePage:function(){var a=this;setTimeout(function(){a.update()},100)},onColumnDrag:function(){var a=this,b=a.widget;a.updateSizes("center"),b.leftColumns.length&&a.updateSizes("left"),b.rightColumns.length&&a.updateSizes("right")},initOptions:function(){var b=this,c=b.widget,d=a.get(document.body);c.addCls("fancy-grid-summary-options"),c.el.on("click",b.onOptionClick,b,".fancy-grid-summary-container .fancy-grid-cell"),d.on("click",function(c){var d=a.get(c.target);if(b.justShownSummaryMenu)return void delete b.justShownSummaryMenu;!d.closest(".fancy-menu").dom&&b.activeSummaryMenu&&(b.activeSummaryMenu.hide(),delete b.activeSummaryMenu)})},onOptionClick:function(b){var c,d=this,e=d.widget,f=a.get(b.currentTarget),g=d.getColumnBySummaryCell(f),h=100;if(d.justShownSummaryMenu=!0,d.activeSummaryMenu&&(d.activeSummaryMenu.hide(),delete d.activeSummaryMenu),g.summaryMenu)c=g.summaryMenu;else{var i=d.generateColumnSummaryItems(g);c=new Fancy.Menu({minWidth:h,width:parseInt(f.css("width"))+1,theme:e.theme,items:i})}var j=f.offset(),k=j.top+parseInt(f.css("height")),l=j.left,m=20,n=-1;if("bottom"===d.position){k=k-parseInt(c.el.css("height"))-parseInt(f.css("height")),m*=-1,n=1}var o=parseInt(f.css("width"))+1;o<h&&(o=h),c.el.css({position:"absolute",width:o,minWidth:70,top:k+m,left:l-1}),c.show(),c.el.animate({duration:200,top:k+n}),g.summaryMenu=c,d.activeSummaryMenu=c},generateColumnSummaryItems:function(b){var c=this,d=[],e=["None","Sum","Average","Count","Min","Max"],f=["None"],g=a.typeOf(b.summary);switch(b.type){case"number":switch(g){case"string":a.each(e,function(a,e){d.push({text:a,checked:a.toLocaleLowerCase()===b.summary,handler:function(){b.summary=a.toLocaleLowerCase(),c.update(),c.activeSummaryMenu.setChecked(e,!0),c.activeSummaryMenu.hide(),delete c.activeSummaryMenu}})});break;case"function":case"object":a.each(e,function(a,e){d.push({text:a,checked:!1,handler:function(){switch(g){case"function":b.summary={type:a.toLocaleLowerCase(),fn:b.summary};break;case"object":b.summary.type=a.toLocaleLowerCase()}c.update(),c.activeSummaryMenu.setChecked(e,!0),c.activeSummaryMenu.hide(),delete c.activeSummaryMenu}})}),"object"!==g&&d.push({text:"Custom",checked:!0,handler:function(){b.summary=b._summary,c.update(),c.activeSummaryMenu.hide(),c.activeSummaryMenu.setChecked(d.length-1,!0),delete c.activeSummaryMenu}})}break;case"string":switch(g){case"string":a.each(f,function(a,e){d.push({text:a,checked:a.toLocaleLowerCase()===b.summary,handler:function(){b.summary.type=a.toLocaleLowerCase(),c.update(),c.activeSummaryMenu.setChecked(e,!0),c.activeSummaryMenu.hide(),delete c.activeSummaryMenu}})});break;case"function":case"object":a.each(f,function(a,e){d.push({text:a,checked:!1,handler:function(){b._summary||(b._summary=b.summary),b.summary="none",c.update(),c.activeSummaryMenu.setChecked(e,!0),c.activeSummaryMenu.hide(),delete c.activeSummaryMenu}})}),d.push({text:"Custom",checked:!0,handler:function(){b.summary=b._summary,c.update(),c.activeSummaryMenu.setChecked(d.length-1,!0),c.activeSummaryMenu.hide(),delete c.activeSummaryMenu}})}}return d},getColumnBySummaryCell:function(a){var b,c=this,d=c.widget,e=a.attr("index");return a.closest(".fancy-grid-center").dom?b=d.columns[e]:a.closest(".fancy-grid-left").dom?b=d.leftColumns[e]:a.closest(".fancy-grid-right")&&(b=d.rightColumns[e]),b}})}(),function(){var a=Fancy,b=a.GRID_COLUMN_TREE_EXPANDER_CLS,c=function(a,b){b=b||0;var d=this,e=d.widget;return Fancy.each(a,function(a){b++;var f=a.data?a.data:a;e.store.filteredData?f.id&&e.store.map[f.id]&&(f=e.store.map[f.id].data):f=e.getById(f.id).data;var g=f.child;g&&f.expanded&&(b+=c.apply(d,[g]))}),b};Fancy.define("Fancy.grid.plugin.Tree",{extend:Fancy.Plugin,ptype:"grid.tree",inWidgetName:"tree",singleExpand:!1,constructor:function(a){this.Super("const",arguments)},init:function(){var a=this;a.expandMap={},a.Super("init",arguments),a.ons()},ons:function(){var a=this,b=a.widget;b.once("init",function(){b.on("rowdblclick",a.onRowDBLClick,a),b.on("cellclick",a.onTreeExpanderClick,a),b.on("beforesort",a.onBeforeSort,a)})},onRowDBLClick:function(a,b){var c=this,d=c.widget,e=b.item;if(!(e.get("leaf")||d.edit&&2===d.edit.clicksToEdit)){e.get("expanded")?c.collapseRow(b.item):c.expandRow(b.item)}},onTreeExpanderClick:function(a,c){var d=this,e=c.item;Fancy.get(c.e.target).hasClass(b)&&!e.get("leaf")&&(e.get("expanded")?d.collapseRow(c.item):d.expandRow(c.item))},collapseRow:function(a){var b=this,d=b.widget,e=d.store,f=a.get("child"),g=(a.get("filteredChild"),a.get("id"));d.$onChangeUpdate=!1,b.expandMap[g]=!1,a.set("expanded",!1);var h=e.getRow(a.get("id")),i=0,j=c.apply(this,[f]);if(e.filteredData){var k,l=a.get("id"),m={};m[l]=!0;for(var n,i=0,j=e.data.length;i<j&&(a=e.data[i],!(n&&n>=a.data.$deep));i++){if(m[a.data.parentId]){n||(n=a.data.$deep-1),k||(k=i);var o=e.data.splice(k,1)[0];o.data.child&&(m[o.data.id]=!0),delete e.map[o.id],i--,j--}a.data.child&&n&&(m[a.data.id]=!0)}e.order&&(delete e.order,delete e.filterOrder,e.reSort()),e.changeDataView()}else{for(d.store.treeCollapsing=!0;i<j;i++)d.removeAt(h+1);delete d.store.treeCollapsing}delete d.$onChangeUpdate,d.update(),d.fire("treecollapse")},expandRow:function(a){var b,c=this,d=c.widget,e=d.store,f=a.get("child"),g=(a.get("filteredChild"),a.get("id")),h=a.get("parentId");if(d.$onChangeUpdate=!1,c.singleExpand)if(h){var i=d.getById(h);b=i.get("child"),Fancy.each(b,function(a){var b=a.get("expanded");void 0!==c.expandMap[a.id]&&(b=c.expandMap[a.id]),!0===b&&c.collapseRow(d.getById(a.id))})}else b=d.findItem("parentId",""),Fancy.each(b,function(a){var b=a.get("expanded");void 0!==c.expandMap[a.id]&&(b=c.expandMap[a.id]),!0===b&&c.collapseRow(a)});c.expandMap[g]=!0,a.set("expanded",!0);var j=e.getRow(a.get("id")),k=a.get("$deep")+1,l=!1;if(e.filteredData){var m=a.get("id");Fancy.each(e.data,function(a,b){if(a.id===m)return j=b,!0})}var n=function(a,b,e,f){return f=f||g,Fancy.each(a,function(a,g){var h=a.data;a.data||(l=!0,h=a),h.$deep=e,h.parentId=f;var i=h.expanded;if(void 0!==c.expandMap[h.id]&&(i=c.expandMap[h.id],h.expanded=i),b++,d.insert(b,h),!0===i){var j=h.child;h.filteredChild,b=n(j,b,e+1,h.id)}}),b};d.store.treeExpanding=!0,n(f,j,k),delete d.store.treeExpanding,l&&Fancy.each(a.data.child,function(b,c){var d=e.getById(b.id);void 0!==d&&(a.data.child[c]=d)}),delete d.$onChangeUpdate,d.update(),e.sorters&&e.order&&(delete e.order,delete e.filterOrder,e.reSort()),d.fire("treeexpand")},onBeforeSort:function(a,b){var c=this;"drop"===b.action&&c.onDropSort()},onDropSort:function(){this.widget.store.treeReBuildData()}})}(),function(){var a=Fancy;a.define("Fancy.grid.plugin.RowHeight",{extend:a.Plugin,ptype:"grid.rowheight",inWidgetName:"rowheight",cellTip:"{value}",stopped:!0,constructor:function(){this.Super("const",arguments),this.rows={}},init:function(){this.Super("init",arguments),this.ons()},ons:function(){var a=this,b=a.widget;b.on("init",a.onInit,a),b.on("update",a.onUpdate,a),b.on("columnresize",a.onColumnResize,a)},onInit:function(){var a=this,b=a.widget;setTimeout(function(){b.scroller.update(a.totalHeight)},50)},onUpdate:function(){var b=this,c=b.widget,d=c.getDataView(),e=0;a.each(d,function(d){var f=d.id,g=b.rows[f],h=c.getRowById(f),i=c.getDomRow(h);a.each(i,function(b){a.get(b).css("height",g)}),e+=g}),b.totalHeight=e,c.grouping&&(b.totalHeight+=c.grouping.getGroupRowsHeight()),setTimeout(function(){c.setSidesHeight(b.totalHeight),c.scroller.update(b.totalHeight)},50)},add:function(a,b){this.rows[a]=b},getRowsHeight:function(b){var c=this,d=0;return a.each(b,function(a){var b=a.get("id");d+=c.rows[b]}),d},onColumnResize:function(a,b){var c=this;"text"===b.column.type&&b.column.autoHeight&&setTimeout(function(){c.widget.update(),c.onUpdate()},400)}})}(),function(){var a=Fancy,b=500,c=a.TOOLTIP_CLS,d=a.TOOLTIP_INNER_CLS;a.define("Fancy.grid.plugin.CellTip",{extend:a.Plugin,ptype:"grid.celltip",inWidgetName:"celltip",cellTip:"{value}",stopped:!0,constructor:function(){this.Super("const",arguments)},init:function(){this.Super("init",arguments),this.ons()},ons:function(){var b=this,c=b.widget,d=a.get(document);c.on("cellenter",b.onCellEnter,b),c.on("cellleave",b.onCellLeave,b),d.on("touchend",b.onTouchEnd,b),d.on("mousemove",b.onDocMove,b)},onCellEnter:function(b,c){var d=this,e=c.column,f=d.cellTip,g=c.e;if(e.cellTip){if(a.isString(e.cellTip))f=e.cellTip;else if(a.isFunction(e.cellTip)&&!1===(f=e.cellTip(c)))return;var h=new a.Template(f),i={title:e.title,value:c.value,columnIndex:0,rowIndex:0};d.stopped=!1,a.apply(i,c.data),a.tip.update(h.getHTML(i)),a.tip.show(g.pageX+15,g.pageY-25)}},onCellLeave:function(){this.stopped=!0,a.tip.hide(b)},onTouchEnd:function(){this.stopped=!0,a.tip.hide(b)},onDocMove:function(e){if(!0!==this.stopped){var f=this,g=f.widget;if("none"===g.el.css("display")||g.panel&&g.panel.el&&"none"===g.panel.el.css("display"))return f.stopped=!0,void a.tip.hide(b);var h=a.get(e.target);return"body"===h.prop("tagName").toLocaleLowerCase()?(f.stopped=!0,void a.tip.hide(b)):h.hasClass(c)||h.hasClass(d)||!1!==g.el.within(h)?void a.tip.show(e.pageX+15,e.pageY-25):(f.stopped=!0,void a.tip.hide(b))}}})}(),function(){var a=Fancy,b=500,c=a.TOOLTIP_CLS,d=a.TOOLTIP_INNER_CLS;a.define("Fancy.grid.plugin.HeaderCellTip",{extend:a.Plugin,ptype:"grid.headercelltip",inWidgetName:"headercelltip",cellTip:"{title}",stopped:!0,constructor:function(){this.Super("const",arguments)},init:function(){this.Super("init",arguments),this.ons()},ons:function(){var b=this,c=b.widget,d=a.get(document);c.on("headercellenter",b.onCellEnter,b),c.on("headercellleave",b.onCellLeave,b),d.on("touchend",b.onTouchEnd,b),d.on("mousemove",b.onDocMove,b)},onCellEnter:function(b,c){var d=this,e=c.column,f=d.cellTip,g=c.e;if(e.headerCellTip){var h={title:e.title,columnIndex:c.columnIndex,side:c.side};if(a.isString(e.headerCellTip))f=e.headerCellTip;else if(a.isFunction(e.headerCellTip)&&(c.data=h,!1===(f=e.headerCellTip(c))))return;var i=new a.Template(f);d.stopped=!1,a.apply(h,c.data),a.tip.update(i.getHTML(h)),a.tip.show(g.pageX+15,g.pageY-25)}},onCellLeave:function(){this.stopped=!0,a.tip.hide(b)},onTouchEnd:function(){this.stopped=!0,a.tip.hide(b)},onDocMove:function(e){if(!0!==this.stopped){var f=this,g=f.widget;if("none"===g.el.css("display")||g.panel&&g.panel.el&&"none"===g.panel.el.css("display"))return f.stopped=!0,void a.tip.hide(b);var h=a.get(e.target);return"body"===h.prop("tagName").toLocaleLowerCase()?(f.stopped=!0,void a.tip.hide(b)):h.hasClass(c)||h.hasClass(d)||!1!==g.el.within(h)?void a.tip.show(e.pageX+15,e.pageY-25):(f.stopped=!0,void a.tip.hide(b))}}})}(),function(){var a=Fancy,b=a.MENU_ITEM_IMG_COPY_CLS,c=a.MENU_ITEM_IMG_DELETE_CLS,d=a.MENU_ITEM_IMG_DUPLICATE_CLS,e=a.MENU_ITEM_IMG_EDIT_CLS;a.define("Fancy.grid.plugin.ContextMenu",{extend:a.Plugin,ptype:"grid.contextmenu",inWidgetName:"contextmenu",defaultItems:["copy","copy+","delete","-","export"],width:200,constructor:function(){this.Super("const",arguments)},init:function(){this.Super("init",arguments),this.ons()},ons:function(){var a=this;a.widget.on("contextmenu",a.onContextMenu,a)},onContextMenu:function(a,b){var c=this,d=b.e;d.preventDefault(),c.menu||c.initMenu(),setTimeout(function(){c.showMenu(d,!0)},50)},initMenu:function(){var f=this,g=f.widget,h=[],i=f.items||a.Array.copy(f.defaultItems);a.each(i,function(i,j){var k=i,l={};switch(i.type&&(k=i.type,a.apply(l,i)),k){case"copy":a.applyIf(l,{text:"Copy",sideText:"CTRL+C",imageCls:b,handler:function(){g.copy()}}),h.push(l);break;case"copyWidthHeader":case"copy+":a.applyIf(l,{text:"Copy with Headers",imageCls:b,handler:function(){g.copy(!0)}}),h.push(l);break;case"delete":a.applyIf(l,{text:"Delete",imageCls:c,handler:function(){switch(g.selection.selModel){case"rows":case"row":var a=g.getSelection();g.remove(a),g.clearSelection()}}}),h.push(l);break;case"edit":f.editItemIndex=j,a.applyIf(l,{text:"Edit",imageCls:e,disabled:!0,handler:function(){if(g.rowEdit){var a=g.selection.getActiveCell(),b=g.getSideByCell(a),c=g.getBody(b),d=c.getEventParams({currentTarget:a.dom});g.rowedit.edit(d)}}}),h.push(l);break;case"export":a.applyIf(l,{text:"Export",items:[{text:"CSV Export",handler:function(){g.exportToCSV({header:!0})}},{text:"Excel Export",handler:function(){g.exportToExcel({header:!0})}}]}),h.push(l);break;case"duplicate":a.applyIf(l,{text:"Duplicate",imageCls:d,handler:function(){switch(g.selection.selModel){case"rows":case"row":var b,c=g.getSelection(),d=[];if(!c.length)return;b=g.getRowById(c[c.length-1].id)+1,a.each(c,function(b){var c=a.Object.copy(b);c.id=a.id(null,"TEMP-"),d.push(c)}),g.insert(b,d),a.each(d,function(a){var b=g.getRowById(a.id);g.flashRow(b)})}}}),h.push(l);break;default:h.push(i)}}),f.menu=new Fancy.Menu({width:f.width,theme:g.theme,items:h})},showMenu:function(b,c){var d=this,e=d.widget,f=e.selection,g=d.menu.el,h=Fancy.get(b.target),i=h.offset(),j=i.top+40,k=i.left;if(c&&(j=b.pageY+40,k=b.pageX),g.css({position:"absolute",top:j,left:k}),d.menu.css("z-index",1e3+a.zIndex++),d.menu.show(),g.animate({duration:200,top:j-20}),f&&d.editItemIndex)switch(f.selModel){case"rows":case"row":var l=e.getSelection();0===l.length||l.length>1?d.menu.disableItem(d.editItemIndex):d.menu.enableItem(d.editItemIndex)}setTimeout(function(){Fancy.get(document).once("click",function(a){d.hideMenu()})},50)},hideMenu:function(){var a=this;setTimeout(function(){a.menu.hide()},50)}})}(),Fancy.modules.filter=!0,function(){var a=Fancy,b=a.FIELD_CLS,c=a.GRID_HEADER_CELL_DOUBLE_CLS,d=a.GRID_HEADER_CELL_TRIPLE_CLS,e=a.GRID_HEADER_CELL_FILTER_CLS,f=a.GRID_HEADER_CELL_FILTER_FULL_CLS,g=a.GRID_HEADER_CELL_FILTER_SMALL_CLS;a.define("Fancy.grid.plugin.Filter",{extend:a.Plugin,ptype:"grid.filter",inWidgetName:"filter",autoEnterDelay:500,caseSensitive:!0,constructor:function(){this.filters={},this.Super("const",arguments)},init:function(){this.Super("init",arguments),this.ons()},ons:function(){var a=this,b=a.widget;b.once("render",function(){a.render()}),b.on("columnresize",a.onColumnResize,a),b.on("filter",a.onFilter,a),b.on("lockcolumn",a.onLockColumn,a),b.on("rightlockcolumn",a.onRightLockColumn,a),b.on("unlockcolumn",a.onUnLockColumn,a),b.on("columndrag",a.onColumnDrag,a)},render:function(){var a=this,b=a.widget;b.header&&(a._renderSideFields(b.header,b.columns),a._renderSideFields(b.leftHeader,b.leftColumns),a._renderSideFields(b.rightHeader,b.rightColumns))},_renderSideFields:function(a,b){for(var f,g,h=this,i=0,j=b.length;i<j;i++)g=b[i],f=a.getCell(i),g.filter&&g.filter.header?(h.renderFilter(g.type,g,f),h.groupHeader&&!g.grouping&&f.addCls(d),f.addCls(e)):h.header&&(h.groupHeader&&!g.grouping?f.addCls(d):g.grouping&&h.groupHeader?f.addCls(c):g.grouping||f.addCls(c))},_clearColumnsFields:function(c,d,e,f){for(var g,h=0,i=c.length;h<i;h++)if(g=c[h],g.filter&&g.filter.header){if(e&&g.index!==e)continue;switch(g.type){case"date":var j=d.getCell(h).select("."+b),k=a.getWidget(j.item(0).attr("id")),l=a.getWidget(j.item(1).attr("id"));k.clear(),l.clear();break;default:var m=d.getCell(h).select("."+b).attr("id"),n=a.getWidget(m);if(f){var o=n.get().split(",");if(o.length<2&&!f)n.clear();else{for(var p=0,q=o.length,r="";p<q;p++){var s=o[p];new RegExp(f).test(s)||(r+=s+",")}","===r[r.length-1]&&(r=r.substring(0,r.length-1)),n.set(r)}}else n.clear()}}},clearColumnsFields:function(a,b){var c=this,d=c.widget;c._clearColumnsFields(d.columns,d.header,a,b),c._clearColumnsFields(d.leftColumns,d.leftHeader,a,b),c._clearColumnsFields(d.rightColumns,d.rightHeader,a,b)},_addValuesInColumnFields:function(c,d,e,f,g){for(var h,i=0,j=c.length;i<j;i++)if(h=c[i],h.index===e&&h.filter&&h.filter.header)switch(h.type){case"date":var k=d.getCell(i).select("."+b),l=a.getWidget(k.item(0).attr("id")),m=a.getWidget(k.item(1).attr("id"));l.clear(),m.clear();break;default:var n=d.getCell(i).select("."+b).attr("id"),o=a.getWidget(n),p=o.get(),q=o.get().split(",");if(1===q.length&&""===q[0])o.set((g||"")+f);else if(1===q.length)new RegExp(g).test(p)?o.set((g||"")+f):o.set(p+","+(g||"")+f);else{for(var r=0,s=q.length,t="",u=!1;r<s;r++){var v=q[r];new RegExp(g).test(v)?(u=!0,0!==t.length&&(t+=","),t+=(g||"")+f):(0!==t.length&&(t+=","),t+=v)}!1===u&&(t+=",",t+=(g||"")+f),o.set(t)}}},addValuesInColumnFields:function(b,c,d){var e=this,f=e.widget;void 0!==c&&null!==c&&0!==c.length&&(a.isFunction(c)||(e._addValuesInColumnFields(f.columns,f.header,b,c,d),e._addValuesInColumnFields(f.leftColumns,f.leftHeader,b,c,d),e._addValuesInColumnFields(f.rightColumns,f.rightHeader,b,c,d)))},renderFilter:function(b,c,d){var e,f=this,g=f.widget,h={position:"absolute",bottom:"3px"},i=c.filter,j=g.theme,k=i.tip,l="",m=f.filters[c.index];if(m)for(var n in m){var o=m[n];switch(n){case"":l+=o;break;default:"combo"===c.type?l=o+",":l+=n+o+","}}if(","===l[l.length-1]&&(l=l.substring(0,l.length-1)),Fancy.isObject(i.header)){var p=i.header;a.apply(p,{renderTo:d.dom,label:!1,style:h,theme:j,widget:g,tip:k,value:l,padding:!1});var q={combo:"Combo"};"combo"===p.type&&a.apply(p,{width:c.width-8,height:28,multiSelect:c.multiSelect,itemCheckBox:c.itemCheckBox,minListWidth:c.minListWidth,listItemTpl:c.listItemTpl});var r=q[p.type];e=new a[r](p)}else switch(b){case"date":var s=[];s.push({change:f.onDateChange,scope:f});if(a.isString(c.format))switch(c.format){case"date":c.format}e=new a.DateRangeField({renderTo:d.dom,value:new Date,format:c.format,label:!1,padding:!1,style:h,events:s,width:c.width-8,emptyText:i.emptyText,dateImage:!1,value:l,theme:j});break;case"string":var s=[{enter:f.onEnter,scope:f}];!1!==f.autoEnterDelay&&s.push({key:f.onKey,scope:f}),e=new a.StringField({renderTo:d.dom,label:!1,padding:!1,style:h,events:s,emptyText:i.emptyText,tip:k,value:l,widget:g});break;case"number":case"grossloss":case"progressbar":case"progressdonut":var s=[{enter:f.onEnter,scope:f}];!1!==f.autoEnterDelay&&s.push({key:f.onKey,scope:f}),e=new a.NumberField({renderTo:d.dom,label:!1,padding:!1,style:h,emptyText:i.emptyText,events:s,widget:g,value:l,tip:k});break;case"combo":var t,u="text",v="text";void 0!==c.displayKey&&(u=c.displayKey,v=u),t=a.isObject(c.data)||a.isObject(c.data[0])?c.data:f.configComboData(c.data);var w;c.filter&&c.filter.selectAll&&(w=c.filter.selectAll),e=new a.Combo({renderTo:d.dom,label:!1,padding:!1,style:h,width:c.width-8,displayKey:u,valueKey:v,value:l,height:28,emptyText:i.emptyText,theme:j,widget:g,tip:k,multiSelect:c.multiSelect,itemCheckBox:c.itemCheckBox,minListWidth:c.minListWidth,listItemTpl:c.listItemTpl,selectAllText:w,subSearch:c.subSearch,events:[{change:f.onEnter,scope:f},{empty:function(){this.set(-1)}}],data:t});break;case"select":g.selection&&/row/.test(g.selection.selModel)&&(e=new a.Combo({renderTo:d.dom,label:!1,padding:!1,style:h,displayKey:"text",valueKey:"value",width:c.width-8,emptyText:i.emptyText,value:l,editable:!1,subSearch:!1,events:[{change:f.onEnterSelect,scope:f}],data:[{value:"",text:""},{value:"false",text:g.lang.no},{value:"true",text:g.lang.yes}]}));break;case"checkbox":e=new a.Combo({renderTo:d.dom,label:!1,padding:!1,style:h,displayKey:"text",valueKey:"value",width:c.width-8,emptyText:i.emptyText,value:l,editable:!1,subSearch:!1,events:[{change:f.onEnter,scope:f}],data:[{value:"",text:""},{value:"false",text:g.lang.no},{value:"true",text:g.lang.yes}]});break;default:var s=[{enter:f.onEnter,scope:f}];!1!==f.autoEnterDelay&&s.push({key:f.onKey,scope:f}),e=new a.StringField({renderTo:d.dom,label:!1,style:h,padding:!1,value:l,emptyText:i.emptyText,events:s})}switch(e.filterIndex=c.index,e.column=c,"date"!==b&&(e.el.css("padding-left","4px"),e.el.css("padding-top","0px")),b){case"checkbox":case"combo":case"date":break;default:e.setInputSize({width:c.width-8})}c.filterField=e},onEnter:function(b,c,d){var e=this,f=e.widget,g=f.store,h=b.filterIndex;if(d=d||{},e.intervalAutoEnter&&(clearInterval(e.intervalAutoEnter),e.intervalAutoEnter=!1),delete e.intervalAutoEnter,0===c.length)return e.filters[b.filterIndex]={},e.clearFilter(b.filterIndex,void 0,!1),e.updateStoreFilters(),void(f.grouping&&f.grouping.reGroup());var i=e.processFilterValue(c,b.column.type),j=0,k=i.length;for(e.filters[h]={};j<k;j++){var l=i[j];""===l.operator&&b.column.filter&&b.column.filter.operator&&(l.operator=b.column.filter.operator),"&"===l.separator?a.isArray(e.filters[h][l.operator])?e.filters[h][l.operator].push(l.value):e.filters[h][l.operator]=[l.value]:e.filters[h][l.operator]=l.value,l.operator,"date"===b.column.type&&a.apply(e.filters[h],d)}g.remoteFilter?(g.filters=e.filters,g.once("serversuccess",function(){f.fire("filter",e.filters)}),g.serverFilter()):e.updateStoreFilters(),f.grouping&&(g.remoteSort?g.once("load",function(){f.grouping.reGroup(),f.fire("filter",e.filters)}):f.grouping.reGroup()),f.setSidesHeight()},onEnterSelect:function(a,b,c){var d=this,e=d.widget,f=e.getSelection(),g=[];Fancy.each(f,function(a){g.push(a.id)}),b===String(!0)?g.length?e.addFilter("id",g,"="):(e.clearFilter("id","="),e.clearFilter("id","!=")):b===String(!1)?(e.clearFilter("id","="),e.addFilter("id",g,"!=")):e.clearFilter("id")},processFilterValue:function(b,c){var d,e,f,g,h,i={"<":!0,">":!0,"!":!0,"=":!0,"|":!0},j=0,k=3,l=[];if(a.isArray(b))return e={},a.Array.each(b,function(a,b){e[String(a).toLocaleLowerCase()]=!0}),l.push({operator:"|",value:e}),l;var m=",";for(/\&/.test(b)&&(m="&"),f=b.split(m),g=0,h=f.length;g<h;g++){for(j=0,d="",e=f[g];j<k;j++)i[e[j]]&&(d+=e[j]);if(e=e.replace(new RegExp("^"+d),""),!(e.length<1)){switch(c){case"number":e=Number(e);break;case"combo":d="="}l.push({operator:d,value:e,separator:m})}}return l},updateStoreFilters:function(a){var b=this,c=b.widget,d=c.store,e=!1;c.filtering=!0,d.filters=b.filters;for(var f in d.filters){if(d.filters[f]){e=!0;break}}e||delete d.filteredData,!1!==a&&(d.changeDataView(),c.update(),c.fire("filter",b.filters),c.setSidesHeight()),e||(delete d.filteredData,delete d.filteredDataMap,delete d.filterOrder),delete c.filtering},forceUpdateStoreFilters:function(){var a=this,b=a.widget;b.store.changeDataView(),b.update(),b.fire("filter",a.filters),b.setSidesHeight()},onColumnResize:function(c,d){var e,f=a.get(d.cell),g=d.width,h=f.select("."+b);2===h.length&&(h=h.item(1)),0===h.length||(2===h.length?(e=a.getWidget(h.item(0).dom.id),e.setWidth((g-8)/2),e=a.getWidget(h.item(1).dom.id),e.setWidth((g-8)/2)):(e=a.getWidget(h.dom.id),"field.combo"===e.wtype?(e.size({width:g-8}),e.el.css("width",g-8+5)):e.setInputSize({width:g-8})))},onKey:function(b,c,d){var e=this;d.keyCode!==a.key.ENTER&&(e.autoEnterTime=+new Date,e.intervalAutoEnter||(e.intervalAutoEnter=setInterval(function(){var a=new Date;e.intervalAutoEnter&&a-e.autoEnterTime>e.autoEnterDelay&&(clearInterval(e.intervalAutoEnter),delete e.intervalAutoEnter,c=b.getValue(),e.onEnter(b,c))},200)))},onDateChange:function(b,c){var d,e,f,g=this,h=g.widget,i=b.format,j=h.store,k=b.dateField1.getDate(),l=b.dateField2.getDate(),m="Invalid Date"!==k.toString()&&a.isDate(k),n="Invalid Date"!==l.toString()&&a.isDate(l),o=j.remoteFilter;m&&(k=new Date(k.getFullYear(),k.getMonth(),k.getDate())),n&&(l=new Date(l.getFullYear(),l.getMonth(),l.getDate())),m&&n?(!0!==o?(e=Number(k),f=Number(l)):(e=a.Date.format(k,i.edit,i.mode),f=a.Date.format(l,i.edit,i.mode)),d=">="+e+",<="+f):m?(d=!0!==o?">="+Number(k):">="+a.Date.format(k,i.edit,i.mode),g.clearFilter(b.filterIndex,"<=",!1)):n?(d=!0!==o?"<="+Number(l):"<="+a.Date.format(k,i.edit,i.mode),g.clearFilter(b.filterIndex,">=",!1)):g.clearFilter(b.filterIndex),d&&g.onEnter(b,d,{type:"date",format:b.format})},clearFilter:function(a,b,c){var d=this;void 0===b?delete d.filters[a]:d.filters[a]&&delete d.filters[a][b],!1!==c&&d.updateStoreFilters()},onFilter:function(){this.widget.scroll(0)},configComboData:function(b){var c=0,d=b.length,e=[];if(a.isObject(b))return b;for(;c<d;c++)e.push({value:c,text:b[c]});return e},destroyFields:function(){var b=this,h=b.widget;a.each(h.columns,function(a){a.filterField&&(a.filterField.destroy(),delete a.filterField)}),a.each(h.leftColumns,function(a){a.filterField&&(a.filterField.destroy(),delete a.filterField)}),a.each(h.rightColumns,function(a){a.filterField&&(a.filterField.destroy(),delete a.filterField)}),h.el.select("."+e).removeCls(e),h.el.select("."+f).removeCls(f),h.el.select("."+g).removeCls(g),h.el.select("."+c).removeCls(c),h.el.select("."+d).removeCls(d)},onLockColumn:function(){this.render()},onUnLockColumn:function(){this.render()},onRightLockColumn:function(){this.render()},onColumnDrag:function(){var a=this;a.destroyFields(),a.render()}})}(),Fancy.define("Fancy.grid.plugin.Search",{extend:Fancy.Plugin,ptype:"grid.search",inWidgetName:"searching",autoEnterDelay:500,constructor:function(){this.searches={},this.Super("const",arguments)},init:function(){this.Super("init",arguments),this.ons()},ons:function(){var a=this;a.widget.once("init",function(){a.generateKeys()})},search:function(a,b){var c=this,d=c.widget,e=d.store;if(c.searches={},!a&&!b)return c.clear(),c.updateStoreSearches(),void(d.grouping&&d.grouping.reGroup());!1!==Fancy.isArray(a)||b||(c.searches=a),c.setFilters(),e.remoteSort?e.serverFilter():(c.updateStoreSearches(),setTimeout(function(){d.fire("filter",e.filters)},1)),d.grouping&&(e.remoteSort?e.once("load",function(){d.grouping.reGroup()}):d.grouping.reGroup())},updateStoreSearches:function(){var a=this.widget;a.store.changeDataView(),a.update()},setKeys:function(a){var b=this;b.keys=a,b.setFilters(),b.updateStoreSearches()},generateKeys:function(){var a=this,b=a.widget;if(a.items)a.keys={},Fancy.each(a.items,function(b){a.keys[b.index]=!0});else if(!a.keys){a.keys={};var c=[];b.columns&&(c=c.concat(b.columns)),b.leftColumns&&(c=c.concat(b.leftColumns)),b.rightColumns&&(c=c.concat(b.rightColumns));var d=[];Fancy.each(c,function(a){var b=a.index;if(!1!==a.searchable){switch(a.type){case"color":case"combo":case"date":case"number":case"string":case"text":case"currency":break;default:return}b&&d.push(b)}}),Fancy.each(d,function(b){"$selected"!==b&&(a.keys[b]=!0)})}return a.keys},setFilters:function(){var a=this,b=a.widget,c=b.store,d=c.filters||{};if(void 0===a.searches||Fancy.isObject(a.searches))return void a.clear();for(var e in a.keys)!1!==a.keys[e]?(d[e]=d[e]||{},d[e]["*"]=a.searches):d[e]&&delete d[e]["*"];a.filters=d,c.filters=d},clear:function(){var a=this,b=a.widget,c=b.store,d=c.filters||{};for(var e in a.keys)void 0!==d[e]&&delete d[e]["*"];a.filters=d,c.filters=d,delete a.searches},clearBarField:function(){for(var a,b=this,c=b.widget,d=0,e=(c.tbar||[]).length;d<e;d++)a=c.tbar[d],"search"===a.type&&a.clear();for(d=0,e=(c.subTBar||[]).length;d<e;d++)a=c.subTBar[d],"search"===a.type&&a.clear()}}),Fancy.modules.dd=!0,function(){var a=Fancy,b=a.GRID_BODY_CLS,c=a.GRID_CLS,d=a.GRID_CELL_CLS;a.define("Fancy.grid.plugin.GridToGrid",{extend:a.Plugin,ptype:"grid.dragdrop",inWidgetName:"dragdrop",dropOK:!1,cellMaskCls:"fancy-drop-cell-mask",dropZoneCls:"fancy-drop-zone-active",dropOkCls:"fancy-drop-ok",dropNotOkCls:"fancy-drop-not-ok",dropHeaderMaskCls:"fancy-drop-header-mask",droppable:!0,dropZoneOverClass:b,constructor:function(){this.Super("const",arguments)},init:function(){var a=this;a.addEvents("drop"),a.Super("init",arguments),a.initDropCls(),a.initEnterLeave(),a.ons()},initDropCls:function(){var a=this,b="."+a.dropGroup;b+=" ."+a.dropZoneOverClass,a.dropCls=b},addDragDropCls:function(){this.widget.el.addCls(this.dragGroup)},ons:function(){var a=this,b=a.widget;b.on("render",function(){a.addDragDropCls()}),a.dropGroup&&(b.on("beforecellmousedown",a.onBeforeCellMouseDown,a),b.on("cellmousedown",a.onCellMouseDown,a),b.on("cellleave",a.onCellLeave,a),b.on("cellenter",a.onCellEnter,a)),a.on("drop",a.onDropItems,a)},onDropItems:function(a,b){var c=this,d=c.widget,e=c.dropGrid,f=void 0===e.activeRowEnterIndex?e.getViewTotal():e.activeRowEnterIndex;d.fire("dropitems",b,f),c.onDrop&&c.onDrop.apply(d,[b,f])},onBeforeCellMouseDown:function(b,c){var d=this,e=d.widget,f=e.lang,g=a.get(document),h=e.getSelection();if((!c.e.ctrlKey||!0!==e.multiSelect)&&h.length>1){var i=!1;if(a.each(h,function(a){if(a.id===c.id)return i=!0,!0}),!1===i)return;e.stopSelection(),g.once("mouseup",d.onDocMouseUp,d),g.on("mousemove",d.onDocMouseMove,d),g.once("mouseup",function(){e.enableSelection()},d),h=e.getSelection();var j=a.String.format(f.dragText,[h.length,h.length>1?"s":""]);d.initTip(j),d.dragItems=e.getSelection(),d.cellMouseDown=!0}},onCellMouseDown:function(b,c){var d=this,e=d.widget,f=a.get(document);if(!1!==e.selection.enabled){c.e.ctrlKey&&!0===e.multiSelect||("$selected"===c.column.index||e.clearSelection(),f.once("mouseup",d.onDocMouseUp,d),f.on("mousemove",d.onDocMouseMove,d),d.cellMouseDown=!0,d.activeRowIndex=c.rowIndex)}},initEnterLeave:function(){var b=this,c=a.select(b.dropCls);if(0===c.length)return void setTimeout(function(){b.initEnterLeave()},500);c.on("mouseenter",b.onMouseEnterDropGroup,b),c.on("mouseleave",b.onMouseLeaveDropGroup,b)},onMouseEnterDropGroup:function(b){var d=this;if(d.cellMouseDown){var e=a.get(b.currentTarget);if(d.dropGrid=a.getWidget(e.closest("."+c).attr("id")),d.dropGrid&&d.dropGrid.dragdrop&&!1===d.dropGrid.dragdrop.droppable)return d.dropOK=!1,void(d.tip&&d.tip.el.replaceClass(d.dropOkCls,d.dropNotOkCls));d.setDropGridCellsMask(),d.dropGridEventInited||d.onsDropGrid(),e.addCls(d.dropZoneCls),d.dropOK=!0,d.tip&&d.tip.el.replaceClass(d.dropNotOkCls,d.dropOkCls)}},onMouseLeaveDropGroup:function(b){var c=this;c.cellMouseDown&&(a.get(b.currentTarget).removeCls(c.dropZoneCls),c.dropOK=!1,c.tip.el.replaceClass(c.dropOkCls,c.dropNotOkCls),c.clearCellsMask())},setDropGridCellsMask:function(){var a,b=this,c=b.dropGrid;c&&b.cellMouseDown&&(a=c.getTotal(),0===a?c.el.addCls(b.dropHeaderMaskCls):c.el.select("."+d+'[index="'+(a-1)+'"]').addCls(b.cellMaskCls))},onsDropGrid:function(){var a=this;a.dropGrid.on("rowenter",a.onDropGridRowEnter,a),a.dropGrid.on("rowleave",a.onDropGridRowLeave,a),a.dropGridEventInited=!0},onDropGridRowEnter:function(a,b){var c=this;!1===c.cellMouseDown&&(c.dropGrid.un("rowenter",c.onDropGridRowEnter),c.dropGrid.un("rowleave",c.onDropGridRowLeave)),c.clearCellsMask(),0===b.rowIndex?a.el.addCls(c.dropHeaderMaskCls):a.el.select("."+d+'[index="'+(b.rowIndex-1)+'"]').addCls(c.cellMaskCls),!1===c.cellMouseDown&&c.clearCellsMask(),c.dropGrid&&(c.dropGrid.activeRowEnterIndex=b.rowIndex)},onDropGridRowLeave:function(a,b){var c=this;c.clearCellsMask(),c.setDropGridCellsMask(),c.dropGrid&&delete c.dropGrid.activeRowEnterIndex},clearCellsMask:function(){var a=this,b=a.cellMaskCls;a.dropGrid&&(a.dropGrid.el.removeCls(a.dropHeaderMaskCls),a.dropGrid.el.select("."+b).removeCls(b))},onDocMouseUp:function(b){var c=this,d=c.widget,e=a.get(document);c.cellMouseDown=!1,c.tip&&c.tip.hide(),d.enableSelection(),e.un("mousemove",c.onDocMouseMove),!0===c.dropOK&&(d.clearSelection(),c.dropGrid.clearSelection(),c.fire("drop",c.dragItems)),delete c.dragItems,c.dropOK=!1,a.select("."+c.dropZoneCls).removeCls(c.dropZoneCls),c.clearCellsMask(),c.dropGrid&&(c.dropGrid.un("rowenter",c.onDropGridRowEnter),c.dropGrid.un("rowleave",c.onDropGridRowLeave)),delete c.dropGridEventInited},onDocMouseMove:function(a){this.dragItems&&this.tip.show(a.pageX+20,a.pageY+20)},onCellLeave:function(b,c){var d=this,e=d.widget,f=e.lang;setTimeout(function(){if(d.onceStopDrag)return void(d.onceStopDrag=!1);if(!0===d.cellMouseDown&&!d.dragItems){var b=e.getSelection(),g=a.String.format(f.dragText,[b.length,b.length>1?"s":""]);e.stopSelection(),d.initTip(g,c.e),d.tip.show(),d.tip.el.css("display","block"),d.dragItems=b}},1)},onCellEnter:function(a,b){var c=this;!0!==c.cellMouseDown||c.dragItems||b.rowIndex!==c.activeRowIndex&&(c.onceStopDrag=!0,c.activeRowIndex=b.rowIndex)},initTip:function(b,c){var d=this,e=d.dropNotOkCls;d.tip||(d.tip=new a.ToolTip({cls:e,text:b})),c&&d.tip.show(c.pageX+20,c.pageY+20),d.tip.update(b),d.tip.el.replaceClass(d.dropOkCls,e)}})}(),function(){var a=Fancy,b=a.GRID_BODY_CLS,c=a.GRID_CELL_CLS,d=a.GRID_CELL_SELECTED_CLS;a.GRID_ROW_DRAG_EL_CLS;a.define("Fancy.grid.plugin.RowDragDrop",{extend:a.Plugin,ptype:"grid.rowdragdrop",inWidgetName:"rowdragdrop",dropOK:!1,cellMaskCls:"fancy-drop-cell-mask",cellFirstRowMaskCls:"fancy-drop-cell-first-mask",dropZoneCls:"fancy-drop-zone-active",dropOkCls:"fancy-drop-ok",dropNotOkCls:"fancy-drop-not-ok",droppable:!0,dropZoneOverClass:b,tipShown:!1,constructor:function(){this.Super("const",arguments)},init:function(){var a=this;a.Super("init",arguments),a.addEvents("drop"),a.ons(),a.initDropCls(),a.initEnterLeave()},ons:function(){var a=this,b=a.widget;b.on("beforecellmousedown",a.onBeforeCellMouseDown,a),b.on("cellmousedown",a.onCellMouseDown,a),b.on("rowenter",a.onRowEnter,a),b.on("cellleave",a.onCellLeave,a),a.on("drop",a.onDrop,a)},disableSelectionMove:function(){this.widget.selection.disableSelectionMove()},showTip:function(a){var b=this;0!==b.widget.getSelection().length&&(b.tip||b.initTip(),b.updateTipText(),a&&b.tip.show(a.pageX+20,a.pageY+20),b.tipShown=!0)},hideTip:function(){var a=this;a.tip&&a.tip.hide(),a.tipShown=!1},onCellMouseDown:function(b,c){var d=this,e=a.get(document),f=a.get(c.e.target),g=f.dom.tagName.toLocaleLowerCase();"svg"!==g&&"path"!==g||(d.cellMouseDown=a.get(c.cell),e.once("mouseup",d.onDocMouseUp,d))},onDocMouseUp:function(b){var c=this,d=c.widget,e=a.get(document);c.cellMouseDown=!1,c.mouseDownDragEl=!1,delete c.tipValue,c.tipShown&&(e.un("mousemove",c.onDocMouseMove),c.hideTip(),c.clearCellsMask(),c.dropOK&&c.fire("drop"),c.tipShown=!1),d.selection&&(setTimeout(function(){d.selection.clearOverCells()},1),d.enableSelection())},onRowEnter:function(b,c){var e=this,f=e.widget,g=f.getSelection();if(e.cellMouseDown&&0!==g.length&&e.tipShown){if(0!==c.rowIndex){var h=c.rowIndex-1;if(f.body.getCell(h,0).hasClass(d))return e.dropOK=!1,e.clearCellsMask(),void delete e.activeRowIndex;if(f.body.getCell(c.rowIndex,0).hasClass(d)&&1===g.length)return e.dropOK=!1,e.clearCellsMask(),void delete e.activeRowIndex;if(g.length>1){var h,i=!0;if(a.each(g,function(a){if(void 0===h)return void(h=f.getRowById(a.id));var b=f.getRowById(a.id);if(h!==b-1)return i=!1,!0;h=b}),i&&f.body.getCell(c.rowIndex,0).hasClass(d))return e.dropOK=!1,e.clearCellsMask(),void delete e.activeRowIndex}e.dropOK=!0;var j=f.get(h);e.insertItem=j}else{if(f.body.getCell(c.rowIndex,0).hasClass(d)){if(!(g.length>1))return e.dropOK=!1,e.clearCellsMask(),void delete e.activeRowIndex;var h,i=!0;if(a.each(g,function(a){if(void 0===h)return void(h=f.getRowById(a.id));var b=f.getRowById(a.id);if(h!==b-1)return i=!1,!0;h=b}),i&&f.body.getCell(c.rowIndex,0).hasClass(d))return e.dropOK=!1,e.clearCellsMask(),void delete e.activeRowIndex;e.dropOK=!0}else e.dropOK=!0;e.insertItem=0}var k=f.selection.memory;if(k&&k.all&&0===k.exceptedLength)return e.dropOK=!1,void delete e.activeRowIndex;e.activeRowIndex=c.rowIndex,e.showCellsDropMask()}},onCellLeave:function(b,c){var e=this,f=a.get(document),g=a.get(c.cell);e.cellMouseDown&&(e.tipShown||g.hasClass(d)&&(e.tip||e.initTip(),e.updateTipText(),e.showTip(c.e),f.on("mousemove",e.onDocMouseMove,e)))},initTip:function(){var b=this,c=b.dropNotOkCls;b.tip||(b.tip=new a.ToolTip({cls:c,text:""}))},updateTipText:function(){var b=this,c=b.widget,d=c.lang,e=c.getSelection(),f=a.String.format(d.dragText,[e.length,e.length>1?"s":""]);b.tipValue&&1===e.length&&(f=b.tipValue),b.tip.update(f),e.length&&0!=b.dropOK?b.tip.el.replaceClass(b.dropNotOkCls,b.dropOkCls):b.tip.el.replaceClass(b.dropOkCls,b.dropNotOkCls)},onDocMouseMove:function(a){var b=this;b.cellMouseDown&&b.cellMouseDown.hasClass(d)?b.showTip(a):b.hideTip()},showCellsDropMask:function(){var a=this,b=a.widget,d=a.activeRowIndex-1;a.clearCellsMask(),-1===d?b.el.select("."+c+'[index="0"]').addCls(a.cellFirstRowMaskCls):b.el.select("."+c+'[index="'+d+'"]').addCls(a.cellMaskCls)},clearCellsMask:function(){var a=this,b=a.widget;b.el.select("."+a.cellMaskCls).removeCls(a.cellMaskCls),b.el.select("."+a.cellFirstRowMaskCls).removeCls(a.cellFirstRowMaskCls)},onDrop:function(){var b,c=this,d=c.widget,e=d.getSelection();d.draggingRows=!0,d.selection.memory||d.clearSelection(),d.remove(e,null,!1),b=0===c.insertItem?0:d.getRowById(c.insertItem.id)+1,d.insert(b,e,!1),d.store.changeDataView(),d.update(),d.selection.memory||a.each(e,function(a){var b=d.getRowById(a.id);d.flashRow(b)}),d.fire("dragrows",e),delete d.draggingRows,d.enableSelection()},onBeforeCellMouseDown:function(b,c){var e=this,f=Fancy.get(document),g=e.widget,h=a.get(c.e.target);("rowdrag"===c.column.type||c.column.rowdrag)&&(c.column.rowdrag&&(e.tipValue=c.value),("rowdrag"===c.column.type||c.column.rowdrag)&&("svg"!==h.dom.tagName.toLocaleLowerCase()&&"svg"!==h.parent().dom.tagName.toLocaleLowerCase()||(Fancy.get(c.cell).hasClass(d)||(g.selection.row?g.selectRow(c.rowIndex):g.selection.rows&&g.selectRow(c.rowIndex,!0,!0)),e.mouseDownDragEl=!0,f.once("mousemove",function(a){e.showTip(a),f.on("mousemove",e.onDocMouseMove,e)}),g.stopSelection())))},initDropCls:function(){var a=this,b=a.widget,c="#"+b.id+" ."+a.dropZoneOverClass;a.dropCls=c},initEnterLeave:function(){var b=this,c=a.select(b.dropCls);if(0===c.length)return void setTimeout(function(){b.initEnterLeave()},500);c.on("mouseleave",b.onMouseLeaveDropGroup,b)},onMouseLeaveDropGroup:function(){var a=this;a.dropOK=!1,a.clearCellsMask()}})}(),Fancy.modules.exporter=!0,Fancy.define("Fancy.grid.plugin.Exporter",{extend:Fancy.Plugin,ptype:"grid.exporter",inWidgetName:"exporter",csvSeparator:",",csvHeader:!1,csvFileName:"export",excelFileName:"export",constructor:function(){this.Super("const",arguments),Fancy.fullBuilt&&Fancy.loadModule("excel")},init:function(){},exportToExcel:function(a){function b(a){for(var b=new ArrayBuffer(a.length),c=new Uint8Array(b),d=0;d!=a.length;++d)c[d]=255&a.charCodeAt(d);return b}var c=this,d=c.widget,a=a||{},e=c.getColumnsData(),f=c.getData(a),g=!1===a.header?f:[e].concat(f),h=function(){if(!(this instanceof h))return new h;this.SheetNames=[],this.Sheets={}},i=new h,j=c.sheet_from_array_of_arrays(g);j["!cols"]=[],Fancy.each(c.widths,function(a){j["!cols"].push({wch:a})});var k=d.title;a.fileName?k=a.fileName:Fancy.isObject(k)&&(k=k.text);var l=k||c.excelFileName;i.SheetNames.push(l),i.Sheets[l]=j;var m=XLSX.write(i,{bookType:"xlsx",bookSST:!0,type:"binary"});saveAs(new Blob([b(m)],{type:"application/octet-stream"}),l+".xlsx")},getColumnsData:function(){var a=this,b=a.widget,c=[].concat(b.leftColumns).concat(b.columns).concat(b.rightColumns),d=[];return a.widths=[],Fancy.each(c,function(b){"$selected"!==b.index&&(a.widths.push(b.width),d.push(b.title||""))}),d},getData:function(a){if(a&&a.data)return a.data;var b=this,a=a||{},c=b.widget,d=[],e=a.all?c.getDisplayedData(!0):c.getDisplayedData();return Fancy.each(e,function(a){var b=[];Fancy.each(a,function(a){b.push(a)}),d.push(b)}),d},sheet_from_array_of_arrays:function(a,b){for(var c={},d={s:{c:1e7,r:1e7},e:{c:0,r:0}},e=0,f=a.length,g=function(a,b){return b&&(a+=1462),(Date.parse(a)-new Date(Date.UTC(1899,11,30)))/864e5};e!=f;++e)for(var h=0;h!=a[e].length;++h){d.s.r>e&&(d.s.r=e),d.s.c>h&&(d.s.c=h),d.e.r<e&&(d.e.r=e),d.e.c<h&&(d.e.c=h);var i={v:a[e][h]};if(null!=i.v){var j=XLSX.utils.encode_cell({c:h,r:e});"number"==typeof i.v?i.t="n":"boolean"==typeof i.v?i.t="b":i.v instanceof Date?(i.t="n",i.z=XLSX.SSF._table[14],i.v=g(i.v)):i.t="s",c[j]=i}}return d.s.c<1e7&&(c["!ref"]=XLSX.utils.encode_range(d)),c},getDataAsCsv:function(a){var b=this,c=b.widget,d=b.getData(a),e="",a=a||{},f=a.separator||b.csvSeparator;if(a.header||b.csvHeader){var g=function(a){a.hidden||(e+='"'+(a.title||"")+'"'+f)};Fancy.each(c.leftColumns,g),Fancy.each(c.columns,g),Fancy.each(c.rightColumns,g),e=e.substring(0,e.length-1),e+="\r\n"}return Fancy.each(d,function(a,b){Fancy.each(a,function(a,b){Fancy.isString(a)&&(a='"'+a+'"'),e+=a+f}),e=e.substring(0,e.length-1),e+="\r\n"}),e},exportToCSV:function(a){var b=this,a=a||{},c=b.getDataAsCsv(a),d=a.fileName||b.csvFileName,e=new Blob([c],{type:"text/csv;charset=utf-8;"});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(e,d);else{var f=document.createElement("a");f.href=window.URL.createObjectURL(e),f.download=d+".csv",document.body.appendChild(f),f.click(),document.body.removeChild(f)}}}),Fancy.modules.state=!0,function(){var a=Fancy;a.define("Fancy.grid.plugin.State",{extend:a.Plugin,ptype:"grid.state",inWidgetName:"state",stateful:!1,$log:{filter:!0,sort:!0,columnresize:!0,columndrag:!0,changepage:!0,columnhide:!0,resize:!0},constructor:function(){this.log=this.log||{},this.Super("const",arguments)},init:function(){var a=this;a.Super("init",arguments),a.initLog(),a.ons()},ons:function(){var a=this,b=a.widget;b.on("beforeinit",a.onBeforeInit,a),a.stateful&&(a.log.sort&&b.on("sort",a.onSort,a),a.log.filter&&b.on("filter",a.onFilter,a),a.log.columnresize&&b.on("columnresize",a.onColumnResize,a),a.log.columndrag&&(b.on("columndrag",a.onColumnDrag,a),b.on("lockcolumn",a.onColumnLock,a),b.on("rightlockcolumn",a.onColumnRightLock,a),b.on("unlockcolumn",a.onColumnUnLock,a)),a.log.changepage&&b.on("changepage",a.onChangePage,a),a.log.columnhide&&(b.on("columnhide",a.onColumnHide,a),b.on("columnshow",a.onColumnShow,a)),b.on("init",function(){b.panel&&a.log.resize&&b.panel.on("resize",a.onResize,a)}))},onSort:function(){var a=this,b=a.widget,c=b.store,d=b.getStateName(),e=localStorage.getItem(d)||"{}";e=JSON.parse(e),e.sorters=JSON.stringify(c.sorters),localStorage.setItem(d,JSON.stringify(e)),a.copyColumns(),a.widget.fire("statechange",a.getState())},onFilter:function(){var a=this,b=a.widget,c=b.store,d=b.getStateName(),e=localStorage.getItem(d)||"{}";e=JSON.parse(e),e.filters=JSON.stringify(c.filters),localStorage.setItem(d,JSON.stringify(e)),a.copyColumns(),a.widget.fire("statechange",a.getState())},onColumnResize:function(){var a=this;a.copyColumns(),a.widget.fire("statechange",a.getState())},onColumnDrag:function(){var a=this;a.copyColumns(),a.widget.fire("statechange",a.getState())},onColumnLock:function(){var a=this;a.copyColumns(),a.widget.fire("statechange",a.getState())},onColumnRightLock:function(){var a=this;a.copyColumns(),a.widget.fire("statechange",a.getState())},onColumnUnLock:function(){var a=this;a.copyColumns(),a.widget.fire("statechange",a.getState())},onColumnHide:function(){var a=this;a.copyColumns(),a.widget.fire("statechange",a.getState())},onColumnShow:function(){var a=this;a.copyColumns(),a.widget.fire("statechange",a.getState())},copyColumns:function(){var b=this,c=b.widget,d=c.getStateName(),e=localStorage.getItem(d)||"{}";e=JSON.parse(e);var f=[].concat(c.leftColumns).concat(c.columns).concat(c.rightColumns),g=[];a.each(f,function(b){var c={};a.each(b,function(b,d){switch(a.typeOf(b)){case"string":case"number":case"boolean":c[d]=b;break;case"object":switch(d){case"filterField":break;default:c[d]="OBJECT"}break;case"array":c[d]="ARRAY";break;case"function":c[d]="FUNCTION"}}),g.push(c)}),e.columns=JSON.stringify(g),localStorage.setItem(d,JSON.stringify(e))},onBeforeInit:function(){var b=this,c=b.widget,d=c.getStateName(),e=localStorage.getItem(d)||"{}",f=b.startState;if(f){if(c.store.loading)return void c.once("load",b.onBeforeInit,b);f.filters&&setTimeout(function(){for(var a in f.filters){var b=f.filters[a];for(var d in b)c.addFilter(a,b[d],d)}},100),f.sorters&&setTimeout(function(){a.each(f.sorters,function(a){c.sort(a.key,a.dir)})},100),void 0!==f.page&&setTimeout(function(){c.setPage(Number(f.page)+1)},100)}if(e=JSON.parse(e),e.sorters&&(e.sorters=JSON.parse(e.sorters),a.each(e.sorters,function(a){c.sort(a.key,a.dir)})),e.filters){e.filters=JSON.parse(e.filters);for(var g in e.filters){var h=e.filters[g];for(var i in h)c.addFilter(g,h[i],i)}c.WAIT_FOR_APPLYING_ALL_FILTERS&&(c.filter.forceUpdateStoreFilters(),c.once("load",function(){delete c.WAIT_FOR_APPLYING_ALL_FILTERS}))}e.page&&c.setPage(Number(e.page)+1),e.width&&c.setWidth(e.width),e.height&&c.setHeight(e.height)},onChangePage:function(a,b){var c=this,d=c.widget,e=d.getStateName(),f=localStorage.getItem(e)||"{}";void 0!==b&&f&&d.inited&&(f=JSON.parse(f),f.page=b,localStorage.setItem(e,JSON.stringify(f)),c.widget.fire("statechange",c.getState()))},onResize:function(a,b){var c=this,d=c.widget,e=d.getStateName(),f=localStorage.getItem(e)||"{}";f=JSON.parse(f),f.width=b.width,f.height=b.height,localStorage.setItem(e,JSON.stringify(f)),c.widget.fire("statechange",c.getState())},initLog:function(){var b=this;a.applyIf(b.log,b.$log)},getState:function(){var a=this,b=a.widget,c=b.getStateName();return localStorage.getItem(c)||"{}"}})}(),Fancy.define("Fancy.grid.plugin.Licence",{extend:Fancy.Plugin,ptype:"grid.licence",inWidgetName:"licence",constructor:function(){this.Super("const",arguments)},init:function(){this.Super("init",arguments),this.ons()},ons:function(){var a=this;a.widget.once("render",function(){a.render()})},render:function(){var a=this,b=a.widget,c=b.body,d=Fancy.get(document.createElement("div"));/fancygrid/.test(location.host)&&!b.watermark||(!0!==a.checkLicence()||b.watermark)&&(d.css({position:"absolute","z-index":2,width:"30px",height:"30px"}),b.nativeScroller?d.css({top:"2px",left:"2px"}):d.css({right:"4px",bottom:"0px"}),d.update('<a href="http://www.fancygrid.com" title="JavaScript Grid - FancyGrid" style="background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAPklEQVR42mNgGLGAo+/4f1IwTN+i8y/+k4JHLR61eNTiUYuHgcUjD5AbZORG0ajFoxaPWjxq8RC2eBQMWwAAuxzh7E9tdUsAAAAASUVORK5CYII=);color: #60B3E2;font-size: 25px;line-height: 30px;text-decoration: none;">&nbsp;&nbsp;&nbsp;&nbsp;</a>'),Fancy.get(c.el.append(d.dom)),a.licenceEl=d,b.watermark&&a.configWatermark(),a.showConsoleText())},showConsoleText:function(){window.console&&console.log&&Fancy.isChrome&&(console.log("%cFancy%cGrid%c %cTrial%c Version!","color:#A2CFE8;font-size: 14px;font-weight: bold;","color:#088EC7;font-size: 14px;font-weight: bold;","font-weight:bold;color: #515151;font-size: 12px;","color: red;font-weight: bold;font-size: 14px;","font-weight:bold;color: #515151;font-size: 12px;"),console.log("%cPurchase license for legal usage!\nSales email: sales@fancygrid.com","font-weight:bold;color: #515151;font-size: 12px;"))},configWatermark:function(){var a=this,b=a.widget,c=b.watermark;if(c.text){var d=a.licenceEl.firstChild();d.css("background-image","none"),d.css("font-size","11px"),d.update(c.text),a.licenceEl.css("width","initial")}c.style&&a.licenceEl.css(c.style)},checkLicence:function(){var a=this,b="FancyGrid";if(!Fancy.LICENSE&&!FancyGrid.LICENSE)return!1;var c,d,e=String(a.md5(location.host.replace(/^www\./,""),b)),f=Fancy.LICENSE||FancyGrid.LICENSE||[],g=a.md5("UNIVERSAL",b),h=a.md5("SAAS",b),i=a.md5("INTERNAL",b),j=a.md5("OEM",b),k=a.md5("ENTERPRISE",b);for(c=0,d=f.length;c<d;c++)switch(String(f[c])){case e:case g:case h:case i:case j:case k:return!0}return!1},md5:function(a,b,c){var d=function(a,b){var c=(65535&a)+(65535&b);return(a>>16)+(b>>16)+(c>>16)<<16|65535&c},e=function(a,b){return a<<b|a>>>32-b},f=function(a,b,c,f,g,h){return d(e(d(d(b,a),d(f,h)),g),c)},g=function(a,b,c,d,e,g,h){return f(b&c|~b&d,a,b,e,g,h)},h=function(a,b,c,d,e,g,h){return f(b&d|c&~d,a,b,e,g,h)},i=function(a,b,c,d,e,g,h){return f(b^c^d,a,b,e,g,h)},j=function(a,b,c,d,e,g,h){return f(c^(b|~d),a,b,e,g,h)},k=function(a,b){a[b>>5]|=128<<b%32,a[14+(b+64>>>9<<4)]=b;var c,e,f,k,l,m=1732584193,n=-271733879,o=-1732584194,p=271733878;for(c=0;c<a.length;c+=16)e=m,f=n,k=o,l=p,m=g(m,n,o,p,a[c],7,-680876936),p=g(p,m,n,o,a[c+1],12,-389564586),o=g(o,p,m,n,a[c+2],17,606105819),n=g(n,o,p,m,a[c+3],22,-1044525330),m=g(m,n,o,p,a[c+4],7,-176418897),p=g(p,m,n,o,a[c+5],12,1200080426),o=g(o,p,m,n,a[c+6],17,-1473231341),n=g(n,o,p,m,a[c+7],22,-45705983),m=g(m,n,o,p,a[c+8],7,1770035416),p=g(p,m,n,o,a[c+9],12,-1958414417),o=g(o,p,m,n,a[c+10],17,-42063),n=g(n,o,p,m,a[c+11],22,-1990404162),m=g(m,n,o,p,a[c+12],7,1804603682),p=g(p,m,n,o,a[c+13],12,-40341101),o=g(o,p,m,n,a[c+14],17,-1502002290),n=g(n,o,p,m,a[c+15],22,1236535329),m=h(m,n,o,p,a[c+1],5,-165796510),p=h(p,m,n,o,a[c+6],9,-1069501632),o=h(o,p,m,n,a[c+11],14,643717713),n=h(n,o,p,m,a[c],20,-373897302),m=h(m,n,o,p,a[c+5],5,-701558691),p=h(p,m,n,o,a[c+10],9,38016083),o=h(o,p,m,n,a[c+15],14,-660478335),n=h(n,o,p,m,a[c+4],20,-405537848),m=h(m,n,o,p,a[c+9],5,568446438),p=h(p,m,n,o,a[c+14],9,-1019803690),o=h(o,p,m,n,a[c+3],14,-187363961),n=h(n,o,p,m,a[c+8],20,1163531501),m=h(m,n,o,p,a[c+13],5,-1444681467),p=h(p,m,n,o,a[c+2],9,-51403784),o=h(o,p,m,n,a[c+7],14,1735328473),n=h(n,o,p,m,a[c+12],20,-1926607734),m=i(m,n,o,p,a[c+5],4,-378558),p=i(p,m,n,o,a[c+8],11,-2022574463),o=i(o,p,m,n,a[c+11],16,1839030562),n=i(n,o,p,m,a[c+14],23,-35309556),m=i(m,n,o,p,a[c+1],4,-1530992060),p=i(p,m,n,o,a[c+4],11,1272893353),o=i(o,p,m,n,a[c+7],16,-155497632),n=i(n,o,p,m,a[c+10],23,-1094730640),m=i(m,n,o,p,a[c+13],4,681279174),p=i(p,m,n,o,a[c],11,-358537222),o=i(o,p,m,n,a[c+3],16,-722521979),n=i(n,o,p,m,a[c+6],23,76029189),m=i(m,n,o,p,a[c+9],4,-640364487),p=i(p,m,n,o,a[c+12],11,-421815835),o=i(o,p,m,n,a[c+15],16,530742520),n=i(n,o,p,m,a[c+2],23,-995338651),m=j(m,n,o,p,a[c],6,-198630844),p=j(p,m,n,o,a[c+7],10,1126891415),o=j(o,p,m,n,a[c+14],15,-1416354905),n=j(n,o,p,m,a[c+5],21,-57434055),m=j(m,n,o,p,a[c+12],6,1700485571),p=j(p,m,n,o,a[c+3],10,-1894986606),o=j(o,p,m,n,a[c+10],15,-1051523),n=j(n,o,p,m,a[c+1],21,-2054922799),m=j(m,n,o,p,a[c+8],6,1873313359),p=j(p,m,n,o,a[c+15],10,-30611744),o=j(o,p,m,n,a[c+6],15,-1560198380),n=j(n,o,p,m,a[c+13],21,1309151649),m=j(m,n,o,p,a[c+4],6,-145523070),p=j(p,m,n,o,a[c+11],10,-1120210379),o=j(o,p,m,n,a[c+2],15,718787259),n=j(n,o,p,m,a[c+9],21,-343485551),m=d(m,e),n=d(n,f),o=d(o,k),p=d(p,l);return[m,n,o,p]},l=function(a){var b,c="";for(b=0;b<32*a.length;b+=8)c+=String.fromCharCode(a[b>>5]>>>b%32&255);return c},m=function(a){var b,c=[];for(c[(a.length>>2)-1]=void 0,b=0;b<c.length;b+=1)c[b]=0;for(b=0;b<8*a.length;b+=8)c[b>>5]|=(255&a.charCodeAt(b/8))<<b%32;return c},n=function(a){return l(k(m(a),8*a.length))},o=function(a,b){var c,d,e=m(a),f=[],g=[];for(f[15]=g[15]=void 0,e.length>16&&(e=k(e,8*a.length)),c=0;c<16;c+=1)f[c]=909522486^e[c],g[c]=1549556828^e[c];return d=k(f.concat(m(b)),512+8*b.length),l(k(g.concat(d),640))},p=function(a){var b,c,d="0123456789abcdef",e="";for(c=0;c<a.length;c+=1)b=a.charCodeAt(c),e+=d.charAt(b>>>4&15)+d.charAt(15&b);return e},q=function(a){return unescape(encodeURIComponent(a))},r=function(a){return n(q(a))},s=function(a){return p(r(a))},t=function(a,b){return o(q(a),q(b))},u=function(a,b){return p(t(a,b))};return function(a,b,c){return b?c?t(b,a):u(b,a):c?r(a):s(a)}(a,b,c)}}),function(){var a=Fancy,b=a.GRID_CELL_CLS,c=a.GRID_CELL_EVEN_CLS,d=a.GRID_CELL_SELECTED_CLS,e=a.GRID_COLUMN_CLS,f=a.GRID_COLUMN_TEXT_CLS,g=a.GRID_COLUMN_ELLIPSIS_CLS,h=a.GRID_COLUMN_ORDER_CLS,i=a.GRID_COLUMN_SELECT_CLS,j=a.GRID_COLUMN_TREE_CLS,k=a.GRID_CELL_INNER_CLS,l=a.GRID_CELL_DIRTY_CLS,m=a.GRID_CELL_DIRTY_EL_CLS,n=a.GRID_PSEUDO_CELL_CLS,o=a.GRID_EMPTY_CLS,p=a.GRID_COLUMN_SPARKLINE_CLS,q=a.GRID_COLUMN_SPARKLINE_BULLET_CLS,r=a.GRID_COLUMN_CHART_CIRCLE_CLS,s=a.GRID_COLUMN_SPARK_PROGRESS_DONUT_CLS,t=a.GRID_COLUMN_GROSSLOSS_CLS,u=a.GRID_COLUMN_PROGRESS_CLS,v=a.GRID_COLUMN_PROGRESS_BAR_CLS,w=a.GRID_COLUMN_H_BAR_CLS,x=a.GRID_COLUMN_ROW_DRAG_CLS,y=a.GRID_ROW_DRAG_EL_CLS;a.ns("Fancy.grid.body.mixin"),a.grid.body.mixin.Updater=function(){},a.grid.body.mixin.Updater.prototype={update:function(a){var b,c=this,d=c.widget,e=d.store;switch(a){case"cell":case"cells":break;default:c.checkDomColumns()}if(!e.loading){switch(a){case"row":case"rows":b=e.changed;for(var f in b){var g=b[f],h=d.getRowById(f);for(var i in g)switch(i){case"length":break;default:c.updateRows(h)}}break;case"cell":case"cells":b=e.changed;for(var f in b){var g=b[f],h=d.getRowById(f);for(var i in g)switch(i){case"length":break;default:var j=d.getColumnOrderByKey(i);c.updateRows(h,j.order)}}break;default:c.checkDomCells(),c.updateRows()}c.showEmptyText()}},checkDomColumns:function(){var b=this,c=b.widget,d=b.el.select("."+e).length,k=b.getColumns(),l=0,m=k.length;if(!(m<=d)){for(;l<m;l++){var n=k[l],o=n.width,p=a.get(document.createElement("div"));if(n.hidden&&p.css("display","none"),p.addCls(e),p.attr("grid",c.id),p.attr("role","presentation"),"$selected"===n.index||n.select)p.addCls(i);else switch(n.type){case"order":p.addCls(h);break;case"rowdrag":p.addCls(x)}if("tree"===n.type&&(p.addCls(j),n.folder&&p.addCls("fancy-grid-tree-column-folder")),n.rowdrag&&p.addCls(x),n.cls&&p.addCls(n.cls),"text"===n.type&&p.addCls(f),p.css({width:o+"px"}),p.attr("index",l),n.cellAlign&&p.css("text-align",n.cellAlign),!0===n.ellipsis)switch(n.type){case"string":case"text":case"number":case"date":case"combo":case"tree":p.addCls(g)}b.el.dom.appendChild(p.dom)}b.fire("adddomcolumns")}},checkDomCells:function(f){var g,h,i=this,j=i.widget,k=j.body,l=j.store,m=0,o=l.dataView.length,p=0;switch(l.infinite&&(o=l.infiniteDisplayedRows)>l.dataView.length&&(o=l.dataView.length),i.side){case"left":h=j.leftColumns;break;case"center":h=j.columns;break;case"right":h=j.rightColumns}g=h.length;var q=i.el.select("."+e),r=l.getLength(),s=i.cellTpl;for(j.cellWrapper&&(s=i.cellWrapperTpl),void 0!==f&&(p=f,g=f);p<g;p++){var t=q.item(p),u=0;for(u=r-t.select("."+b).length,m=o-u;m<o;m++){var v=s.getHTML({}),w=a.get(document.createElement("div"));w.attr("role","gridcell"),w.css({height:j.cellHeight+"px"}),w.addCls(b),w.attr("index",m),m%2!=0&&j.striped&&w.addCls(c),w.update(v),t.dom.appendChild(w.dom),k.el.select("."+b+"."+d+'[index="'+m+'"]').length&&w.addCls(d)}if(j.nativeScroller&&("left"===i.side||"right"===i.side)){t.select("."+n).destroy();var v=s.getHTML({cellValue:"&nbsp;"}),w=a.get(document.createElement("div"));w.attr("role","gridcell"),w.css({height:j.cellHeight+"px"}),w.addCls(n),w.update(v),t.dom.appendChild(w.dom)}}},updateRows:function(a,b){var c,d,e=this,f=e.widget,g=0;switch(void 0===a?e.clearDirty():e.clearDirty(a),e.side){case"left":c=f.leftColumns;break;case"center":c=f.columns;break;case"right":c=f.rightColumns}if(d=c.length,!(void 0!==b&&(g=b,(d=b+1)>c.length))){for(;g<d;g++){var h=c[g];switch(h.type){case"string":case"number":case"combo":case"action":case"text":case"date":case"currency":e.renderUniversal(g,a);break;case"tree":e.renderTree(g,a);break;case"order":e.renderOrder(g,a);break;case"expand":e.renderExpand(g,a);break;case"select":e.renderSelect(g,a);break;case"color":e.renderColor(g,a);break;case"checkbox":e.renderCheckbox(g,a);break;case"switcher":e.renderCheckbox(g,a,!0);break;case"image":e.renderImage(g,a);break;case"sparklineline":e.renderSparkLine(g,a,"line");break;case"sparklinebar":e.renderSparkLine(g,a,"bar");break;case"sparklinetristate":e.renderSparkLine(g,a,"tristate");break;case"sparklinediscrete":e.renderSparkLine(g,a,"discrete");break;case"sparklinebullet":e.renderSparkLine(g,a,"bullet");break;case"sparklinepie":e.renderSparkLine(g,a,"pie");break;case"sparklinebox":e.renderSparkLine(g,a,"box");break;case"circle":e.renderCircle(g,a);break;case"progressdonut":e.renderProgressDonut(g,a);break;case"progressbar":e.renderProgressBar(g,a);break;case"hbar":e.renderHBar(g,a);break;case"grossloss":e.renderGrossLoss(g,a);break;case"rowdrag":e.renderRowDrag(g,a);break;default:throw new Error("[FancyGrid error] - not existed column type "+h.type)}h.select&&e.renderSelect(g,a,!0),h.rowdrag&&e.renderRowDrag(g,a,!0)}e.removeNotUsedCells()}},renderUniversal:function(a,c){var d,f,g,h=this,i=h.widget,j=i.lang,l=i.emptyValue,m=i.store,n=h.getColumns(),o=n[a],p=h.el.select("."+e),q=p.item(a),r=q.select("."+b),s=q.select("."+b+" ."+k),t=j.currencySign,u=!1;o.select&&(u=!0),o.rowdrag&&(u=!0),d=void 0!==o.index?o.index:"action"===o.type?"none":void 0,void 0!==c?(f=c,g=c+1):(f=0,g=m.getLength());var v=0;if(i.infinite){v=m.infiniteScrolledToRow;var w=i.getNumOfVisibleCells();g>w&&(g=w)}for(;f<g;f++){if(i.infinite){var x=m.dataView[f+v],y=r.item(f);if(void 0===x){i.el.select("."+b+'[index="'+f+'"]').css("visibility","hidden");break}if("hidden"===y.css("visibility")){i.el.select("."+b+'[index="'+f+'"]').css("visibility","");break}}var z,A=m.get(f),B=m.getId(f+v),C=s.item(f),y=r.item(f),D={rowIndex:f,data:A,style:{},column:o,id:B,item:m.getItem(f+v),inner:C,cell:y},E=!1;switch(m.changed[D.id]&&m.changed[D.id][o.index]&&(E=!0),z=o.smartIndexFn?o.smartIndexFn(A):m.get(f+v,d),D.value=z,o.format&&(D.value=h.format(D.value,o.format),z=D.value),o.type){case"currency":""!==z&&(z=t+z),D.value=z}switch(o.render&&(D=o.render(D),z=D.value),z){case"":case void 0:z=l}if(i.cellStylingCls&&h.clearCls(y),D.cls&&y.addCls(D.cls),E&&i.dirtyEnabled&&h.enableCellDirty(y),y.css(D.style),u){var F=[];o.rowdrag&&F.push('<div class="fancy-grid-cell-inner-rowdrag"></div>'),o.select?F.push('<div class="fancy-grid-cell-inner-select"></div>'):o.rowdrag&&F.push('<div class="fancy-grid-cell-inner-rowdrag-fix"></div>');var G=C.select(".fancy-grid-cell-inner-text");G.length?G.update(z):(F.push('<div class="fancy-grid-cell-inner-text">'+z+"</div>"),C.update(F.join(" ")))}else D.column.widget||C.update(z);if(D.column.autoHeight){y.css("height","");var H=parseInt(y.css("height"))+4;H<i.cellHeight&&(H=i.cellHeight),i.rowheight.add(B,H)}}},renderOrder:function(a){var c=this,d=c.widget,f=d.store,g=c.getColumns(),h=g[a],i=c.el.select("."+e),j=i.item(a),l=j.select("."+b),m=j.select("."+b+" ."+k),n=0,o=f.getLength(),p=0;if(d.paging&&(p+=f.showPage*f.pageSize),d.infinite){var q=d.getNumOfVisibleCells();o>q&&(o=q),p=f.infiniteScrolledToRow}for(;n<o;n++){var r=f.get(n),s=f.getId(n),t={rowIndex:n,data:r,style:{},column:h,id:s,item:f.getItem(n)},u=n+1+p;t.value=u,h.render&&(t=h.render(t),u=t.value);var v=l.item(n);d.cellStylingCls&&c.clearCls(v),t.cls&&v.addCls(t.cls),v.css(t.style),m.item(n).update(u)}},renderRowDrag:function(a,c,d){var f=this,g=f.widget,h=g.store,i=f.getColumns(),j=i[a],l=f.el.select("."+e),m=l.item(a),n=m.select("."+b),o=m.select("."+b+" ."+k),p=0,q=h.getLength();if(g.infinite){var r=g.getNumOfVisibleCells();q>r&&(q=r)}for(;p<q;p++){var s=h.get(p),t=h.getId(p),u={rowIndex:p,data:s,style:{},column:j,id:t,item:h.getItem(p)},v='<svg class="'+y+'" style="opacity: 0;" viewBox="0 0 6 14"><path fill-rule="evenodd" clip-rule="evenodd" d="M0 2h2V0H0v2zm0 4h2V4H0v2zm0 3.999h2V8H0v1.999zM0 14h2v-2H0v2zM4 0v2h2V0H4zm0 6h2V4H4v2zm0 3.999h2V8H4v1.999zM4 14h2v-2H4v2z"></path></svg>';u.value=v;var w=n.item(p);if(g.cellStylingCls&&f.clearCls(w),u.cls&&w.addCls(u.cls),w.css(u.style),d){o.item(p).select(".fancy-grid-cell-inner-rowdrag").item(0).update(v)}else o.item(p).update(v)}},renderTree:function(a,c){var d,f,g=this,h=g.widget,i=h.store,j=g.getColumns(),l=j[a],m=g.el.select("."+e),n=m.item(a),o=n.select("."+b+" ."+k),p=l.index;if(void 0!==c?(d=c,f=c+1):(d=0,f=i.getLength()),h.infinite){var q=h.getNumOfVisibleCells();f>q&&(f=q)}for(;d<f;d++){var r=o.item(d),s=h.get(d),t=s.get(p),u=Number(s.get("$deep"))-1,v="fancy-grid-tree-expander";s.get("leaf")&&(v="fancy-grid-tree-expander-leaf"),s.get("expanded")&&(v+=" fancy-grid-tree-expander-expanded");var w=15*u,x="";if(l.render){var y=l.render({item:s,data:s.data,deep:u,leaf:s.get("leaf"),rowIndex:c,column:l,value:t});y.nodeImgCls&&(x='<span class="fancy-grid-tree-expander-node '+y.nodeImgCls+'"></span>'),void 0!==y.value&&(t=y.value)}if(l.folder){var z=s.get("leaf"),A=s.get("expanded");x=z?'<span class="fancy-grid-tree-folder-file"></span>':A?'<span class="fancy-grid-tree-folder-opened"></span>':'<span class="fancy-grid-tree-folder-closed"></span>'}s.get("leaf")&&(w-=8);var B=[];B.push('<span class="'+v+'" style="margin-left: '+w+'px;"></span>'),l.select&&B.push('<span class="fancy-grid-cell-inner-select" style="margin-left: 6px;"></span>'),B.push(x),B.push('<span class="fancy-grid-tree-expander-text">'+t+"</span>"),r.update(B.join(""))}},renderExpand:function(c,d){var f,g,h=this,i=h.widget,j=i.store,l=h.getColumns(),m=l[c],n=h.el.select("."+e),o=n.item(c),p=o.select("."+b+" ."+k);if(void 0!==d?(f=d,g=d+1):(f=0,g=j.getLength()),i.infinite){var q=i.getNumOfVisibleCells();g>q&&(g=q)}for(;f<g;f++){var r,s=p.item(f),t=s.select(".fancy-field-checkbox"),u=0!==t.length,v=i.get(f),w=v.id;!1===u?(p.item(f).update(""),t=new a.CheckBox({renderTo:p.item(f).dom,renderId:!0,value:!1,label:!1,expander:!0,style:{padding:"0px",display:"inline-block"},events:[{change:function(a,b){d=a.el.parent().parent().attr("index"),b?i.expander.expand(d):i.expander.collapse(d)}}]})):(r=t.dom.id,t=a.getWidget(r),i.expander._expandedIds[w]?t.set(!0,!1):t.set(!1,!1));var x=j.get(f),y=j.getId(f),z={rowIndex:f,data:x,style:{},column:m,id:y,item:j.getItem(f)};m.render&&(!0===m.render(z).hidden?t.hide():t.show())}},clearCls:function(b){var c=this.widget;a.each(c.cellStylingCls,function(a){b.removeCls(a)})},renderColor:function(a,c){var d,f,g=this,h=g.widget,i=h.store,j=g.getColumns(),l=j[a],m=l.index,n=g.el.select("."+e),o=n.item(a),p=o.select("."+b);if(void 0!==c?(d=c,f=c+1):(d=0,f=i.getLength()),h.infinite){var q=h.getNumOfVisibleCells();f>q&&(f=q)}for(;d<f;d++){var r,s=i.get(d),t={rowIndex:d,data:s,style:{},column:l};r=l.smartIndexFn?l.smartIndexFn(s):i.get(d,m),l.render&&(t=l.render(t),r=t.value),t.value=r;var u=p.item(d);u.css(t.style);u.select("."+k).update('<div class="fancy-grid-color-cell" style="background: '+r+';"></div>')}},renderCombo:function(a,c){var d,f,g=this,h=g.widget,i=h.store,j=g.getColumns(),l=j[a],m=l.index,n=g.el.select("."+e),o=n.item(a),p=o.select("."+b),q=o.select("."+b+" ."+k);for(void 0!==c?(d=c,f=c+1):(d=0,f=i.getLength());d<f;d++){var r=i.get(d,m),s={rowIndex:d,value:r,style:{}};l.render&&(s=l.render(s),r=s.value),p.item(d).css(s.style),q.item(d).update(r)}},renderCheckbox:function(c,d,f){var g,h,i=this,j=i.widget,l=j.store,m=i.getColumns(),n=m[c],o=n.index,p=i.el.select("."+e),q=p.item(c),r=q.select("."+b),s=q.select("."+b+" ."+k),t="CheckBox";if(f&&(t="Switcher"),void 0!==d?(g=d,h=d+1):(g=0,h=l.getLength()),j.infinite){var u=j.getNumOfVisibleCells();h>u&&(h=u)}for(;g<h;g++){var v,w=l.get(g),x=l.get(g,o),y=s.item(g),z=r.item(g),A=y.select(".fancy-field-checkbox"),B=0!==A.length,C=!1,D=l.getId(g),E={rowIndex:g,data:w,style:{},column:n,id:D,item:l.getItem(g),value:x};if(l.changed[E.id]&&l.changed[E.id][n.index]&&(C=!0),n.render&&(E=n.render(E),x=E.value),!1===B)if(E.stopped)s.item(g).update(x);else{var F=!0;j.rowEdit&&(F=!1),s.item(g).update(""),new a[t]({renderTo:s.item(g).dom,renderId:!0,value:x,label:!1,editable:F,style:{padding:"0px",display:"inline-block"},events:[{beforechange:function(a){"$selected"===n.index||n.select||!0!==n.editable&&(a.canceledChange=!0)}},{change:function(a,b){"$selected"===n.index||n.select||(j.celledit.checkBoxChangedValue=b)}}]})}else v=A.dom.id,A=a.getWidget(v),E.stopped?(A.destroy(),s.item(g).update(x)):A.set(x,!1);if(j.cellStylingCls&&i.clearCls(z),E.cls&&z.addCls(E.cls),z.css(E.style),C&&j.dirtyEnabled){var z=r.item(g);i.enableCellDirty(z)}}},renderSelect:function(c,f,g){var h,i,j=this,l=j.widget,m=l.store,n=j.getColumns(),o=n[c],p=j.el.select("."+e),q=p.item(c),r=q.select("."+b+" ."+k);if(void 0!==f?(h=f,i=f+1):(h=0,i=m.getLength()),l.infinite){var s=l.getNumOfVisibleCells();i>s&&(i=s)}for(;h<i;h++){var t,u,v=!1,w=m.get(h,"id"),x=r.item(h),y=x.select(".fancy-field-checkbox"),z=0!==y.length,A=!0;if(l.selection.memory){if(l.selection.memory.all&&!l.selection.memory.excepted[w]?(v=!0,l.selection.domSelectRow(h)):l.selection.memory.has(w)?(v=!0,l.selection.domSelectRow(h)):(v=!1,l.selection.domDeSelectRow(h)),m.isTree){t=m.getItem(h);var B=t.get("$selected");if(B){var C=function(b){a.each(b,function(a){if(a.fields){if(!1===a.get("$selected"))return void l.selection.memory.remove(a.id);t.set("$selected",void 0),a.set("$selected",!0),l.selection.memory.add(a.id),a.data.child&&a.data.child[0]&&a.data.child[0].fields&&C(a.data.child)}})};C(t.data.child)}}}else x.parent().hasClass(d)&&(v=!0);if("select"===o.type||o.select)if(l.selection.disabled&&(A=!1),!1===z){var D=r.item(h);g?(D=D.select(".fancy-grid-cell-inner-select").item(0).dom,Fancy.isBoolean(v)||(v=!1)):(r.item(h).update(""),D=D.dom);var E={renderTo:D,renderId:!0,value:v,label:!1,stopIfCTRL:!0,editable:A,disabled:!A,style:{padding:"0px",display:"inline-block"},events:[{beforechange:function(a){l.selection.stopOneTick&&(a.canceledChange=!0)}}]},y=new a.CheckBox(E);if(m.isTree&&l.selection.memory&&l.selection.memory.tree.selected[w]&&!l.selection.memory.tree.allSelected[w]&&t){var F=t.get("child");F&&F.length&&y.setMiddle(!0)}}else u=y.dom.id,y=a.getWidget(u),y.set(v,!1)}},renderImage:function(a,c){var d,f,g=this,h=g.widget,i=h.store,j=g.getColumns(),l=j[a],m=l.index,n=g.el.select("."+e),o=n.item(a),p=o.select("."+b),q=o.select("."+b+" ."+k);if(void 0!==c?(d=c,f=c+1):(d=0,f=i.getLength()),h.infinite){var r=h.getNumOfVisibleCells();f>r&&(f=r)}for(;d<f;d++){var s=i.get(d,m),t=i.get(d),u={rowIndex:d,value:s,data:t,style:{}},v="";if(l.render&&(u=l.render(u),s=u.value),u.attr)for(var w in u.attr)v+=w+'="'+u.attr[w]+'"';s="<img "+v+' src="'+u.value+'">',p.item(d).css(u.style),q.item(d).update(s)}},renderSparkLine:function(c,d,f){var g,h,i=this,j=i.widget,l=j.cellHeight,m=j.store,n=i.getColumns(),o=n[c],r=o.width,s=o.index,t=i.el.select("."+e),u=t.item(c),v=u.select("."+b),w=u.select("."+b+" ."+k),x=o.sparkConfig||{};u.addCls(p),void 0!==d?(g=d,h=d+1):(g=0,h=m.getLength());var y,z=l-1,A=r-20;switch(f){case"line":case"pie":case"box":y="width";break;case"bullet":y="width",z-=11,u.addCls(q);break;case"discrete":y="width",A=r,z-=2;break;case"bar":case"tristate":y="barWidth"}if(j.infinite){var B=j.getNumOfVisibleCells();h>B&&(h=B)}for(;g<h;g++){var C=m.get(g,s),D=m.get(g),E={rowIndex:g,value:C,data:D,style:{}};if(o.render&&(E=o.render(E),C=E.value),a.isArray(o.values)){var F=0,G=o.values.length;for(C=[];F<G;F++)C.push(m.get(g,o.values[F]))}v.item(g).css(E.style);var H=w.item(g).dom,I={type:f,fillColor:"transparent",height:z};a.apply(I,x),"bar"!==f&&"tristate"!==f||(A=r-20,A/=C.length),I[y]=A,a.$(H).sparkline(C,I)}},renderProgressDonut:function(c,d){var f,g,h=this,i=h.widget,j=i.store,l=h.getColumns(),m=l[c],n=m.index,o=h.el.select("."+e),p=o.item(c),q=p.select("."+b),r=p.select("."+b+" ."+k);if(p.addCls(s),void 0!==d?(f=d,g=d+1):(f=0,g=j.getLength()),i.infinite){var t=i.getNumOfVisibleCells();g>t&&(g=t)}for(;f<g;f++){var u,v=j.get(f),w={rowIndex:f,data:v,style:{},column:m};u=m.smartIndexFn?m.smartIndexFn(v):j.get(f,n),w.value=u,m.format&&(w.value=h.format(w.value,m.format),u=w.value),m.render&&(w=m.render(w),u=w.value),q.item(f).css(w.style);var x=m.sparkConfig||{},y=r.item(f).dom;a.apply(x,{renderTo:y,value:u}),x.size||x.height||x.width||(x.size=i.cellHeaderHeight-6),a.get(y).update(""),new a.spark.ProgressDonut(x)}},renderGrossLoss:function(c,d){var f,g,h=this,i=h.widget,j=i.store,l=h.getColumns(),m=l[c],n=m.index,o=h.el.select("."+e),p=o.item(c),q=p.select("."+b),r=p.select("."+b+" ."+k);p.addCls(t),void 0!==d?(f=d,g=d+1):(f=0,g=j.getLength());var s=m.sparkConfig||{};if(s.showOnMax&&(s.maxValue=Math.max.apply(Math,j.getColumnData(n,m.smartIndexFn))),i.infinite){var u=i.getNumOfVisibleCells();g>u&&(g=u)}for(;f<g;f++){var v,w=j.get(f),x={rowIndex:f,data:w,style:{},column:m};v=m.smartIndexFn?m.smartIndexFn(w):j.get(f,n),x.value=v,m.format&&(x.value=h.format(x.value,m.format),v=x.value),m.render&&(x=m.render(x),v=x.value),q.item(f).css(x.style),a.apply(s,{renderTo:r.item(f).dom,value:v,column:m}),new a.spark.GrossLoss(s)}},renderProgressBar:function(c,d){var f,g,h=this,i=h.widget,j=i.store,l=h.getColumns(),m=l[c],n=m.index,o=h.el.select("."+e),p=o.item(c),q=p.select("."+b),r=p.select("."+b+" ."+k),s=100;p.addCls(u),void 0!==d?(f=d,g=d+1):(f=0,g=j.getLength());var t=m.sparkConfig||{};if(!1===t.percents&&(s=Math.max.apply(Math,j.getColumnData(n))),i.infinite){var w=i.getNumOfVisibleCells();g>w&&(g=w)}for(;f<g;f++){var x,y=j.get(f),z={rowIndex:f,data:y,style:{},column:m};x=m.smartIndexFn?m.smartIndexFn(y):j.get(f,n),z.value=x,m.format&&(z.value=h.format(z.value,m.format),x=z.value),m.render&&(z=m.render(z),x=z.value),q.item(f).css(z.style);var A=a.get(r.item(f).dom);if(A.select("."+v).length){var B=a.getWidget(A.select("."+v).item(0).attr("id"));B.value=x,B.maxValue=s,B.update()}else a.apply(t,{renderTo:r.item(f).dom,value:x,column:m,maxValue:s}),new a.spark.ProgressBar(t)}},renderHBar:function(c,d){var f,g,h=this,i=h.widget,j=i.store,l=h.getColumns(),m=l[c],n=m.index,o=h.el.select("."+e),p=o.item(c),q=p.select("."+b),r=p.select("."+b+" ."+k),s=m.sparkConfig||{},t=m.disabled||{};p.addCls(w);var u,v,x={},c=0,y=Number.MIN_VALUE;if(a.isArray(m.index))for(u=m.index.length;c<u;c++){var z=m.index[c];if(!t[z]){x[z]=j.getColumnData(z);var A=Math.max.apply(Math,x[z]);A>y&&(y=A),v=x[z].length}}else{var B=j.getColumnData(m.index),C=[];for(u=B.length;c<u;c++)for(var D=0,E=B[c].length;D<E;D++)t[D]||(x[D]=x[D]||[],x[D].push(B[c][D]));for(var F in x){var A=Math.max.apply(Math,x[F]);C.push(F),A>y&&(y=A),v=x[F].length}m.fields||(m.fields=C)}for(var G=[],H=0;H<v;H++){G[H]=0;for(var F in x)m.fields&&t[m.index+"."+F]||t[F]||(G[H]+=x[F][H])}var I=Math.max.apply(Math,G);if(s.maxItemValue=y,void 0!==d?(f=d,g=d+1):(f=0,g=j.getLength()),i.infinite){var J=i.getNumOfVisibleCells();g>J&&(g=J)}for(;f<g;f++){var K,B=j.get(f),L={rowIndex:f,data:B,style:{},column:m};K=m.smartIndexFn?m.smartIndexFn(B):j.get(f,n),L.value=K,m.format&&(L.value=h.format(L.value,m.format),K=L.value),m.render&&(L=m.render(L),K=L.value),q.item(f).css(L.style);var M=a.get(r.item(f).dom);if(M.select(".fancy-spark-hbar").length){var N=a.getWidget(M.select(".fancy-spark-hbar").item(0).attr("id"));N.maxValue=I,N.maxItemValue=y,N.update(B)}else a.apply(s,{renderTo:r.item(f).dom,value:K,data:B,column:m,maxValue:I,height:i.cellHeight-1}),new a.spark.HBar(s)}},renderCircle:function(a,c){function d(a,b){var c="http://www.w3.org/2000/svg",d=document.createElementNS(c,"svg:svg");d.setAttribute("width",b),d.setAttribute("height",b),d.setAttribute("viewBox","0 0 "+b+" "+b);var e=document.createElementNS(c,"circle");e.setAttributeNS(null,"cx",b/2),e.setAttributeNS(null,"cy",b/2),e.setAttributeNS(null,"r",b/2);var f="#F0F0F0";b>50&&(f="F0F0F0"),a<0&&(f="#F9DDE0"),e.setAttributeNS(null,"fill",f),d.appendChild(e);var g=document.createElementNS(c,"path"),h=2*Math.PI/100,i=0,j=a*h-.001,k=b/2+b/2*Math.sin(i),l=b/2-b/2*Math.cos(i),m=b/2+b/2*Math.sin(j),n=b/2-b/2*Math.cos(j),o=0;j-i>Math.PI&&(o=1);var p="M "+b/2+","+b/2+" L "+k+","+l+" A "+b/2+","+b/2+" 0 "+o+" 1 "+m+","+n+" Z";g.setAttribute("d",p),a<0?g.setAttribute("fill","#EA7369"):g.setAttribute("fill","#44A4D3"),d.appendChild(g);var q=document.createElementNS(c,"circle");return q.setAttributeNS(null,"cx",b/2),q.setAttributeNS(null,"cy",b/2),q.setAttributeNS(null,"r",.25*b),q.setAttributeNS(null,"fill","#fff"),d.appendChild(q),d}var f,g,h=this,i=h.widget,j=i.store,l=h.getColumns(),m=l[a],n=m.index,o=h.el.select("."+e),p=o.item(a),q=p.select("."+b+" ."+k),s=i.cellHeight-4;if(p.addCls(r),void 0!==c?(f=c,g=c+1):(f=0,g=j.getLength()),i.infinite){var t=i.getNumOfVisibleCells();g>t&&(g=t)}for(;f<g;f++){var u,v=j.get(f),w={rowIndex:f,data:v,style:{}};u=m.smartIndexFn?m.smartIndexFn(v):j.get(f,n),w.value=u,m.render&&(w=m.render(w),u=w.value);var x=q.item(f).dom;""===x.innerHTML&&x.appendChild(d(u,s))}},removeNotUsedCells:function(){for(var a=this,c=a.widget,d=c.store,f=a.el.select("."+e),g=0,h=f.length;g<h;g++)for(var i=f.item(g),j=i.select("."+b),k=d.getLength(),l=j.length;k<l;k++)j.item(k).remove()},getFormat:function(b){var c=this,d=c.widget,e=d.lang;switch(b){case"number":return function(a){return a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,e.thousandSeparator)};case"date":return function(c){var d=a.Date.parse(c,e.date.read,b.mode);return c=a.Date.format(d,e.date.write,b.mode)}}switch(b.type){case"date":return function(c){if(!c||0===c.length)return"";var d=a.Date.parse(c,b.read,b.mode);return c=a.Date.format(d,b.write,void 0,b.mode)}}},format:function(b,c){switch(a.typeOf(c)){case"string":b=this.getFormat(c)(b);break;case"function":b=c(b);break;case"object":var d=this.getFormat(c);d&&(b=d(b))}return b},enableCellDirty:function(a){a.hasCls(l)||(a.addCls(l),a.append('<div class="'+m+'"></div>'))},clearDirty:function(a){var c=this;if(void 0!==a)return c.el.select("."+b+'[index="'+a+'"] .'+m).destroy(),void c.el.select("."+l+'[index="'+a+'"]').removeCls(l);c.el.select("."+m).destroy(),c.el.select("."+l).removeCls(l)},showEmptyText:function(){var b=this,c=b.widget,d=c.store;if("center"===b.side&&(b.emptyTextEl&&(b.emptyTextEl.destroy(),delete b.emptyTextEl),0===d.dataView.length)){var e=a.get(document.createElement("div"));e.addCls(o),e.update(c.emptyText),b.emptyTextEl=a.get(b.el.dom.appendChild(e.dom))}}}}(),function(){var a=Fancy,b=a.GRID_CELL_CLS,c=a.GRID_CELL_INNER_CLS,d=a.GRID_COLUMN_CLS,e=a.GRID_BODY_CLS,f=a.GRID_CELL_WRAPPER_CLS,g=a.GRID_COLUMN_SELECT_CLS,h=a.GRID_COLUMN_ELLIPSIS_CLS,i=a.GRID_COLUMN_ORDER_CLS,j=a.GRID_COLUMN_TEXT_CLS,k=a.GRID_COLUMN_TREE_CLS,l=a.GRID_COLUMN_SPARKLINE_CLS,m=a.GRID_COLUMN_CHART_CIRCLE_CLS,n=a.GRID_COLUMN_SPARK_PROGRESS_DONUT_CLS,o=a.GRID_COLUMN_GROSSLOSS_CLS,p=a.GRID_COLUMN_PROGRESS_CLS,q=a.GRID_COLUMN_H_BAR_CLS,r=a.GRID_COLUMN_ROW_DRAG_CLS,s=a.ANIMATE_DURATION;a.define("Fancy.grid.Body",{extend:a.Widget,mixins:[a.grid.body.mixin.Updater],cls:e,cellTpl:['<div class="'+c+'">{cellValue}</div>'],cellWrapperTpl:['<div class="'+f+'">','<div class="'+c+'">{cellValue}</div>',"</div>"],constructor:function(){this.Super("const",arguments)},init:function(){var a=this;a.Super("init",arguments),a.addEvents("adddomcolumns"),a.initTpl(),a.render(),a.ons()},initTpl:function(){var b=this;b.cellTpl=new a.Template(b.cellTpl),b.cellWrapperTpl=new a.Template(b.cellWrapperTpl)},ons:function(){var a=this,c=a.widget,e=c.id;c.on("afterrender",a.onAfterRender,a);var f="."+d+'[grid="'+e+'"]',g=f+" div."+b;a.el.on("click",a.onCellClick,a,g),a.el.on("dblclick",a.onCellDblClick,a,g),a.el.on("mouseenter",a.onCellMouseEnter,a,g),a.el.on("mouseleave",a.onCellMouseLeave,a,g),a.el.on("mousedown",a.onCellMouseDown,a,g),a.el.on("mouseenter",a.onColumnMouseEnter,a,f),a.el.on("mouseleave",a.onColumnMouseLeave,a,f),a.el.on("contextmenu",a.onContextMenu,a,g)},render:function(){var b,c=this,d=c.widget,f=a.get(document.createElement("div"));f.addCls(e),f.attr("role","presentation"),b=d.el.select(".fancy-grid-"+c.side).dom,c.el=a.get(b.appendChild(f.dom))},onAfterRender:function(){this.update(),this.setHeight()},setColumnsPosition:function(b,c){var e=this,f=e.widget,g=e.getColumns(),h=0,i=g.length,j=0,k=e.el.select("."+d+'[grid="'+f.id+'"]'),b=b||e.scrollLeft||0;for(j+=b;h<i;h++){var l=g[h],m=k.item(h);c&&!a.nojQuery?m.animate({left:j+"px"},a.ANIMATE_DURATION):m.css({left:j+"px"}),l.hidden||(j+=l.width)}},wheelScroll:function(a){var b=this,c=b.widget,e=c.knobOffSet,f=b.el.select("."+d+'[grid="'+c.id+'"]');if(0!==f.length){var g=parseInt(f.item(0).css("top")),h=0,i=f.length,j=c.getBodyHeight(),k=c.getCellsViewHeight(),l=k-j+e,m={oldScroll:parseInt(f.item(0).css("top")),newScroll:parseInt(f.item(0).css("top"))+30*a,deltaScroll:30*a};for(l<0&&(l=0);h<i;h++){var n=f.item(h),o=parseInt(n.css("top"))+30*a;o>0?(o=0,m.newScroll=0):Math.abs(o)>l&&(o=-l-e,m.newScroll=o),o>0&&(o=0),n.css("top",o+"px")}return m.scrolled=g!==parseInt(f.item(0).css("top")),m}},scroll:function(a,b,c){var e=this,f=e.widget,g=f.scroller,h=f.store,i=e.el.select("."+d+'[grid="'+f.id+'"]'),j=0,k=i.length,l={};if(!1!==a&&null!==a&&void 0!==a)if(l.scrollTop=a,f.infinite){if(g.scrollTop!==a){var m=Math.round(a/f.cellHeight);if(h.infiniteScrolledToRow!==m){if(h.infiniteScrolledToRow=m,e.infiniteTimeOut){var n=new Date-e.infiniteTimeOutDate;n<100&&clearInterval(e.infiniteTimeOut)}else e.infiniteTimeOutDate=new Date;e.infiniteTimeOut=setTimeout(function(){f.leftBody.update(),f.body.update(),f.rightBody.update(),clearInterval(e.infiniteTimeOut),delete e.infiniteTimeOut,delete e.infiniteTimeOutDate},1)}}}else for(;j<k;j++){var o=i.item(j);o.css("top",-a+"px")}return!1!==b&&null!==b&&void 0!==b&&(l.scrollLeft=b,f.header&&f.header.scroll(b,c),e.scrollLeft=b,f.body.setColumnsPosition(b,c),"center"===e.side&&(f.grouping&&f.grouping.scrollLeft(b),f.summary&&f.summary.scrollLeft(b))),l},setHeight:function(){var a=this.widget.getBodyHeight();this.css("height",a+"px")},onCellClick:function(a){var b=this,c=b.widget;c.fire("cellclick",b.getEventParams(a)),c.fire("rowclick",b.getEventParams(a)),c.fire("columnclick",b.getColumnEventParams(a)),!1===c.activated&&(c.activated=!0,c.fire("activate"))},onCellDblClick:function(a){var b=this,c=b.widget;c.fire("celldblclick",b.getEventParams(a)),c.fire("rowdblclick",b.getEventParams(a)),c.fire("columndblclick",b.getColumnEventParams(a))},getEventParams:function(b){var c=this,d=c.widget,e=d.store,f=c.getColumns(),g=b.currentTarget,h=a.get(b.currentTarget),i=h.parent();if(void 0===h.parent().dom)return!1;if(0===e.getLength())return!1;if(void 0===i.attr("index"))return!1;var j=e.infiniteScrolledToRow||0,k=parseInt(i.attr("index")),l=parseInt(h.attr("index")),m=f[k],n=m.index,o=e.get(l+j,n),p=e.getId(l+j),q=e.get(l+j),r=e.getById(p);return m.smartIndexFn&&(o=m.smartIndexFn(q)),{e:b,id:p,side:c.side,cell:g,column:m,rowIndex:l,infiniteRowIndex:l+j,columnIndex:k,value:o,data:q,item:r}},getColumnEventParams:function(b){var c=this,d=c.widget,e=d.store,f=a.get(b.currentTarget),g=f.parent(),h=parseInt(g.attr("index")),i=c.getColumns(),j=i[h],k={e:b,side:c.side,columnIndex:h,column:j,columnDom:g.dom,cell:f.dom};return d.columnClickData&&(k.data=e.getColumnData(j.index,j.smartIndexFn)),k},getColumnHoverEventParams:function(b){var c=this,d=a.get(b.currentTarget),e=parseInt(d.attr("index")),f=c.getColumns(),g=f[e];return{e:b,side:c.side,columnIndex:e,column:g,columnDom:d.dom,cell:b.target}},getColumns:function(){return this.widget.getColumns(this.side)},onCellMouseEnter:function(b){var c=this,d=c.widget,e=c.getEventParams(b),f=c.prevCellOver;a.nojQuery&&f&&c.fixZeptoBug&&(e.rowIndex===f.rowIndex&&e.columnIndex===f.columnIndex&&e.side===f.side||(d.fire("cellleave",f),e.rowIndex!==f.rowIndex&&d.fire("rowleave",f))),f?e.rowIndex!==c.prevCellOver.rowIndex&&d.fire("rowenter",e):d.fire("rowenter",e),d.fire("cellenter",e),c.prevCellOver=e},onCellMouseDown:function(b){var c=this,d=c.widget,e=c.getEventParams(b),f={e:e.e,side:e.side,columnDom:a.get(e.cell).parent().dom,column:e.column,columnIndex:e.columnIndex,cell:e.cell};2===b.button&&2===b.buttons||3===b.which||(d.fire("beforecellmousedown",e),d.fire("cellmousedown",e),d.fire("columnmousedown",f),!1===d.activated&&(d.activated=!0,d.fire("activate")))},onCellMouseLeave:function(b){var c=this,d=c.widget,e=c.getEventParams(b),f=c.prevCellOver;if(a.nojQuery){if(void 0===f)return;return void(c.fixZeptoBug=e)}d.fire("rowleave",f),d.fire("cellleave",f),delete c.prevCellOver},onColumnMouseEnter:function(a){var b=this,c=b.widget,d=b.getColumnHoverEventParams(a);b.prevColumnOver?b.prevCellOver&&d.rowIndex!==b.prevCellOver.rowIndex&&c.fire("rowenter",d):c.fire("columnenter",d),b.prevColumnOver=d},onColumnMouseLeave:function(a){var b=this;b.widget.fire("columnleave",b.prevColumnOver),delete b.prevColumnOver},getCell:function(a,c){var e=this,f=e.widget;return this.el.select("."+d+'[index="'+c+'"][grid="'+f.id+'"] .'+b+'[index="'+a+'"]')},getDomCell:function(a,c){var e=this,f=e.widget;return e.el.select("."+d+'[index="'+c+'"][grid="'+f.id+'"] .'+b+'[index="'+a+'"]').dom},getDomColumn:function(a){var b=this,c=b.widget;return b.el.select("."+d+'[index="'+a+'"][grid="'+c.id+'"]').dom},destroy:function(){var a=this,c=a.el,e="div."+b,f="div."+d;c.un("click",a.onCellClick,a,e),c.un("dblclick",a.onCellDblClick,a,e),c.un("mouseenter",a.onCellMouseEnter,a,e),c.un("mouseleave",a.onCellMouseLeave,a,e),c.un("mousedown",a.onCellMouseDown,a,e),c.un("mouseenter",a.onColumnMouseEnter,a,f),c.un("mouseleave",a.onColumnMouseLeave,a,f)},hideColumn:function(a){var b=this,c=b.widget,e=b.getColumns(),f=b.el.select("."+d),g=f.item(a),h=0,i=e.length,j=0,k=0;for("center"===b.side&&(k=c.scroller.scrollLeft,j-=k),g.hide();h<i;h++){var l=e[h],g=f.item(h),m=parseInt(g.css("left"));l.hidden||(m!==j&&(g.stop(),g.animate({left:j},s)),j+=l.width)}},showColumn:function(a){var b=this,c=b.widget,e=b.getColumns(),f=b.el.select("."+d),g=f.item(a),h=0,i=0,j=e.length,k=0;for("center"===b.side&&(k=c.scroller.scrollLeft,h-=k),g.show();i<j;i++){var g=f.item(i),l=(parseInt(g.css("left")),e[i]);l.hidden||(g.stop(),g.animate({left:h},s),h+=l.width)}},removeColumn:function(a){var b=this,c=b.el.select("."+d),e=c.item(a),f=parseInt(e.css("width")),g=a+1,h=c.length;for(e.destroy();g<h;g++){var i=c.item(g),j=parseInt(i.css("left"))-f;i.attr("index",g-1),i.css("left",j)}},insertColumn:function(b,c){var e,f=this,l=f.widget,m=f.getColumns(),n=f.el.select("."+d),o=c.width,p=a.get(document.createElement("div")),q=b,s=n.length,t=0,u=0,v=b;for("center"===f.side&&(t=-l.scroller.scrollLeft);u<v;u++)m[u].hidden||(t+=m[u].width);for(e=t;q<s;q++)if(!m[q].hidden){var w=n.item(q);t=parseInt(w.css("left"))+c.width,w.css("left",t),w.attr("index",q+1)}if(p.attr("role","presentation"),p.addCls(d),p.attr("grid",l.id),"$selected"===c.index||c.select)p.addCls(g);else switch(c.type){case"order":p.addCls(i);break;case"rowdrag":p.addCls(r)}if(c.cls&&p.addCls(c.cls),"tree"===c.type&&(p.addCls(k),c.folder&&p.addCls("fancy-grid-tree-column-folder")),"text"===c.type&&p.addCls(j),p.css({width:o+"px"}),p.attr("index",b),c.cellAlign&&p.css("text-align",c.cellAlign),!0===c.ellipsis)switch(c.type){case"string":case"text":case"number":case"date":case"combo":case"tree":p.addCls(h)}var x=l.scroller.getScroll();p.css("top",-x),0===b&&n.length?(p.css("left","0px"),f.el.dom.insertBefore(p.dom,n.item(b).dom)):0!==b&&n.length?b===n.length?(p.css("left",t+"px"),f.el.dom.appendChild(p.dom)):(p.css("left",e+"px"),f.el.dom.insertBefore(p.dom,n.item(b).dom)):(p.css("left",t+"px"),f.el.dom.appendChild(p.dom)),f.checkDomCells(),f.updateRows(void 0,b)},reSetIndexes:function(){this.el.select("."+d).each(function(a,b){a.attr("index",b)})},clearColumnsStyles:function(){this.el.select("div."+b).each(function(a){a.css("color",""),a.css("background-color","")})},updateColumnsSizes:function(){var b=this,c=b.widget,e=b.getColumns(),f=0;"center"===b.side&&(f=-c.scroller.scrollLeft),a.each(e,function(a,c){if(!a.hidden){var e=b.el.select("."+d+'[index="'+c+'"]');Fancy.nojQuery?e.css({width:a.width,left:f}):(e.animate({width:a.width,left:f},s),e.css("overflow","")),f+=a.width}})},reSetColumnsAlign:function(){var a=this,b=a.getColumns();this.el.select("."+d).each(function(a,c){var d=b[c];a.css("text-align",d.cellAlign||"")})},reSetColumnsCls:function(){var b=this,c=b.getColumns();b.el.select("."+d).each(function(b,e){var f=c[e],j=b.attr("class").split(" ");switch(a.each(j,function(a){switch(a){case d:case f.cls:case t[f.type]:break;default:b.removeCls(a)}}),f.cls&&b.addCls(f.cls),f.ellipsis&&b.addCls(h),f.type){case"order":b.addCls(i);break;case"select":b.addCls(g);break;case"rowdrag":b.addCls(r);break;case"tree":b.addCls(k),f.folder&&b.addCls("fancy-grid-tree-column-folder")}f.select&&b.addCls(g),f.rowdrag&&b.addCls(r)})},onContextMenu:function(a){var b=this;b.widget.fire("contextmenu",b.getEventParams(a))},updateColumnsVisibility:function(){var a=this,b=a.getColumns();a.el.select("."+d).each(function(a,c){b[c].hidden?a.hide():"none"===a.css("display")&&a.show()})}});var t={sparklineline:l,sparklinebar:l,sparklinetristate:l,sparklinediscrete:l,sparklinebullet:l,sparklinepie:l,sparklinebox:l,circle:m,progressdonut:n,grossloss:o,progressbar:p,hbar:q}}(),function(){var a=Fancy,b=a.GRID_HEADER_COLUMN_TRIGGERED_CLS,c=a.GRID_HEADER_CELL_TRIGGER_UP_CLS,d=a.GRID_HEADER_CELL_TRIGGER_DOWN_CLS;a.Mixin("Fancy.grid.header.mixin.Menu",{triggeredColumnCls:b,triggerUpCls:c,triggerDownCls:d,showMenu:function(c,d,e,f){var g=this,h=g.widget,i=c.offset();if(e.menu&&e.menu.rendered&&"block"===e.menu.el.css("display"))return void g.hideMenu();g.hideMenu(),c.addCls(b),e.menu.rendered?!1!==e.menuColumns&&g.updateColumnsMenu(e,f):(e.menu=g.generateMenu(e,f),e.menu=new a.Menu({column:e,items:e.menu,theme:h.theme,events:[{hide:g.onMenuHide,scope:g}]})),e.menu.showAt(i.left+parseInt(c.css("width"))-26,i.top+parseInt(c.css("height"))-1),g.activeMenu=e.menu,g.activeCell=c},hideMenu:function(){var a=this,c=a.widget,d=c.header,e=c.rightHeader,f=c.leftHeader;switch(a.side){case"left":d.activeMenu&&(d.activeMenu.hide(),d.activeCell.removeCls(b),delete d.activeMenu,delete d.activeCell),e.activeMenu&&(e.activeMenu.hide(),e.activeCell.removeCls(b),delete e.activeMenu,delete e.activeCell);break;case"center":f.activeMenu&&(f.activeMenu.hide(),f.activeCell.removeCls(b),delete f.activeMenu,delete f.activeCell),e.activeMenu&&(e.activeMenu.hide(),e.activeCell.removeCls(b),delete e.activeMenu,delete e.activeCell);break;case"right":f.activeMenu&&(f.activeMenu.hide(),f.activeCell.removeCls(b),delete f.activeMenu,delete f.activeCell),d.activeMenu&&(d.activeMenu.hide(),d.activeCell.removeCls(b),delete d.activeMenu,delete d.activeCell)}a.activeMenu&&(a.activeMenu.hide(),a.activeCell.removeCls(b)),delete a.activeMenu,delete a.activeCell},generateMenu:function(b,e){for(var f,g=this,h=g.widget,i=h.lang,j=[],k=!1===b.sortable?"fancy-menu-item-disabled":"",l=b.sortable&&!1!==b.menuSortable,m=!1!==b.lockable&&!1!==b.menuLockable,n=!1!==b.menuColumns,o=0,p=e.length,q={text:i.sortAsc,cls:k,imageCls:c,handler:function(){h.sorter.sort("asc",b.index,g.side),b.menu.hide()}},r={text:i.sortDesc,cls:k,imageCls:d,handler:function(){h.sorter.sort("desc",b.index,g.side),b.menu.hide()}},s={text:i.columns,index:"columns",items:g.prepareColumns(e)};o<p;o++)if(b.index===e[o].index){f=o;break}if("columns"===b.menu)return j=s.items;if(Fancy.isArray(b.menu))a.each(b.menu,function(a){switch(a){case"|":j.push("-");break;case"sort":j.push(q),j.push(r);break;case"columns":j.push(s);break;case"lock":switch(g.side){case"left":case"right":j.push({text:i.unlock,handler:function(){b.menu.hide(),h.unLockColumn(f,g.side)}});break;case"center":j.push({text:i.lock,handler:function(){b.menu.hide(),h.lockColumn(f,g.side)}}),j.push({text:i.rightLock,handler:function(){b.menu.hide(),h.rightLockColumn(f,g.side)}})}break;default:j.push(a)}});else if(l&&(j.push(q),j.push(r),j.push("-")),n&&j.push(s),m)switch(g.side){case"left":case"right":!1!==b.menuColumns&&j.push("-"),j.push({text:i.unlock,handler:function(){b.menu.hide(),h.unLockColumn(f,g.side)}});break;case"center":!1!==b.menuColumns&&j.push("-"),j.push({text:i.lock,handler:function(){b.menu.hide(),h.lockColumn(f,g.side)}}),j.push({text:i.rightLock,handler:function(){b.menu.hide(),h.rightLockColumn(f,g.side)}})}return j},prepareColumns:function(a){for(var b,c=this,d=c.widget,e=[],f=0,g=a.length,h=[];f<g;f++){var i=!0,j=a[f];if(!1!==j.columnMenu){j.hidden&&(i=!1);var k={text:j.title,checked:i,index:j.index,handler:function(a,b){if(!0!==b.checked||b.checkbox.get()||b.checkbox.set(!0),b.checked&&1===a.el.select(".fancy-checkbox-on").length)return void b.checkbox.set(!0);b.checked=!b.checked,b.checkbox.set(b.checked),b.checked?d.showColumn(c.side,b.index):d.hideColumn(c.side,b.index),d.responsive&&d.onWindowResize()}};j.grouping?(h=h||[],h.push(k),b=j.grouping):(h.length&&(e.push({text:b,items:h}),b=void 0,h=[]),e.push(k))}}return h.length&&e.push({text:b,items:h}),e},onMenuHide:function(){this.el.select("."+b).removeCls(b)},updateColumnsMenu:function(a,b,c){for(var d,e,f=this,g=a.menu,h=0,i=g.items.length;h<i;h++)if(e=g.items[h],"columns"===e.index){d=e;break}if(d){h=0,i=d.items.length;for(var j=!1;h<i;h++){e=d.items[h];var k=b[h];e.checkbox&&(e.checkbox.set(!k.hidden,!1),j=!0)}j||c||(d.items=f.prepareColumns(b))}},destroyMenus:function(){for(var b,c=this,d=c.widget,e=d.getColumns(c.side),f=0,g=e.length;f<g;f++)b=e[f],a.isObject(b.menu)&&b.menu.destroy()}})}(),function(){var a=Fancy,b=a.GRID_HEADER_CLS,c=a.GRID_HEADER_CELL_CLS,d=a.GRID_HEADER_CELL_CONTAINER_CLS,e=a.GRID_HEADER_CELL_TEXT_CLS,f=a.GRID_HEADER_CELL_TRIGGER_CLS,g=a.GRID_HEADER_CELL_TRIGGER_IMAGE_CLS,h=a.GRID_HEADER_CELL_TRIGGER_DISABLED_CLS,i=a.GRID_HEADER_CELL_GROUP_LEVEL_1_CLS,j=a.GRID_HEADER_CELL_GROUP_LEVEL_2_CLS,k=a.GRID_HEADER_CELL_SELECT_CLS,l=a.GRID_HEADER_CELL_FILTER_FULL_CLS,m=a.GRID_HEADER_CELL_FILTER_SMALL_CLS,n=a.GRID_HEADER_CELL_TRIPLE_CLS,o=a.GRID_HEADER_CELL_CHECKBOX_CLS,p=a.GRID_HEADER_CELL_SORTABLE_CLS,q=a.GRID_HEADER_CELL_NOT_SORTABLE_CLS,r=a.FIELD_CHECKBOX_CLS,s=a.ANIMATE_DURATION;a.define("Fancy.grid.Header",{extend:a.Widget,cls:b,mixins:["Fancy.grid.header.mixin.Menu"],cellTpl:['<div role="columnheader" class="'+c+' {cls}" style="display:{display};width:{columnWidth}px;height: {height};left: {left};" {groupIndex} index="{index}">','<div class="'+d+'" style="height: {height};">','<span class="'+e+'">{columnName}</span>','<span class="'+f+'">','<div class="'+g+'"></div>',"</span>","</div>","</div>"],constructor:function(){this.Super("const",arguments)},init:function(){var a=this;a.Super("init",arguments),a.initTpl(),a.render(),a.renderHeaderCheckBox(),a.setAlign(),a.setCellsPosition(),a.ons()},initTpl:function(){this.cellTpl=new a.Template(this.cellTpl)},ons:function(){var a=this,b=a.widget,d=a.el,g="div."+c;b.on("render",a.onAfterRender,a),b.on("docmove",a.onDocMove,a),d.on("click",a.onTriggerClick,a,"span."+f),d.on("click",a.onCellClick,a,g),d.on("mousemove",a.onCellMouseMove,a,g),d.on("mousedown",a.onCellMouseDown,a,g),d.on("mousedown",a.onMouseDown,a),d.on("dblclick",a.onCellTextDBLClick,a,"."+e),d.on("mouseenter",a.onCellMouseEnter,a,g),d.on("mouseleave",a.onCellMouseLeave,a,g)},render:function(){var b,c=this,d=c.widget,e=c.getColumns(),f=a.get(document.createElement("div")),g="",j=0,n=e.length,o=1,r={},s=0,t=d.filter&&d.filter.header,u="full",v=d.cellHeaderHeight;for(d.groupheader&&(t&&!d.filter.groupHeader?u="small":o=2),t&&o++;j<n;j++){var w=e[j],x=w.title||w.header,y=v,z="",A="";if(1!==o&&(w.grouping?(r[w.grouping]||(r[w.grouping]={width:0,title:w.grouping,left:s}),y=t&&d.filter.groupHeader?2*v+"px":v+"px",w.hidden||(r[w.grouping].width+=w.width),A='group-index="'+w.grouping+'"',z=i):y=o*v+"px"),s+=w.width,("$selected"===w.index||w.select)&&(z+=" "+k),w.menu||(z+=" "+h),w.filter&&w.filter.header)switch(u){case"small":z+=" "+m;break;case"full":z+=" "+l}w.headerCls&&(z+=" "+w.headerCls),w.sortable?z+=" "+p:z+=" "+q,a.isNumber(y)&&(y+="px");var B={cls:z,columnName:x,columnWidth:w.width,index:j,height:y,left:"initial",groupIndex:A,display:w.hidden?"none":""};g+=c.cellTpl.getHTML(B)}f.css({height:v*o+"px",width:c.getColumnsWidth()}),f.attr("role","presentation"),f.addCls(c.cls),d.groupheader&&(f.addCls("fancy-grid-header-grouped"),g+=c.getGroupingCellsHTML(r)),f.update(g),b=d.el.select(".fancy-grid-"+c.side).dom,c.el=a.get(b.appendChild(f.dom))},insertCell:function(b,d){var e,f=this,g=f.widget,i=f.el.select("."+c+":not(."+j+")"),l=f.getColumns(),m="",n=d.title||d.header,o="",r=0;if(i.length)e=parseInt(i.item(0).css("height"));else{g.header.el.select("."+c+":not(."+j+")")}if(e=parseInt(g.header.el.css("height")),"center"===f.side&&(r=-g.scroller.scrollLeft),g.groupheader){var s=f.el.select("."+j);b!==g.columns.length-1&&s.each(function(a){var b=parseInt(a.css("left")||0)+d.width;a.css("left",b)})}("$selected"===d.index||d.select)&&(m+=" "+k),d.menu||(m+=" "+h);for(var t=0,u=b;t<u;t++)l[t].hidden||(r+=l[t].width);"center"===f.side&&(r+=g.scroller.scrollLeft||0),d.headerCls&&(m+=" "+d.headerCls),d.sortable?m+=" "+p:m+=" "+q;var v=f.cellTpl.getHTML({cls:m,columnName:n,columnWidth:d.width,index:b,height:String(e)+"px",left:String(r)+"px",groupIndex:o});0===b&&i.length?a.get(i.item(0).before(v)):0!==b&&i.length?b===i.length?f.el.append(v):a.get(i.item(b).before(v)):f.el.append(v);var w=0,x=l.length,y=0,r=0;for("center"===f.side&&(r-=g.scroller.scrollLeft),i=f.el.select("."+c+":not(."+j+")");w<x;w++){var d=l[w];if(!d.hidden){i.item(w).css("left",r),r+=d.width,y+=d.width}}var z=parseInt(f.css("width"));z>y&&(y=z),f.css("width",y)},setAlign:function(){for(var a=this,b=a.getColumns(),c=0,d=b.length;c<d;c++){var e=b[c];e.align&&a.getDomCell(c).css("text-align",e.align)}},onAfterRender:function(){},setCellsPosition:function(b){var d=this,e=d.widget,f=d.getColumns(),g=0,h=d.el.select("."+c);if(g+=d.scrollLeft||0,a.each(f,function(c,d){var f=h.item(d),i="0px";c.grouping&&(i=e.cellHeaderHeight+"px"),b&&!a.nojQuery?f.animate({top:i,left:g+"px"},a.ANIMATE_DURATION):f.css({top:i,left:g+"px"}),c.hidden||(g+=c.width)}),e.groupheader){d.el.select("."+j).each(function(c){var e=c.attr("index"),g=(d.el.select('[group-index="'+e+'"]'),d.scrollLeft||0),h=0;a.each(f,function(a){if(a.grouping===e)return!0;a.hidden||(g+=a.width)}),a.each(f,function(a){a.grouping!==e||a.hidden||(h+=a.width)}),b&&!a.nojQuery?c.animate({left:g,width:h},s):c.css({left:g,width:h})})}},fixGroupHeaderSizing:function(){var b=this,d=b.widget,e=d.cellHeaderHeight,f=b.getColumns(),g=b.el.select("."+c),h=0,k={},n={},o={},p=b.calcRows();"center"===b.side&&(h=d.scroller.scrollLeft),a.each(f,function(a,b){var c=g.item(b),f=a.grouping,j="0px",q=e*p;k[f]=!0,f?(void 0===n[f]?(n[f]=a.width,o[f]=h):n[f]+=a.width,c.addCls(i),j=e+"px",q=e,a.filter&&a.filter.header&&(q=2*e,setTimeout(function(){c.addCls(l)},30))):(c.removeCls(i),a.filter&&a.filter.header&&(setTimeout(function(){c.addCls(m)},30),c.addCls(m))),!d.groupheader||q!==e||f||a.filter||(q=2*e),c.css({top:j,height:q}),h+=a.width});for(var q in n){b.el.select('[index="'+q+'"]').css({left:o[q],width:n[q]})}b.el.select("."+j).each(function(a){var b=a.attr("index");k[b]||a.destroy()})},getColumnsWidth:function(){for(var a=this,b=a.getColumns(),c=0,d=0,e=b.length;d<e;d++){c+=b[d].width}return c},getColumns:function(){var a,b=this,c=b.widget;switch(b.side){case"left":a=c.leftColumns;break;case"center":a=c.columns;break;case"right":a=c.rightColumns}return a},getDomCell:function(a){return this.el.select("."+c).item(a)},onCellClick:function(b){var c=this,d=c.widget,e=d.columndrag,h=b.currentTarget,i=a.get(b.target),k=parseInt(a.get(h).attr("index")),l=c.getColumns(),m=l[k];e&&"dragging"===e.status||i.hasCls(f)||i.hasCls(g)||a.get(h).hasCls(j)||c.textDBLClick||(m.titleEditable?setTimeout(function(){c.textDBLClick?setTimeout(function(){delete c.textDBLClick},400):d.fire("headercellclick",{e:b,side:c.side,cell:h,index:k,column:m})},300):d.fire("headercellclick",{e:b,side:c.side,cell:h,index:k,column:m}))},onCellMouseMove:function(b){var c=this,d=c.widget,e=b.currentTarget,f=a.get(e),g=f.hasCls(j),h=parseInt(a.get(e).attr("index"));g||d.fire("headercellmousemove",{e:b,side:c.side,cell:e,index:h})},onMouseDown:function(b){"INPUT"===a.get(b.target).prop("tagName")||b.preventDefault()},onCellMouseDown:function(b){var c=this.widget,d=b.currentTarget,e=parseInt(a.get(d).attr("index"));c.fire("headercellmousedown",{e:b,side:this.side,cell:d,index:e})},scroll:function(a,b){this.scrollLeft=a,this.setCellsPosition(b)},getGroupingCellsHTML:function(b){var c=this,d=c.widget,e="";return a.each(b,function(a,b){e+=c.cellTpl.getHTML({cls:j,columnName:a.title,columnWidth:a.width,index:b,height:d.cellHeaderHeight+"px",left:a.left+"px",groupIndex:""})}),e},destroy:function(){var a=this,b=a.el,d="div."+c;b.un("click",a.onCellClick,a,d),b.un("mousemove",a.onCellMouseMove,a,d),b.un("mousedown",a.onCellMouseDown,a,d),b.un("mousedown",a.onMouseDown,a),b.un("mouseenter",a.onCellMouseEnter,a,d),b.un("mouseleave",a.onCellMouseLeave,a,d)},getCell:function(a){return this.el.select("."+c+'[index="'+a+'"]')},onTriggerClick:function(b){var c=this,d=a.get(b.currentTarget),e=d.parent().parent(),f=parseInt(e.attr("index")),g=c.getColumns(),h=g[f];b.stopPropagation(),c.showMenu(e,f,h,g)},hideCell:function(b){var d=this,e=d.widget,f=d.el.select("."+c+":not(."+j+")"),g=f.item(b),h=parseInt(g.css("width")),k=0,l=f.length,m=d.getColumns();if(g.hasCls(i)){var n=g.attr("group-index"),o=d.el.select("."+j+'[index="'+n+'"]').item(0),p=parseInt(o.css("width"));o.stop(),o.animate({width:p-h},s)}g.hide();var q={},r=0,t=0;for("center"===d.side&&(t=e.scroller.scrollLeft,r-=t);k<l;k++){var u=f.item(k),v=parseInt(u.css("left")),w=m[k];w.hidden||(w.grouping&&m[b].grouping!==w.grouping&&(q[w.grouping]=!0),v!==r&&(u.stop(),u.animate({left:r},s)),r+=w.width)}a.each(q,function(b,c){var f=d.el.select("."+j+'[index="'+c+'"]').item(0),g=0;"center"===d.side&&(t=e.scroller.scrollLeft,g-=t),a.each(m,function(a,b){if(!a.hidden)return a.grouping===c||void(g+=a.width)}),f.stop(),f.animate({left:g},s)})},showCell:function(b){var d,e=this,f=e.widget,g=e.el.select("."+c+":not(."+j+")"),h=g.item(b),k=0,l=0,m=g.length,n=e.getColumns();if(h.show(),d=parseInt(h.css("width")),h.hasCls(i)){var o=h.attr("group-index"),p=e.el.select("."+j+'[index="'+o+'"]').item(0),q=parseInt(p.css("width"));p.stop(),p.animate({width:q+d},s)}var r=0;"center"===e.side&&(r=f.scroller.scrollLeft,k-=r);for(var t={};l<m;l++){var u=g.item(l),v=(parseInt(u.css("left")),n[l]);v.hidden||(v.grouping&&n[b].grouping!==v.grouping&&(t[v.grouping]=!0),u.stop(),u.animate({left:k},s),k+=v.width)}a.each(t,function(b,c){var d=e.el.select("."+j+'[index="'+c+'"]').item(0),g=0;"center"===e.side&&(r=f.scroller.scrollLeft,g-=r),a.each(n,function(a){if(!a.hidden)return a.grouping===c||void(g+=a.width)}),d.stop(),d.animate({left:g},s)})},removeCell:function(a){var b=this,d=b.el.select("."+c+":not(."+j+")"),e=d.item(a),f=parseInt(e.css("width")),g=a+1,h=d.length,i={},k=!1;for(e.attr("group-index")&&(k=e.attr("group-index"),i[k]=!0),e.destroy();g<h;g++){var l=d.item(g),m=parseInt(l.css("left"))-f;l.attr("group-index")&&(i[l.attr("group-index")]=!0),l.attr("index",g-1),l.css("left",m)}for(var n in i){var o=b.el.select('[index="'+n+'"]'),p=parseInt(o.css("width"))-f,q=parseInt(o.css("left"))-f;k&&o?(o.css("width",p),o.attr("index")!==k&&o.css("left",q)):o.css("left",q)}if(k&&0===b.el.select('[group-index="'+k+'"]').length){var o=b.el.select('[index="'+k+'"]');o.destroy()}"center"!==b.side&&b.css("width",parseInt(b.css("width"))-f)},renderHeaderCheckBox:function(){for(var b=this,d=b.widget,f=b.getColumns(),g=0,h=f.length,i=b.el.select("."+c+":not(."+j+")");g<h;g++){var l=f[g];if(a.isObject(l.headerCheckBox)){var m=l.headerCheckBox.el,n=m.attr("id");m=a.get(n),m.dom||(l.headerCheckBox=!0)}if(!0===l.headerCheckBox&&"select"!==l.type){var p=i.item(g),q=p.firstChild(),r=p.select("."+e),s=!!l.title&&l.title,t=0;switch(l.type){case"checkbox":case"switcher":p.addCls(o);break;case"select":p.addCls(k)}r.update(""),s.length&&(t=15*s.width),l.headerCheckBox=new a.CheckBox({renderTo:q.dom,renderId:!0,labelWidth:t,value:!1,label:!1,labelAlign:"right",style:{padding:"0px",display:"inline-block"},events:[{change:function(a,b){for(var c=0,e=d.getViewTotal();c<e;c++)d.set(c,l.index,b)}}]})}}},reSetIndexes:function(){this.el.select("."+c+":not(."+j+")").each(function(a,b){a.attr("index",b)})},reSetGroupIndexes:function(){var a=this,b=a.getColumns();this.el.select("."+c+":not(."+j+")").each(function(a,c){var d=b[c],e=d.grouping;a.attr("group-index")&&!e?a.removeAttr("group-index"):e&&a.attr("group-index")!==e&&a.attr("group-index",e)})},updateTitles:function(){var b=this,d=b.getColumns();a.each(d,function(a,d){a.headerCheckBox||b.el.select("div."+c+'[index="'+d+'"] .'+e).update(a.title||"")})},updateCellsSizes:function(){var b=this,d=b.widget,e=b.getColumns(),f=0;"center"===b.side&&(f=d.nativeScroller?-d.body.el.dom.scrollLeft:-d.scroller.scrollLeft),a.each(e,function(a,d){if(!a.hidden){var e=b.el.select("div."+c+'[index="'+d+'"]'),g=parseInt(e.css("left")),h=parseInt(e.css("width"));if(g===f&&h===a.width)return void(f+=a.width);Fancy.nojQuery?e.css({width:a.width,left:f}):e.animate({width:a.width,left:f},s),f+=a.width}})},calcRows:function(){var a=this,b=a.widget,c=b.columns.concat(b.leftColumns).concat(b.rightColumns),d=1;if(Fancy.each(c,function(a){a.grouping&&(d<2&&(d=2),a.filter&&a.filter.header&&d<3&&(d=3)),a.filter&&a.filter.header&&d<2&&(d=2)}),b.groupheader&&2===d){b.el.select("."+n).length&&(d=3)}return d},reSetColumnsAlign:function(){var a=this,b=a.getColumns();this.el.select("."+c+":not(."+j+")").each(function(a,c){var d=b[c];a.css("text-align",d.align||"")})},destroyMenus:function(){},onDocMove:function(){var a=this,b=a.widget;("none"===b.el.css("display")||b.panel&&b.panel.el&&"none"===b.panel.el.css("display")&&a.hideMenu)&&a.hideMenu()},reSetColumnsCls:function(){var b=this,d=b.getColumns(),e=this.el.select("."+c+":not(."+j+")"),f=[];a.each(d,function(a){a.headerCls&&f.push(a.headerCls),a.sortable?f.push(p):f.push(q)}),e.each(function(b,c){var e=d[c];a.each(f,function(a){b.removeCls(a)}),e.headerCls&&b.addCls(e.headerCls),e.sortable?b.addCls(p):b.addCls(q),e.menu?b.removeCls(h):b.addCls(h)})},updateCellsVisibility:function(){var a=this,b=a.getColumns();this.el.select("."+c+":not(."+j+")").each(function(a,c){b[c].hidden?a.hide():"none"===a.css("display")&&a.show()})},reSetCheckBoxes:function(){var b=this,d=b.getColumns(),e=this.el.select("."+c+":not(."+j+")");a.each(d,function(b,c){var d=e.item(c),f=d.select("."+r);if(f.length){if("select"===b.type||b.select)return;var g=a.getWidget(f.item(0).attr("id"));switch(d.removeCls(o),d.removeCls(k),b.type){case"select":d.addCls(k);break;case"checkbox":d.addCls(o);break;default:b.headerCheckBox||g.destroy()}}}),b.renderHeaderCheckBox()},onCellTextDBLClick:function(a){var b=this,c=b.widget,d=Fancy.get(a.target),e=d.parent().parent(),f=e.attr("index"),g=b.getColumns(),h=g[f],i=h.title;h.titleEditable&&(b.textDBLClick=!0,b.activeEditColumnField&&(b.activeEditColumnField.destroy(),delete b.activeEditColumnField),b.activeEditColumnField=new Fancy.StringField({renderTo:b.el.dom,label:!1,theme:c.theme,padding:"0px 0px 0px",width:h.width+1,value:h.title||"",inputHeight:c.cellHeaderHeight+1,events:[{enter:function(a){a.destroy()}},{esc:function(a){c.setColumnTitle(h.index,i,b.side),a.destroy(),delete b.activeEditColumnField}},{input:function(a,d){c.setColumnTitle(h.index,d,b.side),delete b.activeEditColumnField}},{render:function(a){a.focus(),delete b.activeEditColumnField}}],style:{position:"absolute",top:-1,left:parseInt(e.css("left"))-1}}),c.once("scroll",function(){b.activeEditColumnField&&(b.activeEditColumnField.destroy(),delete b.activeEditColumnField)}))},onCellMouseEnter:function(b){var c=this,d=c.widget,e=c.getEventParams(b),f=c.prevCellOver;if(a.nojQuery&&f&&c.fixZeptoBug){if(e.columnIndex===f.columnIndex&&e.side===f.side)return;d.fire("headercellleave",f)}d.fire("headercellenter",e),c.prevCellOver=e},onCellMouseLeave:function(b){var c=this,d=c.widget,e=c.getEventParams(b),f=c.prevCellOver;if(b.toElement&&c.el.within(b.toElement)||(d.fire("headercellleave",f),delete c.prevCellOver),a.nojQuery){if(void 0===f)return;return void(c.fixZeptoBug=e)}d.fire("headercellleave",f),delete c.prevCellOver},getEventParams:function(b){var c=this,d=c.widget,e=d.store,f=c.getColumns(),g=b.currentTarget,h=a.get(b.currentTarget);if(void 0===h.parent().dom)return!1;if(0===e.getLength())return!1;if(void 0===h.attr("index"))return!1;var i=parseInt(h.attr("index")),j=f[i];return{e:b,side:c.side,cell:g,column:j,columnIndex:i}}})}(),function(){var a=Fancy,b=a.PICKER_DATE_CELL_ACTIVE_CLS,c=a.PICKER_DATE_CLS,d=a.PICKER_DATE_CELL_TODAY_CLS,e=a.PICKER_DATE_CELL_OUT_RANGE_CLS,f="fancy-date-picker-cell-out-min-max",g=a.PICKER_BUTTON_BACK_CLS,h=a.PICKER_BUTTON_NEXT_CLS,i=a.PICKER_BUTTON_DATE_CLS,j=a.PICKER_BUTTON_DATE_WRAPPER_CLS,k=a.PICKER_BUTTON_TODAY_CLS,l=a.PICKER_BUTTON_TODAY_WRAPPER_CLS;a.define("Fancy.datepicker.Manager",{singleton:!0,opened:[],add:function(a){this.hide(),this.opened.push(a)},hide:function(){for(var a=this.opened,b=0,c=a.length;b<c;b++)a[b].hide();this.opened=[]}}),a.define(["Fancy.picker.Date","Fancy.DatePicker"],{extend:a.Grid,type:"datepicker",mixins:["Fancy.grid.mixin.Grid",a.panel.mixin.PrepareConfig,a.panel.mixin.methods,"Fancy.grid.mixin.PrepareConfig","Fancy.grid.mixin.ActionColumn","Fancy.grid.mixin.Edit"],width:308,height:299,frame:!1,i18n:"en",cellTrackOver:!0,cellStylingCls:[e,d,b],activeCellCls:b,todayCellCls:d,pickerDateCls:c,outRangeCellCls:e,buttonBackCls:g,buttonDateCls:i,buttonDateWrapperCls:j,buttonNextCls:h,buttonTodayCls:k,buttonTodayWrapperCls:l,defaults:{type:"string",width:44,align:"center",cellAlign:"center"},gridBorders:[1,0,1,1],panelBodyBorders:[0,0,0,0],barScrollEnabled:!1,constructor:function(b){var c=this;a.apply(c,b),c.initFormat(),c.initColumns(),c.initDate(),c.initData(),c.initBars(),c.Super("constructor",[c])},init:function(){var a=this;a.Super("init",arguments),a.onUpdate(),a.addEvents("changedate"),a.on("update",a.onUpdate,a),a.on("cellclick",a.onCellClick,a),a.addCls(c),a.el.on("mousewheel",a.onMouseWheel,a),a.panel.el.on("mousedown",a.onMouseDown,a)},initFormat:function(){var b=this;b.format||(b.format=a.i18n[b.i18n].date)},initMonthPicker:function(){var b=this;if(b.monthPicker)return void b.monthPicker.setDate(b.date);(a.fullBuilt||!1===a.MODULELOAD||!b.monthPicker||a.modules.grid)&&(b.monthPicker=new a.MonthPicker({date:b.date,renderTo:b.panel.el.dom,i18n:b.i18n,style:{position:"absolute",top:"-"+b.panel.el.height()+"px",left:"0px"},events:[{cancelclick:b.onMonthCancelClick,scope:b},{okclick:b.onMonthOkClick,scope:b}]}))},initData:function(){this.data=this.generateData()},initDate:function(){var a=this;void 0!==a.date&&"Invalid Date"!==a.date.toString()||(a.date=new Date),a.showDate=a.date,a.maxValue&&a.showDate>a.maxValue?a.showDate=a.maxValue:a.minValue&&a.showDate<a.minValue&&(a.showDate=a.minValue)},initColumns:function(){var c=this,g=c.format,h=g.days,i=g.startDay,j=i,k=h.length,l=a.Date.dayIndexes,m=[],n=new Date,o=function(a){switch(a.cls="",a.rowIndex){case 0:Number(a.value)>20&&(a.cls+=" "+e);break;case 4:case 5:Number(a.value)<15&&(a.cls+=" "+e)}var g=c.date,h=c.showDate;n.getMonth()===h.getMonth()&&n.getFullYear()===h.getFullYear()&&a.value===n.getDate()&&(0===a.rowIndex?a.value<20&&(a.cls+=" "+d):4===a.rowIndex||5===a.rowIndex?a.value>20&&(a.cls+=" "+d):a.cls+=" "+d),g.getMonth()===h.getMonth()&&g.getFullYear()===h.getFullYear()&&a.value===g.getDate()&&(0===a.rowIndex?a.value<20&&(a.cls+=" "+b):4===a.rowIndex||5===a.rowIndex?a.value>20&&(a.cls+=" "+b):a.cls+=" "+b);var i=a.value,j=h.getMonth(),k=h.getFullYear();Number(i)>20&&a.rowIndex<2?0===--j&&(k--,j=11):Number(i)<10&&a.rowIndex>3&&12===++j&&(k++,j=0);var l=new Date(k,j,i),m=!1;return c.maxValue&&c.maxValue<l&&(m=!0),c.minValue&&c.minValue>l&&(m=!0),m?a.cls+=" "+f:a.cell&&a.cell.removeCls(f),a},p=0;switch(c.i18n){case"zh-CN":case"zh-TW":p=2}for(;j<k;j++)m.push({index:l[j],title:h[j][p].toLocaleUpperCase(),render:o});for(j=0,k=i;j<k;j++)m.push({index:l[j],title:h[j][0].toLocaleUpperCase(),render:o});c.columns=m},getDataFields:function(){for(var b=this,c=[],d=b.format,e=d.days,f=d.startDay,g=f,h=e.length,i=a.Date.dayIndexes;g<h;g++)c.push(i[g]);for(g=0,h=f;g<h;g++)c.push(i[g]);return c},generateData:function(){for(var b=this,c=b.format,d=c.startDay,e=b.showDate,f=a.Date.getDaysInMonth(e),g=a.Date.getFirstDayOfMonth(e),h=[],i=b.getDataFields(),j=0,k=f,l=0;j<k;j++){var m=j+g-d+l;m<0&&(m=7-d,l=m+1),0===m&&(m=7,l=m),h[m]=j+1}var n=e.getMonth(),o=e.getFullYear(),p=e.getDate(),q=e.getHours(),r=e.getMinutes(),s=e.getSeconds(),t=e.getMilliseconds();0===n?(n=11,o--):n--;var u=new Date(o,n,p,q,r,s,t),v=a.Date.getDaysInMonth(u);for(j=7;j--;)void 0===h[j]&&(h[j]=v,v--);for(var j=28,k=42,w=1;j<k;j++)void 0===h[j]&&(h[j]=w,w++);for(var x=[],j=0,k=6;j<k;j++)x[j]=h.splice(0,7);return{fields:i,items:x}},initBars:function(){this.initTBar(),this.initBBar()},initTBar:function(){var a=this,b=[];b.push({cls:g,handler:a.onBackClick,scope:a,style:{}}),b.push({cls:i,i18n:a.i18n,wrapper:{cls:j},handler:a.onDateClick,scope:a,text:"                       "}),b.push("side"),b.push({cls:h,handler:a.onNextClick,scope:a}),a.tbar=b},initBBar:function(){var a=this,b=[];b.push({text:a.format.today,i18n:a.i18n,cls:k,wrapper:{cls:l},handler:a.onClickToday,scope:a}),a.bbar=b},onBackClick:function(){var a=this,b=a.showDate,c=b.getMonth(),d=b.getFullYear(),e=b.getDate(),f=b.getHours(),g=b.getMinutes(),h=b.getSeconds(),i=b.getMilliseconds();0===c?(c=11,d--):c--,a.showDate=new Date(d,c,e,f,g,h,i);var j=a.generateData();a.store.setData(j.items),a.update()},onNextClick:function(){var a=this,b=a.showDate,c=b.getMonth(),d=b.getFullYear(),e=b.getDate(),f=b.getHours(),g=b.getMinutes(),h=b.getSeconds(),i=b.getMilliseconds();11===c?(c=0,d++):c++,a.showDate=new Date(d,c,e,f,g,h,i);var j=a.generateData();a.store.setData(j.items),a.update()},onUpdate:function(){var b=this,c=a.Date.format(b.showDate,"F Y",{date:b.format}),d=9*c.length+35;switch(b.i18n){case"zh-CN":case"zh-TW":case"ja":case"ko":d=10*c.length+35}b.tbar[1].setText(c,d)},onClickToday:function(){var a=this,b=new Date;a.showDate=b,a.date=b;var c=a.generateData();a.store.setData(c.items),a.update()},onCellClick:function(c,d){var g,h=this,i=h.showDate,j=i.getFullYear(),k=i.getMonth(),l=i.getHours(),m=i.getMinutes(),n=i.getSeconds(),o=i.getMilliseconds(),p=a.get(d.cell);if(!p.hasCls(f)&&(h.date=new Date(j,k,Number(d.value),l,m,n,o),h.el.select("."+b).removeCls(b),p.addCls(b),h.fire("changedate",h.date),p.hasCls(e))){g=Number(d.value),d.rowIndex<3?0===k?(j--,k=11):k--:11===k?(j++,k=11):k++,h.date=new Date(j,k,g,l,m,n,o),h.showDate=h.date;var q=h.generateData();h.store.setData(q.items),h.update()}},onMouseWheel:function(b){a.getWheelDelta(b.originalEvent||b)<0?this.onBackClick():this.onNextClick()},onDateClick:function(){var b=this;b.initMonthPicker(),b.monthPicker.panel.css("display","block"),a.$.fn.animate?b.monthPicker.panel.el.animate({top:"0px"}):b.monthPicker.panel.css({top:"0px"})},onMonthCancelClick:function(){this.hideMonthPicker()},onMonthOkClick:function(){var a=this,b=a.monthPicker.date,c=b.getMonth(),d=b.getFullYear(),e=a.date.getDate(),f=a.date.getHours(),g=a.date.getMinutes(),h=a.date.getSeconds(),i=a.date.getMilliseconds();a.hideMonthPicker(),e>28&&(e=1),a.date=new Date(d,c,e,f,g,h,i),a.showDate=a.date;var j=a.generateData();a.store.setData(j.items),a.update(),a.fire("changedate",a.date,!1)},hideMonthPicker:function(){var b=this.monthPicker.panel.el;a.$.fn.animate?b.animate({top:"-"+b.css("height")},{complete:function(){b.css("display","none")}}):b.css("display","none")},onMouseDown:function(a){a.preventDefault()},setDate:function(a,b){var c=this;c.date=a,b&&c.showDate||(c.showDate=a),c.store.setData(c.generateData().items),c.update()}})}(),function(){var a=Fancy,b=a.PICKER_MONTH_CELL_ACTIVE_CLS,c=a.PICKER_MONTH_CLS,d=a.PICKER_BUTTON_BACK_CLS,e=a.PICKER_BUTTON_NEXT_CLS,f=a.PICKER_MONTH_ACTION_BUTTONS_CLS;a.define(["Fancy.picker.Month","Fancy.MonthPicker"],{extend:a.Grid,type:"monthpicker",mixins:["Fancy.grid.mixin.Grid",a.panel.mixin.PrepareConfig,a.panel.mixin.methods,"Fancy.grid.mixin.PrepareConfig","Fancy.grid.mixin.ActionColumn","Fancy.grid.mixin.Edit"],width:308,height:299,frame:!1,cellHeight:37,i18n:"en",cellTrackOver:!0,cellStylingCls:[b],activeCellCls:b,buttonBackCls:d,buttonNextCls:e,actionButtonsCls:f,defaults:{type:"string",width:76,align:"center",cellAlign:"center"},gridBorders:[1,0,1,1],panelBodyBorders:[0,0,0,0],header:!1,constructor:function(b){var c=this;a.apply(c,b),c.initLang(),c.initColumns(),c.initDate(),c.initData(),c.initBars(),c.Super("constructor",[c])},init:function(){var a=this;a.Super("init",arguments),a.addEvents("cancelclick","okclick"),a.addEvents("changedate"),a.on("cellclick",a.onCellClick,a),a.panel.addCls(c)},initData:function(){this.data=this.generateData()},initDate:function(){var a=this;void 0===a.date&&(a.date=new Date),a.showDate=a.date},initLang:function(){var b=this;b.lang||(b.lang=a.Object.copy(a.i18n[b.i18n||"en"]))},initColumns:function(){var a=this,c=function(c){var d=a.date,e=d.getMonth();return a.lang.date.months[e].substr(0,3)===c.value&&(c.cls=b),c},d=function(c){return a.date.getFullYear()===Number(c.value)&&(c.cls=b),c};a.columns=[{index:"month1",render:c,locked:!0},{index:"month2",render:c,locked:!0,width:77},{index:"year1",render:d,width:77},{index:"year2",render:d,width:77}]},generateData:function(){var a,b,c=this,d=c.lang,e=c.showDate,f=e.getFullYear(),g=d.date.months,h=[],i=[];for(a=0,b=12;a<b;a++)i.push(f-5+a);for(a=0,b=6;a<b;a++)h[a]={},h[a].month1=g[a].substr(0,3),h[a].month2=g[6+a].substr(0,3),h[a].year1=i[a],h[a].year2=i[6+a];return{fields:["month1","month2","year1","year2"],items:h}},initBars:function(){this.initTBar(),this.initBBar()},initTBar:function(){var a=this,b=[];b.push("side"),b.push({cls:d,handler:a.onBackClick,scope:a}),b.push({width:30,cls:e,handler:a.onNextClick,scope:a}),a.tbar=b},initBBar:function(){var a=this,b=[],c=a.lang;b.push({type:"wrapper",cls:f,items:[{text:c.date.ok,i18n:a.i18n,handler:a.onClickOk,scope:a},{text:c.date.cancel,i18n:a.i18n,handler:a.onClickCancel,scope:a}]}),a.bbar=b},onBackClick:function(){var a=this,b=a.showDate,c=b.getFullYear(),d=b.getMonth(),e=b.getDate(),f=b.getHours(),g=b.getMinutes(),h=b.getSeconds(),i=b.getMilliseconds();c-=10,a.showDate=new Date(c,d,e,f,g,h,i);var j=a.generateData();a.store.setData(j.items),a.update()},onNextClick:function(){var a=this,b=a.showDate,c=b.getFullYear(),d=b.getMonth(),e=b.getDate(),f=b.getHours(),g=b.getMinutes(),h=b.getSeconds(),i=b.getMilliseconds();c+=10,a.showDate=new Date(c,d,e,f,g,h,i);var j=a.generateData();a.store.setData(j.items),a.update()},onClickOk:function(){this.fire("okclick")},onClickCancel:function(){this.fire("cancelclick")},onCellClick:function(c,d){var e,f=this,g=f.date,h=g.getFullYear(),i=g.getMonth(),j=g.getDate(),k=g.getHours(),l=g.getMinutes(),m=g.getSeconds(),n=g.getMilliseconds(),o=a.get(d.cell);"center"===d.side?(e=f.body,h=Number(d.value)):(e=f.leftBody,i=d.rowIndex+6*d.columnIndex),e.el.select("."+b).removeCls(b),o.addCls(b),j>28&&(j=1),f.showDate=new Date(h,i,j,k,l,m,n),f.date=f.showDate,f.fire("changedate",f.date)},onMouseWheel:function(b){a.getWheelDelta(b.originalEvent||b)<0?this.onBackClick():this.onNextClick()},setDate:function(a){var b=this;b.date=a,b.showDate=a;var c=b.generateData();b.store.setData(c.items),b.update()}})}(),Fancy.define("Fancy.spark.ProgressDonut",{svgns:"http://www.w3.org/2000/svg",sum:100,prefix:"fancy-spark-progress-donut-",colorBGPlus:"#eee",colorPlus:"#44A4D3",colorBGMinus:"#F9DDE0",colorMinus:"#EA7369",tipTpl:"{value}",tip:!0,tooltip:!0,constructor:function(a){var b=this;Fancy.apply(b,a),b.init()},init:function(){var a=this;a.initId(),a.initChart(),a.setSize(),a.setRadius(),a.setInnerRadius(),a.setParams(),a.iniColors(),a.preRender(),a.render(),!0!==a.inited&&(a.renderTo.appendChild(a.chart),a.ons())},initId:function(){var a=this,b=a.prefix||Fancy.prefix;a.id=a.id||Fancy.id(null,b),Fancy.addWidget(a.id,a)},ons:function(){var a=this;a.el.on("mouseenter",a.onMouseEnter,a),a.el.on("mouseleave",a.onMouseLeave,a),a.el.on("mousemove",a.onMouseMove,a)},onMouseEnter:function(a){var b=this,c=b.el.attr("value");if(b.tip&&b.tipTpl){c=new Fancy.Template(b.tipTpl).getHTML({value:c}),Fancy.tip.update('<span style="color: '+b.color+';">●</span> '+c)}},onMouseLeave:function(a){var b=this;b.tip&&b.tipTpl&&Fancy.tip.hide(500)},onMouseMove:function(a){var b=this;b.tooltip&&b.tip&&b.tipTpl&&Fancy.tip.show(a.pageX+15,a.pageY-25)},iniColors:function(){var a=this;a.value<0?(a.backColor=a.colorBGMinus,a.color=a.colorMinus):(a.backColor=a.colorBGPlus,a.color=a.colorPlus)},preRender:function(){var a=this,b=a.size,c=a.chart;c.setAttribute("width",b),c.setAttribute("height",b),c.setAttribute("viewBox","0 0 "+b+" "+b)},render:function(){var a=this;a.renderBack(),a.renderProgress()},renderBack:function(){var a=this,b=a.radius,c=a.innerRadius,d=["M",a.cx,a.y1,"A",b,b,0,1,1,a.x2,a.y1,"L",a.x2,a.y2,"A",c,c,0,1,0,a.cx,a.y2].join(" "),e=document.createElementNS(a.svgns,"path");e.setAttribute("d",d),e.setAttribute("fill",a.backColor),a.chart.appendChild(e)},renderProgress:function(){var a=this,b=a.radius,c=a.innerRadius,d=document.createElementNS(a.svgns,"path"),e=a.value,f=0;e>99&&(e=99.99999),e<-99&&(e=99.99999),e<0&&(f=100+e,e*=-1);var g=e/a.sum,h=f+e,i=["M"].concat(a.scale(f,b),"A",b,b,0,g>.5?1:0,1,a.scale(h,b),"L");c&&(i=i.concat(a.scale(h,c),"A",c,c,0,g>.5?1:0,0,a.scale(f,c))),i=i.join(" "),d.setAttribute("d",i),d.setAttribute("fill",a.color),a.chart.appendChild(d)},initChart:function(){var a=this,b=Fancy.get(a.renderTo);a.renderTo=Fancy.get(a.renderTo).dom,0===b.select("svg").length?a.chart=document.createElementNS(a.svgns,"svg:svg"):(a.chart=b.select("svg").dom,a.chart.innerHTML="",a.inited=!0),a.el=Fancy.get(a.chart),a.el.attr("id",a.id),a.value<1&&a.value>0?a.el.attr("value",a.value.toFixed(1)):a.value>-1&&a.value<0?a.el.attr("value",a.value.toFixed(1)):a.el.attr("value",a.value.toFixed(0))},scale:function(a,b){var c=this,d=Math.PI,e=c.sum,f=a/e*d*2-d/2;return[b*Math.cos(f)+c.cx,b*Math.sin(f)+c.cy]},radians:function(a){return a*Math.PI/180},setSize:function(){var a=this;a.width=a.width||a.height||a.size||30,a.height=a.height||a.width||a.size||30,a.size=a.size||a.height},setRadius:function(){var a=this;a.radius=a.radius||a.height/2},setInnerRadius:function(){var a=this;a.innerRadius=a.innerRadius||a.height/2-a.height/4},setParams:function(){var a=this,b=a.radius,c=a.innerRadius,d=a.height,e=a.width;a.cy=d/2,a.y1=a.cy-b,a.y2=a.cy-c,a.cx=e/2,a.x2=a.cx-.01}}),Fancy.modules.spark=!0,Fancy.define("Fancy.spark.GrossLoss",{maxValue:100,tipTpl:'<span style="color: {color};">●</span> {value} {suffix}',tip:!0,constructor:function(a){Fancy.apply(this,a),this.init()},init:function(){var a=this;a.preRender(),a.render(),!0!==a.inited&&a.ons()},ons:function(){var a=this;a.el.on("mouseenter",a.onMouseEnter,a),a.el.on("mouseleave",a.onMouseLeave,a),a.el.on("mousemove",a.onMouseMove,a)},onMouseEnter:function(){var a,b=this,c=b.el.attr("value"),d=b.el.css("background-color"),e="";if(b.tipTpl&&b.tip){b.percents&&(e=" %");a=new Fancy.Template(b.tipTpl).getHTML({value:c,color:d,suffix:e}),Fancy.tip.update(a)}},onMouseLeave:function(){var a=this;a.tipTpl&&a.tip&&Fancy.tip.hide(500)},onMouseMove:function(a){var b=this;b.tipTpl&&b.tip&&Fancy.tip.show(a.pageX+15,a.pageY-25)},preRender:function(){},render:function(){var a=this,b=a.column,c=b.width,d=c/a.maxValue,e=0,f=0,g=a.value,h="";g<0?(e=-g*d/2,a.lossColor&&(h="background-color:"+a.lossColor+";"),g='<div class="fancy-grid-grossloss-loss" style="'+h+"width:"+e+'%">&nbsp;</div>'):(f=g*d/2,a.grossColor&&(h="background-color:"+a.grossColor+";"),g='<div class="fancy-grid-grossloss-gross" style="'+h+"width:"+f+'%">&nbsp;</div>'),a.renderTo.innerHTML=g,a.value<0?a.el=Fancy.get(a.renderTo).select(".fancy-grid-grossloss-loss").item(0):a.el=Fancy.get(a.renderTo).select(".fancy-grid-grossloss-gross").item(0),a.el.attr("value",a.value.toFixed(2))}}),Fancy.define("Fancy.spark.ProgressBar",{tipTpl:"{value} {suffix}",tip:!0,constructor:function(a){var b=this;Fancy.apply(b,a),b.init()},init:function(){var a=this;a.initId(),a.render(),!0!==a.inited&&a.ons()},initId:function(){var a=this,b=a.prefix||Fancy.prefix;a.id=a.id||Fancy.id(null,b),Fancy.addWidget(a.id,a)},ons:function(){var a=this;!1!==a.tip&&(a.el.on("mouseenter",a.onMouseEnter,a),a.el.on("mouseleave",a.onMouseLeave,a),a.el.on("mousemove",a.onMouseMove,a))},onMouseEnter:function(a){var b,c=this,d=c.el.attr("value"),e="%";if(!1===c.percents&&(e=""),!1!==c.tip&&c.tipTpl){if(Fancy.isFunction(c.tipTpl))b=c.tipTpl({value:d,suffix:e});else{b=new Fancy.Template(c.tipTpl).getHTML({value:d,suffix:e})}Fancy.tip.update(b)}},onMouseLeave:function(a){this.tip&&this.tipTpl&&Fancy.tip.hide(500)},onMouseMove:function(a){this.tip&&this.tipTpl&&Fancy.tip.show(a.pageX+15,a.pageY-25)},render:function(){var a,b=this,c=b.column,d=c.width-18,e=d/b.maxValue,f=b.value*e,g=b.value,h=c.sparkConfig;g=!1===b.percents?b.value:g<1?b.value.toFixed(1):b.value.toFixed(0);var i="&nbsp;",j="",k="";if(h.label)switch(h.label.type){case"left":i='<div class="fancy-grid-bar-label" style="float: left;">'+g+"</div>",f<7*String(g).length&&(i="&nbsp;",j='<div class="fancy-grid-bar-label-out" style="">'+g+"</div>");break;case"right":i='<div class="fancy-grid-bar-label" style="float: right;">'+g+"</div>",f<7*String(g).length&&(i="&nbsp;",j="right"===h.align?'<div class="fancy-grid-bar-label-out-left" style="">'+g+"</div>":'<div class="fancy-grid-bar-label-out" style="">'+g+"</div>");break;default:i='<div class="fancy-grid-bar-label" style="float: left;">'+g+"</div>",f<7*String(g).length&&(i="&nbsp;",k='<div class="fancy-grid-bar-label-out-left" style="">'+g+"</div>")}var l="width:"+f+"px;",m="";if(h.align&&(m="float:"+h.align+";"),a='<div id="'+b.id+'" value="'+g+'" class="fancy-grid-column-progress-bar" style="'+l+m+'">'+i+"</div>"+j+k,b.renderTo.innerHTML=a,b.el=Fancy.get(b.renderTo).select(".fancy-grid-column-progress-bar").item(0),Fancy.isFunction(b.style)){var n=b.style({value:b.value,column:b.column,rowIndex:b.rowIndex,data:b.data});b.el.css(n)}},update:function(){var a=this,b=a.column,c=b.width-18,d=10,e=c/a.maxValue,f=a.value,g=f*e,h=b.sparkConfig,i=a.el.parent();if(a.el.css("width",g),a.el.attr("value",f),h.label)if("right"===h.label.type){var j=i.select(".fancy-grid-column-progress-bar"),k=i.select(".fancy-grid-bar-label"),l=i.select(".fancy-grid-bar-label-out");String(f).length*d+10>g?(k.dom&&(j.update("&nbsp;"),k.destroy()),l.dom?l.update(f):i.append('<div class="fancy-grid-bar-label-out">'+f+"</div>")):(k.dom||(j.append('<div class="fancy-grid-bar-label" style="float: right;"></div>'),k=i.select(".fancy-grid-bar-label")),k.update(f),l.dom&&l.destroy())}else{var j=i.select(".fancy-grid-column-progress-bar"),k=i.select(".fancy-grid-bar-label"),m=i.select(".fancy-grid-bar-label-out-left");String(f).length*d+10>g?(k.dom&&(j.update("&nbsp;"),k.destroy()),m.dom?m.update(f):i.append('<div class="fancy-grid-bar-label-out-left">'+f+"</div>")):(k.dom||(j.append('<div class="fancy-grid-bar-label" style="float: left;"></div>'),k=i.select(".fancy-grid-bar-label")),k.update(f),m.dom&&m.destroy())}}}),Fancy.define("Fancy.spark.HBar",{tipTpl:"{value}",tip:!0,maxValue:100,stacked:!1,fullStack:!1,constructor:function(a){var b=this;Fancy.apply(b,a),b.init()},init:function(){var a=this;a.initId(),a.render(),!0!==a.inited&&a.ons()},initId:function(){var a=this,b=a.prefix||Fancy.prefix;a.id=a.id||Fancy.id(null,b),Fancy.addWidget(a.id,a)},ons:function(){var a=this;!1!==a.tip&&(a.el.on("mouseenter",a.onMouseEnter,a,".fancy-grid-column-h-bar-node"),a.el.on("mouseleave",a.onMouseLeave,a,".fancy-grid-column-h-bar-node"),a.el.on("mousemove",a.onMouseMove,a,".fancy-grid-column-h-bar-node"))},onMouseEnter:function(a){var b=this,c=Fancy.get(a.target),d=c.attr("key"),e=c.attr("data-title"),f=Number(c.attr("value")),g=Number(c.attr("percents"));if(b.tip&&b.tipTpl){if(b.tipFormat){var h={value:f,percents:g,key:d,column:b.column,data:b.data,title:e};f=b.tipFormat(h)}var i=new Fancy.Template(b.tipTpl),j=i.getHTML({value:f});Fancy.tip.update(j)}},onMouseLeave:function(a){var b=this;b.tip&&b.tipTpl&&Fancy.tip.hide(500)},onMouseMove:function(a){var b=this;b.tip&&b.tipTpl&&Fancy.tip.show(a.pageX+15,a.pageY-25)},render:function(){var a,b,c=this,d=c.column,e=d.width-18,f=e/100,g=d.index,h=0,i=d.disabled||{},j="",k="",l=2,m=0,n=g.length;d.fields?(n=d.fields.length,Fancy.each(d.fields,function(a){var b=d.index+"."+a;i[b]||(h+=c.data[d.index][b])})):Fancy.each(g,function(a){i[a]||(h+=c.data[a])}),c.stacked?c.fullStack||(h=c.maxValue):(h=c.maxItemValue,j="line-height:"+((c.height-1)/g.length-l)+"px;"),a=h/100,m=0;var o="fancy-spark-hbar";for(c.stacked&&(o+=" fancy-spark-stacked "),b='<div id="'+c.id+'" class="'+o+'">';m<n;m++){if(d.fields)var p=d.fields[m],q=c.data[d.index][p];else var p=g[m],q=c.data[p];var r=q/a,s=r*f;if(!i[p]){0!==m&&s--,c.stacked||(k="margin-top:"+l+"px;"),s>0&&s<1&&(s=2);var t="background: "+Fancy.COLORS[m]+";",u="width:"+s+";",v="",w='data-title=""';0===s&&(v="display: none;"),c.title&&(w='data-title="'+c.title[m]+'" ');var x='key="'+p+'" ';q='value="'+q+'" ';b+="<div "+w+x+q+('percents="'+r+'" ')+'" class="fancy-grid-column-h-bar-node" style="'+v+u+t+j+k+'">&nbsp;</div>'}}b+="</div>",c.renderTo.innerHTML=b,c.el=Fancy.get(c.renderTo)},update:function(a){var b,c,d=this,e=d.column,f=e.width-18,g=f/100,h=e.index,i=0,j=e.disabled||{},k=2;d.data=a;var l=0,m=h.length,n=0;for(e.fields?(m=e.fields.length,Fancy.each(e.fields,function(a){if(j[e.index+"."+a])return void n++;i+=d.data[e.index][a]})):Fancy.each(h,function(a){if(j[a])return void n++;i+=d.data[a]}),d.stacked?d.fullStack||(i=d.maxValue):(i=d.maxItemValue,c=(d.height-1)/(h.length-n)-k),b=i/100,l=0;l<m;l++){if(e.fields)var o=e.fields[l],p=d.data[e.index][o];else var o=h[l],p=d.data[o];var q=p/b,r=q*g,s=d.el.select('.fancy-grid-column-h-bar-node[key="'+o+'"]');e.fields&&j[e.index+"."+o]?(s.css("width","0px"),s.hide()):j[o]?(s.css("width","0px"),s.hide()):(0!==l&&r--,d.stacked||(s.css("line-height",c+"px"),s.css("margin-top",k+"px")),0===r||-1===r?s.css("display","none"):s.css("display","block"),r>0&&r<2&&(r=2),s.animate({duration:2,width:r}))}}}),function(){var a=Fancy,b=a.TOOLTIP_CLS,c=a.TOOLTIP_INNER_CLS;a.define("Fancy.ToolTip",{extend:a.Widget,constructor:function(){this.Super("const",arguments)},init:function(){this.initTpl(),this.render(),this.ons()},tpl:['<div class="'+c+'">{text}</div>'],widgetCls:b,cls:"",extraCls:"",render:function(){var b=this,c=a.get(b.renderTo||document.body).dom,d=a.get(document.createElement("div"));d.addCls(a.cls,b.widgetCls,b.cls,b.extraCls),d.update(b.tpl.getHTML({text:b.text})),b.el=a.get(c.appendChild(d.dom))},show:function(a,b){var c=this;c.timeout&&(clearInterval(c.timeout),delete c.timeout),"none"===c.css("display")&&c.css({display:"block"}),c.css({left:a,top:b})},hide:function(a){var b=this;b.timeout&&(clearInterval(b.timeout),delete b.timeout),a?b.timeout=setTimeout(function(){b.el.hide()},a):b.el.hide()},destroy:function(){this.el.destroy()},update:function(a){this.el.select("."+c).update(a)},ons:function(){var a=this;a.el.on("mouseenter",a.onMouseEnter,a)},onMouseEnter:function(a){this.hide(500)}}),a.tip={update:function(b){a.tip=new a.ToolTip({text:b})},show:function(b,c){a.tip=new a.ToolTip({text:" "}),a.tip.show(b,c)},hide:function(){a.tip=new a.ToolTip({text:" "})}}}(),function(){"use strict";function a(b,d){function e(a,b){return function(){return a.apply(b,arguments)}}var f;if(d=d||{},this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=d.touchBoundary||10,this.layer=b,this.tapDelay=d.tapDelay||200,this.tapTimeout=d.tapTimeout||700,!a.notNeeded(b)){for(var g=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"],h=this,i=0,j=g.length;i<j;i++)h[g[i]]=e(h[g[i]],h);c&&(b.addEventListener("mouseover",this.onMouse,!0),b.addEventListener("mousedown",this.onMouse,!0),b.addEventListener("mouseup",this.onMouse,!0)),b.addEventListener("click",this.onClick,!0),b.addEventListener("touchstart",this.onTouchStart,!1),b.addEventListener("touchmove",this.onTouchMove,!1),b.addEventListener("touchend",this.onTouchEnd,!1),b.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(b.removeEventListener=function(a,c,d){var e=Node.prototype.removeEventListener;"click"===a?e.call(b,a,c.hijacked||c,d):e.call(b,a,c,d)},b.addEventListener=function(a,c,d){var e=Node.prototype.addEventListener;"click"===a?e.call(b,a,c.hijacked||(c.hijacked=function(a){a.propagationStopped||c(a)}),d):e.call(b,a,c,d)}),"function"==typeof b.onclick&&(f=b.onclick,b.addEventListener("click",function(a){f(a)},!1),b.onclick=null)}}Fancy.modules.touch=!0;var b=navigator.userAgent.indexOf("Windows Phone")>=0,c=navigator.userAgent.indexOf("Android")>0&&!b,d=/iP(ad|hone|od)/.test(navigator.userAgent)&&!b,e=d&&/OS 4_\d(_\d)?/.test(navigator.userAgent),f=d&&/OS [6-7]_\d/.test(navigator.userAgent),g=navigator.userAgent.indexOf("BB10")>0;a.prototype.needsClick=function(a){switch(a.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(a.disabled)return!0;break;case"input":if(d&&"file"===a.type||a.disabled)return!0;break;case"label":case"iframe":case"video":return!0}return/\bneedsclick\b/.test(a.className)},a.prototype.needsFocus=function(a){switch(a.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!c;case"input":switch(a.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!a.disabled&&!a.readOnly;default:return/\bneedsfocus\b/.test(a.className)}},a.prototype.sendClick=function(a,b){var c,d;document.activeElement&&document.activeElement!==a&&document.activeElement.blur(),d=b.changedTouches[0],c=document.createEvent("MouseEvents"),c.initMouseEvent(this.determineEventType(a),!0,!0,window,1,d.screenX,d.screenY,d.clientX,d.clientY,!1,!1,!1,!1,0,null),c.forwardedTouchEvent=!0,a.dispatchEvent(c)},a.prototype.determineEventType=function(a){return c&&"select"===a.tagName.toLowerCase()?"mousedown":"click"},a.prototype.focus=function(a){var b;d&&a.setSelectionRange&&0!==a.type.indexOf("date")&&"time"!==a.type&&"month"!==a.type?(b=a.value.length,a.setSelectionRange(b,b)):a.focus()},a.prototype.updateScrollParent=function(a){var b,c;if(!(b=a.fastClickScrollParent)||!b.contains(a)){c=a;do{if(c.scrollHeight>c.offsetHeight){b=c,a.fastClickScrollParent=c;break}c=c.parentElement}while(c)}b&&(b.fastClickLastScrollTop=b.scrollTop)},a.prototype.getTargetElementFromEventTarget=function(a){return a.nodeType===Node.TEXT_NODE?a.parentNode:a},a.prototype.onTouchStart=function(a){var b,c,f;if(a.targetTouches.length>1)return!0;if(b=this.getTargetElementFromEventTarget(a.target),c=a.targetTouches[0],d){if(f=window.getSelection(),f.rangeCount&&!f.isCollapsed)return!0;if(!e){if(c.identifier&&c.identifier===this.lastTouchIdentifier)return a.preventDefault(),!1;this.lastTouchIdentifier=c.identifier,this.updateScrollParent(b)}}return this.trackingClick=!0,this.trackingClickStart=a.timeStamp,this.targetElement=b,this.touchStartX=c.pageX,this.touchStartY=c.pageY,a.timeStamp-this.lastClickTime<this.tapDelay&&a.preventDefault(),!0},a.prototype.touchHasMoved=function(a){var b=a.changedTouches[0],c=this.touchBoundary;return Math.abs(b.pageX-this.touchStartX)>c||Math.abs(b.pageY-this.touchStartY)>c},a.prototype.onTouchMove=function(a){return!this.trackingClick||((this.targetElement!==this.getTargetElementFromEventTarget(a.target)||this.touchHasMoved(a))&&(this.trackingClick=!1,this.targetElement=null),!0)},a.prototype.findControl=function(a){return void 0!==a.control?a.control:a.htmlFor?document.getElementById(a.htmlFor):a.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},a.prototype.onTouchEnd=function(a){var b,g,h,i,j,k=this.targetElement;if(!this.trackingClick)return!0;if(a.timeStamp-this.lastClickTime<this.tapDelay)return this.cancelNextClick=!0,!0;if(a.timeStamp-this.trackingClickStart>this.tapTimeout)return!0;if(this.cancelNextClick=!1,this.lastClickTime=a.timeStamp,g=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,f&&(j=a.changedTouches[0],k=document.elementFromPoint(j.pageX-window.pageXOffset,j.pageY-window.pageYOffset)||k,k.fastClickScrollParent=this.targetElement.fastClickScrollParent),"label"===(h=k.tagName.toLowerCase())){if(b=this.findControl(k)){if(this.focus(k),c)return!1;k=b}}else if(this.needsFocus(k))return a.timeStamp-g>100||d&&window.top!==window&&"input"===h?(this.targetElement=null,!1):(this.focus(k),this.sendClick(k,a),d&&"select"===h||(this.targetElement=null,a.preventDefault()),!1);return!(!d||e||!(i=k.fastClickScrollParent)||i.fastClickLastScrollTop===i.scrollTop)||(this.needsClick(k)||(a.preventDefault(),this.sendClick(k,a)),!1)},a.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},a.prototype.onMouse=function(a){return!this.targetElement||(!!a.forwardedTouchEvent||(!a.cancelable||(!(!this.needsClick(this.targetElement)||this.cancelNextClick)||(a.stopImmediatePropagation?a.stopImmediatePropagation():a.propagationStopped=!0,a.stopPropagation(),a.preventDefault(),!1))))},a.prototype.onClick=function(a){var b;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):"submit"===a.target.type&&0===a.detail||(b=this.onMouse(a),b||(this.targetElement=null),b)},a.prototype.destroy=function(){var a=this.layer;c&&(a.removeEventListener("mouseover",this.onMouse,!0),a.removeEventListener("mousedown",this.onMouse,!0),a.removeEventListener("mouseup",this.onMouse,!0)),a.removeEventListener("click",this.onClick,!0),a.removeEventListener("touchstart",this.onTouchStart,!1),a.removeEventListener("touchmove",this.onTouchMove,!1),a.removeEventListener("touchend",this.onTouchEnd,!1),a.removeEventListener("touchcancel",this.onTouchCancel,!1)},a.notNeeded=function(a){var b,d,e;if(void 0===window.ontouchstart)return!0;if(d=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]){if(!c)return!0;if(b=document.querySelector("meta[name=viewport]")){if(-1!==b.content.indexOf("user-scalable=no"))return!0;if(d>31&&document.documentElement.scrollWidth<=window.outerWidth)return!0}}if(g&&(e=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/),e[1]>=10&&e[2]>=3&&(b=document.querySelector("meta[name=viewport]")))){if(-1!==b.content.indexOf("user-scalable=no"))return!0;if(document.documentElement.scrollWidth<=window.outerWidth)return!0}return"none"===a.style.msTouchAction||"manipulation"===a.style.touchAction||(!!(+(/Firefox\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]>=27&&(b=document.querySelector("meta[name=viewport]"))&&(-1!==b.content.indexOf("user-scalable=no")||document.documentElement.scrollWidth<=window.outerWidth))||("none"===a.style.touchAction||"manipulation"===a.style.touchAction))},a.attach=function(b,c){return new a(b,c)},"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(function(){return a}):"undefined"!=typeof module&&module.exports?(module.exports=a.attach,module.exports.FastClick=a):window.FastClick=a}(),Fancy.enableCompo=function(){function a(){if(0!==e)for(var a in f){var c,g,h=f[a],i=d.querySelectorAll(a),j=h.appPreSelector?h.appPreSelector+"-":"data-",k=h.preSelector?h.preSelector+"-":"fancy-",l=0,m=i.length;if(0===i.length)return;for(;l<m;l++){var n={},o=i[l],p=o.id||"rand-id-"+ +new Date,q=o.attributes;for(c=0,g=q.length;c<g;c++){var r=q[c],s=r.name,t=r.value;new RegExp(j).test(s)&&(t=b(t),n[s.replace(j,"")]=t)}!function(){var a=o.getElementsByTagName("*");for(c=0,g=a.length;c<g;c++){var d,e,f=a[c],h=f.tagName.toLowerCase();new RegExp(k).test(h)&&(d=h.replace(k,""),e=b(f.innerHTML),n[d.replace(j,"")]=e)}}(),o.outerHTML='<div id="'+p+'"></div>',h.init(d.getElementById(p),n)}}}function b(a){return/\[/.test(a)||/\{/.test(a)?(a=a.replace(/\n/g,""),a=new Function("return "+a+";")()):a=isNaN(Number(a))?a.replace(/\n/g,""):Number(a),a}var c,d=document,e=0,f={};Fancy.Component=function(a,b){e++,f[a]=b},Fancy.stopWatch=function(){clearInterval(c)},a(),d.addEventListener("DOMContentLoaded",function(){a()}),setTimeout(function(){a()},1),c=setInterval(function(){a()},250),Fancy.Component("fancy-grid",{preSelector:"fancy",attrPreSelector:"data",init:function(a,b){b.renderTo=a,window[a.id]=new FancyGrid(b)}}),Fancy.Component("fancy-form",{preSelector:"fancy",attrPreSelector:"data",init:function(a,b){b.renderTo=a,window[a.id]=new FancyForm(b)}}),Fancy.Component("fancy-tab",{preSelector:"fancy",attrPreSelector:"data",init:function(a,b){b.renderTo=a,window[a.id]=new FancyTab(b)}})},Fancy});