Fancy.modules.filter=!0,Fancy.Mixin("Fancy.store.mixin.Filter",{filterCheckItem:function(a){var b=this,c=b.widget,d=c.filterCaseSensitive,e=Fancy.Object.copy(b.filters),f=!0,g=!1,h=!1;if(void 0===a.data&&(a=new Fancy.Model(a)),b.isTree){var i=a.get("child");if(i){var j=[];if(Fancy.each(i,function(a){var c=a.data?a:new b.model(a);b.filterCheckItem(c)&&j.push(a)}),a.set("filteredChild",j),j.length)return!0}}for(var k in e){var l=c.getColumnByIndex(k),m=e[k],n=a.data[k];if(l&&l.filter&&l.filter.fn)return l.filter.fn(n,e,a);if(b.smartIndexes&&b.smartIndexes[k])n=b.smartIndexes[k](a.data);else if(/\./.test(k)){var o=k.split(".");n=a.data[o[0]][o[1]]}"date"===m.type&&(n=null===n?Number.NEGATIVE_INFINITY:Number(Fancy.Date.parse(n,m.format.read,m.format.mode))),!d&&Fancy.isString(n)&&(n=n.toLocaleLowerCase());for(var p in m){switch(p){case"type":case"format":continue}var q=m[p];switch(!d&&Fancy.isString(q)&&(q=q.toLocaleLowerCase()),p){case"<":f=Number(n)<Number(q);break;case">":f=Number(n)>Number(q);break;case"<=":f=Number(n)<=Number(q);break;case">=":f=Number(n)>=Number(q);break;case"<>":var r=!1;for(var s in q){var t=q[s];switch(s){case"<":Number(n)<Number(t)&&(r=!0);break;case">":Number(n)>Number(t)&&(r=!0);break;case"<=":Number(n)<=Number(t)&&(r=!0);break;case">=":Number(n)>=Number(t)&&(r=!0)}}f=r;break;case"=":case"==":Fancy.isArray(q)?(Fancy.each(q,function(a,b){q[b]=String(a)}),n=String(n),f=-1!==q.indexOf(n)):f=n==q;break;case"===":Fancy.isArray(q)?(n=String(n),f=-1!==q.indexOf(n)):f=n===q;break;case"!==":f=n!==q;break;case"!=":Fancy.isArray(q)?(Fancy.each(q,function(a,b){q[b]=String(a)}),n=String(n),f=-1===q.indexOf(n)):f=n!=q;break;case"":var u=function(a,b){return a=String(a).toLocaleLowerCase(),b=String(b).toLocaleLowerCase(),a=a.replace(/\(/g,"bracketleft"),a=a.replace(/\)/g,"bracketright"),a=a.replace(/\+/g,"plus"),a=a.replace(/\-/g,"minus"),b=b.replace(/\(/g,"bracketleft"),b=b.replace(/\)/g,"bracketright"),b=b.replace(/\+/g,"plus"),b=b.replace(/\-/g,"minus"),new RegExp(a).test(b)};if(Fancy.isArray(q))for(var v=0,w=q.length;v<w&&!1!==(f=u(q[v],n));v++);else f=u(q,n);break;case"*":q=String(q).toLocaleLowerCase(),f=new RegExp(q).test(String(n).toLocaleLowerCase()),f&&(h=!0),g=!0;break;case"|":f=!0===q[String(n).toLocaleLowerCase()];break;case"fn":f=!0===q(n,a);break;default:throw new Error("[FancyGrid Error 5]: Unknown filter "+p)}if("*"!==p&&!1===f)return!1}}return(!0!==g||!1!==h)&&(!0!==g||!0!==f||!1!==h)},filterData:function(a){var b=this,c=b.widget,d=b.data,e=[],f=0,g=d.length,h=[],i=[];if(b.remoteFilter)return void(c.UPDATING_AFTER_LOAD||b.serverFilter(!0!==c.stateIsWaiting));for(b.filteredDataMap={};f<g;f++)b.order?(h.push(b.order[f]),i=d[b.order[f]]):(h.push(f),i=d[f]),b.filterCheckItem(i)&&(e.push(i),b.filteredDataMap[i.id]=i);b.filterOrder=h,b.filteredData=e,b.paging&&b.calcPages(),!1!==a&&b.fire("filter")},serverFilter:function(a){var b=this,c="[",d=b.filters||{};for(var e in d){var f=d[e];for(var g in f){switch(g){case"type":case"format":continue}var h=b.filterOperators[g];if("or"===h){var i=[];for(var j in f[g])i.push(j);c+='{"operator":"'+h+'","value":"'+i.join(", ")+'","property":"'+e+'"},'}else c+='{"operator":"'+h+'","value":"'+f[g]+'","property":"'+e+'"},'}}c=c.replace(/\,$/,""),c+="]",b.params=b.params||{},"[]"===c?(c="",delete b.params[b.filterParam]):b.params[b.filterParam]=c,!1!==a&&b.loadData()},hasFilters:function(){var a=this;if(!a.filters)return!1;for(var b in a.filters)return!0;return!1},"combineÐ¡omparisonSigns":function(a){for(var b in a){var c=Fancy.Object.copy(a[b]);for(var d in c)switch(d){case"<":case">":case"<=":case">=":c["<>"]=c["<>"]||{},c["<>"][d]=c[d],delete c[d]}a[b]=c}return a}}),Fancy.modules.filter=!0,function(){var a=Fancy,b=a.FIELD_CLS,c=a.FIELD_CHECKBOX_CLS,d=a.GRID_HEADER_CELL_DOUBLE_CLS,e=a.GRID_HEADER_CELL_TRIPLE_CLS,f=a.GRID_HEADER_CELL_FILTER_CLS,g=a.GRID_HEADER_CELL_FILTER_FULL_CLS,h=a.GRID_HEADER_CELL_FILTER_SMALL_CLS,i=a.GRID_HEADER_CELL_FILTERED_CLS,j=a.GRID_HEADER_CELL_CLS,k=a.GRID_SUB_HEADER_FILTER_CLS,l=a.GRID_SUB_HEADER_FILTER_CONTAINER_CLS;a.define("Fancy.grid.plugin.Filter",{extend:a.Plugin,ptype:"grid.filter",inWidgetName:"filter",autoEnterDelay:500,constructor:function(){this.Super("const",arguments)},init:function(){this.Super("init",arguments),this.ons()},ons:function(){var a=this,b=a.widget;b.once("render",function(){a.render(),a.waitForComboData&&b.on("load",a.onLoadData,a)}),b.on("columnresize",a.onColumnResize,a),b.on("filter",a.onFilter,a),b.on("lockcolumn",a.onLockColumn,a),b.on("rightlockcolumn",a.onRightLockColumn,a),b.on("unlockcolumn",a.onUnLockColumn,a),b.on("columndrag",a.onColumnDrag,a),b.subHeaderFilter&&(b.on("columnhide",a.onColumnHide,a),b.on("columnshow",a.onColumnShow,a))},render:function(){var a=this,b=a.widget;b.header&&(b.subHeaderFilter?(a._renderSubHeaderFieldsContainer("left"),a._renderSubHeaderFieldsContainer("center"),a._renderSubHeaderFieldsContainer("right"),a.renderedContainers=!0):(a._renderSideFields(b.header,b.columns),a._renderSideFields(b.leftHeader,b.leftColumns),a._renderSideFields(b.rightHeader,b.rightColumns)))},_renderSubHeaderFieldsContainer:function(a){var b,c=this,d=c.widget,e=d.getHeader(a),f=d.cellHeight;if(!c.renderedContainers){switch(b=c.generateFilterRow(a),b.css("height",f),b.firstChild().css("height",f),a){case"left":c.filterElLeft=b;break;case"center":c.filterElCenter=b;break;case"right":c.filterElRight=b}e.el.after(b.dom)}c._renderSubHeaderFields(a)},addSubHeaderFilterCellContainer:function(a){var b=this,c=b.widget,d=c.cellHeight,e=c.getSideEl(a),f=e.select("."+k),g=document.createElement("div");g.className=j,g.style.height=d+"px",f.append(g)},generateFilterRow:function(b){var c=this,d=c.widget,e=d.cellHeight,f=d.getColumnsWidth(b),g=a.get(document.createElement("div")),h="";a.each(d.getColumns(b),function(a,b){var c="";a.hidden&&(c="display: none"),h+=['<div index="'+b+'" style="width:'+a.width+"px;height:"+e+"px;"+c+'" class="'+j+'">',"</div>"].join("")});var i=['<div style="position: relative;" class="'+k+'">',h,"</div>"].join("");return g.update(i),g.select("."+k).css("width",f+"px"),g.addCls(l),g},_renderSideFields:function(a,b){for(var c,g,h=this,i=0,j=b.length;i<j;i++)g=b[i],c=a.getCell(i),g.filter&&g.filter.header?(h.renderFilter(g.type,g,c),h.groupHeader&&!g.grouping&&c.addCls(e),c.addCls(f)):h.header&&(h.groupHeader&&!g.grouping?c.addCls(e):g.grouping&&h.groupHeader?c.addCls(d):g.grouping||c.addCls(d))},_renderSubHeaderFields:function(c){var d,e,g=this,h=g.widget,i=h.getColumns(c),k=g.getSubHeaderFilterEl(c),l=k.select("."+j),m=0,n=i.length;if(0!==l.length)for(;m<n;m++)e=i[m],d=l.item(m),e.filter&&e.filter.header&&(d.select("."+b).each(function(b){a.getWidget(b.id).destroy()}),d.update(""),g.renderFilter(e.type,e,d),d.addCls(f))},_clearColumnsFields:function(c,d,e,f){var g,h,i=this,k=i.widget,l=0,m=c.length;if(k.subHeaderFilter){h=i.getSubHeaderFilterEl(d.side).select("."+j)}for(;l<m;l++)if(g=c[l],g.filter&&g.filter.header){if(e&&g.index!==e)continue;switch(g.type){case"date":var n,o,p;n=k.subHeaderFilter?h.item(l).select("."+b):d.getCell(l).select("."+b),o=a.getWidget(n.item(0).attr("id")),p=a.getWidget(n.item(1).attr("id")),o.clear(),p.clear();break;default:var q;q=k.subHeaderFilter?h.item(l):d.getCell(l);var r=q.select("."+b).attr("id"),s=a.getWidget(r);if(f){var t=s.get().split(",");if(t.length<2&&!f)s.clear();else{for(var u=0,v=t.length,w="";u<v;u++){var x=t[u];new RegExp(f).test(x)||(w+=x+",")}","===w[w.length-1]&&(w=w.substring(0,w.length-1)),s.set(w)}}else s.clear()}}},clearColumnsFields:function(a,b){var c=this,d=c.widget;c._clearColumnsFields(d.columns,d.header,a,b),c._clearColumnsFields(d.leftColumns,d.leftHeader,a,b),c._clearColumnsFields(d.rightColumns,d.rightHeader,a,b)},_addValuesInColumnFields:function(c,d,e,f,g){var h,i,k=this,l=k.widget,m=0,n=c.length;if(l.subHeaderFilter){i=k.getSubHeaderFilterEl(d.side).select("."+j)}for(;m<n;m++)if(h=c[m],h.index===e&&h.filter&&h.filter.header)switch(h.type){case"date":var o;o=l.subHeaderFilter?i.item(m).select("."+b):d.getCell(m).select("."+b);var p=a.getWidget(o.item(0).attr("id")),q=a.getWidget(o.item(1).attr("id"));switch(g){case">":case">=":p.set(new Date(f));break;case"<":case"<=":q.set(new Date(f))}break;case"combo":var r;r=l.subHeaderFilter?i.item(m):d.getCell(m);var s=r.select("."+b).attr("id"),t=a.getWidget(s);a.isArray(f),t.set(f);break;default:var u=l.getFilter(e),v="";for(var w in u){var x=u[w];v+=w,a.isArray(x)?a.each(x,function(a,b){v+=a,x.length-1!==b&&(v+=",")}):v+=x,v+="&"}"&"===v[v.length-1]&&(v=v.substring(0,v.length-1));var r;r=l.subHeaderFilter?i.item(m):d.getCell(m);var s=r.select("."+b).attr("id"),t=a.getWidget(s);t.set(v)}},addValuesInColumnFields:function(b,c,d){var e=this,f=e.widget;void 0!==c&&null!==c&&0!==c.length&&(a.isFunction(c)||(e._addValuesInColumnFields(f.columns,f.header,b,c,d),e._addValuesInColumnFields(f.leftColumns,f.leftHeader,b,c,d),e._addValuesInColumnFields(f.rightColumns,f.rightHeader,b,c,d)))},renderFilter:function(b,c,d){var e,f=this,g=f.widget,h=g.store,i={position:"absolute",bottom:"3px"},j=c.filter,k=g.theme,l=j.tip,m="",n=h.filters[c.index];if(n)if("date"===n.type)m=[n[">="],n["<="]];else for(var o in n){var p=n[o];switch(o){case"":m+=p;break;default:if("combo"===c.type)if(m=m||[],Fancy.isObject(p))for(var q in p)m.push(q);else m.push(p);else m+=o+p+","}}if(","===m[m.length-1]&&(m=m.substring(0,m.length-1)),Fancy.isObject(j.header)){var r=j.header;a.apply(r,{renderTo:d.dom,label:!1,style:i,theme:k,widget:g,tip:l,value:m,padding:!1});var s={combo:"Combo"};"combo"===r.type&&a.apply(r,{width:c.width-8,height:28,multiSelect:c.multiSelect,itemCheckBox:c.itemCheckBox,minListWidth:c.minListWidth,listItemTpl:c.listItemTpl});var t=s[r.type];e=new a[t](r)}else switch(b){case"date":var u=[];u.push({change:f.onDateChange,scope:f}),e=new a.DateRangeField({renderTo:d.dom,format:c.format,label:!1,padding:!1,style:i,events:u,width:c.width-8,emptyText:j.emptyText,dateImage:!1,value:m,theme:k});break;case"string":var u=[{enter:f.onEnter,scope:f}];!1!==f.autoEnterDelay&&u.push({key:f.onKey,scope:f}),e=new a.StringField({renderTo:d.dom,label:!1,padding:!1,style:i,events:u,emptyText:j.emptyText,tip:l,value:m,widget:g});break;case"number":case"grossloss":case"progressbar":case"progressdonut":var u=[{enter:f.onEnter,scope:f}];!1!==f.autoEnterDelay&&u.push({key:f.onKey,scope:f}),e=new a.NumberField({renderTo:d.dom,label:!1,padding:!1,style:i,emptyText:j.emptyText,events:u,widget:g,value:m,tip:l});break;case"combo":var v,w="text",x="text";void 0!==c.displayKey&&(w=c.displayKey,x=w),a.isObject(c.data)||a.isObject(c.data[0])?v=c.data:(v=f.configComboData(c.data),0===v.length&&(c.waitForComboData=!0));var y;c.filter&&c.filter.selectAll&&(y=c.filter.selectAll),e=new a.Combo({renderTo:d.dom,label:!1,padding:!1,style:i,width:c.width-8,displayKey:w,valueKey:x,value:m,height:28,emptyText:j.emptyText,theme:k,widget:g,tip:l,multiSelect:c.multiSelect,itemCheckBox:c.itemCheckBox,minListWidth:c.minListWidth,listItemTpl:c.listItemTpl,selectAllText:y,subSearch:c.subSearch,events:[{change:f.onEnter,scope:f},{empty:function(){this.set(-1)}}],data:v});break;case"select":g.selection&&/row/.test(g.selection.selModel)&&(e=new a.Combo({renderTo:d.dom,label:!1,padding:!1,style:i,displayKey:"text",valueKey:"value",width:c.width-8,emptyText:j.emptyText,value:m,editable:!1,subSearch:!1,events:[{change:f.onEnterSelect,scope:f}],data:[{value:"",text:""},{value:"false",text:g.lang.no},{value:"true",text:g.lang.yes}]}));break;case"checkbox":case"switcher":e=new a.Combo({theme:k,renderTo:d.dom,label:!1,padding:!1,style:i,displayKey:"text",valueKey:"value",width:c.width-8,emptyText:j.emptyText,value:m,editable:!1,subSearch:!1,events:[{change:f.onEnter,scope:f}],data:[{value:"",text:""},{value:"false",text:g.lang.no},{value:"true",text:g.lang.yes}]});break;default:var u=[{enter:f.onEnter,scope:f}];!1!==f.autoEnterDelay&&u.push({key:f.onKey,scope:f}),e=new a.StringField({renderTo:d.dom,label:!1,style:i,padding:!1,value:m,emptyText:j.emptyText,events:u})}switch(e.filterIndex=c.index,e.column=c,"date"!==b&&(e.el.css("padding-left","4px"),e.el.css("padding-top","0px")),b){case"checkbox":case"combo":case"date":break;default:e.setInputSize({width:c.width-8})}c.filterField=e},onEnter:function(b,c){var d=this,e=d.widget;if(clearInterval(d.intervalAutoEnter),delete d.intervalAutoEnter,0===c.length)return void e.clearFilter(b.filterIndex);var f=d.processFilterValue(c,b.column.type);if(e.clearFilter(b.filterIndex,null,!1),1===f.length)e.addFilter(b.filterIndex,f[0].value,f[0].operator,!1);else{var g=[];a.each(f,function(a){switch(a.operator){case"":case"=":g.push(a.value);break;default:e.addFilter(b.filterIndex,a.value,a.operator,!1)}}),g.length&&e.addFilter(b.filterIndex,g,"=",!1)}},onEnterOld:function(b,c,d){var e=this,f=e.widget,g=f.store,h=b.filterIndex;if(d=d||{},clearInterval(e.intervalAutoEnter),delete e.intervalAutoEnter,0===c.length)return g.filters[b.filterIndex]={},e.clearFilter(b.filterIndex,void 0,!1),e.updateStoreFilters(),void(f.grouping&&f.grouping.by&&f.grouping.reGroup());var i=e.processFilterValue(c,b.column.type),j=0,k=i.length;for(g.filters[h]={};j<k;j++){var l=i[j];""===l.operator&&b.column.filter&&b.column.filter.operator&&(l.operator=b.column.filter.operator),"&"===l.separator?a.isArray(g.filters[h][l.operator])?g.filters[h][l.operator].push(l.value):g.filters[h][l.operator]=[l.value]:g.filters[h][l.operator]=l.value,l.operator,"date"===b.column.type&&a.apply(g.filters[h],d)}g.remoteFilter?(g.once("serversuccess",function(){f.fire("filter",g.filters)}),g.serverFilter()):e.updateStoreFilters(),f.grouping&&f.grouping.by&&(g.remoteSort?g.once("load",function(){f.grouping.reGroup(),f.fire("filter",g.filters)}):f.grouping.reGroup()),f.setSidesHeight()},onEnterSelect:function(a,b){var c=this,d=c.widget,e=d.getSelection(),f=[];Fancy.each(e,function(a){f.push(a.id)}),b===String(!0)?f.length?d.addFilter("id",f,"="):(d.clearFilter("id","="),d.clearFilter("id","!=")):b===String(!1)?(d.clearFilter("id","="),d.addFilter("id",f,"!=")):d.clearFilter("id")},processFilterValue:function(b,c){var d,e,f,g,h,i={"<":!0,">":!0,"!":!0,"=":!0,"|":!0},j=0,k=3,l=[];if(a.isArray(b))return e={},a.Array.each(b,function(a){e[String(a).toLocaleLowerCase()]=!0}),l.push({operator:"|",value:e}),l;var m=",";for(/\&/.test(b)&&(m="&"),f=b.split(m),g=0,h=f.length;g<h;g++){for(j=0,d="",e=f[g];j<k;j++)i[e[j]]&&(d+=e[j]);if(e=e.replace(new RegExp("^"+d),""),!(e.length<1)){switch(c){case"number":e=Number(e);break;case"combo":d="=";break;case"date":e=new Date(Number(e))}l.push({operator:d,value:e,separator:m})}}return l},updateStoreFilters:function(a){var b=this,c=b.widget,d=c.store,e=!1;c.filtering=!0;for(var f in d.filters){if(d.filters[f]){e=!0;break}}e||delete d.filteredData,!1!==a?(d.grouping&&d.grouping.by?(d.isFiltered()&&d.filterData(),b.reGroupAccordingToFilters(),d.changeDataView()):d.changeDataView(),!0===c.waitingForFilters||!c.inited&&c.state&&c.state.startState&&c.state.startState.filters||(c.update(),c.fire("filter",d.filters),c.setSidesHeight())):d.changeDataView(),e||(delete d.filteredData,delete d.filteredDataMap,delete d.filterOrder),delete c.filtering},forceUpdateStoreFilters:function(){var a=this,b=a.widget,c=b.store;c.changeDataView(),b.update(),b.fire("filter",c.filters),b.setSidesHeight()},onColumnResize:function(d,e){var f,g=this,h=g.widget,i=a.get(e.cell),k=e.width,l=i.select(":not(."+c+")."+b);if(h.subHeaderFilter){var m=i.attr("index");i=g.getSubHeaderFilterEl(e.side).select("."+j).item(m),l=i.select(":not(."+c+")."+b)}l.length,0===l.length||(2===l.length?(f=a.getWidget(l.item(0).dom.id),f.setWidth((k-8)/2),f=a.getWidget(l.item(1).dom.id),f.setWidth((k-8)/2)):(f=a.getWidget(l.dom.id))&&("field.combo"===f.wtype?(f.size({width:k-8}),f.el.css("width",k-8+5)):f.setInputSize({width:k-8}))),h.subHeaderFilter&&g.updateSubHeaderFilterSizes(e.side)},updateSubHeaderFilterSizes:function(b){var c=this,d=c.widget;if(!b)return c.updateSubHeaderFilterSizes("center"),d.leftColumns.length&&c.updateSubHeaderFilterSizes("left"),void(d.rightColumns.length&&c.updateSubHeaderFilterSizes("right"));var e=c.getSubHeaderFilterEl(b),f=e.select("."+j),g=0,h=d.getColumns(b),i=a.ANIMATE_DURATION;a.each(h,function(a,b){g+=a.width;var c=f.item(b);a.hidden?c.css("display","none"):c.css("display",""),c.animate({width:a.width},i)}),e.firstChild().css({width:g})},removeSubHeaderCell:function(a,b){this.getSubHeaderFilterEl(a).select("."+j).item(b).destroy()},getSubHeaderFilterEl:function(a){switch(a){case"left":return this.filterElLeft;case"center":return this.filterElCenter;case"right":return this.filterElRight}},onKey:function(b,c,d){var e=this;d.keyCode!==a.key.ENTER&&(e.autoEnterTime=+new Date,e.intervalAutoEnter||(e.intervalAutoEnter=setInterval(function(){var a=new Date;e.intervalAutoEnter&&a-e.autoEnterTime>e.autoEnterDelay&&(clearInterval(e.intervalAutoEnter),delete e.intervalAutoEnter,c=b.getValue(),e.onEnter(b,c))},200)))},onDateChange:function(b){var c,d,e,f=this,g=f.widget,h=b.format,i=g.store,j=b.dateField1.getDate(),k=b.dateField2.getDate(),l="Invalid Date"!==j.toString()&&a.isDate(j),m="Invalid Date"!==k.toString()&&a.isDate(k),n=i.remoteFilter;l&&(j=new Date(j.getFullYear(),j.getMonth(),j.getDate())),m&&(k=new Date(k.getFullYear(),k.getMonth(),k.getDate())),l&&m?(!0!==n?(d=Number(j),e=Number(k)):(d=a.Date.format(j,h.edit,h.mode),e=a.Date.format(k,h.edit,h.mode)),c=">="+d+",<="+e):l?(c=!0!==n?">="+Number(j):">="+a.Date.format(j,h.edit,h.mode),f.clearFilter(b.filterIndex,"<=",!1)):m?(c=!0!==n?"<="+Number(k):"<="+a.Date.format(j,h.edit,h.mode),f.clearFilter(b.filterIndex,">=",!1)):f.clearFilter(b.filterIndex),c&&f.onEnter(b,c,{type:"date",format:b.format})},clearFilter:function(a,b,c){var d=this,e=d.widget,f=e.store;f._clearedFilter=!0,setTimeout(function(){delete f._clearedFilter},1),void 0===b?delete f.filters[a]:f.filters[a]&&delete f.filters[a][b],!1!==c&&d.updateStoreFilters()},onFilter:function(a,b){var c=this,d=c.widget;if(d.scroll(0),d.header&&b){d.el.select("."+i).removeCls(i);for(var e in b){var f=d.getHeaderCell(e);f&&f.addCls(i)}}},configComboData:function(b){var c=this,d=0,e=b.length,f=[];if(a.isObject(b))return b;for(;d<e;d++)f.push({value:d,text:b[d]});return 0===f.length&&(c.waitForComboData=!0),f},destroyFields:function(){var b=this,c=b.widget;a.each(c.columns,function(a){a.filterField&&(a.filterField.destroy(),delete a.filterField)}),a.each(c.leftColumns,function(a){a.filterField&&(a.filterField.destroy(),delete a.filterField)}),a.each(c.rightColumns,function(a){a.filterField&&(a.filterField.destroy(),delete a.filterField)}),c.el.select("."+f).removeCls(f),c.el.select("."+g).removeCls(g),c.el.select("."+h).removeCls(h),c.el.select("."+d).removeCls(d),c.el.select("."+e).removeCls(e)},onLockColumn:function(){},onUnLockColumn:function(){},onRightLockColumn:function(){},onColumnDrag:function(){var a=this,b=a.widget;a.updateFields(),b.subHeaderFilter&&a.updateSubHeaderFilterSizes()},updateFields:function(){var a=this;a.destroyFields(),a.render()},reGroupAccordingToFilters:function(){var a=this,b=a.widget,c=b.grouping;c.initGroups("filteredData"),c.initOrder(),c.reFreshExpanded(),c.updateGroupRows(),c.setCellsPosition(),c.reFreshGroupTexts()},scrollLeft:function(a){this.filterElCenter&&this.filterElCenter.firstChild().css("left",a)},onColumnHide:function(){this.updateSubHeaderFilterSizes()},onColumnShow:function(){this.updateSubHeaderFilterSizes()},onLoadData:function(){this.updateFilterComboData()},updateFilterComboData:function(){var b=this,c=b.widget,d=c.store,e=c.getColumns();a.each(e,function(a){if("combo"===a.type&&a.index&&a.waitForComboData){var b=d.getColumnUniqueData(a.index);c.setColumnComboData(a.index,b)}})}})}(),Fancy.define("Fancy.grid.plugin.Search",{extend:Fancy.Plugin,ptype:"grid.search",inWidgetName:"searching",autoEnterDelay:500,constructor:function(){this.searches={},this.Super("const",arguments)},init:function(){this.Super("init",arguments),this.ons()},ons:function(){var a=this;a.widget.once("init",function(){a.generateKeys()})},search:function(a,b){var c=this,d=c.widget,e=d.store;if(c.searches={},!a&&!b)return c.clear(),c.updateStoreSearches(),void(d.isGroupable()&&d.grouping.reGroup());!1!==Fancy.isArray(a)||b||(c.searches=a),c.setFilters(),e.remoteSort?e.serverFilter():(c.updateStoreSearches(),setTimeout(function(){d.fire("filter",e.filters)},1)),d.isGroupable()&&(e.remoteSort?e.once("load",function(){d.grouping.reGroup()}):d.grouping.reGroup())},updateStoreSearches:function(){var a=this.widget;a.store.changeDataView(),a.update()},setKeys:function(a){var b=this;b.keys=a,b.setFilters(),b.updateStoreSearches()},generateKeys:function(){var a=this,b=a.widget;if(a.items)a.keys={},Fancy.each(a.items,function(b){a.keys[b.index]=!0});else if(!a.keys){a.keys={};var c=[];b.columns&&(c=c.concat(b.columns)),b.leftColumns&&(c=c.concat(b.leftColumns)),b.rightColumns&&(c=c.concat(b.rightColumns));var d=[];Fancy.each(c,function(a){var b=a.index;if(!1!==a.searchable){switch(a.type){case"color":case"combo":case"date":case"number":case"string":case"text":case"currency":break;default:return}b&&d.push(b)}}),Fancy.each(d,function(b){"$selected"!==b&&(a.keys[b]=!0)})}return a.keys},setFilters:function(){var a=this,b=a.widget,c=b.store,d=c.filters||{};if(void 0===a.searches||Fancy.isObject(a.searches))return void a.clear();for(var e in a.keys)!1!==a.keys[e]?(d[e]=d[e]||{},d[e]["*"]=a.searches):d[e]&&delete d[e]["*"];c.filters=d},clear:function(){var a=this,b=a.widget,c=b.store,d=c.filters||{};for(var e in a.keys)void 0!==d[e]&&delete d[e]["*"];c.filters=d,delete a.searches,b.state&&b.state.onFilter()},clearBarField:function(){var a=this,b=a.getSearchField("tbar");b&&b.clear(),(b=a.getSearchField("subTBar"))&&b.clear()},setValueInField:function(a){var b=this,c=b.getSearchField("tbar");c&&c.set(a,!1),(c=b.getSearchField("subTBar"))&&c.set(a,!1)},getSearchField:function(a){for(var b,c=this,d=c.widget,e=d[a],f=0,g=(e||[]).length;f<g;f++)if(b=e[f],"search"===b.type)return b;return b}});