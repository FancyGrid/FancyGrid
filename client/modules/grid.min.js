Fancy.modules.grid=!0,Fancy.Mixin("Fancy.grid.mixin.PrepareConfig",{prepareConfig(e,t){const i=this;return e._plugins=e._plugins||[],e.renderOuter&&(e.renderTo=e.renderOuter),e=i.generateColumnsFromData(e,t),e=i.copyColumns(e,t),e=i.prepareConfigScroll(e,t),e=i.prepareConfigData(e,t),e=i.prepareConfigTheme(e,t),e=i.prepareConfigLang(e,t),e=i.prepareConfigSpark(e,t),e=i.prepareConfigPaging(e,t),e=i.prepareConfigInfinite(e,t),e=i.prepareConfigBars(e),e=i.prepareConfigTBar(e),e=i.prepareConfigSubTBar(e),e=i.prepareConfigExpander(e),e=i.prepareConfigColumnMinMaxWidth(e),e=i.prepareConfigGrouping(e),e=i.prepareConfigGroupHeader(e),e=i.prepareConfigSorting(e),e=i.prepareConfigEdit(e),e=i.prepareConfigSelection(e),e=i.prepareConfigLoadMask(e,t),e=i.prepareConfigDefaults(e),e=i.prepareConfigFilter(e,t),e=i.prepareConfigSearch(e),e=i.prepareConfigSummary(e),e=i.prepareConfigState(e,t),e=i.prepareConfigExporter(e),e=i.prepareConfigSmartIndex(e),e=i.prepareConfigActionColumn(e),e=i.prepareConfigWidgetColumn(e),e=i.prepareConfigChart(e,t),e=i.prepareConfigCellTip(e),e=i.prepareConfigHeaderCellTip(e),e=i.prepareConfigColumnsWidth(e),e=i.prepareConfigSize(e,t),e=i.prepareConfigContextMenu(e,t),e=i.prepareConfigColumns(e),e=i.prepareConfigColumnsResizer(e),e=i.prepareConfigFooter(e),e=i.prepareConfigDD(e)},copyColumns:(e,t)=>(e.columns&&(e.columns=Fancy.Array.copy(e.columns,!0)),t.columns&&(t.columns=Fancy.Array.copy(t.columns)),e),generateColumnsFromData(e,t){if(!e.columns&&e.data&&e.data.length&&Fancy.isArray(e.data[0])){const i=e.data[0]||e.data[0],l=[],s=[];Fancy.each(i,(e,t)=>{l.push({index:"autoIndex"+t}),s.push("autoIndex"+t)}),e.columns=l,e.data={items:e.data,fields:s},t.data=e.data}return e},prepareConfigScroll:(e,t)=>(Fancy.isIE&&!1!==t.nativeScroller&&(e.nativeScroller=!0),e),prepareConfigSpark(e){const t=this;return Fancy.each(e.columns,i=>{const l=i.sparkConfig;if(l&&l.legend)switch(l.legend.type){case"tbar":case"bbar":case"buttons":var s=l.legend.type,r=i.index;e[s]=e[s]||[],e[s]=e[s].concat(t._generateLegendBar(l.title,r,l.legend.style,i))}}),e},_generateLegendBar(e,t,i,l){var s=0,r=e.length,o=[],n=this;const a={length:0},d=function(t){var i,l=n;Fancy.each(n.columns,(e,t)=>{e.index===n.columns[t].index&&(i=t)}),(t.hasCls("fancy-legend-item-disabled")||e.length-1!==a.length)&&(t.toggleCls("fancy-legend-item-disabled"),t.hasCls("fancy-legend-item-disabled")?(a[t.index]=!0,l.disableLegend(i,t.index),a.length++):(l.enableLegend(i,t.index),delete a[t.index],a.length--))};for(;s<r;s++){var c=t[s];Fancy.isString(l.index)&&(c=l.index+"."+s);const r={handler:d,index:c,imageColor:Fancy.COLORS[s],text:e[s]};0===s&&i&&(r.style=i),o.push(r)}return o},prepareConfigData(e){if(e.data||(e.data=[]),Fancy.isArray(e.data)&&0===e.data.length&&e.columns){const t=[],i={};Fancy.each(e.columns,e=>{if(e.index)if(/\./.test(e.index)){var l=e.index.split(".");i[l[0]]||(t.push(l[0]),i[l[0]]=!0)}else t.push(e.index||e.key);e.columns&&Fancy.each(e.columns,e=>{e.index&&t.push(e.index||e.key)})}),e.data={fields:t,items:[]}}return e},prepareConfigLoadMask(e){var t,i=!1!==e.loadMask;return Fancy.isString(e.loadMask)&&(t=e.loadMask),e._plugins.push({type:"grid.loadmask",showOnWaitingServer:i,loadText:t}),e},reConfigStore(e){const t=this.store,i=this.getFieldsFromData(e),l="Fancy.model."+Fancy.id();Fancy.define(l,{extend:Fancy.Model,fields:i}),this.model=l,t.model=l,this.fields=i,t.fields=i,t.setModel()},prepareConfigDefaults:e=>(e.defaults=e.defaults||{},void 0===e.defaults.type&&(e.defaults.type="string"),Fancy.each(e.defaults,(t,i)=>{Fancy.each(e.columns,t=>{switch(t.type){case"select":case"order":case"expand":case"rowdrag":return}void 0===t[i]&&(t[i]=e.defaults[i]),"width"===i&&t.flex&&delete t.width})}),e),prepareConfigColumnMinMaxWidth:e=>(Fancy.each(e.columns,e=>{void 0===e.width&&!e.flex&&e.minWidth&&(e.width=e.minWidth)}),e),prepareConfigCellTip:e=>(Fancy.each(e.columns,t=>{if(t.cellTip)return e._plugins.push({type:"grid.celltip"}),!0}),e),prepareConfigHeaderCellTip:e=>(Fancy.each(e.columns,t=>{if(t.headerCellTip)return e._plugins.push({type:"grid.headercelltip"}),!0}),e),prepareConfigDD(e){if(e.gridToGrid){var t={type:"grid.dragdrop"};Fancy.apply(t,e.gridToGrid),e._plugins.push(t)}if(e.rowDragDrop||e.droppable){t={type:"grid.rowdragdrop"};Fancy.apply(t,e.rowDragDrop),e._plugins.push(t)}return e},prepareConfigColumns(e,t){for(var i=e.columns,l=[],s=[],r=0,o=i.length,n=!1,a=!1,d=!1;r<o;r++){const c=i[r];if(c.draggable&&(n=!0),"tree"===c.type&&(a=!0),"rowdrag"!==c.type&&!c.rowdrag||e.rowDragDrop||(e.rowDragDrop=!0),c.headerCheckBox&&!0!==c.sortable&&(c.sortable=!1),c.autoHeight&&(d=!0),c.select&&(this.checkboxRowSelection=!0,this.multiSelect=!0,0),!1!==t&&void 0===c.id&&(c.index?c.id=this.getColumnId(c.index):c.id=Fancy.id(null,"col-id-")),!c.title&&c.index&&!Fancy.isArray(c.index))switch(c.type){case"string":case"number":case"currency":case"date":case"combo":case"checkbox":case"text":c.title=Fancy.String.upFirstChar(c.index)}switch(c.type){case"select":this.checkboxRowSelection=!0,this.multiSelect=!0,i[r].index="$selected",i[r].editable=!0,0;break;case"order":i[r].editable=!1,i[r].sortable=!1,i[r].index="$order",i[r].cellAlign="right",0;break;case"rowdrag":i[r].editable=!1,i[r].sortable=!1,i[r].resizable=!1,i[r].width=30,i[r].index="$rowdrag",0;break;case"checkbox":void 0===c.cellAlign&&(c.cellAlign="center");break;case"currency":void 0===c.format&&(c.format="number"),!1!==c.ellipsis&&(c.ellipsis=!0),c.editFormat||(c.editFormat="currency"),c.beforeSaveFormat||(c.beforeSaveFormat="currency");break;case"string":case"number":case"text":case"date":case"combo":case"tree":!1!==c.ellipsis&&(c.ellipsis=!0)}!1!==t&&(c.locked?(l.push(c),i.splice(r,1),r--,o--):c.rightLocked&&(s.push(c),i.splice(r,1),r--,o--))}if(!1===t)return e;if(d&&e._plugins.push({type:"grid.rowheight"}),n&&e._plugins.push({type:"grid.columndrag"}),a){var c={type:"grid.tree"};e.singleExpand&&(c.singleExpand=e.singleExpand),e._plugins.push(c),e.isTreeData=!0}return e.leftColumns=l,e.rightColumns=s,e},prepareConfigColumnsWidth(e){var t,i=this,l=e.columns,s=e.width,r=[],o=[],n=100,a=0,d=!1,c=!1,h=!1,g=Fancy.get(e.renderTo||document.body);if((e.width<1||void 0===e.width)&&"body"!==g.prop("tagName").toLocaleLowerCase()&&(h=g.closest(".tab-pane"))&&h.css({display:"block",visibility:"hidden"}),void 0!==s&&"fit"!==s||(s=Fancy.get(e.renderTo||document.body).width()),s-=2*e.panelBorderWidth,!1!==e.flexScrollSensitive)s-=e.bottomScrollHeight;else{var u=this.theme;Fancy.isString(e.theme)?u=e.theme:Fancy.isObject(e.theme)&&e.theme.name&&(u=e.theme.name),"bootstrap-no-borders"!==u&&(s-=1)}Fancy.each(l,(t,l)=>{switch(t.autoWidth&&(e.autoColumnWidth=!0),t.flex&&(e.hasFlexColumns=!0),t.type){case"select":void 0===t.width&&(t.width=35);break;case"order":void 0===t.width&&(t.width=40);break;case"rowdrag":void 0===t.width&&(t.width=30);break;case"expand":void 0===t.width&&(t.width=38);break;case"combo":t.data||(t.data=[],setTimeout(()=>{i.on("init",()=>{const e=i.store.getColumnUniqueData(t.index);i.setColumnComboData(t.index,e)})},1))}t.locked&&(d=!0),t.rightLocked&&(c=!0),t.hidden?void 0===t.width&&(t.width=100):void 0===t.width?(t.flex&&(a+=t.flex,o.push(l)),r.push(l)):Fancy.isNumber(t.width)&&(s-=t.width)}),e.hasFlexColumns&&e._plugins.push({type:"grid.columnresizer"}),d&&c&&(s-=2);var p=parseInt(s/r.length);p<50&&(p=50),p>100&&(n=100),p<50&&(n=50);var m=!1,f=s;if(Fancy.each(r,e=>{void 0===(t=l[e]).flex&&(f-=n)}),a){const e=parseInt(f/a);Fancy.each(o,t=>{f-=e*l[t].flex})}return f<0&&(m=!0),Fancy.each(r,e=>{void 0===(t=l[e]).flex&&(t.width=n,s-=n)}),a&&(Fancy.each(o,e=>{(t=l[e]).width=m?n*t.flex:s/a*t.flex,t.width=parseInt(t.width),t.minWidth&&t.width<t.minWidth&&(t.width=t.minWidth)}),f>=1&&Fancy.each(o,e=>{if(f<1)return!0;(t=l[e]).width+=1,f-=1})),h&&h.css({display:"",visibility:""}),e},prepareConfigActionRender:e=>(function(t){return Fancy.each(e.items,e=>{const i=e.text||"",l=Fancy.styleToString(e.style),s=e.cls||"";t.value+=['<div class="fancy-grid-column-action-item '+s+'" style="'+l+'">',i,"</div>"].join(" "),e.render&&(t=e.render(t))}),t}),prepareConfigSmartIndex:e=>(Fancy.each(e.columns,e=>{if(/\+|\-|\/|\*|\[|\./.test(e.index)){var t=e.index;switch(t){case"xAxis.categories":case"yAxis.categories":case"zAxis.categories":return}t="return "+(t=t.replace(/(\w+)/g,function(e,t,i,l){return"."===l[i-1]?t:isNaN(Number(t))?"data."+t:t}))+";",e.smartIndexFn=new Function("data",t)}}),e),prepareConfigActionColumn(e){for(var t=this,i=e.columns,l=0,s=i.length;l<s;l++){const e=i[l];if("action"===e.type){e.sortable=!1,e.editable=!1,e.render=t.prepareConfigActionRender(e);var r=e.items;if(void 0!==r&&0!==r.length)for(var o,n=0,a=r.length;n<a;n++)switch((o=r[n]).action){case"remove":void 0===o.handler&&(o.handler=function(e,t){e.remove(t)});break;case"dialog":!function(e){if(void 0===e.handler){for(var l=[],s=0,r=i.length,o=87;s<r;s++){const e=i[s];switch(e.type){case"action":continue}l.push({label:e.title||"",type:e.type,name:e.index}),o+=38}e.handler=function(i,s){e.dialog?(e.dialog.show(),e.dialog.set(s.data)):e.dialog=new FancyForm({window:!0,draggable:!0,modal:!0,title:{text:"Edit",tools:[{text:"Close",handler(){this.hide()}}]},width:300,height:o,items:l,buttons:["side",{text:"Clear",handler(){this.clear()}},{text:"Save",handler(){const e=this.get();e.id&&(t.getById(e.id).set(e),t.update())}}],events:[{init(){this.show(),this.set(s.data)}}]})}}}(o)}}}return e},prepareConfigWidgetColumn(e){for(var t=this,i=e.columns,l=0,s=i.length;l<s;l++){const e=i[l];e.widget&&(e.render=function(e){var i,l=e.cell.select("."+Fancy.FIELD_CLS),s=e.cell.dom;const r={vtype:(o=e.column).vtype,style:{padding:"0px","margin-top":"-10px","margin-left":"-1px"},label:!1,renderTo:s,value:e.value,emptyText:o.emptyText};if(l.length)(i=Fancy.getWidget(l.dom.id)).get()!=e.value&&i.set(e.value);else{var o,n=e.column.width,a=(o=e.column).index;switch(e.column.type){case"number":case"currency":Fancy.apply(r,{spin:o.spin,min:o.min,max:o.max,events:[{change(i,l){t.set(e.rowIndex,a,l),t.updater.updateRow()}}]}),i=new Fancy.NumberField(r);break;case"string":case"image":Fancy.apply(r,{events:[{change(i,l){t.set(e.rowIndex,a,l),t.updater.updateRow()}}]}),i=new Fancy.StringField(r);break;case"combo":Fancy.apply(r,{displayKey:e.column.displayKey,valueKey:e.column.displayKey,padding:!1,checkValidOnTyping:!0,data:e.column.data,events:[{change(i,l){t.set(e.rowIndex,a,l),t.updater.updateRow()}}]}),i=new Fancy.Combo(r)}switch(e.column.type){case"number":case"string":case"currency":case"image":i.setInputSize({width:n+1,height:33});break;case"combo":i.size({width:n+1,height:33})}}return e})}return e},prepareConfigSorting:e=>(e.defaults||{}).sortable?(e._plugins.push({type:"grid.sorter"}),e):(Fancy.each(e.columns,function(t){t.sortable&&e._plugins.push({type:"grid.sorter"})}),e),prepareConfigSelection(e){var t=!1,i={type:"grid.selection"},l=!1;if((e.trackOver||e.columnTrackOver||e.cellTrackOver)&&(t=!0),e.selModel){t=!0;var s=!1,r=!1,o=!1,n=!0,a=!1,d=!0,c=!1,h=!1,g=!1,u=!1,p=!1,m=!1,f=!1;if(Fancy.isObject(e.selModel)){s=!!e.selModel.checkOnly,f=!!e.selModel.activeCell,("cell"===e.selModel.type||"cells"===e.selModel.type||f)&&(e.selModel.selectBottomCellAfterEdit&&(c=!0),e.selModel.selectRightCellOnEnd&&(h=!0),e.selModel.selectLeftCellOnLeftEnd&&(g=!0),e.selModel.selectUpCellOnUp&&(u=!0),e.selModel.selectBottomCellOnDown&&(p=!0),e.selModel.continueEditOnEnter&&(m=e.selModel.continueEditOnEnter));var C=!1,y=!1;if(Fancy.each(e.columns,e=>{"tree"===e.type&&(C=!0),e.select&&(y=!0),"select"===e.type&&(y=!0)}),C&&y&&(s=!0),!e.selModel.type)throw new Error("[FancyGrid Error 5]: Type for selection is not set");void 0!==e.selModel.mouseMoveSelection&&(d=e.selModel.mouseMoveSelection),r=!0===e.selModel.memory,e.selModel.disabled&&(l=!0),e.selModel.selectLeafsOnly&&(o=!0),void 0!==e.selModel.allowDeselect&&(a=!0),void 0!==e.selModel.keyNavigation&&(n=e.selModel.keyNavigation),e.selModel=e.selModel.type}"rows"===e.selModel&&(e.multiSelect=!0),e.selection=e.selection||{},e.selection.selModel=e.selModel,e.selection[e.selModel]=!0,e.selection.checkOnly=s,e.selection.memory=r,e.selection.memoryPerformance=!0,e.selection.disabled=l,e.selection.selectLeafsOnly=o,e.selection.keyNavigation=n,e.selection.allowDeselect=a,e.selection.mouseMoveSelection=d,e.selection.selectBottomCellAfterEdit=c,e.selection.selectRightCellOnEnd=h,e.selection.selectLeftCellOnLeftEnd=g,e.selection.selectUpCellOnUp=u,e.selection.selectBottomCellOnDown=p,e.selection.continueEditOnEnter=m,e.selection.activeCell=f}return e.selection&&(t=!0,Fancy.isObject(e.selection)&&Fancy.apply(i,e.selection)),!0===t&&e._plugins.push(i),e},prepareConfigEdit(e){var t={type:"grid.edit"},i=!1,l=(e.defaults||{}).editable;return void 0!==e.clicksToEdit&&(t.clicksToEdit=e.clicksToEdit),l&&(i||e._plugins.push(t),e._plugins.push({type:"grid.celledit"}),i=!0),e.rowEdit&&e._plugins.push({type:"grid.rowedit"}),Fancy.each(e.columns,l=>{switch(void 0===l.index&&void 0===l.key&&(l.editable=!1),l.type){case"image":l.sortable=!1;break;case"sparklineline":case"sparklinebar":case"sparklinetristate":case"sparklinediscrete":case"sparklinebullet":case"sparklinepie":case"sparklinebox":l.editable=!1,l.sortable=!1}l.editable&&!1===i&&(e._plugins.push(t),e._plugins.push({type:"grid.celledit"}))}),e},prepareConfigExpander(e){if(e.expander){const t=e.expander;Fancy.apply(t,{type:"grid.expander"}),e.expanded={},e.grouping&&(t.expanded=!1),e._plugins.push(t)}return e},prepareConfigGrouping(e){if(e.grouping){var t=e.grouping;!0===t&&(t={}),Fancy.apply(t,{type:"grid.grouping"}),e.expanded={},e._plugins.push(t)}return e},prepareConfigSummary(e){if(e.summary){var t=e.summary;!0===t&&(t={}),Fancy.apply(t,{type:"grid.summary"}),e._plugins.push(t)}return e},prepareConfigContextMenu(e){if(e.contextmenu){var t=e.contextmenu;Fancy.isArray(e.contextmenu)&&Fancy.each(e.contextmenu,function(t){"export"===t&&(e.exporter=!0)}),!0===t&&(t={}),Fancy.isArray(t)&&(t={items:t}),Fancy.apply(t,{type:"grid.contextmenu"}),e._plugins.push(t)}return e},prepareConfigExporter(e){if(e.exporter){var t=e.exporter;!0===t&&(t={}),Fancy.apply(t,{type:"grid.exporter"}),e._plugins.push(t)}return e},prepareConfigFilter(e){var t=e.columns,i=!1,l=!1,s=!1,r={type:"grid.filter"};return e.filter&&(!0===e.filter&&(i=!0,e.filter={}),Fancy.apply(r,e.filter)),Fancy.each(t,e=>{e.filter&&(i=!0,e.filter.header&&(l=!0,e.grouping&&(s=!0)))}),r.header=l,r.groupHeader=s,i&&(e._plugins.push(r),e.filterable=!0),e},prepareConfigSearch(e){var t={type:"grid.search"},i=!1;return e.searching&&(i=!0,Fancy.apply(t,e.searching)),i&&e._plugins.push(t),e},prepareConfigGroupHeader(e){var t=e.columns,i=0,l=t.length,s=[],r=!1,o=[];if(t.forEach(e=>{e.columns&&(r=!0,s.push(e))}),r){for(i=0;i<l;i++){var n=t[i];if(n.columns){for(var a=0,d=n.columns.length,c=n.text||n.title||"  ";a<d;a++)n.locked&&(n.columns[a].locked=!0),n.rightLocked&&(n.columns[a].rightLocked=!0),n.columns[a].grouping=c,n.defaults&&(Fancy.applyIf(n.columns[a],n.defaults),n.defaults.width&&n.columns[a].flex&&delete n.columns[a].width);o=o.concat(n.columns)}else o=o.concat(t.slice(i,i+1))}const r={};Fancy.each(s,e=>{r[e.title||e.text||""]=e}),e.columns=o,e._plugins.push({type:"grid.groupheader",groups:s,groupsMap:r}),e.isGroupedHeader=!0}return e},prepareConfigPaging(e,t){var i=e.lang,l=e.paging,s="bbar",r="last";if(!l)return e;if(void 0!==l.barType)switch(l.barType){case"bbar":case"tbar":case"both":s=l.barType;break;case!1:case"none":s="none";break;default:throw new Error("[FancyGrid Error]: - not supported bar type for paging")}return l.pageOverFlowType&&(r=l.pageOverFlowType),e._plugins.push({i18n:t.i18n,type:"grid.paging",barType:s,pageOverFlowType:r}),"both"===s?(e.tbar=this.generatePagingBar(l,i),e.bbar=this.generatePagingBar(l,i)):"none"===s||(e[s]=this.generatePagingBar(l,i)),e},prepareConfigInfinite:e=>e.infinite?(e.nativeScroller=!1,e._plugins.push({type:"grid.infinite"}),e):e,generatePagingBar(e,t){var i=this,l=[],s="fancy-bar-button-disabled",r="material"===i.theme?8:3,o={float:"left","margin-right":"5px","margin-top":r+"px"};if(l.push({imageCls:"fancy-paging-first",disabledCls:s,role:"first",handler:function(){i.paging.firstPage()},style:{float:"left","margin-left":"5px","margin-right":"5px","margin-top":r+"px"}}),l.push({imageCls:"fancy-paging-prev",disabledCls:s,role:"prev",handler:function(){i.paging.prevPage()},style:o}),l.push("|"),l.push({type:"text",text:t.paging.page}),l.push({type:"number",label:!1,padding:!1,style:{float:"left","margin-left":"-1px","margin-right":"8px","margin-top":r+1+"px"},role:"pagenumber",min:1,width:e.inputWidth||30,listeners:[{enter(e){0===parseInt(e.getValue())&&e.set(1);var t=parseInt(e.getValue())-1,l=i.paging.setPage(t);t!==l&&e.set(l)}},{up(e,t){var l=i.store.pages;(t=Number(t)+1)>l&&(t=l),e.set(t)}},{down(e,t){i.store.pages;(t=Number(t)-1)<1&&(t=1),e.set(t)}}]}),l.push({type:"text",text:"",role:"ofText"}),l.push("|"),l.push({imageCls:"fancy-paging-next",disabledCls:s,role:"next",style:o,handler(){i.paging.nextPage()}}),l.push({imageCls:"fancy-paging-last",disabledCls:s,role:"last",style:o,handler(){i.paging.lastPage()}}),Fancy.isObject(e)&&!0===e.refreshButton&&(l.push("|"),l.push({imageCls:"fancy-paging-refresh",disabledCls:s,role:"refresh",style:o,handler(){i.paging.refresh()}})),e&&Fancy.isArray(e.pageSizeData)){for(var n=e.pageSizeData,a=[],d=0,c=n.length,h=0;d<c;d++)a.push({index:d,value:n[d]}),e.pageSize===n[d]&&(h=d);var g=Fancy.Object.copy(o);g["margin-top"]=r+1+"px",l.push({editable:!1,width:50,type:"combo",role:"size",style:g,data:a,displayKey:"value",valueKey:"index",value:h,subSearch:!1,events:[{change(e,t){i.scroll(0,0),i.paging.setPageSize(n[t])}},{render:function(e){i.store.on("changepages",()=>{var t;i.store.pageSize!==Number(e.input.dom.value)&&(Fancy.each(e.data,e=>{if(e.value===i.store.pageSize)return t=e.index,!0}),void 0!==t&&e.setValue(t,!1))})}}]})}return l.push("side"),l.push({type:"text",role:"info",text:""}),l},prepareConfigState(e){const t=this;if(e.stateful){var i={};Fancy.isObject(e.stateful)&&(i=e.stateful);const o=e.state||{};var l=e.stateId||this.getStateName(),s=localStorage.getItem(l);if(s||(t.memoryInitialColumns(l,e.columns),e.defaults&&t.memoryInitialDefaults(l,e.defaults)),s&&(t.wasColumnsCodeChanged(l,e.columns)||t.wasDefaultChanged(l,e.defaults))&&(localStorage.clear(l),localStorage.clear(l+"memory-columns"),s=null,t.memoryInitialColumns(l,e.columns),e.defaults&&t.memoryInitialDefaults(l,e.defaults)),s){for(var r in s=JSON.parse(s))Fancy.isString(s[r])&&(s[r]=JSON.parse(s[r]));const t=s.columns;for(var r in t&&(Fancy.each(t,t=>{Fancy.each(t,(i,l)=>{if("FUNCTION"===i||"OBJECT"===i||"ARRAY"===i){var s=t.index;Fancy.each(e.columns,e=>{if(e.index===s)return t[l]=e[l],!0})}})}),e.columns=t),s)"columns"!==r&&void 0===o[r]&&(o[r]=s[r])}e._plugins.push({type:"grid.state",stateful:!0,startState:o,log:i})}else e.state&&e._plugins.push({type:"grid.state",startState:e.state});return e},prepareConfigColumnsResizer(e){if((e.defaults||{}).resizable)return e._plugins.push({type:"grid.columnresizer"}),e;var t=[].concat(e.columns).concat(e.leftColumns).concat(e.rightColumns);return Fancy.each(t,t=>{if(t.resizable||t.autoWidth)return e._plugins.push({type:"grid.columnresizer"}),!0}),e},prepareConfigBars(e){const t=function(t){for(var i=0,l=t.length;i<l;i++)switch(t[i].type){case"date":if(!t[i].format){var s=e.lang.date;t[i].format={read:s.read,write:s.write,edit:s.edit}}e.i18n&&(t[i].i18n=e.i18n)}};return t(e.tbar||[]),t(e.subTBar||[]),t(e.bbar||[]),t(e.buttons||[]),e},prepareConfigTBar(e){const t=this,i=e.tbar;if(i)for(var l=0,s=i.length;l<s;l++){switch(i[l].type){case"columns":i[l].text=i[l].text||"Columns",i[l].type="button",i[l].menuIcon=!1;var r=[];Fancy.each(e.columns,e=>{e.title&&r.push({text:e.title,index:e.index,column:e,checked:!e.hidden,handler(i,l){!0!==l.checked||l.checkbox.get()||l.checkbox.set(!0),l.checked&&1===i.el.select(".fancy-checkbox-on").length?l.checkbox.set(!0):(l.checked=!l.checked,l.checkbox.set(l.checked),l.checked?t.showColumn(t.side,l.index,e):t.hideColumn(t.side,l.index,e),t.responsive&&t.onWindowResize())}})}),i[l].menu=r;break;case"search":e.searching=e.searching||{},e.filter=e.filter||!0;break;case"date":e.i18n&&(i[l].i18n=e.i18n)}switch(i[l].action){case"add":void 0===i[l].handler&&(i[l].handler=function(){t.insert(0,{}),t.scroll(0)});break;case"undo":void 0===i[l].handler&&(i[l].handler=function(){t.undo()});break;case"undoall":void 0===i[l].handler&&(i[l].handler=function(){t.undoAll()});break;case"redo":void 0===i[l].handler&&(i[l].handler=function(){t.redo()});break;case"remove":void 0===i[l].handler&&(i[l].disabled=!0,i[l].handler=function(){Fancy.each(t.getSelection(),function(e){t.remove(e)}),t.selection.clearSelection()},i[l].events=[{render:function(){const e=this;setTimeout(()=>{const t=Fancy.getWidget(e.el.parent().parent().parent().select("."+Fancy.GRID_CLS).dom.id);t.on("select",()=>{0===t.getSelection().length?e.disable():e.enable()}),t.on("clearselect",()=>{e.disable()})},10)}}])}}return e},prepareConfigSubTBar(e){const t=e.subTBar;if(t)for(var i=0,l=t.length;i<l;i++)switch(t[i].type){case"search":e.searching=e.searching||{},e.filter=e.filter||!0}return e},prepareConfigChart(e){var t=e.data,i=t.chart;return Fancy.isObject(i)&&(i=[i]),t&&t.chart&&(e._plugins.push({type:"grid.chartintegration",chart:i,toChart:!!t.items||!!t.proxy}),Fancy.each(i,function(t){var i=t.type;switch(i){case"highchart":case"highcharts":e._plugins.push({type:"grid.highchart"});break;case void 0:throw new Error("[FancyGrid Error] - type of chart is undefined");default:throw new Error("[FancyGrid Error] - type of chart "+i+" does not exist")}})),e},prepareConfigSize(e){var t,i,l,s=this,r=e.renderTo,o=!!(e.title||e.subTitle||e.tbar||e.bbar||e.buttons||e.panel),n=e.panelBodyBorders,a=e.gridWithoutPanelBorders,d=e.gridBorders;if(void 0===e.width){if(r){if(e.responsive=!0,e.responsiveWidth=!0,i=Fancy.get(r),e.width=parseInt(i.width()),e.width<1&&"body"!==i.prop("tagName").toLocaleLowerCase()){const t=i.closest(".tab-pane");t?(t.css({display:"block",visibility:"hidden"}),e.width=parseInt(i.width()),t.css({display:"",visibility:""})):e.width=i.parent().width()}0===e.width&&(e.width=parseInt(i.parent().width()))}}else if("fit"===e.width){var c=0,h=!1;this.fitWidth=!0,Fancy.each(e.columns,e=>{e.hidden||(c+=e.width),e.locked&&(h=!0)}),e.title||e.subTitle?c+=n[1]+n[3]+d[1]+d[3]:c+=a[1]+a[3]+d[1]+d[3],h&&c--,e.width=c}if(void 0===e.height)r&&(e.responsiveHeight=!0,(l=parseInt(i.height()))<50&&(l=parseInt(i.parent().css("height"))),e.height=l);else if("fit"===e.height){var g=1;t=0,Fancy.each(e.columns,e=>{e.grouping&&(g<2&&(g=2),e.filter&&e.filter.header&&g<3&&(g=3)),e.filter&&e.filter.header&&g<2&&(g=2)}),Fancy.isArray(e.data)?t=e.data.length:e.data&&Fancy.isArray(e.data.items)&&(t=e.data.items.length),l=t*e.cellHeight,e.title&&(l+=e.titleHeight),e.tbar&&(l+=e.tbarHeight||e.barHeight),e.tabs&&(l+=e.barHeight),e.bbar&&(l+=s.bbarHeight||e.barHeight),e.buttons&&(l+=e.buttonsHeight||e.barHeight),e.subTBar&&(l+=e.subTBarHeight||e.barHeight),e.footer&&(l+=e.barHeight),!1!==e.header&&(l+=e.cellHeaderHeight*g),l+=o?n[0]+n[2]+d[0]+d[2]:a[0]+a[2]+d[0]+d[2],e.minHeight&&l<e.minHeight&&(l=e.minHeight),e.heightFit=!0,e.height=l}return o&&!e.title&&(e.panelBodyBorders=[0,0,0,0],setTimeout(function(){s.panel&&s.panel.css("border-bottom-width",0)},1)),e},wasDefaultChanged(e,t){e+="-memory-defaults";const i=JSON.parse(localStorage.getItem(e));if(!i||!t)return!1;for(var l in i){switch(Fancy.typeOf(i[l])){case"number":case"string":case"boolean":break;default:continue}if(t[l]!==i[l])return!0}for(var l in t){switch(Fancy.typeOf(t[l])){case"number":case"string":case"boolean":break;default:continue}if(void 0===i[l])return!0}return!1},wasColumnsCodeChanged(e,t){e+="-memory-columns";const i=JSON.parse(localStorage.getItem(e));if(!i)return!1;if(t.length!==i.length)return!0;var l=!1;return Fancy.each(i,(e,i)=>{for(const s in e)if(e[s]!==t[i][s]){if("width"===s&&e.autoWidth)continue;return l=!0,!0}}),Fancy.each(t,(e,t)=>{for(const s in e)switch(Fancy.typeOf(e[s])){case"number":case"string":case"boolean":if(void 0===i[t][s])return l=!0,!0}}),l},memoryInitialDefaults(e,t){e+="-memory-defaults";const i={};for(var l in t)switch(Fancy.typeOf(t[l])){case"string":case"number":case"boolean":i[l]=t[l]}localStorage.setItem(e,JSON.stringify(i))},memoryInitialColumns(e,t){e+="-memory-columns";const i=[];Fancy.each(t,e=>{const t={};for(const i in e)switch(Fancy.typeOf(e[i])){case"string":case"number":case"boolean":t[i]=e[i]}i.push(t)}),localStorage.setItem(e,JSON.stringify(i))}}),Fancy.Mixin("Fancy.grid.mixin.ActionColumn",{initActionColumnHandler(){this.on("cellclick",this.onCellClickColumnAction,this)},onCellClickColumnAction(e,t){var i,l,s=t.column,r=s.items;"action"===s.type&&(i=this.getActiveActionColumnItem(t),r&&void 0!==i&&(l=r[i]).handler&&l.handler(this,t))},getActiveActionColumnItem(e){for(var t=Fancy.get(e.cell),i=e.e.target,l=t.select(`.${Fancy.GRID_COLUMN_ACTION_ITEM_CLS}`),s=0,r=l.length;s<r;s++)if(l.item(s).within(i))return s}}),function(){const e=Fancy,t=e.TOUCH_CLS,i=e.HIDDEN_CLS,l=e.GRID_CLS,s=e.GRID_STATE_SORTED_CLS,r=e.GRID_STATE_FILTERED_CLS,o=e.GRID_CENTER_CLS,n=e.GRID_LEFT_CLS,a=e.GRID_RIGHT_CLS,d=e.GRID_HEADER_CLS,c=e.GRID_BODY_CLS,h=e.PANEL_BODY_INNER_CLS,g=e.GRID_UNSELECTABLE_CLS,u=e.GRID_LEFT_EMPTY_CLS,p=e.GRID_RIGHT_EMPTY_CLS,m=e.GRID_COLUMN_SORT_ASC,f=e.GRID_COLUMN_SORT_DESC,C=e.GRID_ROW_GROUP_CLS,y=e.GRID_ROW_GROUP_COLLAPSED_CLS,v=e.PANEL_CLS,w=e.PANEL_TBAR_CLS,b=e.PANEL_SUB_TBAR_CLS,x=e.PANEL_BBAR_CLS,S=e.PANEL_BUTTONS_CLS,I=e.PANEL_GRID_INSIDE_CLS,E=e.ANIMATE_DURATION;e.GRID_ANIMATION_CLS;let T;e.Mixin("Fancy.grid.mixin.Grid",{tabScrollStep:80,waitingForFilters:!1,tpl:['<div class="'+n+" "+u+'"></div>','<div class="'+o+'"></div>','<div class="'+a+" "+p+'"></div>','<div class="fancy-grid-editors"></div>'],initStore(){var t,i,l,s=this,r=s.getFieldsFromData(s.data),o="Fancy.model."+e.id(),n=s.data,a=!1,d=s.state;s.data.items&&(n=s.data.items),t=s.data.remoteSort,i=s.data.remoteFilter,(l=s.data.remotePage)&&(l="server"),e.define(o,{extend:e.Model,fields:r}),s.isGroupable()&&void 0!==s.grouping.collapsed&&(a=s.grouping.collapsed);const c={widget:s,model:o,data:n,paging:s.paging,remoteSort:t,remoteFilter:i,pageType:l,collapsed:a,multiSort:s.multiSort};s.multiSortLimit&&(c.multiSortLimit=s.multiSortLimit),s.infinite&&(c.infinite=!0),d&&d.filters&&(c.filters=d.filters),!0!==s.filterable||c.filters||(c.filters={}),n.pageSize&&(c.pageSize=n.pageSize),s.store=new e.Store(c),s.model=o,s.fields=r},initDebug(){const t=this;e.DEBUG&&(t.panel?t.panel.addCls("fancy-debug"):t.addCls("fancy-debug"))},initTouch(){const i=this;e.isTouch&&window.FastClick&&(i.panel?(FastClick.attach(i.panel.el.dom),i.panel.addCls(t)):(FastClick.attach(i.el.dom),i.addCls(t)))},initElements(){const t=this;!1!==t.header&&(t.leftHeader=new e.grid.Header({widget:t,side:"left"}),t.header=new e.grid.Header({widget:t,side:"center"}),t.rightHeader=new e.grid.Header({widget:t,side:"right"})),t.leftBody=new e.grid.Body({widget:t,side:"left"}),t.body=new e.grid.Body({widget:t,side:"center"}),t.rightBody=new e.grid.Body({widget:t,side:"right"}),t.leftEl=t.el.select(`.${n}`),t.centerEl=t.el.select(`.${o}`),t.rightEl=t.el.select(`.${a}`)},getFieldsFromData(t){const i=this,l=t.items||t;if(t.fields)return i.isTreeData&&(t.fields.push("$deep"),t.fields.push("leaf"),t.fields.push("parentId"),t.fields.push("expanded"),t.fields.push("child"),t.fields.push("filteredChild")),t.fields;l||e.error("Data is empty and not set fields of data to build model",4);const s=l[0],r=[];for(var o in s)r.push(o);return i.isTreeData&&(r.push("$deep"),r.push("leaf"),r.push("parentId"),r.push("expanded"),r.push("child")),r},render(){var t=this,i=Fancy.get(t.renderTo||document.body),l=e.newEl("div"),s=t.panelBodyBorders;t.renderOuter&&(l=i),i.dom||e.error(`Could not find renderTo element: ${t.renderTo}`,1),l.addCls(e.cls,t.widgetCls,t.cls),Fancy.loadingStyle&&(t.panel?(t.panel.el.css("opacity",0),t.intervalStyleLoad=setInterval(()=>{Fancy.loadingStyle||(clearInterval(t.intervalStyleLoad),t.panel.el.animate({opacity:1,force:!0}))},100)):(l.css("opacity",0),t.intervalStyleLoad=setInterval(()=>{Fancy.loadingStyle||(clearInterval(t.intervalStyleLoad),t.el.animate({opacity:1,force:!0}))},100))),l.attr("role","grid"),l.attr("id",t.id),void 0===t.panel&&t.shadow&&l.addCls("fancy-panel-shadow"),!1===t.columnLines&&l.addCls("fancy-grid-disable-column-lines"),!1===t.rowLines&&l.addCls("fancy-grid-disable-row-lines"),"default"===t.theme||t.panel||l.addCls(Fancy.getThemeCSSCls(t.theme)),t.treeFolder&&l.addCls("fancy-grid-tree-folder");var r=0;t.panel&&(r=s[1]+s[3]),l.css({width:t.width-r+"px",height:t.height-0+"px"}),t.initTpl(),l.update(t.tpl.getHTML({})),t.renderOuter?t.el=l:t.el=e.get(i.dom.appendChild(l.dom)),t.setHardBordersWidth(),setTimeout(()=>{Fancy.nojQuery&&t.el.addCls(Fancy.GRID_ANIMATION_CLS)},100),t.rendered=!0},setHardBordersWidth(){var e=this,t=e.panel?e.gridBorders:e.gridWithoutPanelBorders;e.wrapped&&(t=e.gridBorders),e.css({"border-top-width":t[0],"border-right-width":t[1],"border-bottom-width":t[2],"border-left-width":t[3]})},update(e){const t=this;if(!t.store.loading){t.expander&&t.expander.reSet();var i="default";if(e&&e.type&&(i=e.type),t.updater.update(i),t.fire("update"),t.heightFit&&t.fitHeight(),t.setBodysHeight(),t.paging&&t.paging.update(),e&&e.flash){const i=t.store.changed;for(const l in i){const s=i[l],r=t.getRowById(l);if(void 0!==r)for(const i in s)switch(i){case"length":break;default:const l=t.getColumnOrderByKey(i);switch(e.flash){case!0:t.flashCell(r,l.order,l.side);break;case"plusminus":t.flashCell(r,l.order,l.side,{type:"plusminus",delta:s[i].value-s[i].originValue})}}}t.clearDirty()}else t.scroller.update();t._setColumnsAutoWidth()}},lightStartUpdate(){const e=this;e.rowheight&&e.rowheight.onUpdate(),e.bugFixReFreshChartColumns("left"),e.bugFixReFreshChartColumns("center"),e.bugFixReFreshChartColumns("right")},bugFixReFreshChartColumns(e){const t=this.getBody(e);this.getColumns(e).forEach((e,i)=>{switch(e.type){case"grossloss":t.renderGrossLoss(i);break;case"hbar":t.renderHBar(i)}})},getColumnsWidth(e){const t=this;switch(e){case"center":case void 0:return t.getCenterFullWidth();case"left":return t.getLeftFullWidth();case"right":return t.getRightFullWidth()}},setSides(){var e=this,t=e.leftColumns,i=e.rightColumns,l=e.getLeftFullWidth(),s=e.getCenterFullWidth(),r=e.getRightFullWidth(),h=e.gridBorders,g=e.panelBodyBorders,m=e.gridWithoutPanelBorders;t.length>0&&e.leftEl.removeCls(u),i.length>0&&e.rightEl.removeCls(p),s=e.wrapped?e.width-h[1]-h[3]:e.panel?e.width-h[1]-h[3]-g[1]-g[3]:e.width-m[1]-m[3],0===l&&0===r||(0===r?s-=l:0===l?s-=r:e.width>l+s+r?s-=l:s-=l+r),e.leftEl.css({width:l+"px"}),e.centerEl.css({left:l+"px",width:s+"px"}),e.header&&(e.el.select(`.${n} .${d}`).css({width:l+"px"}),e.el.select(`.${o} .${d}`).css({width:s+"px"})),e.el.select(`.${o} .${c}`).css({width:s+"px"}),e.width>l+s+r?e.rightEl.css({right:"0px"}):e.rightEl.css({left:"",right:"0px"}),e.rightEl.css({width:r}),e.header&&e.el.select(`.${a} .${d}`).css({width:r+"px"}),e.startWidths={center:s,left:l,right:r}},setColumnsPosition(){this.body.setColumnsPosition(),this.leftBody.setColumnsPosition(),this.rightBody.setColumnsPosition()},setSidesHeight(e){var t=this,i=t.store,l=1,s=t.cellHeaderHeight;!1!==t.header&&(l+=s,t.filter&&t.filter.header&&(t.groupheader?t.filter.groupHeader&&(l+=s):l+=s),t.groupheader&&(t.filter&&t.filter.header,l+=s)),t.isGroupable()&&(l+=t.grouping.groups.length*t.groupRowHeight),t.expander&&(l+=t.expander.plusHeight),t.summary&&(l+=t.summary.topOffSet),t.rowheight&&t.rowheight.totalHeight&&(e=t.rowheight.totalHeight),l+=e||i.getLength()*t.cellHeight-1,t.paging&&t.summary&&"bottom"===t.summary.position&&(l=t.height),t.leftEl.css({height:l+"px"}),t.centerEl.css({height:l+"px"}),t.rightEl.css({height:l+"px"})},setBodysHeight(){this.body.setHeight(),this.leftBody.setHeight(),this.rightBody.setHeight()},preRender(){const e=this;(e.title||e.subTitle||e.tbar||e.bbar||e.buttons||e.panel)&&e.renderPanel()},renderPanel(){const t=this,i={renderTo:t.renderTo,renderOuter:t.renderOuter,title:t.title,subTitle:t.subTitle,width:t.width,height:t.height,titleHeight:t.titleHeight,subTitleHeight:t.subTitleHeight,barHeight:t.barHeight,subTBarHeight:t.subTBarHeight||t.barHeight,tbarHeight:t.tbarHeight||t.barHeight,bbarHeight:t.bbarHeight||t.barHeight,buttonsHeight:t.buttonsHeight||t.barHeight,theme:t.theme,shadow:t.shadow,style:t.style||{},window:t.window,modal:t.modal,frame:t.frame,items:[t],draggable:t.draggable,resizable:t.resizable,minWidth:t.minWidth,minHeight:t.minHeight,panelBodyBorders:t.panelBodyBorders,barContainer:t.barContainer,barScrollEnabled:t.barScrollEnabled,tabScrollStep:t.tabScrollStep},l=t.panelBodyBorders;t.bbar&&(i.bbar=t.bbar,t.bbarHidden?i.bbarHidden=!0:t.height-=t.bbarHeight||t.barHeight),t.tbar&&(i.tbar=t.tbar,t.tbarHidden?i.tbarHidden=!0:t.height-=t.tbarHeight||t.barHeight),t.subTBar&&(i.subTBar=t.subTBar,t.subTBarHidden?i.subTBarHidden=!0:t.height-=t.subTBarHeight||t.barHeight),t.buttons&&(i.buttons=t.buttons,t.buttonsHidden?i.buttonsHidden=!0:t.height-=t.buttonsHeight||t.barHeight),t.footer&&(i.footer=t.footer,t.height-=t.barHeight),t.panel=new e.Panel(i),t.bbar=t.panel.bbar,t.tbar=t.panel.tbar,t.subTBar=t.panel.subTBar,t.buttons=t.panel.buttons,t.wrapped||t.panel.addCls(I),t.title&&(t.height-=t.titleHeight),t.subTitle&&(t.height-=t.subTitleHeight,t.height+=l[2]),t.height-=l[0]+l[2],t.renderTo=t.panel.el.select(`.${h}`).dom,t.resizable&&t.panel.on("resize",()=>t.setBodysHeight())},getBodyHeight(){let e=this,t=e.height,i=1,l=e.gridBorders,s=e.gridWithoutPanelBorders;return e.groupheader&&(i=2),e.filter&&e.filter.header&&(e.groupheader?(e.filter.groupHeader&&!e.subHeaderFilter&&i++,e.subHeaderFilter&&(t-=e.cellHeight)):e.subHeaderFilter?t-=e.cellHeight:i++),!1!==e.header&&(t-=e.cellHeaderHeight*i),e.panel?t-=l[0]+l[2]:t-=s[0]+s[2],e.summary&&(t-=e.summary.topOffSet,t-=e.summary.bottomOffSet),t},ons(){const t=this,i=t.store,l=e.get(document);i.on("set",t.onSetStore,t),i.on("insert",t.onInsertStore,t),i.on("remove",t.onRemoveStore,t),i.on("beforesort",t.onBeforeSortStore,t),i.on("sort",t.onSortStore,t),i.on("beforeload",t.onBeforeLoadStore,t),i.on("load",t.onLoadStore,t),l.on("mouseup",t.onDocMouseUp,t),l.on("click",t.onDocClick,t),l.on("mousemove",t.onDocMove,t),i.on("servererror",t.onServerError,t),i.on("serversuccess",t.onServerSuccess,t),t.responsive&&t.once("render",t.initResponsiveness,t),t.on("activate",t.onActivate,t),t.on("deactivate",t.onDeActivate,t),t.on("filter",t.onFilter,t),t.on("sort",t.onSort,t)},onServerError(e,t,i,l){this.fire("servererror",t,i,l)},onServerSuccess(e,t,i){this.fire("serversuccess",t,i)},onBeforeLoadStore(){this.fire("beforeload")},onRemoveStore(e,t,i){this.fire("remove",t,i)},onInsertStore(e,t){this.fire("insert",t)},onLoadStore(){const e=this;setTimeout(()=>{e.fire("load"),e.stateIsWaiting||(e.UPDATING_AFTER_LOAD=!0,e.store.changeDataView({reSort:!0}),e.update(),e.setSidesHeight(),delete e.UPDATING_AFTER_LOAD)},1)},onSetStore(e,t){this.fire("set",t),this.fire("change",t),this.fire("edit",t)},onBeforeSortStore(e,t){this.fire("beforesort",t)},onSortStore(e,t){this.fire("sort",t)},getCellsViewHeight(){var e=this,t=e.store,l=0,s=0;return e.isGroupable()&&(e.grouping.calcPlusScroll(),l+=e.grouping.plusScroll),e.expander&&(l+=e.expander.plusScroll),!e.scroller.scrollBottomEl||e.scroller.scrollBottomEl.hasCls(i)||(s=e.scroller.cornerSize),(e.rowheight?e.rowheight.totalHeight:e.cellHeight*t.dataView.length)+s+l},onDocMouseUp(){this.fire("docmouseup")},onDocClick(e){this.fire("docclick",e)},onDocMove(e){this.fire("docmove",e)},getCenterViewWidth(){const e=this,t=e.centerEl.width();if(0===t){let t=0;return e.columns.forEach(e=>{e.hidden||(t+=e.width)}),t}return t},getCenterFullWidth(){let e=0;return this.columns.forEach(t=>{t.hidden||(e+=t.width)}),e},getLeftFullWidth(){let e=0;return this.leftColumns.forEach(t=>{t.hidden||(e+=t.width)}),e},getRightFullWidth(){let e=0;return this.rightColumns.forEach(t=>{t.hidden||(e+=t.width)}),e},getColumns(e){const t=this;let i=[];switch(e){case"left":i=t.leftColumns;break;case"center":i=t.columns;break;case"right":i=t.rightColumns;break;case void 0:i=i.concat(t.leftColumns).concat(t.columns).concat(t.rightColumns)}return i},setColumnsLinksToSide(e,t){const i=this;switch(t){case"left":i.leftColumns=e;break;case"center":case void 0:i.columns=e;break;case"right":i.rightColumns=e}},getBody(e){let t,i=this;switch(e){case"left":t=i.leftBody;break;case"center":t=i.body;break;case"right":t=i.rightBody}return t},getHeader(e){let t,i=this;switch(e){case"left":t=i.leftHeader;break;case"center":t=i.header;break;case"right":t=i.rightHeader}return t},getHeaderCell(t,i){let l,s,r=this;if(e.isString(t)){const e=r.getColumnOrderByKey(t);if(!(s=r.getHeader(e.side)))return;l=s.getCell(e.order)}else{if(i=i||"center",!(s=r.getHeader(i)))return;l=s.getCell(t)}return l},getDomRow(e){const t=this,i=t.leftBody,l=t.body,s=t.rightBody,r=[];return t.leftColumns.forEach((t,l)=>{r.push(i.getDomCell(e,l))}),t.columns.forEach((t,i)=>{r.push(l.getDomCell(e,i))}),t.rightColumns.forEach((t,i)=>{r.push(s.getDomCell(e,i))}),r},initTextSelection(){const e=this;!1===e.textSelection&&e.addCls(g)},setTrackOver(e,t){const i=this;switch(e){case"cell":i.cellTrackOver=t;break;case"column":i.columnTrackOver=t;break;case"row":i.trackOver=t}},setSelModel(e){const t=this.selection;t.cell=!1,t.cells=!1,t.row=!1,t.rows=!1,t.column=!1,t.columns=!1,t[e]=!0,t.selModel=e,this.multiSelect="rows"===e,t.clearSelection()},getSelection(e){return this.selection.getSelection(e)},selectCell(e){return this.selection.selectCell(e)},selectCellLeft(){return this.selection.moveLeft()},selectCellRight(){return this.selection.moveRight()},selectCellDown(){return this.selection.moveDown()},selectCellUp(){return this.selection.moveUp()},clearSelection(){const e=this.selection;e&&e.clearSelection()},destroy(e){const t=this,i=t.store;if(t.panel?t.panel.hide():t.el.hide(),t.el&&t.el.dom)if(t.body.destroy(),t.leftBody.destroy(),t.rightBody.destroy(),t.header.destroy(),t.leftHeader.destroy(),t.rightHeader.destroy(),t.scroller.destroy(),!1===e){const e=t.panel?t.panel.el.child():t.el.child();Fancy.each(e,e=>e.destroy())}else t.el.destroy(),t.panel&&t.panel.el.destroy();i.destroy(),t.responsiveOverver&&t.responsiveOverver.stop&&(t.responsiveOverver.stop(),delete t.responsiveOverver)},clearData(){this.setData([]),this.update(),this.scroller.update()},showAt(){const e=this;e.panel&&e.panel.showAt.apply(e.panel,arguments)},show(){const e=this;setTimeout(()=>{e.panel?e.panel.show.apply(e.panel,arguments):e.el.show()},30)},hide(){const e=this;if(e.panel?e.panel.hide.apply(e.panel,arguments):e.el.hide(),e.celledit){const t=e.celledit.activeEditor;t&&t.hide()}},initDateColumn(){const t=this,i=function(i){return i.forEach(i=>{if("date"===i.type){i.format=i.format||{};const l={type:"date"};e.applyIf(l,t.lang.date),e.applyIf(i.format,l)}}),i};t.columns=i(t.columns),t.leftColumns=i(t.leftColumns),t.rightColumns=i(t.rightColumns)},stopEditor(){this.edit.stopEditor()},stopSaving(){this.store.stopSaving=!0},getById(e){return this.store.getById(e)},get(e,t){const i=this.store;return void 0!==t?i.get(e,t):void 0===e?i.get():i.getItem(e)},getRowById(e){return this.store.getRow(e)},getTotal(){return this.store.getTotal()},getViewTotal(){return this.store.getLength()},getDataView(){return this.store.getDataView()},getData(){return this.store.getData()},selectRow(e,t,i,l){this.selection.selectRow(e,t,i,l)},deSelectRow(e){this.selection.selectRow(e,!1,!0)},selectById(e,t,i){this.selection.selectById(e,t,i)},selectColumn(e){let t,i,l=this,s=l.leftColumns||[],r=l.columns||[],o=l.rightColumns||[];const n=t=>{let l=0,s=t.length;for(;l<s;l++){if(t[l].index===e)return i=l,!0}return!1};n(s)?t="left":n(r)?t="center":n(o)&&(t="right"),t&&l.selection.selectColumn(i,t)},getColumnByIndex(e){let t=this.getColumns(),i=0,l=t.length;for(;i<l;i++){const l=t[i];if(l.index===e)return l}},getColumn(e){return this.getColumnByIndex(e)},getColumnById(e){let t=this.getColumns(),i=0,l=t.length;for(;i<l;i++){const l=t[i];if(l.id===e)return l}},getColumnOrderByKey(e){let t,i=this.leftColumns||[],l=this.columns||[],s=this.rightColumns||[],r="";return l.forEach((i,l)=>{i.index===e&&(r="center",t=l)}),r||(i.forEach((i,l)=>{i.index===e&&(r="left",t=l)}),r||s.forEach((i,l)=>{i.index===e&&(r="right",t=l)})),{side:r,order:t}},getColumnOrderById(t){var i,l=this.leftColumns||[],s=this.columns||[],r=this.rightColumns||[],o="";return e.each(s,(e,l)=>{e.id===t&&(o="center",i=l)}),o||(e.each(l,(e,l)=>{e.id===t&&(o="left",i=l)}),o||e.each(r,(e,l)=>{e.id===t&&(o="right",i=l)})),{side:o,order:i}},load(e){this.store.loadData(e)},save(){this.store.save()},onWindowResize(){var t,i=this,s=i.renderTo;i.panel&&(s=i.panel.renderTo),((t=i.responsive?e.get(s):i.panel?i.panel.el:e.get(s)).hasClass(v)||t.hasClass(l))&&(t=t.parent());let r=t.width();if(void 0!==t.dom){if(0===r&&(r=t.parent().width()),i.responsive?i.setWidth(r):i.fitWidth,i.responsiveHeight){let e=parseInt(t.height());0===e&&(e=parseInt(t.parent().height())),i.setHeight(e)}i.setBodysHeight(),i.updateColumnsWidth(),i.scroller.scrollDelta(0),i.scroller.update()}},updateColumnsWidth(){const e=this,t=function(e,t,i){Fancy.each(e,(e,i)=>{if(!e.hidden&&e.flex)t.getCell(i)})};t(e.columns,e.header),t(e.leftColumns,e.leftHeader),t(e.rightColumns,e.rightHeader)},setWidth(e){const t=this,i=t.el,l=t.gridBorders,s=t.gridWithoutPanelBorders,r=t.panelBodyBorders,n=t.body,a=t.header,d=e=>{let t=0;return e.forEach(e=>{e.hidden||(t+=e.width)}),t};let c,h=d(t.leftColumns),g=d(t.rightColumns),u=e-h-g-r[1]-r[3];t.wrapped?(c=e,u=e-h-g,u-=l[1]+l[3],t.css({width:c})):t.panel?(u=e-h-g-r[1]-r[3],t.panel.el.width(e),u-=l[1]+l[3],c=e-r[1]-r[3],t.css({width:c})):(u=e-h-g-s[1]-s[3],i.css("width",e)),u<100&&(u=100),i.select(`.${o}`).css("width",u),a.css("width",u),n.css("width",u),t.hasFlexColumns&&(t.reCalcColumnsWidth(),t.columnresizer.updateColumnsWidth()),t.scroller.setScrollBars(),t.fire("changewidth",e)},getWidth(){let e,t=this;return e=t.panel?parseInt(t.panel.css("width")):parseInt(t.css("width"))},getHeight(){let e,t=this;return e=t.panel?parseInt(t.panel.css("height")):parseInt(t.css("height"))},setHeight(e,t){const i=this,l=e,s=i.gridBorders;i.panelBodyBorders;i.panel&&!1!==t&&i.panel.setHeight(e),i.title&&(e-=i.titleHeight),i.subTitle&&(e-=i.subTitleHeight),i.footer&&(e-=i.barHeight),i.bbar&&!i.bbarHidden&&(e-=i.bbarHeight||i.barHeight),i.tbar&&!i.tbarHidden&&(e-=i.tbarHeight||i.barHeight),i.subTBar&&!i.subTBarHidden&&(e-=i.subTBarHeight||i.barHeight),i.buttons&&!i.buttonsHidden&&(e-=i.buttonsHeight||i.barHeight);let r=e;i.header&&(r-=i.cellHeaderHeight,i.groupheader&&(r-=i.cellHeaderHeight)),i.panel?r-=2:r-=s[0]+s[2],i.summary&&(i.summary.el?r-=i.summary.el.dom.clientHeight:r-=i.cellHeight),i.body&&i.body.css("height",r),i.leftBody&&i.leftBody.css("height",r),i.rightBody&&i.rightBody.css("height",r),i.el.css("height",e),i.height=e,i.scroller.update(),i.fire("changeheight",l)},find(e,t,i){return this.store.find(e,t,i)},findItem(e,t){return this.store.findItem(e,t)},each(e,t){this.store.each(e,t)},onActivate(){const t=this,i=e.get(document);T&&T.id!==t.id&&T.fire("deactivate"),setTimeout(()=>{i.on("click",t.onDeactivateClick,t)},100),T=t},onDeActivate(){const t=this,i=e.get(document);t.activated=!1,i.un("click",t.onDeactivateClick,t),t.selection&&t.selection.activeCell&&t.selection.clearActiveCell()},onDeactivateClick(t){for(var i=0,l=e.get(t.target);i<20;i++){if(!l.dom)return;if(!l.dom.tagName||"body"===l.dom.tagName.toLocaleLowerCase())return void this.fire("deactivate");if(void 0===l.hasCls)return void this.fire("deactivate");if(l.hasCls(c))return;l=l.parent()}},search(e,t){this.searching.search(e,t)},stopSelection(){const e=this;e.selection&&e.selection.stopSelection()},enableSelection(e){const t=this;t.selection&&t.selection.enableSelection(e)},hideColumn(t,i,l){const s=this;void 0!==i||e.isArray(i)||e.isArray(t)||(i=t,(t=this.getSideByColumnIndex(i))||((r=s.getColumnOrderById(i)).side||e.error("Column does not exist"),l=s.getColumnById(i),t=r.side));if(void 0===i&&(i=t,t=void 0),e.isArray(i))e.each(i,e=>{t?s.hideColumn(t,e):s.hideColumn(e)});else{if(l){var r=s.getColumnOrderById(l.id);if(t=r.side,l.hidden)return}var o,n=s.getBody(t),a=s.getHeader(t),d=s.getColumns(t),c=0,h=d.length,g=s.centerEl,u=s.leftEl,p=s.leftHeader,m=s.rightEl,f=s.rightHeader;if(l)o=r.order,l.hidden=!0;else if(e.isNumber(i)){if((l=d[i]).hidden)return;o=i,l.hidden=!0}else for(;c<h;c++)if((l=d[c]).index===i){if(l.hidden)return;o=c,l.hidden=!0;break}if(a.hideCell(o),n.hideColumn(o),s.rowedit&&s.rowedit.hideField(o,t),s.leftColumns.length||s.rightColumns.length){var C=s.calcCurrentLeftWidth(),y=s.calcCurrentRightWidth(),v=parseInt(s.el.css("width"))-C-y;s.panel?v-=s.gridBorders[1]+s.gridBorders[3]:v-=s.gridWithoutPanelBorders[1]+s.gridWithoutPanelBorders[3],u.animate({width:C},E),p.el.animate({width:C},E),g.animate({left:C},E),g.animate({width:v},E),s.body.el.animate({width:v},E),s.header.el.animate({width:v},E),m.animate({width:y},E),f.el.animate({width:y},E),0===y&&setTimeout(function(){m.css("display","none")},E)}s.isGroupable()&&s.grouping.updateGroupRows(),"right"!==t&&"left"!==t||(clearInterval(s.intervalScrollUpdate),s.intervalScrollUpdate=setTimeout(()=>{s.scroller.update(),delete s.intervalScrollUpdate},E)),s.onWindowResize(),s.fire("columnhide",{column:l,side:t,orderIndex:o})}},showColumn(t,i,l){const s=this;void 0!==i||e.isArray(i)||e.isArray(t)||(i=t,(t=this.getSideByColumnIndex(i))||((r=s.getColumnOrderById(i)).side||e.error(`Column ${i} does not exist`),l=s.getColumnById(i),t=r.side));if(void 0===i&&(i=t,t=void 0),e.isArray(i))e.each(i,e=>{t?s.showColumn(t,e):s.showColumn(e)});else{if(l){var r=s.getColumnOrderById(l.id);if(t=r.side,!l.hidden)return}var o,n=s.getBody(t),a=s.getHeader(t),d=s.getColumns(t),c=0,h=d.length,g=s.centerEl,u=s.leftEl,p=s.leftHeader,m=s.rightEl,f=s.rightHeader;if(l)o=r.order,l.hidden=!1;else if(e.isNumber(i)){if(!(l=d[i]).hidden)return;o=i,l.hidden=!1}else for(;c<h;c++)if((l=d[c]).index===i){if(!l.hidden)return;o=c,delete l.hidden;break}if(a.showCell(o,l.width),n.showColumn(o,l.width),s.rowedit&&s.rowedit.showField(o,t),s.leftColumns.length||s.rightColumns.length){var C=s.calcCurrentLeftWidth(),y=s.calcCurrentRightWidth(),v=parseInt(s.el.css("width"))-C-y;s.panel?v-=s.gridBorders[1]+s.gridBorders[3]:v-=s.gridWithoutPanelBorders[1]+s.gridWithoutPanelBorders[3],"none"===m.css("display")&&m.show(),u.animate({width:C},E),p.el.animate({width:C},E),g.animate({left:C},E),g.animate({width:v},E),s.body.el.animate({width:v},E),s.header.el.animate({width:v},E),m.animate({width:y},E),f.el.animate({width:y},E)}s.isGroupable()&&s.grouping.updateGroupRows(),"right"!==t&&"left"!==t||(clearInterval(s.intervalScrollUpdate),s.intervalScrollUpdate=setTimeout(()=>{s.scroller.update(),delete s.intervalScrollUpdate},E)),s.onWindowResize(),s.fire("columnshow",{column:l,side:t,orderIndex:o})}},removeColumn(t,i){var l,s=this,r=s.leftEl,o=s.leftHeader,n=s.leftBody,a=s.centerEl,d=s.body,c=s.header,h=s.rightEl,g=s.rightBody,u=s.rightHeader;if(void 0===i&&(i="center"),e.isString(t))if((m=s.getColumnOrderById(t)).side)t=m.order,i=m.side;else{var p=s.getColumns(i);e.each(p,(e,i)=>{if(e.index===t)return t=i,!0}),e.isString(t)&&"center"===i&&(p=s.getColumns("left"),e.each(p,(e,l)=>{if(e.index===t)return t=l,i="left",!0}),e.isString(t)&&(p=s.getColumns("right"),e.each(p,(e,l)=>{if(e.index===t)return t=l,i="right",!0}),e.isString(t)&&e.error("Column was not found for method removeColumn",7)))}else if(e.isObject(t)){var m=s.getColumnOrderById(t.id);l=t,t=m.order,i=m.side}switch(i){case"left":l=s.leftColumns[t],s.leftColumns.splice(t,1),o.removeCell(t),n.removeColumn(t),r.css("width",parseInt(r.css("width"))-l.width),a.css("left",parseInt(a.css("left"))-l.width),a.css("width",parseInt(a.css("width"))+l.width),d.css("width",parseInt(d.css("width"))+l.width),c.css("width",parseInt(c.css("width"))+l.width),0===s.leftColumns.length&&s.leftEl.addCls(Fancy.GRID_LEFT_EMPTY_CLS);break;case"center":l=s.columns[t],s.columns.splice(t,1),c.removeCell(t),d.removeColumn(t);break;case"right":var f=0;l=s.rightColumns[t],s.rightColumns.splice(t,1),u.removeCell(t),g.removeColumn(t),h.css("width",parseInt(h.css("width"))-l.width),a.css("width",parseInt(a.css("width"))+l.width),c.css("width",parseInt(c.css("width"))+l.width),0===s.rightColumns.length&&(s.rightEl.addCls(Fancy.GRID_RIGHT_EMPTY_CLS),e.nojQuery&&(f=2)),d.css("width",parseInt(d.css("width"))+l.width-f)}return l.grouping&&delete l.grouping,s.summary&&s.summary.removeColumn(t,i),s.fire("columnremove"),clearInterval(s.removeColumnScrollInt),s.removeColumnScrollInt=setTimeout(()=>{delete s.removeColumnScrollInt,s.scroller.update()},Fancy.ANIMATE_DURATION),l.index===l.id?delete s.columnsIdsSeed[l.index]:new RegExp(l.index).test(l.id)&&(1===s.columnsIdsSeed[l.index]?delete s.columnsIdsSeed[l.index]:s.columnsIdsSeed[l.index]--),l},insertColumn(t,i,l,s){var r=this,o=r.store,n=r.leftEl,a=r.leftBody,d=r.leftHeader,c=r.centerEl,h=r.body,g=r.header,m=r.rightEl,f=r.rightBody,C=r.rightHeader,y=0;switch(t.index&&o.addField(t.index),l=l||"center"){case"center":delete t.rightLocked,delete t.locked,r.columns.splice(i,0,t),g.insertCell(i,t),h.insertColumn(i,t);break;case"left":t.locked=!0,y=0;var v=0,w=0;0===r.leftColumns.length?(e.nojQuery||(y=1,w=2),r.leftEl.removeCls(u)):w=2,e.nojQuery||(v=0);var b=n.dom.clientWidth+t.width+w;b-parseInt(n.css("width"))-t.width<-10&&(b=parseInt(n.css("width"))+t.width),r.leftColumns.splice(i,0,t),d.insertCell(i,t),d.css("width",parseInt(d.css("width"))+v),a.insertColumn(i,t),n.css("width",b),c.css("width",parseInt(c.css("width"))-t.width),c.css("left",parseInt(c.css("left"))+t.width+y),h.el.css("width",parseInt(h.el.css("width"))-t.width),g.el.css("width",parseInt(g.el.css("width"))-t.width);break;case"right":t.rightLocked=!0;w=0;0===r.rightColumns.length&&(e.nojQuery||(y=1,w=2),r.rightEl.removeCls(p)),r.rightColumns.splice(i,0,t),C.insertCell(i,t),f.insertColumn(i,t),m.css("width",parseInt(m.css("width"))+t.width),c.css("width",parseInt(c.css("width"))-t.width-y),h.css("width",parseInt(h.css("width"))-t.width-w),g.css("width",parseInt(g.css("width"))-t.width-w)}if(t.menu)if(t._menu)t.menu=t._menu;else{var x=!0;e.each(t.menu,t=>{e.isString(t)||e.isObject(t)&&t._isConfigApplied&&(x=!1)}),x||(t.menu=!0)}if(r.isGroupable()){switch(l){case"left":1===r.leftColumns.length&&r.grouping.softRenderGroupedRows("left");break;case"right":1===r.rightColumns.length&&r.grouping.softRenderGroupedRows("right")}r.grouping.updateGroupRows(),r.grouping.setCellsPosition(i,l)}t.rowEditor&&("left"===l&&i--,r.rowedit.moveEditor(t,i,l,s)),r.summary&&r.summary.insertColumn(i,l),r.header.destroyMenus(),r.leftHeader.destroyMenus(),r.rightHeader.destroyMenus(),r.sorter&&r.sorter.updateSortedHeader(),r.filter&&(clearInterval(r.intFilterFieldsUpdate),r.intFilterFieldsUpdate=setTimeout(()=>{r.filter.updateFields(),delete r.intFilterFieldsUpdate},e.ANIMATE_DURATION))},addColumn(e,t,i,l){const s=this;!1!==l?setTimeout(()=>{s._addColumn(e,t,i)},1):s._addColumn(e,t,i)},_addColumn(t,i="center",l){const s=this;if(t.type||(t.type="string"),t.width||(t.width=s.defaultColumnWidth),void 0===l){l=s.getColumns(i).length}const r={$selected:!0,$order:!0,$rowdrag:!0};void 0===t.id&&(t.index&&!r[t.index]?t.id=s.getColumnId(t.index):t.id=Fancy.id(null,"col-id-")),s.defaults&&e.applyIf(t,s.defaults),s.insertColumn(t,l,i),s.scroller.update(),s.fire("columnadd")},disableLegend(e,t){this.columns[e].disabled=this.columns[e].disabled||{},this.columns[e].disabled[t]=!0,this.update()},enableLegend(e,t){this.columns[e].disabled=this.columns[e].disabled||{},delete this.columns[e].disabled[t],this.update()},fitHeight(){var e=this,t=e.store,i=e.panelBodyBorders,l=e.gridBorders,s=t.getLength()*e.cellHeight,r=1,o=e.columns.concat(e.leftColumns||[]).concat(e.rightColumns||[]);Fancy.each(o,e=>{e.grouping&&(r<2&&(r=2),e.filter&&e.filter.header&&r<3&&(r=3)),e.filter&&e.filter.header&&r<2&&(r=2)}),e.getCenterFullWidth()>e.getCenterViewWidth()&&!e.nativeScroller&&!Fancy.isIE&&(s+=e.bottomScrollHeight),e.title&&(s+=e.titleHeight),e.tbar&&(s+=e.tbarHeight||e.barHeight),e.summary&&(s+=e.cellHeight),e.bbar&&(s+=e.bbarHeight||e.barHeight),e.buttons&&(s+=e.buttonsHeight||e.barHeight),e.subTBar&&(s+=e.subTBarHeight||e.barHeight),e.footer&&(s+=e.barHeight),!1!==e.header&&(s+=e.cellHeaderHeight*r),e.isGroupable()&&(s+=e.grouping.groups.length*e.groupRowHeight),e.panel?s+=i[0]+i[2]+l[0]+l[2]:s+=l[0]+l[2],e.setHeight(s)},addFilter(t,i,l,s){var r=this,o=r.store.filters[t],n=!1===r.waitingForFilters;if(e.isFunction(i)&&(l="fn"),l=l||"",void 0===o&&(o={}),e.isDate(i)){const e=this.getColumnByIndex(t).format;o.type="date",o.format=e,i=Number(i)}o[l]=i,r.store.filters[t]=o,n&&(clearInterval(r.intervalUpdatingFilter),r.intervalUpdatingFilter=setTimeout(()=>{r.WAIT_FOR_STATE_TO_LOAD?r.filter.updateStoreFilters(!1):r.filter.updateStoreFilters(),delete r.intervalUpdatingFilter},1)),!1!==s?r.filter.addValuesInColumnFields(t,i,l):r.searching},clearFilter(t,i,l){const s=this,r=s.store,o=!1===s.waitingForFilters;s.isRequiredChangeAllMemorySelection()&&(s.selection.memory.selectAllFiltered(),setTimeout(()=>{s.selection.updateHeaderCheckBox()},1)),void 0===t||null===t?r.filters={}:void 0===i||null===i?r.filters&&r.filters[t]&&delete r.filters[t]:s.filter&&r.filters&&r.filters[t]&&void 0!==r.filters[t][i]&&(delete r.filters[t][i],e.Object.isEmpty(r.filters[t])&&delete r.filters[t]),e.Object.isEmpty(r.filter)&&(delete r.filteredData,delete r.filterOrder,delete r.filteredDataMap),s.searching&&void 0===t&&void 0===i&&(s.searching.clearBarField(),s.search(""),s.expander&&s.expander.reSet()),o&&(clearInterval(s.intervalUpdatingFilter),s.intervalUpdatingFilter=setTimeout(()=>{if(r.remoteFilter)return r.once("serversuccess",()=>{s.fire("filter",r.filters),delete s.intervalUpdatingFilter}),void r.serverFilter();if(r.grouping&&r.grouping.by){const e=s.grouping;r.isFiltered()?(r.changeDataView(),e.initGroups("filteredData")):e.initGroups(),e.reFreshExpanded(),e.initOrder(),r.changeDataView(),e.updateGroupRows(),e.setCellsPosition(),e.setPositions(),e.reFreshGroupTexts(),e.update()}else r.changeDataView();r.grouping&&r.grouping.by||s.update(),s.setSidesHeight(),delete s.intervalUpdatingFilter},100)),s.filter&&!1!==l&&s.filter.clearColumnsFields(t,i),o&&(s.fire("filter",r.filters),s.setSidesHeight())},isRequiredChangeAllMemorySelection(){const e=this.store,t=this.selection;return e.hasFilters()&&t&&t.memory&&t.memory.all},updateFilters(){delete this.waitingForFilters,this.filter.updateStoreFilters()},updateFilter(){this.updateFilters()},showLoadMask(e){this.loadmask.show(e)},clearSorter(){this.sorter&&this.sorter.clearSort()},hideLoadMask(){this.loadmask.hide()},prevPage(){this.paging.prevPage()},nextPage(){this.paging.nextPage()},setPage(e,t){--e<0&&(e=0),this.paging.setPage(e,t)},firstPage(){this.paging.firstPage()},lastPage(){this.paging.lastPage()},setPageSize(e){this.paging.setPageSize(e)},getPage(){return this.store.showPage+1},getPages(){return this.store.pages},getPageSize(){return this.store.pageSize},refresh(){this.paging.refresh()},scroll(e,t,i){const l=this,s=l.scroller;void 0!==t&&t>0&&(t=-t);const r=s.getScrollHeight();e>r&&(e=r,l.nativeScroller&&s.isRightScrollable()&&(e+=17));const o=s.getScrollWidth();Math.abs(t)>o&&(t=-o),!1===s.isBottomScrollable()?t=0:l.nativeScroller&&s.isRightScrollable()&&(t-=17),s.scroll(e,t,i),s.scrollBottomKnob(),s.scrollRightKnob()},getDataFiltered(){return this.store.filteredData},reCalcColumnsWidth(){const e=this;if(e.hasFlexColumns){var t,i,l=e.scroller,s=e.getCenterViewWidth(),r=e.columns,o=0,n=0,a=r.length,d=s;for(!1!==e.flexScrollSensitive&&l.isRightScrollable()&&!l.nativeScroller&&(d-=e.bottomScrollHeight);n<a;n++)(i=r[n]).hidden||(i.flex?o+=i.flex:d-=i.width);if(0!==o)for(t=d/o,n=0;n<a;n++)(i=r[n]).hidden||i.flex&&(i.width=Math.floor(i.flex*t),i.minWidth&&i.width<i.minWidth&&(i.width=i.minWidth),i.minWidth&&i.width<i.minWidth?i.width=i.minWidth:i.width<e.minColumnWidth&&(i.width=e.minColumnWidth))}},getDisplayedData(t,i,l,s,r){var o=this,n=o.getViewTotal(),a=[],d=0,c=o.leftColumns,h=o.columns,g=o.rightColumns,u={};r&&(r=this.getSelection()),l&&e.each(l,e=>{u[e]=!0}),t&&(n=o.getTotal());const p=function(e){if(!(void 0===e.index||"$selected"===e.index||e.hidden||s&&!1===e.exportable)){if(/spark/.test(e.type))return!1;switch(e.type){case"select":case"action":case"expand":case"grossloss":case"hbar":case"rowdrag":break;case"order":m.push(d+1);break;default:if(r)var t=(l=r[d])[e.index];else{var l=o.get(d);t=o.get(d,e.index)}e.exportFn&&s?(l&&l.data&&(l=l.data),m.push(e.exportFn({value:t,data:l}).value)):e.render&&!0!==i?(l&&l.data&&(l=l.data),t=e.render({value:t,data:l}).value.replace(/<\/?[^>]+(>|$)/g,""),m.push(t)):r?m.push(t):m.push(o.get(d,e.index))}}};for(r&&(d=0,n=r.length);d<n;d++){var m=[];if(l){var f=o.get(d);if(!f||!u[f.id])continue}e.each(c,p),e.each(h,p),e.each(g,p),a.push(m)}return a},getAllDisplayedData(){var t=this,i=t.getViewTotal(),l=[],s=0,r=t.leftColumns,o=t.columns,n=t.rightColumns;const a=function(e){if(void 0!==e.index&&"$selected"!==e.index&&!e.hidden)switch(e.type){case"order":d.push(s+1);break;default:if(e.render){var i=t.get(s),l=t.get(s,e.index);d.push(e.render({value:l,data:i}).value)}else d.push(t.get(s,e.index))}};for(;s<i;s++){var d=[];e.each(r,a),e.each(o,a),e.each(n,a),l.push(d)}return l},setData(e){const t=this,i=t.store;i.isTree?i.initTreeData(e):i.setData(e),t.isGroupable()&&i.orderDataByGroup(),i.sorters&&i.reSort(),i.filterOrder&&t.filter.updateStoreFilters(!1),i.clearDirty(),(i.sorters||i.filterOrder)&&i.changeDataView({doNotFired:!0}),t.setSidesHeight(),t.filter&&t.filter.waitForComboData&&t.filter.updateFilterComboData(),t.isGroupable()&&(t.grouping.reGroup(),t.update())},exportToExcel(e){const t=this;t.exporter&&t.exporter.exportToExcel(e)},getDataAsCsv(e){const t=this;if(t.exporter)return t.exporter.getDataAsCsv(e)},getDataAsCSV(e){return this.getDataAsCsv(e)},exportToCSV(e){const t=this;if(t.exporter)return t.exporter.exportToCSV(e)},exportToCsv(e){return this.exportToCSV(e)},disableSelection(){this.selection.disableSelection()},setParams(t){const i=this.store;i.proxy&&(i.proxy.params=i.proxy.params||{},e.apply(i.proxy.params,t))},setUrl(t){const i=this.store;if(e.isString(t)){if(i.proxy&&i.proxy.api)if("rest"===i.proxy.type)for(var l in i.proxy.api)i.proxy.api[l]=t;else i.proxy.api.read=t}else i.proxy&&i.proxy.api&&e.apply(i.proxy.api,t)},getSideByCell(e){var t;return this.centerEl.within(e)?t="center":this.leftEl.within(e)?t="left":this.rightEl.within(e)&&(t="right"),t},getSideEl(e){const t=this;switch(e){case"left":return t.leftEl;case"center":return t.centerEl;case"right":return t.rightEl}},addChild(t,i){const l=this,s=l.store;if(void 0===i)t.$deep=1,void 0===t.child&&(t.child=[]),l.add(t);else{e.isNumber(t)&&(t=l.getById(t));var r=!1;!0===t.get("leaf")&&(t.set("leaf",!1),t.set("expanded",!0),t.set("child",[]),r=!0);const o=t.get("$deep"),n=t.get("child"),a=l.getRowById(t.id)+n.length+1;if(i.$deep=o+1,i.parentId=t.id,r){const s=t.get("parentId");if(s){const r=l.getById(s);e.each(r.data.child,e=>{if(e.id===t.id)return e.leaf=!1,e.expanded=!0,e.child=[i],!0})}}n.push(new s.model(i)),t.set("child",n),!0===t.get("expanded")&&l.insert(a,i)}},expand(t,i){var l,s=this;switch(e.typeOf(t)){case"number":case"string":l=s.getById(t)}if(l)if(!0!==l.get("expanded")){if(s.tree&&s.tree.expandRow(l),s.expander){if(i&&this.expander._expandedIds[t])return void this.collapse(t);var r=s.getRowById(t);s.expander.expand(r)}}else i&&this.collapse(t)},toggleExpand(e){this.expand(e,!0)},collapse(t,i){var l,s=this;switch(e.typeOf(t)){case"number":case"string":l=s.getById(t)}if(!1!==l.get("expanded")){if(s.tree&&s.tree.collapseRow(l),s.expander){var r=!this.expander._expandedIds[t];if(!r&&this.expander._expandedIds[t].hidden&&(r=!0),i&&r)return void this.expand(t);var o=s.getRowById(t);s.expander.collapse(o)}}else i&&this.expand(t)},toggleCollapse(e){this.collapse(e,!0)},collapseAll(){const t=this;if(t.tree){const i=t.findItem("$deep",1);e.each(i,e=>{t.collapse(e.id)})}else t.expander&&t.expander.collapseAll()},expandAll(){let t=this,i=t.findItem("expanded",!1);e.each(i,e=>{t.expand(e.id)}),(i=t.findItem("expanded",!1)).length&&t.expandAll()},copy(e){const t=this;t.selection&&t.selection.copy(e)},sort(t,i,l){var s,r,o=this.getColumnByIndex(t),n=this.getColumnOrderByKey(t);if(void 0===l&&(l=!0),n.side)if(r=(s=this.getHeader(n.side)).getCell(n.order),i){switch(i=i||"ASC",r=s.getCell(n.order),i=i.toLocaleLowerCase()){case"asc":r.removeCls(f),r.addCls(m);break;case"desc":r.removeCls(m),r.addCls(f);break;case"drop":r.removeCls(m),r.removeCls(f);break;default:e.error("sorting type is not right - "+i)}this.sorter.sort(i,t,n.side,o,r,l)}else r.dom.click()},flashRow(t){const i=this.getDomRow(t);i.forEach(t=>{(t=e.get(t)).addCls("fancy-grid-cell-flash")}),setTimeout(()=>{i.forEach(t=>{(t=e.get(t)).addCls("fancy-grid-cell-animation")})},200),setTimeout(()=>{i.forEach(t=>{(t=e.get(t)).removeCls("fancy-grid-cell-flash"),t.removeCls("fancy-grid-cell-animation")})},700)},flashCell(e,t,i="center",l){var s=this.getBody(i),r=700,o=Fancy.isObject(e)?e:s.getCell(e,t);if(l)switch(l.duration&&(r=l.duration),l.type){case"plusminus":l.delta>0?(o.addCls("fancy-grid-cell-flash-plus"),setTimeout(()=>{o.removeCls("fancy-grid-cell-flash-plus"),o.removeCls("fancy-grid-cell-animation")},r)):(o.addCls("fancy-grid-cell-flash-minus"),setTimeout(()=>{o.removeCls("fancy-grid-cell-flash-minus"),o.removeCls("fancy-grid-cell-animation")},r))}else o.addCls("fancy-grid-cell-flash"),setTimeout(()=>{o.removeCls("fancy-grid-cell-flash"),o.removeCls("fancy-grid-cell-animation")},700);setTimeout(()=>{o.addCls("fancy-grid-cell-animation")},200)},scrollToRow(e){const t=this.body.getCell(e,0);this.scroller.scrollToCell(t.dom,!1,!0),this.scroller.update(),this.flashRow(e)},getStateSorters(){const t={},i=JSON.parse(localStorage.getItem(this.getStateName()));if(!i)return;if(!i.sorters)return{};const l=JSON.parse(i.sorters);return e.each(l,e=>{t[e.key]=e}),t},getStateName(){const e=this,t=e.id,i=location.host+"-"+location.pathname;return e.stateId?e.stateId:t+"-"+i},setWidthFit(){var e=this,t=e.panelBodyBorders,i=e.gridWithoutPanelBorders,l=e.gridBorders,s=0,r=!1,o=[].concat(e.leftColumns).concat(e.columns).concat(e.rightColumns);Fancy.each(o,e=>{e.hidden||(s+=e.width),e.locked&&(r=!0)}),e.panel?s+=t[1]+t[3]+l[1]+l[3]:s+=i[1]+i[3]+l[1]+l[3],r&&s--,e.setWidth(s)},setColumnTitle(e,t,i="center"){var l,s=this.getHeader(i),r=s.getColumns();Fancy.isString(e)&&(e=this.getColumnOrderByKey(e).order),(l=r[e]).title=t,s.getCell(e).select(`.${Fancy.GRID_HEADER_CELL_TEXT_CLS}`).item(0).update(t),this.fire("columntitlechange",{orderIndex:e,index:l.index,value:t,side:i})},clearDirty(){this.store.clearDirty(),this.body.clearDirty(),this.leftBody.clearDirty(),this.rightBody.clearDirty()},isDirty(){return this.store.isDirty()},hideBar(t){var i,l,s=this;s.barHeight;switch(t){case"tbar":i=w,s.tbarHidden=!0,s.tbarHeight&&s.tbarHeight;break;case"subtbar":i=b,s.subTBarHidden=!0,s.subTBarHeight&&s.subTBarHeight;break;case"bbar":i=x,s.bbarHidden=!0,s.bbarHeight&&s.bbarHeight;break;case"buttons":i=S,s.buttonsHidden=!0,s.buttonsHeight&&s.buttonsHeight;break;default:e.error("Bar does not exist")}if("none"!==(l=s.panel.el.select(`.${i}`)).css("display")){l.hide();const e=parseInt(s.panel.el.css("height"));s.setHeight(e)}},showBar(t){var i,l,s=this;s.barHeight;switch(t){case"tbar":i=w,delete s.tbarHidden,s.tbarHeight&&s.tbarHeight;break;case"subtbar":i=b,delete s.subTBarHidden,s.subTBarHeight&&s.subTBarHeight;break;case"bbar":i=x,delete s.bbarHidden,s.bbarHeight&&s.bbarHeight;break;case"buttons":i=S,delete s.buttonsHidden,s.buttonsHeight&&s.buttonsHeight;break;default:e.error("Bar does not exist")}if("none"==(l=s.panel.el.select(`.${i}`)).css("display")){l.show();const e=parseInt(s.panel.el.css("height"));s.setHeight(e)}},initResponsiveness(){const t=this,i=function(){t.onWindowResize(),clearInterval(t.intWindowResize),t.intWindowResize=setTimeout(()=>{t.onWindowResize(),delete t.intWindowResize,setTimeout(()=>{t.onWindowResize()},300)},30)};"ResizeObserver"in window?(setTimeout(()=>{var l,s;t.nativeResizeObserver?l=new ResizeObserver(i):(l=new e.ResizeObserver(i),t.responsiveOverver=l),(s=t.panel?t.panel.el.parent().dom:t.el.parent().dom)&&l.observe(s)},100),e.$(window).bind("resize",i)):(setTimeout(()=>{const l=new e.ResizeObserver(i),s=t.el.parent().dom;s&&(t.responsiveOverver=l,l.observe(s))},100),e.$(window).bind("resize",i))},getNumOfVisibleCells(){const e=this;if(!e.numOfVisibleCells)try{e.numOfVisibleCells=Math.ceil(e.getBodyHeight()/e.cellHeaderHeight)}catch(t){e.numOfVisibleCells=0}return e.numOfVisibleCells},getSideByColumnIndex(t){var i;return e.each(this.columns,e=>{e.index===t&&(i="center")}),e.each(this.leftColumns,e=>{e.index===t&&(i="left")}),e.each(this.rightColumns,e=>{e.index===t&&(i="right")}),i},setColumnWidth(t,i,l="center"){const s=this;if(e.isArray(t))e.each(t,e=>{s.setColumnWidth(e.index,e.width,e.side)});else{const r=s.getColumns(l);e.isNumber(t)?r[t].width=i:s.getColumnByIndex(t).width=i}clearInterval(s.intervalUpdateColumnsWidth),s.intervalUpdateColumnsWidth=setTimeout(()=>{s.columnresizer&&(s.columnresizer.updateColumnsWidth("all"),delete this.intervalUpdateColumnsWidth,setTimeout(()=>{s.scroller.update()},Fancy.ANIMATE_DURATION))},100)},isLoading(){return this.store.loading},getChanges(){const e=this.store,t={};return t.changed=e.changed,t.removed=e.removed,t.inserted=e.inserted,t},autoSizeColumn(t,i,l){var s,r=this;if(e.isBoolean(i)?i=(s=r.getColumnOrderById(t)).side:(s=r.getColumnOrderByKey(t))&&void 0!==s.order||(i=(s=r.getColumnOrderById(t)).side),s&&void 0!==s.order){i=i||s.side;var o,n=r.getBody(i),a=e.get(n.getDomColumn(s.order)),d=a.css("width");if(d>500&&(d=100),a.css("width",""),o=a.dom.offsetWidth+2,l&&l.maxWidth&&l.maxWidth<o?o=l.maxWidth:l&&l.minWidth&&l.minWidth>o?o=l.minWidth:l&&l.maxAutoWidth&&l.maxAutoWidth<o&&(o=l.maxAutoWidth),a.css("width",d),r.header){const e=r.getHeaderCell(s.order,i);d=e.css("width"),e.css("width","");const t=e.dom.offsetWidth+25;e.css("width",d),t>o&&(o=t)}r.setColumnWidth(s.order,o,i)}else e.error("Column index was not found")},autoSizeColumns(){const t=this,i=t.getColumns();e.each(i,e=>{t.isServiceColumn(e)||e.id&&t.autoSizeColumn(e.id,!0,e)})},onFilter(){const e=this;e.store.hasFilters()?e.addCls(r):e.removeCls(r)},onSort(){const e=this,t=e.store;t.sorters&&t.sorters.length?e.addCls(s):e.removeCls(s)},isServiceColumn(e){switch(e.type){case"order":case"select":case"expand":case"rowdrag":return!0}return!1},getFilter(e,t){const i=this;if(void 0===e&&void 0===t)return i.store.filters;const l=i.store.filters[e];return void 0===t?l||void 0:l&&l[t]?l[t]:void 0},getSorter(t){const i=this;if(void 0!==t){let l;return e.each(i.store.sorters,e=>{if(e.key===t)return l=e,!0}),l}return i.store.sorters},setColumnComboData(t,i){const l=this.getColumns();e.each(l,l=>{if(l.index===t||l.id===t){if(l.data=i,l.editor&&delete l.editor,l.filterField){var s=[];e.isObject(i[0])?s=i:e.each(i,(e,t)=>{s.push({value:t,text:e})}),l.filterField.setData(s)}if(l.rowEditor){s=[];e.isObject(i[0])?s=i:e.each(i,(e,t)=>{s.push({value:t,text:e})}),l.rowEditor.setData(s)}}})},clearGroup(){const e=this,t=e.store;t.clearGroup(),e.grouping.clearGroup(),t.changeDataView(),e.update(),e.setSidesHeight(),e.scroller.update()},addGroup(e,t){const i=this,l=i.store,s=!i.grouping.by;l.addGroup(e),l.sorters&&l.reSort(),l.filterOrder,i.grouping.addGroup(s),i.setSidesHeight(),t&&i.expandGroup(),i.scroller.update(),i.scroll(0,0)},isGroupable(){return this.grouping&&this.grouping.by},expandGroup(t){const i=this,l=i.store,s=i.grouping,r=s.groups;t?(i.el.select("."+C+'[group="'+t+'"]').removeCls(y),s.expand(s.by,t)):(e.each(r,function(e){i.el.select("."+C+'[group="'+e+'"]').removeCls(y)}),s.expand(s.by,r)),(l.sorters||l.filterOrder)&&l.changeDataView({doNotFired:!0}),l.filterOrder&&l.grouping&&l.grouping.by&&i.filter.reGroupAccordingToFilters(),s.update()},collapseGroup(t){const i=this,l=i.grouping,s=l.groups;t?(i.el.select("."+C+'[group="'+t+'"]').addCls(y),l.collapse(l.by,t)):e.each(s,function(e){i.el.select("."+C+'[group="'+e+'"]').addCls(y),l.collapse(l.by,e)}),l.update()},calcCurrentLeftWidth(){var t=this.getColumns("left"),i=0;return e.each(t,e=>{e.hidden||(i+=e.width)}),i},calcCurrentRightWidth(){var t=this.getColumns("right"),i=0;return e.each(t,e=>{e.hidden||(i+=e.width)}),i},setColumns(e){const t=this;e=Fancy.Array.copy(e,!0),e=t.prepareConfigColumnMinMaxWidth({columns:e}).columns,t.defaults&&(e=t.prepareConfigDefaults({defaults:t.defaults,columns:e}).columns),t.refreshcolumns.setColumns(e),t._setColumnsAutoWidth(),setTimeout(()=>{Fancy.each(["left","center","right"],e=>{const i=t.getHeader(e),l=t.getBody(e);i.reSetColumnsAlign(),i.reSetColumnsCls(),l.reSetColumnsAlign(),l.reSetColumnsCls(),l.reSetIndexes()})},1)}}),e.ResizeObserver=function(e){this.fn=e},e.ResizeObserver.prototype.observe=function(e){this.el=e,this.init()},e.ResizeObserver.prototype.init=function(){const e=this;e.width=e.el.clientWidth,e.height=e.el.clientHeight,e.interval=setInterval(()=>{const t=e.el.clientWidth,i=e.el.clientHeight;t===e.width&&i===e.height||(e.fn(),e.width=e.el.clientWidth,e.height=e.el.clientHeight)},100)},e.ResizeObserver.prototype.stop=function(){clearInterval(this.interval),delete this.width,delete this.height}}(),Fancy.define("Fancy.grid.plugin.Updater",{extend:Fancy.Plugin,ptype:"grid.updater",inWidgetName:"updater",constructor:function(e){Fancy.applyConfig(this,e),this.Super("const",arguments)},init(){},update(e=""){const t=this.widget;t.leftColumns&&t.leftColumns.length&&t.leftBody.update(e),t.body.update(e),t.rightColumns&&t.rightColumns.length&&t.rightBody.update(e)},updateRow(e){const t=this.widget;t.leftBody.updateRows(e),t.body.updateRows(e),t.rightBody.updateRows(e)}}),function(){const e=Fancy,t=e.HIDDEN_CLS,i=e.GRID_COLUMN_CLS,l=e.GRID_CENTER_CLS;e.define("Fancy.grid.plugin.Scroller",{extend:e.Plugin,ptype:"grid.scroller",inWidgetName:"scroller",rightKnobDown:!1,bottomKnobDown:!1,minRightKnobHeight:35,minBottomKnobWidth:35,cornerSize:12,scrollLeft:0,scrollTop:0,constructor:function(){this.Super("const",arguments)},init(){this.Super("init",arguments),this.ons()},ons(){const t=this,i=t.widget,l=e.getMouseWheelEventName();i.once("render",()=>{t.render(),i.leftBody.el.on(l,t.onMouseWheel,t),i.nativeScroller&&(i.leftBody.el.on(l,t.onMouseWheelLeft,t),i.rightBody.el.on(l,t.onMouseWheelRight,t)),i.body.el.on(l,t.onMouseWheel,t),i.rightBody.el.on(l,t.onMouseWheel,t),i.once("init",t.onGridInit,t),i.nativeScroller?(i.body.el.on("scroll",t.onNativeScrollBody,t),i.leftBody.el.on("scroll",t.onNativeScrollLeftBody,t),i.rightBody.el.on("scroll",t.onNativeScrollRightBody,t)):(i.panel&&i.panel.on("resize",t.onPanelResize,t),i.body.el.on("scroll",t.onScrollBodyBugFix,t))}),t.on("render",t.onRender,t),i.store.on("change",t.onChangeStore,t)},destroy(){const t=this,i=t.widget,l=i.leftBody,s=i.body,r=i.rightBody,o=e.getMouseWheelEventName();l.el.un(o,t.onMouseWheel,t),s.el.un(o,t.onMouseWheel,t),r.el.un(o,t.onMouseWheel,t),i.nativeScroller||(t.scrollBottomEl.un("mousedown",t.onMouseDownBottomSpin,t),t.scrollRightEl.un("mousedown",t.onMouseDownRightSpin,t)),e.isTouch&&(l.el.un("touchstart",t.onBodyTouchStart,t),l.el.un("touchmove",t.onBodyTouchMove,t),s.el.un("touchstart",t.onBodyTouchStart,t),s.el.un("touchmove",t.onBodyTouchMove,t),r.el.un("touchstart",t.onBodyTouchStart,t),r.el.un("touchmove",t.onBodyTouchMove,t))},onGridInit(){const t=this,i=t.widget,l=i.store,s=e.get(document);t.setScrollBars(),s.on("mouseup",t.onMouseUpDoc,t),s.on("mousemove",t.onMouseMoveDoc,t),i.on("columnresize",t.onColumnResize,t),i.on("lockcolumn",t.onLockColumn,t),i.on("rightlockcolumn",t.onRightLockColumn,t),i.on("unlockcolumn",t.onUnLockColumn,t),l.on("changepages",t.onChangePages,t),i.on("columndrag",t.onColumnDrag,t),setTimeout(()=>{t.update()},1)},render(){const i=this,l=i.widget,s=l.body,r=e.newEl("div"),o=e.newEl("div"),n=e.newEl("div");l.nativeScroller?l.el.addCls("fancy-grid-native-scroller"):(r.addCls("fancy-scroll-right"),o.addCls("fancy-scroll-bottom",t),r.update(['<div class="fancy-scroll-right-inner"></div>'].join(" ")),r.select(".fancy-scroll-right-inner").css("margin-top",l.knobOffSet),o.update(['<div class="fancy-scroll-bottom-inner"></div>'].join(" ")),e.get(s.el.append(r.dom)),i.scrollRightEl=s.el.select(".fancy-scroll-right"),e.get(s.el.append(o.dom)),i.scrollBottomEl=s.el.select(".fancy-scroll-bottom"),l.doubleHorizontalScroll&&(n.addCls("fancy-scroll-top",t),n.update(['<div class="fancy-scroll-top-inner"></div>'].join(" ")),e.get(s.el.append(n.dom)),i.scrollTopEl=s.el.select(".fancy-scroll-top"))),i.fire("render")},onMouseWheel(t){const i=this,l=i.widget,s=l.store,r=e.getWheelDelta(t.originalEvent||t);if(l.infinite){let e;return t.preventDefault(),(e=r<0?s.infiniteScrolledToRow+1:s.infiniteScrolledToRow-1)>s.getNumOfInfiniteRows()-(l.numOfVisibleCells-1)&&(e=s.getNumOfInfiniteRows()-(l.numOfVisibleCells-1)),e<0&&(e=0),s.infiniteScrolledToRow=e,l.update(),void(l.selection&&l.selection.updateSelection())}0!=i.isRightScrollable()&&(l.stopProp&&t.stopPropagation(),l.nativeScroller||(i.scrollDelta(r)&&t.preventDefault(),i.scrollRightKnob()))},onRender(){const t=this,i=t.widget,{bottomKnobDown:l,rightKnobDown:s}=t;!0!==i.nativeScroller&&(t.scrollRightEl.hover(()=>{!0!==l&&t.scrollRightEl.addCls("fancy-scroll-right-hover")},()=>{t.scrollRightEl.removeCls("fancy-scroll-right-hover")}),t.scrollBottomEl.hover(()=>{!0!==s&&t.scrollBottomEl.addCls("fancy-scroll-bottom-hover")},()=>{t.scrollBottomEl.removeCls("fancy-scroll-bottom-hover")}),i.doubleHorizontalScroll&&t.scrollTopEl.hover(()=>{!0!==l&&t.scrollTopEl.addCls("fancy-scroll-top-hover")},()=>{!0!==l&&t.scrollTopEl.removeCls("fancy-scroll-top-hover")}),t.initRightScroll(),t.initBottomScroll()),e.isTouch&&t.initTouch()},initTouch(){const t=this,i=t.widget,l=i.leftBody,s=i.body,r=i.rightBody,o=e.get(document);l.el.on("touchstart",t.onBodyTouchStart,t),l.el.on("touchmove",t.onBodyTouchMove,t),s.el.on("touchstart",t.onBodyTouchStart,t),s.el.on("touchmove",t.onBodyTouchMove,t),r.el.on("touchstart",t.onBodyTouchStart,t),r.el.on("touchmove",t.onBodyTouchMove,t),o.on("touchend",t.onBodyTouchEnd,t)},onBodyTouchStart(e){e=e.originalEvent||e;const t=this,i=t.widget,l=e.changedTouches[0];i.nativeScroller||(Fancy.nojQuery&&(i.panel?i.panel.el.select("."+Fancy.GRID_ANIMATION_CLS).removeCls(Fancy.GRID_ANIMATION_CLS):i.el.removeCls(Fancy.GRID_ANIMATION_CLS)),e.preventDefault(),t.rightKnobDown=!0,t.bottomKnobDown=!0,t.mouseDownXY={x:l.pageX,y:l.pageY},t.rightKnobTop=parseInt(t.rightKnob.css("margin-top")),t.scrollRightEl.addCls("fancy-scroll-right-active"),t.bottomKnobLeft=parseInt(t.bottomKnob.css("margin-left")),t.scrollBottomEl.addCls("fancy-scroll-bottom-active"),i.doubleHorizontalScroll&&t.scrollTopEl.addCls("fancy-scroll-top-active"))},onBodyTouchEnd(){const e=this,t=e.widget;if(e.onMouseUpDoc(),!0!==t.nativeScroller&&e.spyOnSwipe){const t=e.spyOnSwipe.swipedX,i=e.spyOnSwipe.swipedY;i&&t?"top"===e.touchScrollDirection?e.swipeTop():"left"===e.touchScrollDirection&&e.swipeLeft():i?e.swipeTop():t&&e.swipeLeft()}delete e.spyOnSwipe,delete e.touchScrollDirection},swipeTop(){let e=this.widget,t=this.scrollTop+10*this.spyOnSwipe.swipedY;this.isRightScrollable()&&(t<0&&(t=0),e.scroll(t,!1,!0))},swipeLeft(){let e=this.widget,t=this.scrollLeft+10*this.spyOnSwipe.swipedX;this.isBottomScrollable()&&(t<0&&(t=0),e.scroll(!1,t,!0))},onBodyTouchMove(t){var i=this,l=i.widget,s=(t=t.originalEvent||t).changedTouches[0],r=!0;if(l.nativeScroller){if(e.isTouch)return;i.onMouseMoveDoc({pageX:s.pageX,pageY:s.pageY})}else{var o=i.scrollLeft,n=i.scrollTop;i.onMouseMoveDoc({pageX:s.pageX,pageY:s.pageY}),r=o!==i.scrollLeft||n!==i.scrollTop,t.preventDefault()}!0===i.rightKnobDown&&r&&t.preventDefault(),!0===i.bottomKnobDown&&r&&t.preventDefault()},initRightScroll(){const e=this;e.rightKnob=e.scrollRightEl.select(".fancy-scroll-right-inner"),e.scrollRightEl.on("mousedown",e.onMouseDownRightSpin,e)},initBottomScroll(){const e=this,t=e.widget;e.bottomKnob=e.scrollBottomEl.select(".fancy-scroll-bottom-inner"),e.scrollBottomEl.on("mousedown",e.onMouseDownBottomSpin,e),t.doubleHorizontalScroll&&(e.topKnob=e.scrollTopEl.select(".fancy-scroll-top-inner"),e.scrollTopEl.on("mousedown",e.onMouseDownBottomSpin,e))},onMouseDownRightSpin(t){const i=this,l=i.widget;e.isTouch||(Fancy.nojQuery&&(l.panel?l.panel.el.select("."+Fancy.GRID_ANIMATION_CLS).removeCls(Fancy.GRID_ANIMATION_CLS):l.el.removeCls(Fancy.GRID_ANIMATION_CLS)),t.preventDefault(),i.rightKnobDown=!0,i.mouseDownXY={x:t.pageX,y:t.pageY},i.rightKnobTop=parseInt(i.rightKnob.css("margin-top")),i.scrollRightEl.addCls("fancy-scroll-right-active"))},onMouseDownBottomSpin(t){const i=this,l=i.widget,s=e.get(t.target);t.preventDefault(),Fancy.nojQuery&&(l.panel?l.panel.el.select("."+Fancy.GRID_ANIMATION_CLS).removeCls(Fancy.GRID_ANIMATION_CLS):l.el.removeCls(Fancy.GRID_ANIMATION_CLS)),i.bottomKnobDown=!0,i.mouseDownXY={x:t.pageX,y:t.pageY},i.bottomKnobLeft=parseInt(i.bottomKnob.css("margin-left")),i.scrollBottomEl.addCls("fancy-scroll-bottom-active"),s.hasClass()&&i.scrollTopEl.addCls("fancy-scroll-top-inner")},onMouseUpDoc(){const e=this,t=e.widget;e.mouseDownXY={},delete e.mouseMoveInitXY,!1!==e.rightKnobDown||!1!==e.bottomKnobDown?(Fancy.nojQuery&&t.addCls(Fancy.GRID_ANIMATION_CLS),e.scrollRightEl.removeCls("fancy-scroll-right-active"),e.scrollBottomEl.removeCls("fancy-scroll-bottom-active"),e.rightKnobDown=!1,e.bottomKnobDown=!1,t.doubleHorizontalScroll&&e.scrollTopEl.removeCls("fancy-scroll-top-active","fancy-scroll-top-hover")):t.nativeScroller&&Fancy.nojQuery&&t.addCls(Fancy.GRID_ANIMATION_CLS)},onMouseMoveDoc(t){var i,l,s,r,o=this,n=o.widget,a=!1,d=!1,c=n.knobOffSet,h=t.pageX,g=t.pageY;if(!e.isTouch||o.mouseMoveInitXY){if(e.isTouch&&!o.touchScrollDirection){if(i=o.mouseMoveInitXY.x-h,l=o.mouseMoveInitXY.y-g,!o.touchScrollDirection&&Math.abs(l)<5&&Math.abs(i)<5)return;Math.abs(l)>Math.abs(i)?o.touchScrollDirection="top":o.touchScrollDirection="left"}clearInterval(o.scrollInterval),o.spyOnSwipe?(Math.abs(o.spyOnSwipe.x-h)>1?o.spyOnSwipe.swipedX=o.spyOnSwipe.x-h:delete o.spyOnSwipe.swipedX,Math.abs(o.spyOnSwipe.y-g)>1?o.spyOnSwipe.swipedY=o.spyOnSwipe.y-g:delete o.spyOnSwipe.swipedY,o.spyOnSwipe.x=h,o.spyOnSwipe.y=g):o.spyOnSwipe={x:h,y:g},o.scrollInterval=setTimeout(()=>{if(o.rightKnobDown&&"left"!==o.touchScrollDirection&&(e.isTouch?(l=o.mouseDownXY.y-g,s=l+Math.ceil(o.rightKnobTop*o.rightScrollScale)):(l=g-o.mouseDownXY.y,s=l+o.rightKnobTop),e.isTouch?o.bodyViewHeight<s/o.rightScrollScale+o.rightKnobHeight&&(s=o.bodyFullViewHeight-o.bodyViewHeight):o.bodyViewHeight<s+o.rightKnobHeight&&(s=o.bodyViewHeight-o.rightKnobHeight),s<0&&(s=0),e.isTouch?(a=s,o.rightKnob.css("margin-top",s/o.rightScrollScale+c+"px")):(a=o.rightScrollScale*s,o.rightKnob.css("margin-top",s+c+"px")),n.doubleHorizontalScroll&&"none"!==o.scrollBottomEl.css("display")&&s<o.cornerSize&&(s=o.cornerSize),n.infinite&&n.selection&&(n.selection.updateSelection(),n.selection.clearActiveCell())),o.bottomKnobDown&&"top"!==o.touchScrollDirection&&(e.isTouch?(i=o.mouseDownXY.x-h,l=o.mouseDownXY.y-g,r=i+Math.ceil(o.bottomKnobLeft*Math.abs(o.bottomScrollScale))):(i=h-o.mouseDownXY.x,l=g-o.mouseDownXY.y,r=i+o.bottomKnobLeft),r<1&&(r=1),e.isTouch?o.bodyViewWidth-2<Math.abs(r/o.bottomScrollScale)+o.bottomKnobWidth&&(r=o.bodyFullViewWidth-o.bodyViewWidth-2):o.bodyViewWidth-2<r+o.bottomKnobWidth&&(r=o.bodyViewWidth-o.bottomKnobWidth-2),o.bottomScrollScale<0&&r<0&&(r=0,o.bottomScrollScale=0),e.isTouch?(d=-r-1,o.bottomKnob.css("margin-left",Math.abs(r/o.bottomScrollScale)+"px")):(d=Math.ceil(o.bottomScrollScale*(r-1)),o.bottomKnob.css("margin-left",r+"px")),n.doubleHorizontalScroll&&o.topKnob.css("margin-left",r+"px")),e.isTouch)switch(o.touchScrollDirection){case"top":o.scroll(a);break;case"left":o.scroll(!1,d)}else!1!==a&&!1!==d?o.scroll(a,d):!1!==a?o.scroll(a):!1!==d&&o.scroll(!1,d)},1)}else o.mouseMoveInitXY={x:h,y:g}},setScrollBars(e){const t=this,i=t.widget;i.rowheight&&void 0===e||(setTimeout(()=>{t.checkRightScroll(e)},1),t.checkBottomScroll()||t.scrollTop&&!i.infinite&&i.scroll(!1,0),i.nativeScroller||setTimeout(()=>{t.checkCorner(),t.setRightKnobSize(e),t.setBottomKnobSize()},1))},checkRightScroll(e){const i=this,l=i.widget,s=l.body,r=l.gridBorders,o=l.getBodyHeight(),n=(e||l.getCellsViewHeight())-r[0]-r[2];l.nativeScroller?o>=n?s.el.css("overflow-y","hidden"):s.el.css("overflow-y","scroll"):o>=n?i.scrollRightEl.addCls(t):i.scrollRightEl.removeCls(t)},isRightScrollable(){const e=this.widget;return e.nativeScroller?"scroll"===e.body.el.css("overflow-y"):!this.scrollRightEl.hasCls(t)},isBottomScrollable(){const e=this.widget;return e.nativeScroller?"scroll"===e.body.el.css("overflow-x"):!this.scrollBottomEl.hasCls(t)},setRightKnobSize(e){const t=this,i=t.widget;if(!i.nativeScroller){var l=i.getBodyHeight()-(t.corner?t.cornerSize:0)-2,s=(e||i.getCellsViewHeight())-(t.corner?t.cornerSize:0),r=l*((100-(s-l)/(l/100))/100),o=i.knobOffSet;r<t.minRightKnobHeight&&(r=t.minRightKnobHeight,i.doubleHorizontalScroll&&(r+=t.minRightKnobHeight)),!1===t.corner&&(l-=o),t.rightKnob.css({height:r}),t.rightKnobHeight=r,t.bodyViewHeight=l,t.bodyFullViewHeight=s,t.rightScrollScale=(s-l)/(l-r)}},checkBottomScroll(){var e,i=this,l=i.widget,s=l.body,r=l.getCenterViewWidth(),o=l.getCenterFullWidth()-2;return l.nativeScroller?r>o?(e=!1,s.el.css("overflow-x","hidden")):(e=!0,s.el.css("overflow-x","scroll")):r>o?(e=!1,i.scrollBottomEl.addCls(t),l.doubleHorizontalScroll&&i.scrollTopEl.addCls(t)):(e=!0,i.scrollBottomEl.removeCls(t),l.doubleHorizontalScroll&&i.scrollTopEl.removeCls(t)),e},checkCorner(){this.widget.nativeScroller||(this.corner=!this.scrollRightEl.hasCls(t)&&!this.scrollBottomEl.hasCls(t))},setBottomKnobSize(){const t=this,i=t.widget;if(!i.nativeScroller){var l=i.getCenterViewWidth()-(t.corner?t.cornerSize:0),s=i.getCenterFullWidth()-(t.corner?t.cornerSize:0),r=l*((100-(s-l)/(s/100))/100)-2;r<t.minBottomKnobWidth&&(r=t.minBottomKnobWidth),t.bottomKnob.css({width:r}),i.doubleHorizontalScroll&&t.topKnob.css({width:r},e.ANIMATE_DURATION),t.bottomKnobWidth=r,t.bodyViewWidth=l,t.bottomScrollScale=(l-s)/(l-r-2-1),t.bodyFullViewWidth=s}},scroll(t,i,l){var s,r=this.widget;if(i>0&&(i=0),r.nativeScroller)return null!==t&&void 0!==t&&(r.body.el.dom.scrollTop=t),null!==i&&void 0!==i&&(r.body.el.dom.scrollLeft=Math.abs(i),r.header&&r.header.scroll(i,!0)),void r.fire("scroll");l&&(r.el.addCls("fancy-grid-columns-animation"),setTimeout(()=>{r.el.removeCls("fancy-grid-columns-animation")},e.ANIMATE_DURATION+150)),r.leftBody.scroll(t),s=r.body.scroll(t,i,l),r.rightBody.scroll(t),void 0!==s.scrollTop&&(this.scrollTop=Math.abs(s.scrollTop)),void 0!==s.scrollLeft&&(this.scrollLeft=Math.abs(s.scrollLeft)),r.fire("scroll"),e.isTouch&&(r._preventTouchDown=!0)},scrollDelta(e){var t,i=this.widget;if(i.leftBody.wheelScroll(e),t=i.body.wheelScroll(e),i.rightBody.wheelScroll(e),void 0!==t)return this.scrollTop=Math.abs(t.newScroll),i.fire("scroll"),t.scrolled},scrollRightKnob(){var e=this,t=e.widget,i=(t.store,e.getScroll()/e.rightScrollScale+t.knobOffSet);e.rightKnob&&(t.doubleHorizontalScroll&&(i+=e.cornerSize),t.infinite,e.rightKnob.css("margin-top",i+"px"))},scrollBottomKnob(){var e=this,t=e.widget,i=e.getBottomScroll(),l=i/e.bottomScrollScale+t.knobOffSet;0===i&&(l=-1),e.bottomKnob&&(e.bottomKnob.css("margin-left",-l+"px"),t.doubleHorizontalScroll&&e.topKnob.css("margin-left",-l+"px"))},getScroll(){const e=this.widget,t=e.store;if(e.nativeScroller)return e.body.el.dom.scrollTop;if(e.infinite)return Math.abs(t.infiniteScrolledToRow*e.cellHeight);if(0===e.columns.length){if(e.leftColumns.length)return Math.abs(parseInt(e.leftBody.el.select("."+i).item(0).css("top")));if(e.rightColumns.length)return Math.abs(parseInt(e.rightBody.el.select("."+i).item(0).css("top")))}const l=e.body.el.select("."+i);return 0===l.length?0:Math.abs(parseInt(l.item(0).css("top")))},getBottomScroll(){const e=this.widget;if(e.nativeScroller)return e.body.el.dom.scrollLeft;if(0===e.columns.length){if(e.leftColumns.length)return Math.abs(parseInt(e.leftBody.el.select("."+i).item(0).css("left")));if(e.rightColumns.length)return Math.abs(parseInt(e.rightBody.el.select("."+i).item(0).css("left")))}const t=e.body.el.select("."+i);return 0===t.length?0:Math.abs(parseInt(t.item(0).css("left")))},update(e){this.setScrollBars(e),this.checkScroll(e),this.scrollRightKnob(),this.scrollBottomKnob()},onChangeStore(){this.update()},onColumnResize(){const e=this;e.setScrollBars(),setTimeout(()=>{e.setScrollBars()},Fancy.ANIMATE_DURATION+20)},getScrollHeight(){const e=this,t=e.widget,i=t.getBodyHeight()-(e.corner?e.cornerSize:0),l=t.getCellsViewHeight()-(e.corner?e.cornerSize:0);return i>l?i:l-i},getScrollWidth(){const e=this,t=e.widget,i=t.getCenterViewWidth()-(e.corner?e.cornerSize:0),l=t.getCenterFullWidth()-(e.corner?e.cornerSize:0);return i>l?i:l-i},checkScroll(t){var i=this,l=i.widget,s=i.getScroll(),r=l.getBodyHeight()-(i.corner?i.cornerSize:0),o=(t||l.getCellsViewHeight())-(i.corner?i.cornerSize:0),n=l.getCenterFullWidth(),a=l.getCenterViewWidth(),d=i.getScrollTop(),c=i.getScrollLeft();n<c+a?setTimeout(function(){d=i.getScrollTop(),c=i.getScrollLeft();const e=n-(c+a);c+e<0?l.scroll(d,0):l.scroll(d,c+e)},e.nojQuery?10:e.ANIMATE_DURATION):s&&o<r&&(i.scroll(0),l.nativeScroller||i.scrollRightKnob())},scrollToCell(t,i,s){if(void 0!==t){var r=this,o=r.widget,n=o.store,a=o.cellHeight,d=e.get(t),c=d.parent(),h=Number(d.attr("index")),g=Number(c.attr("index")),u=r.getScroll(),p=a*(h+1),m=o.getBodyHeight(),f=r.getBottomScroll(),C=o.getSideByCell(t),y=o.getColumnsWidth(C),v=parseInt(o.body.el.css("width")),w=0,b=c.parent().parent().hasCls(l);if(o.rowheight&&(p=o.rowheight.rowIndexesSum[h]),!o.nativeScroller||i){if(o.infinite&&(h+=n.infiniteScrolledToRow,p+=a*n.infiniteScrolledToRow),0===h&&0===g){if(0===r.scrollLeft||"row"!==o.selModel&&"rows"!==o.selModel||o.selection&&o.selection.activeCell)if(o.selection&&o.selection.activeCell){"center"!==o.selection.getActiveCellInfo().side?r.scroll(0):r.scroll(0,0)}else r.scroll(0,0);else r.scroll(0);return r.scrollBottomKnob(),void r.scrollRightKnob()}if(0!==h||0===r.scrollTop){if(o.isGroupable()&&(p+=o.grouping.getSpecialRowsAbove(h)*o.groupRowHeight),o.expander&&(p+=o.expander.getBeforeHeight(h)),s){const e=o.getCellsViewHeight();e-(u=p-a)<m&&(u-=Math.abs(e-u-m)),r.scroll(u)}else if(p-u>m){var x=5;o.nativeScroller&&(x=20),u=p-m+x,r.scroll(u)}else p-u<o.cellHeight&&((u=p-a-5)<0&&(u=0),r.scroll(u));if(b){for(var S=o.columns,I=0;I<=g;I++)S[I].hidden||(w+=S[I].width);w-f>v?S[I]?r.scroll(u,-(f+(w-f)-v)):r.scroll(u,-(y-v)):w-f<S[g].width?((f=-(w-S[g].width))>0&&(f=0),r.scroll(u,f)):0!==f&&0===g&&r.scroll(u,0),r.scrollBottomKnob()}r.scrollRightKnob()}else r.scroll(0)}}},onNativeScrollBody(){const t=this.widget,i=t.body.el.dom.scrollTop,l=t.body.el.dom.scrollLeft;t.header&&t.header.scroll(-l),t.leftBody&&(t.leftBody.el.dom.scrollTop=i),t.rightBody&&(t.rightBody.el.dom.scrollTop=i),t.leftColumns.length&&t.leftBody.el.dom.scrollTop!==t.body.el.dom.scrollTop?t.body.el.dom.scrollTop=t.leftBody.el.dom.scrollTop:t.rightColumns.length&&t.rightBody.el.dom.scrollTop!==t.body.el.dom.scrollTop&&(t.body.el.dom.scrollTop=t.rightBody.el.dom.scrollTop),Fancy.nojQuery&&(t.panel?t.panel.el.select("."+Fancy.GRID_ANIMATION_CLS).removeCls(Fancy.GRID_ANIMATION_CLS):t.el.removeCls(Fancy.GRID_ANIMATION_CLS)),t.summary&&t.summary.scrollLeft(-l),t.subHeaderFilter&&t.filter.scrollLeft(-l),t.fire("nativescroll"),e.isTouch&&(t._preventTouchDown=!0)},onNativeScrollLeftBody(){const e=this.widget;e.leftBody.el.dom.scrollTop!==e.body.el.dom.scrollTop&&this.onNativeScrollBody()},onNativeScrollRightBody(){const e=this.widget;e.rightBody.el.dom.scrollTop!==e.body.el.dom.scrollTop&&this.onNativeScrollBody()},onMouseWheelLeft(t){const i=this.widget,l=e.getWheelDelta(t.originalEvent||t)*i.cellHeight;i.leftBody.el.dom.scrollTop-=l,i.body.el.dom.scrollTop-=l,i.rightBody.el.dom.scrollTop-=l},onMouseWheelRight(t){const i=this.widget,l=e.getWheelDelta(t.originalEvent||t)*i.cellHeight;i.leftBody.el.dom.scrollTop-=l,i.body.el.dom.scrollTop-=l,i.rightBody.el.dom.scrollTop-=l},onLockColumn(){const t=this;t.update(),t.widget.setColumnsPosition(),setTimeout(()=>{t.update(),t.widget.setColumnsPosition()},e.ANIMATE_DURATION)},onColumnDrag(){const t=this;e.nojQuery&&setTimeout(()=>{t.update()},e.ANIMATE_DURATION)},onRightLockColumn(){const t=this;t.update(),t.widget.setColumnsPosition(),setTimeout(()=>{t.update(),t.widget.setColumnsPosition()},e.ANIMATE_DURATION)},onUnLockColumn(){const t=this;t.update(),t.widget.setColumnsPosition(),setTimeout(()=>{t.update(),t.widget.setColumnsPosition()},e.ANIMATE_DURATION+100)},onPanelResize(){this.widget.scroll(0,0)},onChangePages(){var e=this;!e.widget.nativeScroller&&e.scrollTop&&setTimeout(()=>{e.scrollDelta(0)},1)},onScrollBodyBugFix(){const e=this.widget,t=e.body,i=t.el.dom.scrollLeft;t.el.dom.scrollLeft=this.scrollLeft,e.scroll(this.scrollTop,-this.scrollLeft-i)},getScrollTop(){const e=this.widget;return e.nativeScroller?e.body.el.dom.scrollTop:this.scrollTop},getScrollLeft(){const e=this.widget;return e.nativeScroller?e.body.el.dom.scrollLeft:this.scrollLeft}})}(),function(){const e=Fancy;let t;const i={title:function(e,t,i,l){e.setColumnTitle(i,t,l)},width:function(e,t,i,l){e.setColumnWidth(i,t,l)},hidden:function(e,t,i,l,s){t?e.hideColumn(s):e.showColumn(s)},render:function(e,i,l,s,r){clearInterval(t),e.getColumnById(r).render=i,t=setTimeout(function(){e.update()},1)}};e.define("Fancy.grid.plugin.RefreshColumn",{extend:e.Plugin,ptype:"grid.refreshcolumns",inWidgetName:"refreshcolumns",constructor:function(){this.Super("const",arguments)},setColumns(t){const i=this.widget;this.applyChanges(t),t=i.prepareConfigColumnsWidth({columns:t,width:i.width}).columns,t=i.prepareConfigColumns({columns:t},!1).columns,this.setColumnsByOrder(t),i.filter&&(clearInterval(i.intFilterFieldsUpdate),i.intFilterFieldsUpdate=setTimeout(()=>{delete i.intFilterFieldsUpdate,i.filter.updateFields()},e.ANIMATE_DURATION))},applyChanges(t){const i={},l=[];e.each(t,e=>{e.id?i[e.id]=e:e.index?i[e.index]=e:l.push(e)}),this.setChangesByIds(i),this.setChangesWithoutIds(l),this.setChangesToNotCheckedColumns(t)},setChangesByIds(t){const l=this.widget,s=l.getColumns();e.each(s,e=>{!e.id||/col-id-/.test(e.id)||t[e.id]||l.removeColumn(e.id)});for(const e in t){const s=l.getColumnById(e),r=l.getColumnOrderById(e),o=t[e];if(s){for(const t in i)void 0!==o[t]&&s[t]!==o[t]&&i[t](l,o[t],r.order,r.side,e);o.$checked=!0,s.$checked=!0}}},setChangesWithoutIds(t){const l=this.widget,s=l.getColumns();e.each(t,t=>{if(t.render){const r=[],o=t.render.toString();if(e.each(s,e=>{e.render&&o===e.render.toString()&&r.push(e)}),1===r.length){const e=r[0],s=l.getColumnOrderById(e.id);for(const r in i)void 0!==t[r]&&e[r]!==t[r]&&i[r](l,t[r],s.order,s.side,e.id);t.$checked=!0,e.$checked=!0}}})},setChangesToNotCheckedColumns(t){var i=this.widget,l=i.getColumns(),s=[],r={},o={};for(var n in e.each(l,e=>{e.$checked||(s.push(e),r[e.type]=r[e.type]||[],r[e.type].push(e))}),e.each(t,e=>{e.$checked||(o[e.type]=o[e.type]||[],o[e.type].push(e))}),r){var a=r[n];e.each(a,t=>{var i=o[n];e.each(i,e=>{var l=!0;for(const i in e)if(e[i]!==t[i]){l=!1;break}l&&(i.$checked=!0,t.$checked=!0)})})}s=[],e.each(l,e=>{e.$checked||s.push(e)}),e.each(s,e=>i.removeColumn(e.id)),e.each(t,e=>{delete e.$checked}),e.each(l,e=>{delete e.$checked})},setColumnsByOrder(t){const i=[],l=[],s=[];e.each(t,e=>{e.locked?i.push(e):e.rightLocked?l.push(e):s.push(e)}),this.setColumnsByOrderInSide(s,"center"),this.setColumnsByOrderInSide(i,"left"),this.setColumnsByOrderInSide(l,"right")},setColumnsByOrderInSide(t,i){const l=this.widget,s=l.getColumns(i);e.each(t,(e,t)=>{var r=!0,o=s[t];if(void 0!==o)for(const t in e){if(void 0!==e.id&&e.id===o.id)break;switch(t){case"width":case"hidden":continue}if(e[t]!==o[t]){r=!1;break}}else r=!1;if(!r)if(o&&o.index===e.index)l.removeColumn(o.id),l.addColumn(e,i,t,!1);else if(!e.id){const s=l.getColumnByIndex(e.index);s&&l.removeColumn(s.id),l.addColumn(e,i,t,!1)}})}})}(),Fancy.define("Fancy.grid.plugin.LoadMask",{extend:Fancy.Plugin,ptype:"grid.loadmask",inWidgetName:"loadmask",cls:"fancy-loadmask",innerCls:"fancy-loadmask-inner",imageCls:"fancy-loadmask-image",textCls:"fancy-loadmask-text",constructor:function(){this.Super("const",arguments)},init(){this.Super("init",arguments),this.ons()},ons(){const e=this,t=e.widget,i=t.store;t.once("render",()=>{e.render(),i.loading&&e.onBeforeLoad(),t.on("beforeload",e.onBeforeLoad,e),t.on("load",e.onLoad,e)})},render(){var e,t,i=this,l=i.widget,s=l.el,r=Fancy.newEl("div"),o=l.lang;l.panel&&(s=l.panel.el),e=s.width(),t=s.height(),r.addCls(i.cls),"default"!==l.theme&&r.addCls(Fancy.getThemeCSSCls(l.theme)),r.css({width:e,height:t,opacity:0}),i.loadText?r.update(['<div class="'+i.innerCls+'"><div class="'+i.textCls+'">'+i.loadText+"</div></div>"].join(" ")):r.update(['<div class="'+i.innerCls+'"><div class="'+i.imageCls+'"></div><div class="'+i.textCls+'">'+o.loadingText+"</div></div>"].join(" ")),i.el=Fancy.get(s.dom.appendChild(r.dom)),i.innerEl=i.el.select("."+i.innerCls),i.textEl=i.el.select("."+i.textCls);var n=i.innerEl.width(),a=i.innerEl.height(),d=e/2-n/2;d<10&&(i.intLeft=setInterval(function(){"none"===i.el.css("display")&&clearInterval(i.intLeft),n=i.innerEl.width(),a=i.innerEl.height(),(d=e/2-n/2)<10||(i.innerEl.css({left:d}),clearInterval(i.intLeft))},100)),i.innerEl.css({left:d,top:t/2-a/2}),!0!==l.store.loading?r.css("display","none"):!1===i.showOnWaitingServer?r.css("display","none"):r.css("display","block")},onBeforeLoad(){this.showOnWaitingServer&&this.show()},onLoad(){const e=this,t=e.widget;e.showOnWaitingServer&&t.once("update",()=>e.hide())},show(e){const t=this,i=t.el,l=t.widget.lang;if(i.stop(),i.css("opacity",1),t.el.css("display","block"),t.updateSize(),e)return t.textEl.update(e),void t.el.css("display","block");t.loaded=!1,setTimeout(()=>{!0!==t.loaded&&(t.textEl.update(t.loadText||l.loadingText),t.el.css("display","block"))},50)},hide(){const e=this,t=e.el;t.stop(),t.css("opacity",1),t.animate({opacity:0,force:!0},{complete(){e.loaded=!0,t.css("display","none")}})},updateSize(){const e=this,t=e.widget,i=t.getWidth(),l=t.getHeight();e.el.css({height:l,width:i});const s=i/2-Math.abs(e.innerEl.width())/2,r=l/2-Math.abs(e.innerEl.height())/2;e.innerEl.css({left:s,top:r})}}),function(){const e=Fancy,t=e.get,i=e.FIELD_CLS,l=e.GRID_RESIZER_LEFT_CLS,s=e.GRID_RESIZER_RIGHT_CLS,r=e.GRID_HEADER_CELL_TRIGGER_CLS,o=e.GRID_HEADER_CELL_TRIGGER_IMAGE_CLS,n=e.GRID_HEADER_CELL_CLS,a=e.GRID_COLUMN_RESIZER_CLS,d=e.GRID_COLUMN_CLS,c=e.GRID_HEADER_CELL_GROUP_LEVEL_2_CLS,h=e.GRID_STATE_RESIZE_COLUMN_CLS,g=e.ANIMATE_DURATION,u=`.${n}`;e.define("Fancy.grid.plugin.ColumnResizer",{extend:e.Plugin,ptype:"grid.columnresizer",inWidgetName:"columnresizer",constructor:function(){this.Super("const",arguments)},init(){const e=this,t=e.widget;e.Super("init",arguments),t.header&&t.on("render",function(){e.render(),e.ons()})},ons(){const e=this,t=e.widget;t.on("headercellmousemove",e.onCellMouseMove,e),t.on("headercellmousedown",e.onHeaderCellMouseDown,e),t.on("docclick",e.onDocClick,e),t.on("docmove",e.onDocMove,e),t.on("docmouseup",e.onDocMouseUp,e)},onCellMouseMove(e,l){var s=this,n=s.widget,a=l.e,d=t(l.cell),c=a.offsetX,h=d.width(),g=t(a.target),u=g.hasCls(r),p=g.hasCls(o),m=d.select("."+r).item(0),f=d.select("."+o).item(0),C=t(a.target).closest("."+i).hasCls(i),y=parseInt(m.css("width")),v=parseInt(f.css("width")),w=h,b=7;if(u&&(w=y),p&&(w=v),!n.startResizing)if(p)s.removeCellResizeCls(l.cell);else if("left"===l.side&&l.index===n.leftColumns.length-1&&w-c<b+2&&(b+=2),!u&&!p&&"right"===l.side&&0===l.index&&c<b)s.isColumnResizable(l)&&(C||s.addCellResizeCls(l.cell));else if(!u&&!p&&c<b&&"center"===l.side&&0===l.index&&n.leftColumns.length)l.side="left",l.index=n.leftColumns.length-1,s.isColumnResizable(l)&&(C||s.addCellResizeCls(l.cell));else if(u||p||!(w-c<b||c<b)||0===l.index)w-c<b?p?v-c>2?s.removeCellResizeCls(l.cell):s.addCellResizeCls(l.cell):s.isColumnResizable(l)&&s.addCellResizeCls(l.cell):s.removeCellResizeCls(l.cell);else{const e=c<b;s.isColumnResizable(l,e)&&(C||s.addCellResizeCls(l.cell))}},addCellResizeCls(e){const i=this.widget.columndrag;i&&"dragging"===i.status||(t(e).addCls(a),t(e).select("."+r).addCls(a))},removeCellResizeCls(e){t(e).removeClass(a),t(e).select("."+r).item(0).removeClass(a)},onHeaderCellMouseDown(l,s){l=s.e;var n=this,a=n.widget,d=t(l.target),c=t(s.cell),h=l.offsetX,g=c.width(),u=c.select("."+i),p=d.hasCls(r),m=d.hasCls(o),f=c.select("."+r).item(0),C=c.select("."+o).item(0),y=parseInt(f.css("width")),v=parseInt(C.css("width")),w=g,b=7;p&&(w=y),m?w=v:u.length>0&&u.item(0).within(d.dom)||("left"===s.side&&s.index===a.leftColumns.length-1&&w-h<b+2&&(b+=2),!p&&!m&&"right"===s.side&&0===s.index&&h<b?(a.startResizing=!0,e.apply(n,{cell:s.cell,activeSide:s.side,clientX:l.clientX,columnIndex:s.index,moveLeftResizer:!0})):h<7&&"center"===s.side&&0===s.index&&a.leftColumns.length?(a.startResizing=!0,s.side="left",s.index=a.leftColumns.length-1,e.apply(n,{cell:n.getCell(s),activeSide:s.side,clientX:l.clientX,columnIndex:s.index})):!p&&!m&&h<b&&0!==s.index?(a.startResizing=!0,e.apply(n,{cell:n.getPrevCell(s),activeSide:s.side,clientX:l.clientX,columnIndex:s.index-1})):w-h<b&&(a.startResizing=!0,e.apply(n,{cell:s.cell,activeSide:s.side,clientX:l.clientX,columnIndex:s.index})),a.startResizing&&n.isColumnResizable())},isColumnResizable(e,t){var i,l,s,r=this,o=r.widget;if(e){if(i=o.getColumns(e.side),s=e.index,t&&(l=i[--s],s>0&&i[s].hidden&&s--),isNaN(s))return;return l=i[s],!(0===s&&l.hidden&&("center"!==e.side||!o.leftColumns))&&(!l.hidden&&!0===l.resizable)}!0!==(i=o.getColumns(r.activeSide))[r.columnIndex].resizable&&(o.startResizing=!1,delete r.cell,delete r.activeSide,delete r.clientX,delete r.columnIndex)},getMinColumnWidth(){var e,t=this.widget,i=t.minCellWidth;return void 0===this.columnIndex?i:(e=t.getColumns(this.activeSide)[this.columnIndex]).minWidth?e.minWidth:i},getMaxColumnWidth(){var e,t=this.widget;return void 0!==this.columnIndex&&(!!(e=t.getColumns(this.activeSide)[this.columnIndex]).maxWidth&&e.maxWidth)},onDocClick(){this.widget.startResizing=!1},onDocMove(e,t){this.widget.startResizing&&this.moveResizeEls(t)},render(){const i=this.widget,r=e.newEl("div"),o=e.newEl("div");r.addCls(l),o.addCls(s),this.leftEl=t(i.el.dom.appendChild(r.dom)),this.rightEl=t(i.el.dom.appendChild(o.dom))},moveResizeEls(i){var l=this,s=l.widget,r=t(l.cell),o=parseInt(r.css("left")),n=l.getMinColumnWidth(),a=l.getMaxColumnWidth();switch(s.header.hideMenu&&s.header.hideMenu(),s.el.addCls(h),e.get(document.body).addCls(h),l.activeSide){case"left":break;case"center":o+=parseInt(s.leftEl.css("width"));break;case"right":o+=parseInt(s.leftEl.css("width")),o+=parseInt(s.centerEl.css("width"))}var d=i.clientX,c=d-l.clientX,g=r.width()+c;g<n&&(g=n),a&&g>a&&(g=a),l.deltaWidth=r.width()-g,l.moveLeftResizer?(c=d-l.clientX,(g=r.width()-c)<n&&(g=n),l.deltaWidth=r.width()-g,l.leftEl.css({display:"block",left:o+c+"px"}),l.rightEl.css({display:"block",left:o+r.width()-1+"px"})):(l.leftEl.css({display:"block",left:o+"px"}),l.rightEl.css({display:"block",left:o+g+"px"})),l.cellWidth=g},onDocMouseUp(){const t=this,i=t.widget;!1!==i.startResizing&&(i.el.removeCls(h),e.get(document.body).removeCls(h),t.leftEl.css({display:"none"}),t.rightEl.css({display:"none"}),t.fixSidesWidth(),i.startResizing=!1,t.moveLeftResizer=!1,delete t.cellWidth,i.scroller.update())},fixSidesWidth(){var i,l,s,r,o=this,n=o.widget,a=o.cellWidth,h=o.columnIndex,p=o.deltaWidth,m=n.leftEl,f=n.centerEl,C=n.rightEl,y=n.leftHeader.el,v=n.header.el,w=n.rightHeader.el,b=n.body.el,x={},S={},I=o.minCenterWidth;if(void 0!==a){var E=1;switch(e.nojQuery&&(E=0),o.activeSide){case"left":if((r=parseInt(f.css("width"))+p+E)<I)return;s=n.leftColumns[h],n.leftColumns[o.columnIndex].width=a,i=n.leftBody.el.select("."+d),l=n.leftHeader.el.select(u),(H=i.item(h)).animate({width:a},g),H.css("overflow","");for(var T=o.columnIndex+1,L=l.length,R=0,D=T;R<D;R++){(M=(F=l.item(R)).attr("group-index"))&&(S[M]=!0)}for(;T<L;T++){var _=i.item(T),F=l.item(T);_.animate({left:parseInt(_.css("left"))-p-E},g),F.hasCls(c)&&S[F.attr("index")]||F.animate({left:parseInt(F.css("left"))-p-E},g)}m.animate({width:parseInt(m.css("width"))-p-E},g),y.animate({width:parseInt(y.css("width"))-p-E+"px"},g),n.columns.length&&(f.animate({left:parseInt(f.css("left"))-p-E,width:r},g),v.animate({width:parseInt(v.css("width"))+p+E},g),b.animate({width:parseInt(b.css("width"))+p+E},g));break;case"center":s=n.columns[h],n.columns[o.columnIndex].width=a,i=n.body.el.select("."+d),l=n.header.el.select(u),(H=i.item(h)).animate({width:a},g),H.css("overflow","");for(T=o.columnIndex+1,L=l.length,R=0,D=T;R<D;R++){(M=(F=l.item(R)).attr("group-index"))&&(S[M]=!0)}for(;T<L;T++){_=i.item(T),F=l.item(T);var k=parseInt(_.css("left"))-p-E,B=parseInt(F.css("left"))-p-E;F.attr("group-index")&&(x[F.attr("group-index")]={}),_.animate({left:k},g),F.hasCls(c)&&S[F.attr("index")]||F.animate({left:B},g)}break;case"right":if((r=parseInt(f.css("width"))+p+E)<I)return;var H;s=n.rightColumns[h],n.rightColumns[o.columnIndex].width=a,i=n.rightBody.el.select("."+d),l=n.rightHeader.el.select(u),(H=i.item(h)).animate({width:a+"px"},g),H.css("overflow","");for(T=o.columnIndex+1,L=l.length,R=0,D=T;R<D;R++){var M;(M=(F=l.item(R)).attr("group-index"))&&(S[M]=!0)}for(;T<L;T++){_=i.item(T),F=l.item(T);_.animate({left:parseInt(_.css("left"))-p-E},g),F.hasCls(c)&&S[F.attr("index")]||F.animate({left:parseInt(F.css("left"))-p-E},g)}C.animate({width:parseInt(C.css("width"))-p-E},g),w.animate({width:parseInt(w.css("width"))-p-E+"px"},g),n.columns.length&&(f.animate({width:r},g),v.animate({width:parseInt(v.css("width"))+p+E},g),b.animate({width:parseInt(b.css("width"))+p+E},g))}var O,A=t(o.cell),N=A.attr("group-index");if(A.animate({width:a+"px"},g),N)(O=n.el.select("[index='"+N+"']")).animate({width:parseInt(O.css("width"))-p-E},g);else for(var W in x)(O=n.el.select("[index='"+W+"']")).css("left",parseInt(O.css("left"))-(x[W].delta||0)-E);if(n.fire("columnresize",{cell:A.dom,width:a,column:s,side:o.activeSide}),/sparkline/.test(s.type))switch(o.activeSide){case"left":n.leftBody.updateRows(void 0,h);break;case"center":n.body.updateRows(void 0,h);break;case"right":n.rightBody.updateRows(void 0,h)}else switch(s.type){case"progressbar":case"hbar":n.update()}}},getPrevCell(t){var i,l=this.widget;switch(t.side){case"left":i=l.leftHeader;break;case"center":i=l.header;break;case"right":i=l.rightHeader}const s=i.el.select(u).item(t.index-1).dom;return"none"===e.get(s).css("display")&&0!==t.index?(t.cell=s,t.index--,this.getPrevCell(t)):s},getCell(e){var t,i=this.widget;switch(e.side){case"left":t=i.leftHeader;break;case"center":t=i.header;break;case"right":t=i.rightHeader}return t.el.select(u).item(e.index).dom},updateColumnsWidth:function(t){if("all"===t)return this.updateColumnsWidth("left"),this.updateColumnsWidth("right"),void this.updateColumnsWidth("center");var i=1;e.nojQuery&&(i=0);for(var l=this.widget,s=(t=t||"center",l.getHeader(t)),r=l.getBody(t),o=l.getColumns(t),n=0,a=o.length,d=0,c=l.leftEl,h=l.rightEl,u=l.leftHeader.el,p=l.rightHeader.el;n<a;n++){const e=o[n];e.hidden||(d+=e.width,this.setColumnWidth(n,e.width,t))}switch(l.header&&(s.setCellsPosition(),s.updateCellsSizes()),r.updateColumnsSizes(),t){case"center":break;case"left":var m=parseInt(c.css("width")),f=parseInt(u.css("width")),C=m-d;c.animate({width:m-C-i},g),u.animate({width:f-C-i},g),l.columns.length&&this.updateCenterSideWidth();break;case"right":var y=parseInt(c.css("width"));f=parseInt(u.css("width")),C=y-d;h.animate({width:y-C},g),p.animate({width:f-C},g),l.columns.length&&this.updateCenterSideWidth()}},updateCenterSideWidth(){var t=this.widget,i=t.centerEl,l=t.header.el,s=t.body.el,r=0,o=0,n=t.getColumns("left"),a=t.getColumns("right"),d=t.width;t.panel?(d-=t.panelBodyBorders[1],d-=t.panelBodyBorders[3],d-=t.gridBorders[1],d-=t.gridBorders[3]):(d-=t.gridWithoutPanelBorders[1],d-=t.gridWithoutPanelBorders[3]);var c=1;e.nojQuery&&(c=0),e.each(n,e=>{e.hidden||(r+=e.width)}),e.each(a,e=>{e.hidden||(o+=e.width)}),d-=r,d-=o,d+=c,i.animate({left:r-c,width:d},g),i.animate({width:d},g),l.animate({width:d},g),s.animate({width:d},g)},setColumnWidth(e,i,l="center"){var s,r,o=this.widget,n=o.getColumns(l),a=o.getBody(l),d=t(a.getDomColumn(e));(o.header&&(s=o.getHeader(l).getCell(e)),parseInt(d.css("width"))!==i)&&(o.header&&(r=s.dom),o.fire("columnresize",{cell:r,width:i,column:n[e],side:l}))},getNextVisibleIndex(e,t){for(var i=this.widget.getColumns(t),l=e+1,s=i.length;l<s;l++){if(!i[l].hidden)return l}}})}(),Fancy.define("Fancy.grid.plugin.Licence",{extend:Fancy.Plugin,ptype:"grid.licence",inWidgetName:"licence",constructor:function(){this.Super("const",arguments)},init(){this.Super("init",arguments),this.ons()},ons(){const e=this;e.widget.once("render",()=>e.render())},render(){const e=this,t=e.widget,i=t.body,l=Fancy.newEl("div");/fancygrid/.test(location.host)&&!t.watermark||(!0!==e.checkLicence()||t.watermark)&&(l.css({position:"absolute","z-index":2,width:"30px",height:"30px"}),t.nativeScroller?l.css({top:"2px",left:"2px"}):l.css({right:"4px",bottom:"0px"}),l.update(['<a href="http://www.fancygrid.com" title="JavaScript Grid - FancyGrid">','<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">','<rect height="12" width="12" x="2" y="2" ry="2" stroke-width="0" fill="#088EC7"></rect>','<rect height="12" width="12" x="16" y="2" rx="2" stroke-width="0" fill="#A2CFE8"></rect>','<rect height="12" width="12" x="2" y="16" rx="2" stroke-width="0" fill="#A2CFE8"></rect>','<rect height="12" width="12" x="16" y="16" rx="2" stroke-width="0" fill="#088EC7"></rect>',"</svg>","</a>"].join("")),Fancy.get(i.el.append(l.dom)),e.licenceEl=l,t.watermark&&e.configWatermark(),e.showConsoleText())},showConsoleText(){window.console&&console.log&&Fancy.isChrome&&(console.log("%cFancy%cGrid%c %cTrial%c Version!","color:#A2CFE8;font-size: 14px;font-weight: bold;","color:#088EC7;font-size: 14px;font-weight: bold;","font-weight:bold;color: #515151;font-size: 12px;","color: red;font-weight: bold;font-size: 14px;","font-weight:bold;color: #515151;font-size: 12px;"),console.log("%cPurchase license for legal usage!\nSales email: sales@fancygrid.com","font-weight:bold;color: #515151;font-size: 12px;"))},configWatermark(){const e=this,t=e.widget.watermark;if(t.text){const i=e.licenceEl.firstChild();i.css("background-image","none"),i.css("font-size","11px"),i.update(t.text),e.licenceEl.css("width","initial")}t.style&&e.licenceEl.css(t.style)},checkLicence(){var e=this,t="FancyGrid";if(!Fancy.LICENSE&&!FancyGrid.LICENSE)return!1;var i,l,s=String(e.md5(location.host.replace(/^www\./,""),t)),r=Fancy.LICENSE||FancyGrid.LICENSE||[],o=e.md5("UNIVERSAL",t),n=e.md5("SAAS",t),a=e.md5("INTERNAL",t),d=e.md5("OEM",t),c=e.md5("ENTERPRISE",t);for(i=0,l=r.length;i<l;i++)switch(String(r[i])){case s:case o:case n:case a:case d:case c:return!0}return!1},md5(e,t,i){var l=function(e,t){var i=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(i>>16)<<16|65535&i},s=function(e,t,i,s,r,o){return l((n=l(l(t,e),l(s,o)))<<(a=r)|n>>>32-a,i);var n,a},r=function(e,t,i,l,r,o,n){return s(t&i|~t&l,e,t,r,o,n)},o=function(e,t,i,l,r,o,n){return s(t&l|i&~l,e,t,r,o,n)},n=function(e,t,i,l,r,o,n){return s(t^i^l,e,t,r,o,n)},a=function(e,t,i,l,r,o,n){return s(i^(t|~l),e,t,r,o,n)},d=function(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;var i,s,d,c,h,g=1732584193,u=-271733879,p=-1732584194,m=271733878;for(i=0;i<e.length;i+=16)s=g,d=u,c=p,h=m,g=r(g,u,p,m,e[i],7,-680876936),m=r(m,g,u,p,e[i+1],12,-389564586),p=r(p,m,g,u,e[i+2],17,606105819),u=r(u,p,m,g,e[i+3],22,-1044525330),g=r(g,u,p,m,e[i+4],7,-176418897),m=r(m,g,u,p,e[i+5],12,1200080426),p=r(p,m,g,u,e[i+6],17,-1473231341),u=r(u,p,m,g,e[i+7],22,-45705983),g=r(g,u,p,m,e[i+8],7,1770035416),m=r(m,g,u,p,e[i+9],12,-1958414417),p=r(p,m,g,u,e[i+10],17,-42063),u=r(u,p,m,g,e[i+11],22,-1990404162),g=r(g,u,p,m,e[i+12],7,1804603682),m=r(m,g,u,p,e[i+13],12,-40341101),p=r(p,m,g,u,e[i+14],17,-1502002290),u=r(u,p,m,g,e[i+15],22,1236535329),g=o(g,u,p,m,e[i+1],5,-165796510),m=o(m,g,u,p,e[i+6],9,-1069501632),p=o(p,m,g,u,e[i+11],14,643717713),u=o(u,p,m,g,e[i],20,-373897302),g=o(g,u,p,m,e[i+5],5,-701558691),m=o(m,g,u,p,e[i+10],9,38016083),p=o(p,m,g,u,e[i+15],14,-660478335),u=o(u,p,m,g,e[i+4],20,-405537848),g=o(g,u,p,m,e[i+9],5,568446438),m=o(m,g,u,p,e[i+14],9,-1019803690),p=o(p,m,g,u,e[i+3],14,-187363961),u=o(u,p,m,g,e[i+8],20,1163531501),g=o(g,u,p,m,e[i+13],5,-1444681467),m=o(m,g,u,p,e[i+2],9,-51403784),p=o(p,m,g,u,e[i+7],14,1735328473),u=o(u,p,m,g,e[i+12],20,-1926607734),g=n(g,u,p,m,e[i+5],4,-378558),m=n(m,g,u,p,e[i+8],11,-2022574463),p=n(p,m,g,u,e[i+11],16,1839030562),u=n(u,p,m,g,e[i+14],23,-35309556),g=n(g,u,p,m,e[i+1],4,-1530992060),m=n(m,g,u,p,e[i+4],11,1272893353),p=n(p,m,g,u,e[i+7],16,-155497632),u=n(u,p,m,g,e[i+10],23,-1094730640),g=n(g,u,p,m,e[i+13],4,681279174),m=n(m,g,u,p,e[i],11,-358537222),p=n(p,m,g,u,e[i+3],16,-722521979),u=n(u,p,m,g,e[i+6],23,76029189),g=n(g,u,p,m,e[i+9],4,-640364487),m=n(m,g,u,p,e[i+12],11,-421815835),p=n(p,m,g,u,e[i+15],16,530742520),u=n(u,p,m,g,e[i+2],23,-995338651),g=a(g,u,p,m,e[i],6,-198630844),m=a(m,g,u,p,e[i+7],10,1126891415),p=a(p,m,g,u,e[i+14],15,-1416354905),u=a(u,p,m,g,e[i+5],21,-57434055),g=a(g,u,p,m,e[i+12],6,1700485571),m=a(m,g,u,p,e[i+3],10,-1894986606),p=a(p,m,g,u,e[i+10],15,-1051523),u=a(u,p,m,g,e[i+1],21,-2054922799),g=a(g,u,p,m,e[i+8],6,1873313359),m=a(m,g,u,p,e[i+15],10,-30611744),p=a(p,m,g,u,e[i+6],15,-1560198380),u=a(u,p,m,g,e[i+13],21,1309151649),g=a(g,u,p,m,e[i+4],6,-145523070),m=a(m,g,u,p,e[i+11],10,-1120210379),p=a(p,m,g,u,e[i+2],15,718787259),u=a(u,p,m,g,e[i+9],21,-343485551),g=l(g,s),u=l(u,d),p=l(p,c),m=l(m,h);return[g,u,p,m]},c=function(e){var t,i="";for(t=0;t<32*e.length;t+=8)i+=String.fromCharCode(e[t>>5]>>>t%32&255);return i},h=function(e){var t,i=[];for(i[(e.length>>2)-1]=void 0,t=0;t<i.length;t+=1)i[t]=0;for(t=0;t<8*e.length;t+=8)i[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return i},g=function(e){var t,i,l="";for(i=0;i<e.length;i+=1)t=e.charCodeAt(i),l+="0123456789abcdef".charAt(t>>>4&15)+"0123456789abcdef".charAt(15&t);return l},u=function(e){return unescape(encodeURIComponent(e))},p=function(e){return function(e){return c(d(h(e),8*e.length))}(u(e))},m=function(e,t){return function(e,t){var i,l,s=h(e),r=[],o=[];for(r[15]=o[15]=void 0,s.length>16&&(s=d(s,8*e.length)),i=0;i<16;i+=1)r[i]=909522486^s[i],o[i]=1549556828^s[i];return l=d(r.concat(h(t)),512+8*t.length),c(d(o.concat(l),640))}(u(e),u(t))};return function(e,t,i){return t?i?m(t,e):g(m(t,e)):i?p(e):g(p(e))}(e,t,i)}}),function(){const e=Fancy,t=e.GRID_CELL_CLS,i=e.GRID_CELL_EVEN_CLS,l=e.GRID_CELL_SELECTED_CLS,s=e.GRID_COLUMN_CLS,r=e.GRID_COLUMN_TEXT_CLS,o=e.GRID_COLUMN_ELLIPSIS_CLS,n=e.GRID_COLUMN_ORDER_CLS,a=e.GRID_COLUMN_SELECT_CLS,d=e.GRID_COLUMN_TREE_CLS,c=e.GRID_CELL_INNER_CLS,h=e.GRID_CELL_DIRTY_CLS,g=e.GRID_CELL_DIRTY_EL_CLS,u=e.GRID_PSEUDO_CELL_CLS,p=e.GRID_EMPTY_CLS,m=e.GRID_COLUMN_SPARKLINE_CLS,f=e.GRID_COLUMN_SPARKLINE_BULLET_CLS,C=e.GRID_COLUMN_CHART_CIRCLE_CLS,y=e.GRID_COLUMN_SPARK_PROGRESS_DONUT_CLS,v=e.GRID_COLUMN_GROSSLOSS_CLS,w=e.GRID_COLUMN_PROGRESS_CLS,b=e.GRID_COLUMN_PROGRESS_BAR_CLS,x=e.GRID_COLUMN_H_BAR_CLS,S=e.GRID_COLUMN_ROW_DRAG_CLS,I=e.GRID_ROW_DRAG_EL_CLS,E=`.${t}`,T=`.${t} .${c}`;e.ns("Fancy.grid.body.mixin"),e.grid.body.mixin.Updater=function(){},e.grid.body.mixin.Updater.prototype={update(e){let t,i=this,l=i.widget,s=l.store;switch(e){case"cell":case"cells":break;case"waitstate":return void i.checkDomColumns();default:i.checkDomColumns()}if(!s.loading){switch(e){case"row":case"rows":for(var r in t=s.changed){var o=t[r],n=l.getRowById(r);for(var a in o)switch(a){case"length":break;default:i.updateRows(n)}}break;case"cell":case"cells":for(var r in t=s.changed){o=t[r],n=l.getRowById(r);for(var a in o)switch(a){case"length":break;default:var d=l.getColumnOrderByKey(a);i.updateRows(n,d.order)}}break;default:i.checkDomCells(),i.updateRows()}i.showEmptyText()}},checkDomColumns(){var t=this,i=t.widget,l=t.el.select("."+s).length,c=t.getColumns(),h=0,g=c.length;if(!(g<=l)){for(;h<g;h++){const l=c[h],g=l.width,u=e.newEl("div");if(l.hidden&&u.css("display","none"),u.addCls(s),u.attr("grid",i.id),u.attr("role","presentation"),"$selected"===l.index||l.select)u.addCls(a);else switch(l.type){case"order":u.addCls(n);break;case"rowdrag":u.addCls(S)}if("tree"===l.type&&(u.addCls(d),l.folder&&u.addCls("fancy-grid-tree-column-folder")),l.rowdrag&&u.addCls(S),l.cls&&u.addCls(l.cls),"text"===l.type&&u.addCls(r),u.css({width:g+"px"}),u.attr("index",h),l.cellAlign&&u.css("text-align",l.cellAlign),!0===l.ellipsis)switch(l.type){case"string":case"text":case"number":case"currency":case"date":case"combo":case"tree":u.addCls(o)}t.el.dom.appendChild(u.dom)}t.fire("adddomcolumns")}},checkDomCells(r){var o,n,a=this,d=a.widget,c=d.body,h=d.store,g=0,p=h.dataView.length,m=0;switch(h.infinite&&(p=h.infiniteDisplayedRows)>h.dataView.length&&(p=h.dataView.length),a.side){case"left":n=d.leftColumns;break;case"center":n=d.columns;break;case"right":n=d.rightColumns}o=n.length;var f=a.el.select("."+s),C=h.getLength(),y=a.cellTpl;for(d.cellWrapper&&(y=a.cellWrapperTpl),void 0!==r&&(m=r,o=r);m<o;m++){var v=f.item(m);for(g=p-(C-v.select(E).length);g<p;g++){var w=y.getHTML({});(b=e.newEl("div")).attr("role","gridcell"),b.css({height:d.cellHeight+"px"}),b.addCls(t),b.attr("index",g),g%2!=0&&d.striped&&b.addCls(i),b.update(w),v.dom.appendChild(b.dom),c.el.select("."+t+"."+l+'[index="'+g+'"]').length&&b.addCls(l)}if(d.nativeScroller&&("left"===a.side||"right"===a.side)){v.select(`.${u}`).destroy();var b;w=y.getHTML({cellValue:"&nbsp;"});(b=e.newEl("div")).attr("role","gridcell"),b.css({height:d.cellHeight+"px"}),b.addCls(u),b.update(w),v.dom.appendChild(b.dom)}}},updateRows(e,t){var i,l,s=this,r=s.widget,o=0;switch(void 0===e?s.clearDirty():s.clearDirty(e),s.side){case"left":i=r.leftColumns;break;case"center":i=r.columns;break;case"right":i=r.rightColumns}if(l=i.length,!(void 0!==t&&(o=t,(l=t+1)>i.length))){for(;o<l;o++){const t=i[o];switch(t.type){case"string":case"number":case"combo":case"action":case"text":case"date":case"currency":s.renderUniversal(o,e);break;case"tree":s.renderTree(o,e);break;case"order":s.renderOrder(o,e);break;case"expand":s.renderExpand(o,e);break;case"select":s.renderSelect(o,e);break;case"color":s.renderColor(o,e);break;case"checkbox":s.renderCheckbox(o,e);break;case"switcher":s.renderCheckbox(o,e,!0);break;case"image":s.renderImage(o,e);break;case"sparklineline":s.renderSparkLine(o,e,"line");break;case"sparklinebar":s.renderSparkLine(o,e,"bar");break;case"sparklinetristate":s.renderSparkLine(o,e,"tristate");break;case"sparklinediscrete":s.renderSparkLine(o,e,"discrete");break;case"sparklinebullet":s.renderSparkLine(o,e,"bullet");break;case"sparklinepie":s.renderSparkLine(o,e,"pie");break;case"sparklinebox":s.renderSparkLine(o,e,"box");break;case"circle":s.renderCircle(o,e);break;case"progressdonut":s.renderProgressDonut(o,e);break;case"progressbar":s.renderProgressBar(o,e);break;case"hbar":s.renderHBar(o,e);break;case"grossloss":s.renderGrossLoss(o,e);break;case"rowdrag":s.renderRowDrag(o,e);break;default:throw new Error("[FancyGrid error] - not existed column type "+t.type)}t.select&&s.renderSelect(o,e,!0),t.rowdrag&&s.renderRowDrag(o,e,!0)}s.removeNotUsedCells()}},renderUniversal(e,i){var l,r,o,n=this,a=n.widget,d=a.lang,c=a.emptyValue,h=a.store,g=n.getColumns()[e],u=n.el.select(`.${s}`).item(e),p=u.select(E),m=u.select(T),f=g.currency||d.currencySign,C=!1;g.select&&(C=!0),g.rowdrag&&(C=!0),l=void 0!==g.index?g.index:"action"===g.type?"none":void 0,void 0!==i?(r=i,o=i+1):(r=0,o=h.getLength());var y=0;if(a.infinite){y=h.infiniteScrolledToRow;const e=a.getNumOfVisibleCells();o>e&&(o=e)}for(;r<o;r++){if(a.infinite){var v=h.dataView[r+y],w=p.item(r);if(void 0===v){a.el.select("."+t+'[index="'+r+'"]').css("visibility","hidden");break}if("hidden"===w.css("visibility")){a.el.select("."+t+'[index="'+r+'"]').css("visibility","");break}}var b,x=h.get(r+y),S=h.getId(r+y),I=m.item(r),L=(w=p.item(r),{rowIndex:r,data:x,style:{},column:g,id:S,item:h.getItem(r+y),inner:I,cell:w}),R=!1;switch(h.changed[L.id]&&h.changed[L.id][g.index]&&(R=!0),b=g.smartIndexFn?g.smartIndexFn(x):void 0===l?"":h.get(r+y,l),L.value=b,g.format&&(L.value=n.format(L.value,g.format,g.precision),b=L.value),g.type){case"currency":""!==b&&(b=f+b),L.value=b}switch(g.render&&(b=(L=g.render(L)).value),b){case"":case null:case void 0:b=c}if(a.cellStylingCls&&n.clearCls(w),L.cls&&w.addCls(L.cls),R&&a.dirtyEnabled&&n.enableCellDirty(w),w.css(L.style),C){const e=[];g.rowdrag&&e.push('<div class="fancy-grid-cell-inner-rowdrag"></div>'),g.select?e.push('<div class="fancy-grid-cell-inner-select"></div>'):g.rowdrag&&e.push('<div class="fancy-grid-cell-inner-rowdrag-fix"></div>');const t=I.select(".fancy-grid-cell-inner-text");t.length?t.update(b):(e.push('<span class="fancy-grid-cell-inner-text">'+b+"</span>"),I.update(e.join(" ")))}else L.column.widget||I.update(b);if(L.column.autoHeight){w.css("height","");let e=parseInt(w.css("height"))+4;a.rowheight.waitToShow(),e<a.cellHeight&&(e=a.cellHeight),a.rowheight.add(S,e,L.rowIndex)}}},renderOrder(e){var t=this.widget,i=t.store,l=this.getColumns()[e],r=this.el.select(`.${s}`).item(e),o=r.select(E),n=r.select(T),a=0,d=i.getLength(),c=0;if(t.paging&&(c+=i.showPage*i.pageSize),t.infinite){const e=t.getNumOfVisibleCells();d>e&&(d=e),c=i.infiniteScrolledToRow}for(;a<d;a++){var h=i.get(a),g=i.getId(a),u={rowIndex:a,data:h,style:{},column:l,id:g,item:i.getItem(a)},p=a+1+c;t.grouping&&(p+=t.grouping.getCollapsedRowsBefore(g)),u.value=p,l.render&&(p=(u=l.render(u)).value);const e=o.item(a);t.cellStylingCls&&this.clearCls(e),u.cls&&e.addCls(u.cls),e.css(u.style),n.item(a).update(p)}t.grouping&&delete t.grouping.collapsedRowsBefore},renderRowDrag(e,t,i){var l=this.widget,r=l.store,o=this.getColumns()[e],n=this.el.select(`.${s}`).item(e),a=n.select(E),d=n.select(T),c=0,h=r.getLength();if(l.infinite){const e=l.getNumOfVisibleCells();h>e&&(h=e)}for(;c<h;c++){const e={rowIndex:c,data:r.get(c),style:{},column:o,id:r.getId(c),item:r.getItem(c)},t='<svg class="'+I+'" style="opacity: 0;" viewBox="0 0 6 14"><path fill-rule="evenodd" clip-rule="evenodd" d="M0 2h2V0H0v2zm0 4h2V4H0v2zm0 3.999h2V8H0v1.999zM0 14h2v-2H0v2zM4 0v2h2V0H4zm0 6h2V4H4v2zm0 3.999h2V8H4v1.999zM4 14h2v-2H4v2z"></path></svg>';e.value=t;const s=a.item(c);if(l.cellStylingCls&&this.clearCls(s),e.cls&&s.addCls(e.cls),s.css(e.style),i){d.item(c).select(".fancy-grid-cell-inner-rowdrag").item(0).update(t)}else d.item(c).update(t)}},renderTree(e,t){var i,l,r=this.widget,o=r.store,n=this.getColumns()[e],a=this.el.select(`.${s}`).item(e).select(T),d=n.index;if(void 0!==t?(i=t,l=t+1):(i=0,l=o.getLength()),r.infinite){const e=r.getNumOfVisibleCells();l>e&&(l=e)}for(;i<l;i++){var c=a.item(i),h=r.get(i),g=h.get(d),u=Number(h.get("$deep"))-1,p="fancy-grid-tree-expander";h.get("leaf")&&(p="fancy-grid-tree-expander-leaf"),h.get("expanded")&&(p+=" fancy-grid-tree-expander-expanded");let e=15*u,l="";if(n.render){const e=n.render({item:h,data:h.data,deep:u,leaf:h.get("leaf"),rowIndex:t,column:n,value:g});e.nodeImgCls&&(l='<span class="fancy-grid-tree-expander-node '+e.nodeImgCls+'"></span>'),void 0!==e.value&&(g=e.value)}if(n.folder){const e=h.get("leaf"),t=h.get("expanded");l=e?'<span class="fancy-grid-tree-folder-file"></span>':t?'<span class="fancy-grid-tree-folder-opened"></span>':'<span class="fancy-grid-tree-folder-closed"></span>'}h.get("leaf")&&(e-=8);const s=[];s.push('<span class="'+p+'" style="margin-left: '+e+'px;"></span>'),n.select&&s.push('<span class="fancy-grid-cell-inner-select" style="margin-left: 6px;"></span>'),s.push(l),s.push('<span class="fancy-grid-tree-expander-text">'+g+"</span>"),c.update(s.join(""))}},renderExpand(t,i){var l,r,o=this.widget,n=o.store,a=this.getColumns()[t],d=this.el.select(`.${s}`).item(t).select(T);if(void 0!==i?(l=i,r=i+1):(l=0,r=n.getLength()),o.infinite){const e=o.getNumOfVisibleCells();r>e&&(r=e)}for(;l<r;l++){var c,h=d.item(l).select(".fancy-field-checkbox"),g=0!==h.length,u=o.get(l).id;!1===g?(d.item(l).update(""),h=new e.CheckBox({renderTo:d.item(l).dom,renderId:!0,value:!1,label:!1,expander:!0,style:{padding:"0px",display:"inline-block"},events:[{change:function(e,t){i=e.el.parent().parent().attr("index"),t?o.expander.expand(i):o.expander.collapse(i)}}]})):(c=h.dom.id,h=e.getWidget(c),o.expander._expandedIds[u]?h.set(!0,!1):h.set(!1,!1));const t={rowIndex:l,data:n.get(l),style:{},column:a,id:n.getId(l),item:n.getItem(l)};a.render&&(!0===a.render(t).hidden?h.hide():h.show())}},clearCls(t){const i=this.widget;e.each(i.cellStylingCls,e=>t.removeCls(e))},renderColor(e,t){var i,l,r=this.widget,o=r.store,n=this.getColumns()[e],a=n.index,d=this.el.select("."+s).item(e).select(E);if(void 0!==t?(i=t,l=t+1):(i=0,l=o.getLength()),r.infinite){const e=r.getNumOfVisibleCells();l>e&&(l=e)}for(;i<l;i++){var h,g=o.get(i),u={rowIndex:i,data:g,style:{},column:n};h=n.smartIndexFn?n.smartIndexFn(g):o.get(i,a),n.render&&(h=(u=n.render(u)).value),u.value=h;const e=d.item(i);e.css(u.style),e.select(`.${c}`).update('<div class="fancy-grid-color-cell" style="background: '+h+';"></div>')}},renderCombo(e,t){var i,l,r=this.widget.store,o=this.getColumns()[e],n=o.index,a=this.el.select(`.${s}`).item(e),d=a.select(E),c=a.select(T);for(void 0!==t?(i=t,l=t+1):(i=0,l=r.getLength());i<l;i++){var h=r.get(i,n),g={rowIndex:i,value:h,style:{}};o.render&&(h=(g=o.render(g)).value),d.item(i).css(g.style),c.item(i).update(h)}},renderCheckbox(t,i,l){var r,o,n=this,a=n.widget,d=a.store,c=n.getColumns()[t],h=c.index,g=n.el.select(`.${s}`).item(t),u=g.select(E),p=g.select(T),m="CheckBox";if(l&&(m="Switcher"),void 0!==i?(r=i,o=i+1):(r=0,o=d.getLength()),a.infinite){const e=a.getNumOfVisibleCells();o>e&&(o=e)}for(;r<o;r++){var f,C=d.get(r),y=d.get(r,h),v=p.item(r),w=u.item(r),b=l?v.select(".fancy-field-switcher"):v.select(".fancy-field-checkbox"),x=0!==b.length,S=!1,I=d.getId(r),L={rowIndex:r,data:C,style:{},column:c,id:I,item:d.getItem(r),value:y};if(d.changed[L.id]&&d.changed[L.id][c.index]&&(S=!0),c.render&&(y=(L=c.render(L)).value),!1===x)if(L.stopped)p.item(r).update(y);else{let t=!0;a.rowEdit&&(t=!1),p.item(r).update(""),new e[m]({renderTo:p.item(r).dom,renderId:!0,value:y,label:!1,editable:t,style:{padding:"0px",display:"inline-block"},events:[{beforechange(e){"$selected"===c.index||c.select||!0!==c.editable&&(e.canceledChange=!0)}},{change(e,t){"$selected"===c.index||c.select||(a.celledit.checkBoxChangedValue=t)}}]})}else f=b.dom.id,b=e.getWidget(f),L.stopped?(b.destroy(),p.item(r).update(y)):b.set(y,!1);a.cellStylingCls&&n.clearCls(w),L.cls&&w.addCls(L.cls),w.css(L.style),S&&a.dirtyEnabled&&(w=u.item(r),n.enableCellDirty(w))}},renderSelect(t,i,r){let o;var n,a,d=this.widget,c=d.store,h=this.getColumns()[t],g=this.el.select(`.${s}`).item(t).select(T);if(void 0!==i?(n=i,a=i+1):(n=0,a=c.getLength()),d.infinite){const e=d.getNumOfVisibleCells();a>e&&(a=e)}for(;n<a;n++){var u,p,m=!1,f=c.get(n,"id"),C=g.item(n),y=0!==(o=C.select(".fancy-field-checkbox")).length,v=!0;if(d.selection.memory){if(d.selection.memory.all&&!d.selection.memory.excepted[f]?(m=!0,d.selection.domSelectRow(n)):d.selection.memory.has(f)?(m=!0,d.selection.domSelectRow(n)):(m=!1,d.selection.domDeSelectRow(n)),c.isTree){var w=(u=c.getItem(n)).get("$selected");if(w){const t=function(i){e.each(i,function(e){e.fields&&(!1!==e.get("$selected")?(u.set("$selected",void 0),e.set("$selected",!0),d.selection.memory.add(e.id),e.data.child&&e.data.child[0]&&e.data.child[0].fields&&t(e.data.child)):d.selection.memory.remove(e.id))})};t(u.data.child)}}}else C.parent().hasClass(l)&&(m=!0);if("select"===h.type||h.select)if(d.selection.disabled&&(v=!1),!1===y){let t=g.item(n);r?(t=t.select(".fancy-grid-cell-inner-select").item(0).dom,Fancy.isBoolean(m)||(m=!1)):(g.item(n).update(""),t=t.dom);const i={renderTo:t,renderId:!0,value:m,label:!1,stopIfCTRL:!0,editable:v,disabled:!v,style:{padding:"0px",display:"inline-block"},events:[{beforechange:function(e){d.selection.stopOneTick&&(e.canceledChange=!0)}}]};if(o=new e.CheckBox(i),c.isTree&&d.selection.memory&&d.selection.memory.tree.selected[f]&&!d.selection.memory.tree.allSelected[f]&&u){const e=u.get("child");e&&e.length&&o.setMiddle(!0)}}else p=o.dom.id,(o=e.getWidget(p)).set(m,!1)}},renderImage(e,t){var i,l,r=this.widget,o=r.store,n=this.getColumns()[e],a=n.index,d=this.el.select(`.${s}`).item(e),c=d.select(E),h=d.select(T);if(void 0!==t?(i=t,l=t+1):(i=0,l=o.getLength()),r.infinite){const e=r.getNumOfVisibleCells();l>e&&(l=e)}for(;i<l;i++){var g=o.get(i,a),u={rowIndex:i,value:g,data:o.get(i),style:{}},p="";if(n.render&&(g=(u=n.render(u)).value),u.attr)for(var m in u.attr)p+=m+'="'+u.attr[m]+'"';g="<img "+p+' src="'+u.value+'">',c.item(i).css(u.style),h.item(i).update(g)}},renderSparkLine(t,i,l){var r,o,n=this.widget,a=n.cellHeight,d=n.store,c=this.getColumns()[t],h=c.width,g=c.index,u=this.el.select(`.${s}`).item(t),p=u.select(E),C=u.select(T),y=c.sparkConfig||{};u.addCls(m),void 0!==i?(r=i,o=i+1):(r=0,o=d.getLength());var v,w=a-1,b=h-20;switch(l){case"line":case"pie":case"box":v="width";break;case"bullet":v="width",w-=11,u.addCls(f);break;case"discrete":v="width",b=h,w-=2;break;case"bar":case"tristate":v="barWidth"}if(n.infinite){const e=n.getNumOfVisibleCells();o>e&&(o=e)}for(;r<o;r++){var x=d.get(r,g),S={rowIndex:r,value:x,data:d.get(r),style:{}};if(c.render&&(x=(S=c.render(S)).value),e.isArray(c.values)){var I=0,L=c.values.length;for(x=[];I<L;I++)x.push(d.get(r,c.values[I]))}p.item(r).css(S.style);const t=C.item(r).dom,i={type:l,fillColor:"transparent",height:w};e.apply(i,y),"bar"!==l&&"tristate"!==l||(b=h-20,b/=x.length),i[v]=b,e.$(t).sparkline(x,i)}},renderProgressDonut(t,i){var l,r,o=this.widget,n=o.store,a=this.getColumns()[t],d=a.index,c=this.el.select(`.${s}`).item(t),h=c.select(E),g=c.select(T);if(c.addCls(y),void 0!==i?(l=i,r=i+1):(l=0,r=n.getLength()),o.infinite){const e=o.getNumOfVisibleCells();r>e&&(r=e)}for(;l<r;l++){var u,p=n.get(l),m={rowIndex:l,data:p,style:{},column:a};u=a.smartIndexFn?a.smartIndexFn(p):n.get(l,d),m.value=u,a.format&&(m.value=this.format(m.value,a.format),u=m.value),a.render&&(u=(m=a.render(m)).value),h.item(l).css(m.style);const t=a.sparkConfig||{},i=g.item(l).dom;e.apply(t,{renderTo:i,value:u}),t.size||t.height||t.width||(t.size=o.cellHeaderHeight-6),e.get(i).update(""),new e.spark.ProgressDonut(t)}},renderGrossLoss(t,i){var l,r,o=this.widget,n=o.store,a=this.getColumns()[t],d=a.index,c=this.el.select(`.${s}`).item(t),h=c.select(E),g=c.select(T);c.addCls(v),void 0!==i?(l=i,r=i+1):(l=0,r=n.getLength());const u=a.sparkConfig||{};if(u.showOnMax&&(u.maxValue=Math.max.apply(Math,n.getColumnData(d,a.smartIndexFn))),o.infinite){const e=o.getNumOfVisibleCells();r>e&&(r=e)}for(;l<r;l++){var p,m=n.get(l),f={rowIndex:l,data:m,style:{},column:a};p=a.smartIndexFn?a.smartIndexFn(m):n.get(l,d),f.value=p,a.format&&(f.value=this.format(f.value,a.format),p=f.value),a.render&&(p=(f=a.render(f)).value),h.item(l).css(f.style),e.apply(u,{renderTo:g.item(l).dom,value:p,column:a}),new e.spark.GrossLoss(u)}},renderProgressBar(t,i){var l,r,o=this,n=o.widget,a=n.store,d=o.getColumns()[t],c=d.index,h=o.el.select(`.${s}`).item(t),g=h.select(E),u=h.select(T),p=100;h.addCls(w),void 0!==i?(l=i,r=i+1):(l=0,r=a.getLength());const m=d.sparkConfig||{};if(!1===m.percents&&(p=Math.max.apply(Math,a.getColumnData(c))),n.infinite){const e=n.getNumOfVisibleCells();r>e&&(r=e)}for(;l<r;l++){var f,C=a.get(l),y={rowIndex:l,data:C,style:{},column:d},v=g.item(l);f=d.smartIndexFn?d.smartIndexFn(C):a.get(l,c),y.value=f,d.format&&(y.value=o.format(y.value,d.format),f=y.value),d.render&&(f=(y=d.render(y)).value),v.css(y.style),n.cellStylingCls&&o.clearCls(v),y.cls&&v.addCls(y.cls);const t=e.get(u.item(l).dom);if(t.select("."+b).length){const i=e.getWidget(t.select(`.${b}`).item(0).attr("id"));i.value=f,i.maxValue=p,i.update()}else e.apply(m,{renderTo:u.item(l).dom,value:f,column:d,maxValue:p}),new e.spark.ProgressBar(m)}},renderHBar(t,i){let l,r;var o,n,a=this.widget,d=a.store,c=this.getColumns()[t],h=c.index,g=this.el.select(`.${s}`).item(t),u=g.select(E),p=g.select(T),m=c.sparkConfig||{},f=c.disabled||{};g.addCls(x);var C,y,v={},w=(t=0,Number.MIN_VALUE);if(e.isArray(c.index))for(C=c.index.length;t<C;t++){const e=c.index[t];f[e]||(v[e]=d.getColumnData(e),(r=Math.max.apply(Math,v[e]))>w&&(w=r),y=v[e].length)}else{let e=[];for(C=(l=d.getColumnData(c.index)).length;t<C;t++){let e=0,i=l[t].length;for(;e<i;e++)f[e]||(v[e]=v[e]||[],v[e].push(l[t][e]))}for(var b in v)r=Math.max.apply(Math,v[b]),e.push(b),r>w&&(w=r),y=v[b].length;c.fields||(c.fields=e)}for(var S=[],I=0;I<y;I++)for(var b in S[I]=0,v)c.fields&&f[c.index+"."+b]||f[b]||(S[I]+=v[b][I]);const L=Math.max.apply(Math,S);if(m.maxItemValue=w,void 0!==i?(o=i,n=i+1):(o=0,n=d.getLength()),a.infinite){const e=a.getNumOfVisibleCells();n>e&&(n=e)}for(;o<n;o++){var R,D={rowIndex:o,data:l=d.get(o),style:{},column:c};R=c.smartIndexFn?c.smartIndexFn(l):d.get(o,h),D.value=R,c.format&&(D.value=this.format(D.value,c.format),R=D.value),c.render&&(R=(D=c.render(D)).value),u.item(o).css(D.style);const t=e.get(p.item(o).dom);if(t.select(".fancy-spark-hbar").length){const i=e.getWidget(t.select(".fancy-spark-hbar").item(0).attr("id"));i.maxValue=L,i.maxItemValue=w,i.update(l)}else e.apply(m,{renderTo:p.item(o).dom,value:R,data:l,column:c,maxValue:L,height:a.cellHeight-1}),new e.spark.HBar(m)}},renderCircle(e,t){var i,l,r=this.widget,o=r.store,n=this.getColumns()[e],a=n.index,d=this.el.select(`.${s}`).item(e),c=d.select(T),h=r.cellHeight-4;function g(e,t){const i="http://www.w3.org/2000/svg",l=document.createElementNS(i,"svg:svg");l.setAttribute("width",t),l.setAttribute("height",t),l.setAttribute("viewBox","0 0 "+t+" "+t);const s=document.createElementNS(i,"circle");s.setAttributeNS(null,"cx",t/2),s.setAttributeNS(null,"cy",t/2),s.setAttributeNS(null,"r",t/2);let r="#F0F0F0";t>50&&(r="F0F0F0"),e<0&&(r="#F9DDE0"),s.setAttributeNS(null,"fill",r),l.appendChild(s);var o=document.createElementNS(i,"path"),n=e*(2*Math.PI/100)-.001,a=t/2+t/2*Math.sin(0),d=t/2-t/2*Math.cos(0),c=t/2+t/2*Math.sin(n),h=t/2-t/2*Math.cos(n),g=0;n-0>Math.PI&&(g=1);var u="M "+t/2+","+t/2+" L "+a+","+d+" A "+t/2+","+t/2+" 0 "+g+" 1 "+c+","+h+" Z";o.setAttribute("d",u),e<0?o.setAttribute("fill","#EA7369"):o.setAttribute("fill","#44A4D3"),l.appendChild(o);const p=document.createElementNS(i,"circle");return p.setAttributeNS(null,"cx",t/2),p.setAttributeNS(null,"cy",t/2),p.setAttributeNS(null,"r",.25*t),p.setAttributeNS(null,"fill","#fff"),l.appendChild(p),l}if(d.addCls(C),void 0!==t?(i=t,l=t+1):(i=0,l=o.getLength()),r.infinite){const e=r.getNumOfVisibleCells();l>e&&(l=e)}for(;i<l;i++){var u,p=o.get(i),m={rowIndex:i,data:p,style:{}};u=n.smartIndexFn?n.smartIndexFn(p):o.get(i,a),m.value=u,n.render&&(u=(m=n.render(m)).value);const e=c.item(i).dom;""===e.innerHTML&&e.appendChild(g(u,h))}},removeNotUsedCells(){for(var e=this.widget.store,t=this.el.select("."+s),i=0,l=t.length;i<l;i++)for(var r=t.item(i).select(E),o=e.getLength(),n=r.length;o<n;o++)r.item(o).remove()},getFormat(t){const i=this.widget.lang;switch(t){case"number":return function(e,t){if(void 0===e)return"";const l=e.toString().split(i.decimalSeparator);if(t=t||0,l[0]=l[0].replace(/\B(?=(\d{3})+(?!\d))/g,i.thousandSeparator),l[1]){if(t>0){if(l[1].length<t){for(var s="",r=l[1].length;r<t;r++)s+="0";return l[0]+i.decimalSeparator+l[1]+s}return l[1]=String(l[1]).substring(0,t),l[0]+i.decimalSeparator+l[1]}return l[0]}if(t>0&&""!==l[0]){for(s="",r=0;r<t;r++)s+="0";return l[0]+i.decimalSeparator+s}return l[0]};case"date":return function(l){const s=e.Date.parse(l,i.date.read,t.mode);return l=e.Date.format(s,i.date.write,t.mode)}}switch(t.type){case"date":return function(i){let l;return i&&0!==i.length?(l=e.isDate(i)?i:e.Date.parse(i,t.read,t.mode),i=e.Date.format(l,t.write,void 0,t.mode)):""}}},format(t,i,l){switch(e.typeOf(i)){case"string":t=this.getFormat(i)(t,l);break;case"function":t=i(t);break;case"object":const s=this.getFormat(i);s&&(t=s(t))}return t},enableCellDirty(e){e.hasCls(h)||(e.addCls(h),e.append('<div class="'+g+'"></div>'))},clearDirty(e){const i=this;if(void 0!==e)return i.el.select("."+t+'[index="'+e+'"] .'+g).destroy(),void i.el.select("."+h+'[index="'+e+'"]').removeCls(h);i.el.select(`.${g}`).destroy(),i.el.select(`.${h}`).removeCls(h)},showEmptyText:function(){const t=this,i=t.widget,l=i.store;if("center"===t.side&&(t.emptyTextEl&&(t.emptyTextEl.destroy(),delete t.emptyTextEl),0===l.dataView.length)){const l=e.newEl("div");l.addCls(p),l.update(i.emptyText),t.emptyTextEl=e.get(t.el.dom.appendChild(l.dom))}}}}(),function(){const e=Fancy,t=e.GRID_CELL_CLS,i=e.GRID_CELL_INNER_CLS,l=e.GRID_COLUMN_CLS,s=e.GRID_BODY_CLS,r=e.GRID_CELL_WRAPPER_CLS,o=e.GRID_COLUMN_SELECT_CLS,n=e.GRID_COLUMN_ELLIPSIS_CLS,a=e.GRID_COLUMN_ORDER_CLS,d=e.GRID_COLUMN_TEXT_CLS,c=e.GRID_COLUMN_TREE_CLS,h=e.GRID_COLUMN_SPARKLINE_CLS,g=e.GRID_COLUMN_CHART_CIRCLE_CLS,u=e.GRID_COLUMN_SPARK_PROGRESS_DONUT_CLS,p=e.GRID_COLUMN_GROSSLOSS_CLS,m=e.GRID_COLUMN_PROGRESS_CLS,f=e.GRID_COLUMN_H_BAR_CLS,C=e.GRID_COLUMN_ROW_DRAG_CLS,y=e.GRID_ROW_EXPAND_CLS,v=e.ANIMATE_DURATION,w={sparklineline:h,sparklinebar:h,sparklinetristate:h,sparklinediscrete:h,sparklinebullet:h,sparklinepie:h,sparklinebox:h,circle:g,progressdonut:u,grossloss:p,progressbar:m,hbar:f};e.define("Fancy.grid.Body",{extend:e.Widget,mixins:[e.grid.body.mixin.Updater],cls:s,cellTpl:['<div class="'+i+'">{cellValue}</div>'],cellWrapperTpl:['<div class="'+r+'">','<div class="'+i+'">{cellValue}</div>',"</div>"],constructor:function(){this.Super("const",arguments)},init(){const e=this;e.Super("init",arguments),e.addEvents("adddomcolumns"),e.initTpl(),e.render(),e.ons()},initTpl(){this.cellTpl=new e.Template(this.cellTpl),this.cellWrapperTpl=new e.Template(this.cellWrapperTpl)},ons(){const i=this,s=i.widget,r=s.id;s.on("afterrender",i.onAfterRender,i);const o=`.${l}[grid="${r}"]`,n=`${o} div.${t}`;i.el.on("click",i.onCellClick,i,n),Fancy.isTouch||i.el.on("dblclick",i.onCellDblClick,i,n),i.el.on("mouseenter",i.onCellMouseEnter,i,n),i.el.on("mouseleave",i.onCellMouseLeave,i,n),e.isTouch?i.el.on("touchend",i.onCellMouseDown,i,n):i.el.on("mousedown",i.onCellMouseDown,i,n),i.el.on("mouseenter",i.onColumnMouseEnter,i,o),i.el.on("mouseleave",i.onColumnMouseLeave,i,o),e.isTouch?i.initTouchContextMenu(n):i.el.on("contextmenu",i.onContextMenu,i,n),i.el.on("mouseleave",i.onBodyLeave,i)},render(){let t,i=this.widget,l=e.newEl("div");l.addCls(s),l.attr("role","presentation"),t=i.el.select(`.fancy-grid-${this.side}`).dom,this.el=e.get(t.appendChild(l.dom))},onAfterRender(){const e=this,t=e.widget,i=t.store;("left"!==e.side||t.leftColumns.length)&&("right"!==e.side||t.rightColumns.length)&&(!t.grouping||t.grouping&&!t.grouping.by?t.state&&t.state.startState&&(t.state.startState.sorters||t.state.startState.filters||void 0!==t.state.startState.page)?e.update("waitstate"):e.update():t.grouping&&"server"===i.proxyType&&e.update(),e.setHeight())},setColumnsPosition(t,i){var s=this.widget,r=this.getColumns(),o=0,n=r.length,a=0,d=this.el.select(`.${l}[grid="${s.id}"]`);for(a+=t=t||this.scrollLeft||0;o<n;o++){const t=r[o],l=d.item(o);i&&!e.nojQuery?l.animate({left:a+"px"},e.ANIMATE_DURATION):l.css({left:a+"px"}),t.hidden||(a+=t.width)}},wheelScroll(e){const t=this.widget,i=(t.store,t.knobOffSet),s=this.el.select(`.${l}[grid="${t.id}"]`);if(0!==s.length){var r=parseInt(s.item(0).css("top")),o=0,n=s.length,a=t.getBodyHeight(),d=t.getCellsViewHeight()-a+i,c={oldScroll:parseInt(s.item(0).css("top")),newScroll:parseInt(s.item(0).css("top"))+30*e,deltaScroll:30*e};for(d<0&&(d=0);o<n;o++){let t=s.item(o),l=parseInt(t.css("top"))+30*e;l>0?(l=0,c.newScroll=0):Math.abs(l)>d&&(l=-d-i,c.newScroll=l),l>0&&(l=0),t.css("top",l+"px")}return c.scrolled=r!==parseInt(s.item(0).css("top")),c}},scroll(e,t,i){var s=this,r=s.widget,o=r.scroller,n=r.store,a=s.el.select(`.${l}[grid="${r.id}"]`),d=0,c=a.length,h={};if(!1!==e&&null!==e&&void 0!==e)if(h.scrollTop=e,r.infinite){if(o.scrollTop!==e){const t=Math.round(e/r.cellHeight);if(n.infiniteScrolledToRow!==t){if(n.infiniteScrolledToRow=t,s.infiniteTimeOut){new Date-s.infiniteTimeOutDate<100&&clearInterval(s.infiniteTimeOut)}else s.infiniteTimeOutDate=new Date;s.infiniteTimeOut=setTimeout(function(){r.leftBody.update(),r.body.update(),r.rightBody.update(),clearInterval(s.infiniteTimeOut),delete s.infiniteTimeOut,delete s.infiniteTimeOutDate},1)}}}else for(;d<c;d++){a.item(d).css("top",-e+"px")}return!1!==t&&null!==t&&void 0!==t&&(h.scrollLeft=t,r.header&&r.header.scroll(t,i),s.scrollLeft=t,r.body.setColumnsPosition(t,i),"center"===s.side&&(r.grouping&&r.grouping.by&&r.grouping.scrollLeft(t),r.summary&&r.summary.scrollLeft(t),r.subHeaderFilter&&r.filter.scrollLeft(t))),h},setHeight(){const e=this.widget.getBodyHeight();this.css("height",`${e}px`)},onCellClick(t){const i=this,l=i.widget;if(e.isTouch)if(i.waitForDblClickInt){if(new Date-i.waitForDblClickDate<500)return l.fire("celldblclick",i.getEventParams(t)),l.fire("rowdblclick",i.getEventParams(t)),void l.fire("columndblclick",i.getColumnEventParams(t));delete i.waitForDblClickInt,delete i.waitForDblClickDate}else i.waitForDblClickDate=new Date,i.waitForDblClickInt=setTimeout(function(){delete i.waitForDblClickInt,delete i.waitForDblClickDate},500);l.fire("cellclick",i.getEventParams(t)),l.fire("rowclick",i.getEventParams(t)),l.fire("columnclick",i.getColumnEventParams(t)),!1===l.activated&&(l.activated=!0,l.fire("activate"))},onCellDblClick(e){const t=this.widget;t.fire("celldblclick",this.getEventParams(e)),t.fire("rowdblclick",this.getEventParams(e)),t.fire("columndblclick",this.getColumnEventParams(e))},getEventParams(t){const i=this.widget.store,l=this.getColumns(),s=t.currentTarget,r=e.get(t.currentTarget),o=r.parent();if(void 0===r.parent().dom)return!1;if(0===i.getLength())return!1;if(void 0===o.attr("index"))return!1;const n=i.infiniteScrolledToRow||0;let a=parseInt(o.attr("index")),d=parseInt(r.attr("index")),c=l[a],h=c.index,g=i.get(d+n,h),u=i.getId(d+n),p=i.get(d+n),m=i.getById(u);return c.smartIndexFn&&(g=c.smartIndexFn(p)),{e:t,id:u,side:this.side,cell:s,column:c,rowIndex:d,infiniteRowIndex:d+n,columnIndex:a,value:g,data:p,item:m}},getColumnEventParams(t){const i=this.widget,l=i.store,s=e.get(t.currentTarget),r=s.parent(),o=parseInt(r.attr("index")),n=this.getColumns()[o],a={e:t,side:this.side,columnIndex:o,column:n,columnDom:r.dom,cell:s.dom};return i.columnClickData&&(a.data=l.getColumnData(n.index,n.smartIndexFn)),a},getColumnHoverEventParams(i){let l=e.get(i.currentTarget),s=parseInt(l.attr("index")),r=this.getColumns()[s],o=i.target;return e.get(o).hasCls(t)||(o=e.get(o).parent("."+t).dom),{e:i,side:this.side,columnIndex:s,column:r,columnDom:l.dom,cell:o}},getColumns(){return this.widget.getColumns(this.side)},onCellMouseEnter(t){const i=this,l=i.widget,s=i.getEventParams(t),r=i.prevCellOver;e.nojQuery&&r&&i.fixZeptoBug&&(s.rowIndex===r.rowIndex&&s.columnIndex===r.columnIndex&&s.side===r.side||(l.fire("cellleave",r),s.rowIndex!==r.rowIndex&&l.fire("rowleave",r))),r?s.rowIndex!==i.prevCellOver.rowIndex&&l.fire("rowenter",s):l.fire("rowenter",s),l.fire("cellenter",s),i.prevCellOver=s},onCellMouseDown(t){const i=this.widget,l=this.getEventParams(t),s={e:l.e,side:l.side,columnDom:e.get(l.cell).parent().dom,column:l.column,columnIndex:l.columnIndex,cell:l.cell};2===t.button&&2===t.buttons||3===t.which||(i.fire("beforecellmousedown",l),i.fire("cellmousedown",l),i.fire("columnmousedown",s),!1===i.activated&&(i.activated=!0,i.fire("activate")))},onCellMouseLeave(t){const i=this,l=i.widget,s=i.getEventParams(t),r=i.prevCellOver;if(e.nojQuery){if(s.rowIndex+1===l.getDataView().length){const e=s.cell.getBoundingClientRect();if(t.clientY>e.top+e.height-2)return l.fire("rowleave",r),l.fire("cellleave",r),void delete i.prevCellOver}if(void 0===r)return;i.fixZeptoBug=s}else l.fire("rowleave",r),l.fire("cellleave",r),delete i.prevCellOver},onColumnMouseEnter(e){const t=this,i=t.widget,l=t.getColumnHoverEventParams(e);t.prevColumnOver?t.prevCellOver&&l.rowIndex!==t.prevCellOver.rowIndex&&i.fire("rowenter",l):i.fire("columnenter",l),t.prevColumnOver=l},onColumnMouseLeave(){this.widget.fire("columnleave",this.prevColumnOver),delete this.prevColumnOver},getCell(e,i){const s=this.widget;return this.el.select("."+l+'[index="'+i+'"][grid="'+s.id+'"] .'+t+'[index="'+e+'"]')},getDomCell(e,i){const s=this.widget;return this.el.select("."+l+'[index="'+i+'"][grid="'+s.id+'"] .'+t+'[index="'+e+'"]').dom},getDomColumn(e){const t=this.widget;return this.el.select("."+l+'[index="'+e+'"][grid="'+t.id+'"]').dom},destroy(){const i=this,s=i.el,r="div."+t,o="div."+l;s.un("click",i.onCellClick,i,r),Fancy.isTouch||s.un("dblclick",i.onCellDblClick,i,r),s.un("mouseenter",i.onCellMouseEnter,i,r),s.un("mouseleave",i.onCellMouseLeave,i,r),e.isTouch?s.un("touchend",i.onCellMouseDown,i,r):s.un("mousedown",i.onCellMouseDown,i,r),s.un("mouseenter",i.onColumnMouseEnter,i,o),s.un("mouseleave",i.onColumnMouseLeave,i,o)},hideColumn(e){var t=this.widget,i=this.getColumns(),s=this.el.select("."+l),r=s.item(e),o=0,n=i.length,a=0;for("center"===this.side&&(a-=t.scroller.scrollLeft),r.hide();o<n;o++){r=s.item(o);var d=i[o],c=parseInt(r.css("left"));d.hidden||(c!==a&&(r.stop(),r.animate({left:a},v)),a+=d.width)}},showColumn(t,i){var s=this.widget,r=this.getColumns(),o=this.el.select("."+l),n=o.item(t),a=0,d=0,c=r.length;for("center"===this.side&&(a-=s.scroller.scrollLeft),e.isNumber(i)&&n.css("width",i+"px"),n.show();d<c;d++){n=o.item(d);parseInt(n.css("left"));const e=r[d];e.hidden||(n.stop(),n.animate({left:a},v),a+=e.width)}},removeColumn(e){var t=this.el.select("."+l),i=t.item(e),s=parseInt(i.css("width")),r=e+1,o=t.length;for(i.destroy();r<o;r++){const e=t.item(r),i=parseInt(e.css("left"))-s;e.attr("index",r-1),e.css("left",i)}},insertColumn(t,i){var s,r=this,h=r.widget,g=r.getColumns(),u=r.el.select("."+l),p=i.width,m=e.newEl("div"),f=t,y=u.length,v=0,w=0,b=t;for("center"===r.side&&(v=-h.scroller.scrollLeft);w<b;w++)g[w].hidden||(v+=g[w].width);for(s=v;f<y;f++){if(g[f].hidden)continue;const e=u.item(f);v=parseInt(e.css("left"))+i.width,e.css("left",v),e.attr("index",f+1)}if(m.attr("role","presentation"),m.addCls(l),m.attr("grid",h.id),"$selected"===i.index||i.select)m.addCls(o);else switch(i.type){case"order":m.addCls(a);break;case"rowdrag":m.addCls(C)}if(i.cls&&m.addCls(i.cls),"tree"===i.type&&(m.addCls(c),i.folder&&m.addCls("fancy-grid-tree-column-folder")),"text"===i.type&&m.addCls(d),m.css({width:p+"px"}),m.attr("index",t),i.cellAlign&&m.css("text-align",i.cellAlign),!0===i.ellipsis)switch(i.type){case"string":case"text":case"number":case"date":case"combo":case"tree":m.addCls(n)}const x=h.scroller.getScroll();m.css("top",-x),0===t&&u.length?(m.css("left","0px"),r.el.dom.insertBefore(m.dom,u.item(t).dom)):0!==t&&u.length?t===u.length?(m.css("left",v+"px"),r.el.dom.appendChild(m.dom)):(m.css("left",s+"px"),r.el.dom.insertBefore(m.dom,u.item(t).dom)):(m.css("left",v+"px"),r.el.dom.appendChild(m.dom)),r.checkDomCells(),r.updateRows(void 0,t)},reSetIndexes(){this.el.select(`.${l}`).each((e,t)=>{e.attr("index",t)})},clearColumnsStyles(){this.el.select(`div.${t}`).each(e=>{e.css("color",""),e.css("background-color","")})},updateColumnsSizes(){let t=this,i=t.widget,s=t.getColumns(),r=0;"center"===t.side&&(r=-i.scroller.scrollLeft),e.each(s,(e,i)=>{if(e.hidden)return;const s=t.el.select(`.${l}[index="${i}"]`);Fancy.nojQuery?s.css({width:e.width,left:r}):(s.$dom.stop(),s.animate({width:e.width,left:r},v,void 0,()=>{s.css("overflow","")})),r+=e.width})},reSetColumnsAlign(){const e=this.getColumns();this.el.select(`.${l}`).each(function(t,i){const l=e[i];t.css("text-align",l.cellAlign||"")})},reSetColumnsCls(){const t=this.getColumns();this.el.select(`.${l}`).each((i,s)=>{const r=t[s],d=i.attr("class").split(" ");if(e.each(d,e=>{switch(e){case l:case r.cls:case w[r.type]:break;default:i.removeCls(e)}}),r.cls&&i.addCls(r.cls),r.ellipsis)switch(r.type){case"checkbox":break;default:i.addCls(n)}switch(r.type){case"order":i.addCls(a);break;case"select":i.addCls(o);break;case"rowdrag":i.addCls(C);break;case"tree":i.addCls(c),r.folder&&i.addCls("fancy-grid-tree-column-folder")}r.select&&i.addCls(o),r.rowdrag&&i.addCls(C)})},initTouchContextMenu(e){this.el.on("touchstart",this.onTouchStart,this,e)},onTouchStart(e){const t=this;t.touchEvent=e,t.intTouchStart=setTimeout(()=>{t.touchLongPress=!0},1e3),t.el.once("touchend",t.onTouchEnd,t),t.el.once("touchmove",t.onTouchMove,t)},onTouchEnd(){const e=this,t=e.widget;e.touchLongPress&&t.fire("contextmenu",e.getEventParams(e.touchEvent)),clearInterval(e.intTouchStart),e.el.un("touchmove",e.onTouchMove),delete e.touchLongPress},onTouchMove(){clearInterval(this.intTouchStart),delete this.touchLongPress,this.un("touchend",this.onTouchEnd)},onContextMenu(e){this.widget.fire("contextmenu",this.getEventParams(e))},updateColumnsVisibility(){const e=this.getColumns();this.el.parent().select(`:not(.${y}) .${l}`).each((t,i)=>{e[i].hidden?t.hide():"none"===t.css("display")&&t.show()})},onBodyLeave(){delete this.prevCellOver}})}(),function(){const e=Fancy,t=e.GRID_HEADER_CLS,i=e.GRID_HEADER_CELL_CLS,l=e.GRID_HEADER_CELL_CONTAINER_CLS,s=e.GRID_HEADER_CELL_TEXT_CLS,r=e.GRID_HEADER_CELL_LEFT_IMAGE_CLS,o=e.GRID_HEADER_CELL_CONTAINS_LI,n=e.GRID_HEADER_CELL_TRIGGER_CLS,a=e.GRID_HEADER_CELL_TRIGGER_IMAGE_CLS,d=e.GRID_HEADER_CELL_TRIGGER_DISABLED_CLS,c=e.GRID_HEADER_CELL_GROUP_LEVEL_1_CLS,h=e.GRID_HEADER_CELL_GROUP_LEVEL_2_CLS,g=e.GRID_HEADER_CELL_SELECT_CLS,u=e.GRID_HEADER_CELL_FILTER_FULL_CLS,p=e.GRID_HEADER_CELL_FILTER_SMALL_CLS,m=e.GRID_HEADER_CELL_TRIPLE_CLS,f=e.GRID_HEADER_CELL_CHECKBOX_CLS,C=e.GRID_HEADER_CELL_SORTABLE_CLS,y=e.GRID_HEADER_CELL_NOT_SORTABLE_CLS,v=e.FIELD_CHECKBOX_CLS,w=e.ANIMATE_DURATION;e.define("Fancy.grid.Header",{extend:e.Widget,cls:t,mixins:["Fancy.grid.header.mixin.Menu"],cellTpl:['<div role="columnheader" col-id="{id}" class="'+i+' {cls}" style="display:{display};width:{columnWidth}px;height: {height};left: {left};" {groupIndex} index="{index}">','<div class="'+l+'" style="height: {height};">','<span class="'+r+' {headerLImageCls}">&nbsp;</span>','<span class="'+s+'">{columnName}</span>','<span class="'+n+'">','<div class="'+a+'"></div>',"</span>","</div>","</div>"],constructor:function(){this.Super("const",arguments)},init(){const e=this;e.Super("init",arguments),e.initTpl(),e.render(),e.renderHeaderCheckBox(),e.setAlign(),e.setCellsPosition(),e.ons()},initTpl(){this.cellTpl=new e.Template(this.cellTpl)},ons(){const e=this,t=e.widget,l=e.el,r=`div.${i}`;t.on("render",e.onAfterRender,e),t.on("docmove",e.onDocMove,e),t.on("columndrag",e.onColumnDrag,e),l.on("click",e.onTriggerClick,e,`span.${n}`),l.on("click",e.onCellClick,e,r),l.on("mousemove",e.onCellMouseMove,e,r),l.on("mousedown",e.onCellMouseDown,e,r),l.on("mousedown",e.onMouseDown,e),l.on("dblclick",e.onCellTextDBLClick,e,`.${s}`),l.on("mouseenter",e.onCellMouseEnter,e,r),l.on("mouseleave",e.onCellMouseLeave,e,r)},render(){var t,i=this,l=i.widget,s=i.getColumns(),r=e.newEl("div"),n="",a=0,h=s.length,m=1,f={},v=0,w=l.filter&&l.filter.header&&!l.subHeaderFilter,b="full",x=l.cellHeaderHeight;for(l.groupheader&&(w&&!l.filter.groupHeader?b="small":m=2),w&&m++;a<h;a++){var S=s[a],I=S.title||S.header,E=x,T="",L="";if(void 0!==I&&""!==I&&" "!==I||(I="&nbsp;"),1!==m)if(S.grouping){if(!f[S.grouping]){const e=l.groupheader.groupsMap[S.grouping];f[S.grouping]={width:0,title:S.grouping,left:v,cls:e.headerCls||""}}E=w&&l.filter.groupHeader?2*x+"px":x+"px",S.hidden||(f[S.grouping].width+=S.width),L='group-index="{column.grouping}"',T=c}else E=m*x+"px";if(v+=S.width,("$selected"===S.index||S.select)&&(T+=" "+g),S.menu||(T+=" "+d),S.filter&&S.filter.header)switch(b){case"small":T+=" "+p;break;case"full":l.subHeaderFilter||(T+=" "+u)}S.headerLImageCls&&(T+=" "+o),S.headerCls&&(T+=" "+S.headerCls),S.sortable?T+=" "+C:T+=" "+y,e.isNumber(E)&&(E+="px");const t={cls:T,columnName:I,columnWidth:S.width,index:a,height:E,left:"initial",groupIndex:L,display:S.hidden?"none":"",id:S.id||"",headerLImageCls:S.headerLImageCls||""};n+=i.cellTpl.getHTML(t)}r.css({height:x*m+"px",width:i.getColumnsWidth()}),r.attr("role","presentation"),r.addCls(i.cls),l.groupheader&&(r.addCls("fancy-grid-header-grouped"),n+=i.getGroupingCellsHTML(f)),r.update(n),t=l.el.select(".fancy-grid-"+i.side).dom,i.el=e.get(t.appendChild(r.dom))},insertCell(t,i){var l,s=this,r=s.widget,o=s.getCells(),n=s.getColumns(),a="",c=i.title||i.header,u=0;if(o.length&&(l=parseInt(o.item(0).css("height"))),l=parseInt(r.header.el.css("height")),"center"===s.side&&(u=-r.scroller.scrollLeft),r.groupheader){const e=s.el.select(`.${h}`);t!==r.columns.length-1&&e.each(e=>{const t=parseInt(e.css("left")||0)+i.width;e.css("left",t)})}("$selected"===i.index||i.select)&&(a+=" "+g),i.menu||(a+=" "+d);for(var p=0,m=t;p<m;p++)n[p].hidden||(u+=n[p].width);"center"===s.side&&(u+=r.scroller.scrollLeft||0),i.headerCls&&(a+=" "+i.headerCls),i.sortable?a+=" "+C:a+=" "+y;var f=s.cellTpl.getHTML({cls:a,columnName:c,columnWidth:i.width,index:t,height:String(l)+"px",left:String(u)+"px",groupIndex:"",id:i.id||""});0===t&&o.length?e.get(o.item(0).before(f)):0!==t&&o.length?t===o.length?s.el.append(f):e.get(o.item(t).before(f)):s.el.append(f);var v=0,w=n.length,b=0;for(u=0,"center"===s.side&&(u-=r.scroller.scrollLeft),o=s.getCells();v<w;v++){if((i=n[v]).hidden)continue;o.item(v).css("left",u),u+=i.width,b+=i.width}const x=parseInt(s.css("width"));x>b&&(b=x),s.css("width",b),r.subHeaderFilter&&r.filter.addSubHeaderFilterCellContainer(s.side),s.reSetColumnsAlign(),s.reSetIndexes(),r.subHeaderFilter&&r.filter.updateSubHeaderFilterSizes()},setAlign(){for(var e=this.getColumns(),t=0,i=e.length;t<i;t++){const i=e[t];i.align&&this.getDomCell(t).css("text-align",i.align)}},onAfterRender(){},setCellsPosition(t){var i=this,l=i.widget,s=i.getColumns(),r=0,o=i.getCells();if(r+=i.scrollLeft||0,e.each(s,(e,t)=>{let i=o.item(t),s="0px";e.grouping&&(s=l.cellHeaderHeight+"px"),i.css({top:s,left:r+"px"}),e.hidden||(r+=e.width)}),l.groupheader){i.el.select(`.${h}`).each(function(l){const r=l.attr("index");i.el.select('[group-index="'+r+'"]');var o=i.scrollLeft||0,n=0;e.each(s,e=>{if(e.grouping===r)return!0;e.hidden||(o+=e.width)}),e.each(s,e=>{e.grouping!==r||e.hidden||(n+=e.width)}),t&&!e.nojQuery?(l.css({left:o,width:n}),0===n&&l.css({display:"none"})):l.css({left:o,width:n})})}},fixGroupHeaderSizing(){var t=this,i=t.widget,s=i.cellHeaderHeight,r=t.getColumns(),o=t.getCells(),n=0,a={},d={},g={},m=t.calcRows(),f=i.filter&&i.filter.header&&!i.subHeaderFilter,C=!1;"center"===t.side&&(n=i.scroller.scrollLeft),f&&e.each(r,e=>{e.grouping&&e.filter&&e.filter.header&&(C=!0)}),e.each(r,(e,t)=>{var r=o.item(t),h=e.grouping,y="0px",v=s*m;a[h]=!0,h?(void 0===d[h]?(d[h]=e.width,g[h]=n):d[h]+=e.width,r.addCls(c),y=s+"px",v=s,C&&(v=2*s),e.filter&&e.filter.header&&f&&setTimeout(function(){r.addCls(u)},30)):(r.removeCls(c),e.filter&&e.filter.header&&f&&(setTimeout(function(){r.addCls(p)},30),r.addCls(p))),!i.groupheader||v!==s||h||e.filter||f||(v=2*s),r.css({top:y,height:v}),r.select(`.${l}`).css({height:v}),n+=e.width});for(const e in d){t.el.select(`[index="${e}"]`).css({left:g[e],width:d[e]})}t.el.select(`.${h}`).each(e=>{const t=e.attr("index");a[t]||e.destroy()})},getColumnsWidth(){for(var e=this.getColumns(),t=0,i=0,l=e.length;i<l;i++){t+=e[i].width}return t},getColumns(){let e,t=this,i=t.widget;switch(t.side){case"left":e=i.leftColumns;break;case"center":e=i.columns;break;case"right":e=i.rightColumns}return e},getDomCell(e){return this.getCells().item(e)},onCellClick(t){const i=this,l=i.widget,s=l.columndrag,r=t.currentTarget,o=e.get(t.target),d=parseInt(e.get(r).attr("index")),c=i.getColumns()[d];s&&"dragging"===s.status||o.hasCls(n)||o.hasCls(a)||e.get(r).hasCls(h)||i.textDBLClick||(c.titleEditable?setTimeout(()=>{i.textDBLClick?setTimeout(()=>{delete i.textDBLClick},400):l.fire("headercellclick",{e:t,side:i.side,cell:r,index:d,column:c})},300):l.fire("headercellclick",{e:t,side:i.side,cell:r,index:d,column:c}))},onCellMouseMove(t){const i=this.widget,l=t.currentTarget,s=e.get(l).hasCls(h),r=parseInt(e.get(l).attr("index"));s||i.fire("headercellmousemove",{e:t,side:this.side,cell:l,index:r})},onMouseDown(t){"INPUT"===e.get(t.target).prop("tagName")||t.preventDefault()},onCellMouseDown(t){const i=this.widget,l=t.currentTarget,s=parseInt(e.get(l).attr("index"));i.fire("headercellmousedown",{e:t,side:this.side,cell:l,index:s})},scroll(e,t){this.scrollLeft=e,this.setCellsPosition(t)},getGroupingCellsHTML(t){var i=this,l=i.widget,s="";return e.each(t,(e,t)=>{s+=i.cellTpl.getHTML({cls:h+" "+e.cls,columnName:e.title,columnWidth:e.width,index:t,height:l.cellHeaderHeight+"px",left:e.left+"px",groupIndex:"",id:e.id||""})}),s},destroy(){const e=this,t=e.el,l=`div.${i}`;t.un("click",e.onCellClick,e,l),t.un("mousemove",e.onCellMouseMove,e,l),t.un("mousedown",e.onCellMouseDown,e,l),t.un("mousedown",e.onMouseDown,e),t.un("mouseenter",e.onCellMouseEnter,e,l),t.un("mouseleave",e.onCellMouseLeave,e,l)},getCell(e){return this.el.select(`.${i}[index="${e}"]`)},onTriggerClick(t){const i=e.get(t.currentTarget).parent().parent(),l=parseInt(i.attr("index")),s=this.getColumns(),r=s[l];t.stopPropagation(),this.showMenu(i,l,r,s)},hideCell(t){var i=this,l=i.widget,s=i.getCells(),r=s.item(t),o=parseInt(r.css("width")),n=0,a=s.length,d=i.getColumns();if(r.hasCls(c)){const e=r.attr("group-index"),t=i.el.select(`.${h}[index="${e}"]`).item(0),l=parseInt(t.css("width"));t.stop(),l-o==0?t.css({display:"none",width:l-o}):t.animate({width:l-o},w)}r.hide();var g={},u=0,p=0;for("center"===i.side&&(u-=p=l.scroller.scrollLeft);n<a;n++){const e=s.item(n),i=parseInt(e.css("left")),l=d[n];l.hidden||(l.grouping&&d[t].grouping!==l.grouping&&(g[l.grouping]=!0),i!==u&&(e.stop(),e.animate({left:u},w)),u+=l.width)}e.each(g,(t,s)=>{var r=i.el.select("."+h+'[index="'+s+'"]').item(0),o=0;"center"===i.side&&(p=l.scroller.scrollLeft,o-=p),e.each(d,e=>{if(!e.hidden)return e.grouping===s||void(o+=e.width)}),r.stop(),r.animate({left:o},w)})},showCell(t,i){var l,s=this,r=s.widget,o=s.getCells(),n=o.item(t),a=0,d=0,g=o.length,u=s.getColumns();if(e.isNumber(i)&&n.css("width",`${i}px`),n.show(),l=parseInt(n.css("width")),n.hasCls(c)){const e=n.attr("group-index"),t=s.el.select("."+h+'[index="'+e+'"]').item(0),i=parseInt(t.css("width"));t.stop(),"none"===t.css("display")&&t.show(),t.animate({width:i+l},w)}let p=0;"center"===s.side&&(a-=p=r.scroller.scrollLeft);const m={};for(;d<g;d++){const e=o.item(d),i=(parseInt(e.css("left")),u[d]);i.hidden||(i.grouping&&u[t].grouping!==i.grouping&&(m[i.grouping]=!0),e.stop(),e.animate({left:a},w),a+=i.width)}e.each(m,(t,i)=>{var l=s.el.select("."+h+'[index="'+i+'"]').item(0),o=0;"center"===s.side&&(p=r.scroller.scrollLeft,o-=p),e.each(u,e=>{if(!e.hidden)return e.grouping===i||void(o+=e.width)}),l.stop(),l.animate({left:o},w)})},removeCell(e){var t=this,i=t.widget,l=t.getCells(),s=l.item(e),r=parseInt(s.css("width")),o=e+1,n=l.length,a={},d=!1;for(s.attr("group-index")&&(a[d=s.attr("group-index")]=!0),s.destroy();o<n;o++){const e=l.item(o),t=parseInt(e.css("left"))-r;e.attr("group-index")&&(a[e.attr("group-index")]=!0),e.attr("index",o-1),e.css("left",t)}for(const e in a){var c=t.el.select(`[index="${e}"]`),h=parseInt(c.css("width"))-r,g=parseInt(c.css("left"))-r;d&&c?(c.css("width",h),c.attr("index")!==d&&c.css("left",g)):c.css("left",g)}d&&0===t.el.select(`[group-index="${d}"]`).length&&(c=t.el.select(`[index="${d}"]`)).destroy(),"center"!==t.side&&t.css("width",parseInt(t.css("width"))-r),i.subHeaderFilter&&i.filter.removeSubHeaderCell(t.side,e),t.reSetIndexes()},renderHeaderCheckBox(){for(var t=this.widget,i=this.getColumns(),l=0,r=i.length,o=this.getCells();l<r;l++){const r=i[l];if(e.isObject(r.headerCheckBox)){var n=r.headerCheckBox.el,a=n.attr("id");(n=e.get(a)).dom||(r.headerCheckBox=!0)}if(!0===r.headerCheckBox&&"select"!==r.type){var d=o.item(l),c=d.firstChild(),h=d.select(`.${s}`),u=!!r.title&&r.title,p=0;switch(r.type){case"checkbox":case"switcher":d.addCls(f);break;case"select":d.addCls(g)}h.update(""),u.length&&(p=15*u.width),r.headerCheckBox=new e.CheckBox({renderTo:c.dom,renderId:!0,labelWidth:p,value:!1,label:!1,labelAlign:"right",style:{padding:"0px",display:"inline-block"},events:[{change:(e,i)=>{for(var l=0,s=t.getViewTotal();l<s;l++)t.set(l,r.index,i)}}]})}}},reSetIndexes(){const e=this,t=e.widget,l=e.getCells(),s=e.getColumns();if(l.each((e,t)=>{e.attr("index",t);const i=s[t];e.attr("col-id",i.id)}),t.subHeaderFilter){t.filter.getSubHeaderFilterEl(e.side).select(`.${i}`).each((e,t)=>{e.attr("index",t)})}},reSetGroupIndexes(){const e=this.getColumns();this.getCells().each((t,i)=>{const l=e[i].grouping;t.attr("group-index")&&!l?t.removeAttr("group-index"):l&&t.attr("group-index")!==l&&t.attr("group-index",l)})},updateTitles(){const t=this,l=t.getColumns();e.each(l,(e,l)=>{e.headerCheckBox||t.el.select("div."+i+'[index="'+l+'"] .'+s).update(e.title||"")})},updateCellsSizes(){var t=this,l=t.widget,s=t.getColumns(),r=0;"center"===t.side&&(r=l.nativeScroller?-l.body.el.dom.scrollLeft:-l.scroller.scrollLeft),e.each(s,(e,l)=>{if(e.hidden)return;const s=t.el.select(`div.${i}[index="${l}"]`),o=parseInt(s.css("left")),n=parseInt(s.css("width"));o!==r||n!==e.width?(Fancy.nojQuery?s.css({width:e.width,left:r}):s.animate({width:e.width,left:r},w),r+=e.width):r+=e.width})},calcRows(){var e=this.widget,t=e.columns.concat(e.leftColumns).concat(e.rightColumns),i=1;if(Fancy.each(t,t=>{t.grouping&&(i<2&&(i=2),t.filter&&t.filter.header&&!e.subHeaderFilter&&i<3&&(i=3)),t.filter&&t.filter.header&&!e.subHeaderFilter&&i<2&&(i=2)}),e.groupheader&&2===i){e.el.select(`.${m}`).length&&(i=3)}return i},reSetColumnsAlign(){const e=this.getColumns();this.getCells().each((t,i)=>{const l=e[i];t.css("text-align",l.align||"")})},destroyMenus(){},onDocMove(){const e=this,t=e.widget;("none"===t.el.css("display")||t.panel&&t.panel.el&&"none"===t.panel.el.css("display")&&e.hideMenu)&&e.hideMenu()},reSetColumnsCls(){const t=this.getColumns(),i=this.getCells(),l=[];e.each(t,e=>{e.headerCls&&l.push(e.headerCls),e.sortable?l.push(C):l.push(y)}),i.each((i,s)=>{const r=t[s];e.each(l,e=>{i.removeCls(e)}),r.headerCls&&i.addCls(r.headerCls),r.sortable?i.addCls(C):i.addCls(y),r.menu?i.removeCls(d):i.addCls(d)})},updateCellsVisibility(){const e=this.getColumns();this.getCells().each((t,i)=>{e[i].hidden?t.hide():"none"===t.css("display")&&t.show()})},reSetCheckBoxes(){const t=this.getColumns(),i=this.getCells();e.each(t,(t,l)=>{const s=i.item(l),r=s.select(`.${v}`);if(r.length){if("select"===t.type||t.select)return;const i=e.getWidget(r.item(0).attr("id"));switch(s.removeCls(f,g),t.type){case"select":s.addCls(g);break;case"checkbox":s.addCls(f);break;default:t.headerCheckBox||i.destroy()}}}),this.renderHeaderCheckBox()},onCellTextDBLClick(e){const t=this,i=t.widget,l=Fancy.get(e.target).parent().parent(),s=l.attr("index"),r=t.getColumns()[s],o=r.title;r.titleEditable&&(t.textDBLClick=!0,t.activeEditColumnField&&(t.activeEditColumnField.destroy(),delete t.activeEditColumnField),t.activeEditColumnField=new Fancy.StringField({renderTo:t.el.dom,label:!1,theme:i.theme,padding:"0px 0px 0px",width:r.width+1,value:r.title||"",inputHeight:i.cellHeaderHeight+1,events:[{enter(e){e.destroy()}},{esc(e){i.setColumnTitle(r.index,o,t.side),e.destroy(),delete t.activeEditColumnField}},{input(e,l){i.setColumnTitle(r.index,l,t.side),delete t.activeEditColumnField}},{render(e){e.focus(),delete t.activeEditColumnField}}],style:{position:"absolute",top:-1,left:parseInt(l.css("left"))-1}}),i.once("scroll",()=>{t.activeEditColumnField&&(t.activeEditColumnField.destroy(),delete t.activeEditColumnField)}))},onCellMouseEnter(t){const i=this,l=i.widget,s=i.getEventParams(t),r=i.prevCellOver;if(e.nojQuery&&r&&i.fixZeptoBug){if(s.columnIndex===r.columnIndex&&s.side===r.side)return;l.fire("headercellleave",r)}l.fire("headercellenter",s),i.prevCellOver=s},onCellMouseLeave(t){const i=this,l=i.widget,s=i.getEventParams(t),r=i.prevCellOver;if(t.toElement&&i.el.within(t.toElement)||(l.fire("headercellleave",r),delete i.prevCellOver),e.nojQuery){if(void 0===r)return;i.fixZeptoBug=s}else l.fire("headercellleave",r),delete i.prevCellOver},getEventParams(t){const i=this.widget.store,l=this.getColumns(),s=t.currentTarget,r=e.get(t.currentTarget);if(void 0===r.parent().dom)return!1;if(0===i.getLength())return!1;if(void 0===r.attr("index"))return!1;const o=parseInt(r.attr("index")),n=l[o];return{e:t,side:this.side,cell:s,column:n,columnIndex:o}},updateLImages(){const t=this.getCells(),i=this.getColumns();t.each(t=>{const l=t.attr("index"),s=i[l],n=s.headerLImageCls,a=t.select(`.${r}`),d=a.getCls();e.each(d,e=>{e!==r&&(n&&e===s.headerLImageCls||a.removeCls(e))}),n?(a.addCls(n),t.addCls(o)):t.removeCls(o)})},getCells(){return this.el.select(`.${i}:not(.${h})`)},onColumnDrag(){this.reSetIndexes()}})}();