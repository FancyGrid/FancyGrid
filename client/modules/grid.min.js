Fancy.modules.grid=!0,Fancy.Mixin("Fancy.grid.mixin.PrepareConfig",{prepareConfig(e,t){const i=this;return e._plugins=e._plugins||[],e.renderOuter&&(e.renderTo=e.renderOuter),e=i.generateColumnsFromData(e,t),e=i.copyColumns(e,t),e=i.prepareConfigScroll(e,t),e=i.prepareConfigData(e,t),e=i.prepareConfigTheme(e,t),e=i.prepareConfigLang(e,t),e=i.prepareConfigSpark(e,t),e=i.prepareConfigPaging(e,t),e=i.prepareConfigInfinite(e,t),e=i.prepareConfigBars(e),e=i.prepareConfigTBar(e),e=i.prepareConfigSubTBar(e),e=i.prepareConfigExpander(e),e=i.prepareConfigColumnMinMaxWidth(e),e=i.prepareConfigGrouping(e),e=i.prepareConfigGroupHeader(e),e=i.prepareConfigSorting(e),e=i.prepareConfigEdit(e),e=i.prepareConfigSelection(e),e=i.prepareConfigLoadMask(e,t),e=i.prepareConfigDefaults(e),e=i.prepareConfigFilter(e,t),e=i.prepareConfigSearch(e),e=i.prepareConfigSummary(e),e=i.prepareConfigState(e,t),e=i.prepareConfigExporter(e),e=i.prepareConfigSmartIndex(e),e=i.prepareConfigActionColumn(e),e=i.prepareConfigWidgetColumn(e),e=i.prepareConfigChart(e,t),e=i.prepareConfigCellTip(e),e=i.prepareConfigHeaderCellTip(e),e=i.prepareConfigColumnsWidth(e),e=i.prepareConfigSize(e,t),e=i.prepareConfigContextMenu(e,t),e=i.prepareConfigColumns(e),e=i.prepareConfigColumnsResizer(e),e=i.prepareConfigFooter(e),e=i.prepareConfigDD(e)},copyColumns:(e,t)=>(e.columns&&(e.columns=Fancy.Array.copy(e.columns,!0)),t.columns&&(t.columns=Fancy.Array.copy(t.columns)),e),generateColumnsFromData(e,t){if(!e.columns&&e.data&&e.data.length&&Fancy.isArray(e.data[0])){const i=e.data[0]||e.data[0],l=[],r=[];Fancy.each(i,(e,t)=>{l.push({index:"autoIndex"+t}),r.push("autoIndex"+t)}),e.columns=l,e.data={items:e.data,fields:r},t.data=e.data}return e},prepareConfigScroll:(e,t)=>(Fancy.isIE&&!1!==t.nativeScroller&&(e.nativeScroller=!0),e),prepareConfigSpark(e){const t=this;return Fancy.each(e.columns,i=>{const l=i.sparkConfig;if(l&&l.legend)switch(l.legend.type){case"tbar":case"bbar":case"buttons":var r=l.legend.type,s=i.index;e[r]=e[r]||[],e[r]=e[r].concat(t._generateLegendBar(l.title,s,l.legend.style,i))}}),e},_generateLegendBar(e,t,i,l){var r=0,s=e.length,n=[],o=this;const a={length:0},d=function(t){var i,l=o;Fancy.each(o.columns,(e,t)=>{e.index===o.columns[t].index&&(i=t)}),(t.hasCls("fancy-legend-item-disabled")||e.length-1!==a.length)&&(t.toggleCls("fancy-legend-item-disabled"),t.hasCls("fancy-legend-item-disabled")?(a[t.index]=!0,l.disableLegend(i,t.index),a.length++):(l.enableLegend(i,t.index),delete a[t.index],a.length--))};for(;r<s;r++){var c=t[r];Fancy.isString(l.index)&&(c=l.index+"."+r);const s={handler:d,index:c,imageColor:Fancy.COLORS[r],text:e[r]};0===r&&i&&(s.style=i),n.push(s)}return n},prepareConfigData(e){if(e.data||(e.data=[]),Fancy.isArray(e.data)&&0===e.data.length&&e.columns){const t=[],i={};Fancy.each(e.columns,e=>{if(e.index)if(/\./.test(e.index)){var l=e.index.split(".");i[l[0]]||(t.push(l[0]),i[l[0]]=!0)}else t.push(e.index||e.key);e.columns&&Fancy.each(e.columns,e=>{e.index&&t.push(e.index||e.key)})}),e.data={fields:t,items:[]}}return e},prepareConfigLoadMask(e){var t,i=!1!==e.loadMask;return Fancy.isString(e.loadMask)&&(t=e.loadMask),e._plugins.push({type:"grid.loadmask",showOnWaitingServer:i,loadText:t}),e},reConfigStore(e){const t=this.store,i=this.getFieldsFromData(e),l="Fancy.model."+Fancy.id();Fancy.define(l,{extend:Fancy.Model,fields:i}),this.model=l,t.model=l,this.fields=i,t.fields=i,t.setModel()},prepareConfigDefaults:e=>(e.defaults=e.defaults||{},void 0===e.defaults.type&&(e.defaults.type="string"),Fancy.each(e.defaults,(t,i)=>{Fancy.each(e.columns,t=>{switch(t.type){case"select":case"order":case"expand":case"rowdrag":return}void 0===t[i]&&(t[i]=e.defaults[i]),"width"===i&&t.flex&&delete t.width})}),e),prepareConfigColumnMinMaxWidth:e=>(Fancy.each(e.columns,e=>{void 0===e.width&&!e.flex&&e.minWidth&&(e.width=e.minWidth)}),e),prepareConfigCellTip:e=>(Fancy.each(e.columns,t=>{if(t.cellTip)return e._plugins.push({type:"grid.celltip"}),!0}),e),prepareConfigHeaderCellTip:e=>(Fancy.each(e.columns,t=>{if(t.headerCellTip)return e._plugins.push({type:"grid.headercelltip"}),!0}),e),prepareConfigDD(e){if(e.gridToGrid){var t={type:"grid.dragdrop"};Fancy.apply(t,e.gridToGrid),e._plugins.push(t)}if(e.rowDragDrop||e.droppable){t={type:"grid.rowdragdrop"};Fancy.apply(t,e.rowDragDrop),e._plugins.push(t)}return e},prepareConfigColumns(e,t){for(var i=e.columns,l=[],r=[],s=0,n=i.length,o=!1,a=!1,d=!1;s<n;s++){const c=i[s];if(c.draggable&&(o=!0),"tree"===c.type&&(a=!0),"rowdrag"!==c.type&&!c.rowdrag||e.rowDragDrop||(e.rowDragDrop=!0),c.headerCheckBox&&!0!==c.sortable&&(c.sortable=!1),c.autoHeight&&(d=!0),c.select&&(this.checkboxRowSelection=!0,this.multiSelect=!0,0),!1!==t&&void 0===c.id&&(c.index?c.id=this.getColumnId(c.index):c.id=Fancy.id(null,"col-id-")),!c.title&&c.index&&!Fancy.isArray(c.index))switch(c.type){case"string":case"number":case"currency":case"date":case"combo":case"checkbox":case"text":c.title=Fancy.String.upFirstChar(c.index)}switch(c.type){case"select":this.checkboxRowSelection=!0,this.multiSelect=!0,i[s].index="$selected",i[s].editable=!0,0;break;case"order":i[s].editable=!1,i[s].sortable=!1,i[s].index="$order",i[s].cellAlign="right",0;break;case"rowdrag":i[s].editable=!1,i[s].sortable=!1,i[s].resizable=!1,i[s].width=30,i[s].index="$rowdrag",0;break;case"checkbox":void 0===c.cellAlign&&(c.cellAlign="center");break;case"currency":void 0===c.format&&(c.format="number"),!1!==c.ellipsis&&(c.ellipsis=!0),c.editFormat||(c.editFormat="currency"),c.beforeSaveFormat||(c.beforeSaveFormat="currency");break;case"string":case"number":case"text":case"date":case"combo":case"tree":!1!==c.ellipsis&&(c.ellipsis=!0)}!1!==t&&(c.locked?(l.push(c),i.splice(s,1),s--,n--):c.rightLocked&&(r.push(c),i.splice(s,1),s--,n--))}if(!1===t)return e;if(d&&e._plugins.push({type:"grid.rowheight"}),o&&e._plugins.push({type:"grid.columndrag"}),a){var c={type:"grid.tree"};e.singleExpand&&(c.singleExpand=e.singleExpand),e._plugins.push(c),e.isTreeData=!0}return e.leftColumns=l,e.rightColumns=r,e},prepareConfigColumnsWidth(e){var t,i=this,l=e.columns,r=e.width,s=[],n=[],o=100,a=0,d=!1,c=!1,h=!1,g=Fancy.get(e.renderTo||document.body);if((e.width<1||void 0===e.width)&&"body"!==g.prop("tagName").toLocaleLowerCase()&&(h=g.closest(".tab-pane"))&&h.css({display:"block",visibility:"hidden"}),void 0!==r&&"fit"!==r||(r=Fancy.get(e.renderTo||document.body).width()),r-=2*e.panelBorderWidth,!1!==e.flexScrollSensitive)r-=e.bottomScrollHeight;else{var u=this.theme;Fancy.isString(e.theme)?u=e.theme:Fancy.isObject(e.theme)&&e.theme.name&&(u=e.theme.name),"bootstrap-no-borders"!==u&&(r-=1)}Fancy.each(l,(t,l)=>{switch(t.autoWidth&&(e.autoColumnWidth=!0),t.flex&&(e.hasFlexColumns=!0),t.type){case"select":void 0===t.width&&(t.width=35);break;case"order":void 0===t.width&&(t.width=40);break;case"rowdrag":void 0===t.width&&(t.width=30);break;case"expand":void 0===t.width&&(t.width=38);break;case"combo":t.data||(t.data=[],setTimeout(()=>{i.on("init",()=>{const e=i.store.getColumnUniqueData(t.index);i.setColumnComboData(t.index,e)})},1))}t.locked&&(d=!0),t.rightLocked&&(c=!0),t.hidden?void 0===t.width&&(t.width=100):void 0===t.width?(t.flex&&(a+=t.flex,n.push(l)),s.push(l)):Fancy.isNumber(t.width)&&(r-=t.width)}),e.hasFlexColumns&&e._plugins.push({type:"grid.columnresizer"}),d&&c&&(r-=2);var p=parseInt(r/s.length);p<50&&(p=50),p>100&&(o=100),p<50&&(o=50);var m=!1,f=r;if(Fancy.each(s,e=>{void 0===(t=l[e]).flex&&(f-=o)}),a){const e=parseInt(f/a);Fancy.each(n,t=>{f-=e*l[t].flex})}return f<0&&(m=!0),Fancy.each(s,e=>{void 0===(t=l[e]).flex&&(t.width=o,r-=o)}),a&&(Fancy.each(n,e=>{(t=l[e]).width=m?o*t.flex:r/a*t.flex,t.width=parseInt(t.width),t.minWidth&&t.width<t.minWidth&&(t.width=t.minWidth)}),f>=1&&Fancy.each(n,e=>{if(f<1)return!0;(t=l[e]).width+=1,f-=1})),h&&h.css({display:"",visibility:""}),e},prepareConfigActionRender:e=>(function(t){return Fancy.each(e.items,e=>{const i=e.text||"",l=Fancy.styleToString(e.style),r=e.cls||"";t.value+=['<div class="fancy-grid-column-action-item '+r+'" style="'+l+'">',i,"</div>"].join(" "),e.render&&(t=e.render(t))}),t}),prepareConfigSmartIndex:e=>(Fancy.each(e.columns,e=>{if(/\+|\-|\/|\*|\[|\./.test(e.index)){var t=e.index;switch(t){case"xAxis.categories":case"yAxis.categories":case"zAxis.categories":return}t="return "+(t=t.replace(/(\w+)/g,function(e,t,i,l){return"."===l[i-1]?t:isNaN(Number(t))?"data."+t:t}))+";",e.smartIndexFn=new Function("data",t)}}),e),prepareConfigActionColumn(e){for(var t=this,i=e.columns,l=0,r=i.length;l<r;l++){const e=i[l];if("action"===e.type){e.sortable=!1,e.editable=!1,e.render=t.prepareConfigActionRender(e);var s=e.items;if(void 0!==s&&0!==s.length)for(var n,o=0,a=s.length;o<a;o++)switch((n=s[o]).action){case"remove":void 0===n.handler&&(n.handler=function(e,t){e.remove(t)});break;case"dialog":!function(e){if(void 0===e.handler){for(var l=[],r=0,s=i.length,n=87;r<s;r++){const e=i[r];switch(e.type){case"action":continue}l.push({label:e.title||"",type:e.type,name:e.index}),n+=38}e.handler=function(i,r){e.dialog?(e.dialog.show(),e.dialog.set(r.data)):e.dialog=new FancyForm({window:!0,draggable:!0,modal:!0,title:{text:"Edit",tools:[{text:"Close",handler(){this.hide()}}]},width:300,height:n,items:l,buttons:["side",{text:"Clear",handler(){this.clear()}},{text:"Save",handler(){const e=this.get();e.id&&(t.getById(e.id).set(e),t.update())}}],events:[{init(){this.show(),this.set(r.data)}}]})}}}(n)}}}return e},prepareConfigWidgetColumn(e){for(var t=this,i=e.columns,l=0,r=i.length;l<r;l++){const e=i[l];e.widget&&(e.render=function(e){var i,l=e.cell.select("."+Fancy.FIELD_CLS),r=e.cell.dom;const s={vtype:(n=e.column).vtype,style:{padding:"0px","margin-top":"-10px","margin-left":"-1px"},label:!1,renderTo:r,value:e.value,emptyText:n.emptyText};if(l.length)(i=Fancy.getWidget(l.dom.id)).get()!=e.value&&i.set(e.value);else{var n,o=e.column.width,a=(n=e.column).index;switch(e.column.type){case"number":case"currency":Fancy.apply(s,{spin:n.spin,min:n.min,max:n.max,events:[{change(i,l){t.set(e.rowIndex,a,l),t.updater.updateRow()}}]}),i=new Fancy.NumberField(s);break;case"string":case"image":Fancy.apply(s,{events:[{change(i,l){t.set(e.rowIndex,a,l),t.updater.updateRow()}}]}),i=new Fancy.StringField(s);break;case"combo":Fancy.apply(s,{displayKey:e.column.displayKey,valueKey:e.column.displayKey,padding:!1,checkValidOnTyping:!0,data:e.column.data,events:[{change(i,l){t.set(e.rowIndex,a,l),t.updater.updateRow()}}]}),i=new Fancy.Combo(s)}switch(e.column.type){case"number":case"string":case"currency":case"image":i.setInputSize({width:o+1,height:33});break;case"combo":i.size({width:o+1,height:33})}}return e})}return e},prepareConfigSorting:e=>(e.defaults||{}).sortable?(e._plugins.push({type:"grid.sorter"}),e):(Fancy.each(e.columns,function(t){t.sortable&&e._plugins.push({type:"grid.sorter"})}),e),prepareConfigSelection(e){var t=!1,i={type:"grid.selection"},l=!1;if((e.trackOver||e.columnTrackOver||e.cellTrackOver)&&(t=!0),e.selModel){t=!0;var r=!1,s=!1,n=!1,o=!0,a=!1,d=!0,c=!1,h=!1,g=!1,u=!1,p=!1,m=!1,f=!1;if(Fancy.isObject(e.selModel)){r=!!e.selModel.checkOnly,f=!!e.selModel.activeCell,("cell"===e.selModel.type||"cells"===e.selModel.type||f)&&(e.selModel.selectBottomCellAfterEdit&&(c=!0),e.selModel.selectRightCellOnEnd&&(h=!0),e.selModel.selectLeftCellOnLeftEnd&&(g=!0),e.selModel.selectUpCellOnUp&&(u=!0),e.selModel.selectBottomCellOnDown&&(p=!0),e.selModel.continueEditOnEnter&&(m=e.selModel.continueEditOnEnter));var C=!1,v=!1;if(Fancy.each(e.columns,e=>{"tree"===e.type&&(C=!0),e.select&&(v=!0),"select"===e.type&&(v=!0)}),C&&v&&(r=!0),!e.selModel.type)throw new Error("[FancyGrid Error 5]: Type for selection is not set");void 0!==e.selModel.mouseMoveSelection&&(d=e.selModel.mouseMoveSelection),s=!0===e.selModel.memory,e.selModel.disabled&&(l=!0),e.selModel.selectLeafsOnly&&(n=!0),void 0!==e.selModel.allowDeselect&&(a=!0),void 0!==e.selModel.keyNavigation&&(o=e.selModel.keyNavigation),e.selModel=e.selModel.type}"rows"===e.selModel&&(e.multiSelect=!0),e.selection=e.selection||{},e.selection.selModel=e.selModel,e.selection[e.selModel]=!0,e.selection.checkOnly=r,e.selection.memory=s,e.selection.memoryPerformance=!0,e.selection.disabled=l,e.selection.selectLeafsOnly=n,e.selection.keyNavigation=o,e.selection.allowDeselect=a,e.selection.mouseMoveSelection=d,e.selection.selectBottomCellAfterEdit=c,e.selection.selectRightCellOnEnd=h,e.selection.selectLeftCellOnLeftEnd=g,e.selection.selectUpCellOnUp=u,e.selection.selectBottomCellOnDown=p,e.selection.continueEditOnEnter=m,e.selection.activeCell=f}return e.selection&&(t=!0,Fancy.isObject(e.selection)&&Fancy.apply(i,e.selection)),!0===t&&e._plugins.push(i),e},prepareConfigEdit(e){var t={type:"grid.edit"},i=!1,l=(e.defaults||{}).editable;return void 0!==e.clicksToEdit&&(t.clicksToEdit=e.clicksToEdit),l&&(i||e._plugins.push(t),e._plugins.push({type:"grid.celledit"}),i=!0),e.rowEdit&&e._plugins.push({type:"grid.rowedit"}),Fancy.each(e.columns,l=>{switch(void 0===l.index&&void 0===l.key&&(l.editable=!1),l.type){case"image":l.sortable=!1;break;case"sparklineline":case"sparklinebar":case"sparklinetristate":case"sparklinediscrete":case"sparklinebullet":case"sparklinepie":case"sparklinebox":l.editable=!1,l.sortable=!1}l.editable&&!1===i&&(e._plugins.push(t),e._plugins.push({type:"grid.celledit"}))}),e},prepareConfigExpander(e){if(e.expander){const t=e.expander;Fancy.apply(t,{type:"grid.expander"}),e.expanded={},e.grouping&&(t.expanded=!1),e._plugins.push(t)}return e},prepareConfigGrouping(e){if(e.grouping){var t=e.grouping;!0===t&&(t={}),Fancy.apply(t,{type:"grid.grouping"}),e.expanded={},e._plugins.push(t)}return e},prepareConfigSummary(e){if(e.summary){var t=e.summary;!0===t&&(t={}),Fancy.apply(t,{type:"grid.summary"}),e._plugins.push(t)}return e},prepareConfigContextMenu(e){if(e.contextmenu){var t=e.contextmenu;Fancy.isArray(e.contextmenu)&&Fancy.each(e.contextmenu,function(t){"export"===t&&(e.exporter=!0)}),!0===t&&(t={}),Fancy.isArray(t)&&(t={items:t}),Fancy.apply(t,{type:"grid.contextmenu"}),e._plugins.push(t)}return e},prepareConfigExporter(e){if(e.exporter){var t=e.exporter;!0===t&&(t={}),Fancy.apply(t,{type:"grid.exporter"}),e._plugins.push(t)}return e},prepareConfigFilter(e){var t=e.columns,i=!1,l=!1,r=!1,s={type:"grid.filter"};return e.filter&&(!0===e.filter&&(i=!0,e.filter={}),Fancy.apply(s,e.filter)),Fancy.each(t,e=>{e.filter&&(i=!0,e.filter.header&&(l=!0,e.grouping&&(r=!0)))}),s.header=l,s.groupHeader=r,i&&(e._plugins.push(s),e.filterable=!0),e},prepareConfigSearch(e){var t={type:"grid.search"},i=!1;return e.searching&&(i=!0,Fancy.apply(t,e.searching)),i&&e._plugins.push(t),e},prepareConfigGroupHeader(e){var t=e.columns,i=0,l=t.length,r=[],s=!1,n=[];if(Fancy.each(t,e=>{e.columns&&(s=!0,r.push(e))}),s){for(i=0;i<l;i++){var o=t[i];if(o.columns){for(var a=0,d=o.columns.length,c=o.text||o.title||"  ";a<d;a++)o.locked&&(o.columns[a].locked=!0),o.rightLocked&&(o.columns[a].rightLocked=!0),o.columns[a].grouping=c,o.defaults&&(Fancy.applyIf(o.columns[a],o.defaults),o.defaults.width&&o.columns[a].flex&&delete o.columns[a].width);n=n.concat(o.columns)}else n=n.concat(t.slice(i,i+1))}const s={};Fancy.each(r,e=>{s[e.title||e.text||""]=e}),e.columns=n,e._plugins.push({type:"grid.groupheader",groups:r,groupsMap:s}),e.isGroupedHeader=!0}return e},prepareConfigPaging(e,t){var i=e.lang,l=e.paging,r="bbar",s="last";if(!l)return e;if(void 0!==l.barType)switch(l.barType){case"bbar":case"tbar":case"both":r=l.barType;break;case!1:case"none":r="none";break;default:throw new Error("[FancyGrid Error]: - not supported bar type for paging")}return l.pageOverFlowType&&(s=l.pageOverFlowType),e._plugins.push({i18n:t.i18n,type:"grid.paging",barType:r,pageOverFlowType:s}),"both"===r?(e.tbar=this.generatePagingBar(l,i),e.bbar=this.generatePagingBar(l,i)):"none"===r||(e[r]=this.generatePagingBar(l,i)),e},prepareConfigInfinite:e=>e.infinite?(e.nativeScroller=!1,e._plugins.push({type:"grid.infinite"}),e):e,generatePagingBar(e,t){var i=this,l=[],r="fancy-bar-button-disabled",s="material"===i.theme?8:3,n={float:"left","margin-right":"5px","margin-top":s+"px"};if(l.push({imageCls:"fancy-paging-first",disabledCls:r,role:"first",handler:function(){i.paging.firstPage()},style:{float:"left","margin-left":"5px","margin-right":"5px","margin-top":s+"px"}}),l.push({imageCls:"fancy-paging-prev",disabledCls:r,role:"prev",handler:function(){i.paging.prevPage()},style:n}),l.push("|"),l.push({type:"text",text:t.paging.page}),l.push({type:"number",label:!1,padding:!1,style:{float:"left","margin-left":"-1px","margin-right":"8px","margin-top":s+1+"px"},role:"pagenumber",min:1,width:e.inputWidth||30,listeners:[{enter(e){0===parseInt(e.getValue())&&e.set(1);var t=parseInt(e.getValue())-1,l=i.paging.setPage(t);t!==l&&e.set(l)}},{up(e,t){var l=i.store.pages;(t=Number(t)+1)>l&&(t=l),e.set(t)}},{down(e,t){i.store.pages;(t=Number(t)-1)<1&&(t=1),e.set(t)}}]}),l.push({type:"text",text:"",role:"ofText"}),l.push("|"),l.push({imageCls:"fancy-paging-next",disabledCls:r,role:"next",style:n,handler(){i.paging.nextPage()}}),l.push({imageCls:"fancy-paging-last",disabledCls:r,role:"last",style:n,handler(){i.paging.lastPage()}}),Fancy.isObject(e)&&!0===e.refreshButton&&(l.push("|"),l.push({imageCls:"fancy-paging-refresh",disabledCls:r,role:"refresh",style:n,handler(){i.paging.refresh()}})),e&&Fancy.isArray(e.pageSizeData)){for(var o=e.pageSizeData,a=[],d=0,c=o.length,h=0;d<c;d++)a.push({index:d,value:o[d]}),e.pageSize===o[d]&&(h=d);var g=Fancy.Object.copy(n);g["margin-top"]=s+1+"px",l.push({editable:!1,width:50,type:"combo",role:"size",style:g,data:a,displayKey:"value",valueKey:"index",value:h,subSearch:!1,events:[{change(e,t){i.scroll(0,0),i.paging.setPageSize(o[t])}},{render:function(e){i.store.on("changepages",()=>{var t;i.store.pageSize!==Number(e.input.dom.value)&&(Fancy.each(e.data,e=>{if(e.value===i.store.pageSize)return t=e.index,!0}),void 0!==t&&e.setValue(t,!1))})}}]})}return l.push("side"),l.push({type:"text",role:"info",text:""}),l},prepareConfigState(e){const t=this;if(e.stateful){var i={};Fancy.isObject(e.stateful)&&(i=e.stateful);const n=e.state||{};var l=e.stateId||this.getStateName(),r=localStorage.getItem(l);if(r||(t.memoryInitialColumns(l,e.columns),e.defaults&&t.memoryInitialDefaults(l,e.defaults)),r&&(t.wasColumnsCodeChanged(l,e.columns)||t.wasDefaultChanged(l,e.defaults))&&(localStorage.clear(l),localStorage.clear(l+"memory-columns"),r=null,t.memoryInitialColumns(l,e.columns),e.defaults&&t.memoryInitialDefaults(l,e.defaults)),r){for(var s in r=JSON.parse(r))Fancy.isString(r[s])&&(r[s]=JSON.parse(r[s]));const t=r.columns;for(var s in t&&(Fancy.each(t,t=>{Fancy.each(t,(i,l)=>{if("FUNCTION"===i||"OBJECT"===i||"ARRAY"===i){var r=t.index;Fancy.each(e.columns,e=>{if(e.index===r)return t[l]=e[l],!0})}})}),e.columns=t),r)"columns"!==s&&void 0===n[s]&&(n[s]=r[s])}e._plugins.push({type:"grid.state",stateful:!0,startState:n,log:i})}else e.state&&e._plugins.push({type:"grid.state",startState:e.state});return e},prepareConfigColumnsResizer(e){if((e.defaults||{}).resizable)return e._plugins.push({type:"grid.columnresizer"}),e;var t=[].concat(e.columns).concat(e.leftColumns).concat(e.rightColumns);return Fancy.each(t,t=>{if(t.resizable||t.autoWidth)return e._plugins.push({type:"grid.columnresizer"}),!0}),e},prepareConfigBars(e){const t=function(t){for(var i=0,l=t.length;i<l;i++)switch(t[i].type){case"date":if(!t[i].format){var r=e.lang.date;t[i].format={read:r.read,write:r.write,edit:r.edit}}e.i18n&&(t[i].i18n=e.i18n)}};return t(e.tbar||[]),t(e.subTBar||[]),t(e.bbar||[]),t(e.buttons||[]),e},prepareConfigTBar(e){const t=this,i=e.tbar;if(i)for(var l=0,r=i.length;l<r;l++){switch(i[l].type){case"columns":i[l].text=i[l].text||"Columns",i[l].type="button",i[l].menuIcon=!1;var s=[];Fancy.each(e.columns,e=>{e.title&&s.push({text:e.title,index:e.index,column:e,checked:!e.hidden,handler(i,l){!0!==l.checked||l.checkbox.get()||l.checkbox.set(!0),l.checked&&1===i.el.select(".fancy-checkbox-on").length?l.checkbox.set(!0):(l.checked=!l.checked,l.checkbox.set(l.checked),l.checked?t.showColumn(t.side,l.index,e):t.hideColumn(t.side,l.index,e),t.responsive&&t.onWindowResize())}})}),i[l].menu=s;break;case"search":e.searching=e.searching||{},e.filter=e.filter||!0;break;case"date":e.i18n&&(i[l].i18n=e.i18n)}switch(i[l].action){case"add":void 0===i[l].handler&&(i[l].handler=function(){t.insert(0,{}),t.scroll(0)});break;case"undo":void 0===i[l].handler&&(i[l].handler=function(){t.undo()});break;case"undoall":void 0===i[l].handler&&(i[l].handler=function(){t.undoAll()});break;case"redo":void 0===i[l].handler&&(i[l].handler=function(){t.redo()});break;case"remove":void 0===i[l].handler&&(i[l].disabled=!0,i[l].handler=function(){Fancy.each(t.getSelection(),function(e){t.remove(e)}),t.selection.clearSelection()},i[l].events=[{render:function(){const e=this;setTimeout(()=>{const t=Fancy.getWidget(e.el.parent().parent().parent().select("."+Fancy.GRID_CLS).dom.id);t.on("select",()=>{0===t.getSelection().length?e.disable():e.enable()}),t.on("clearselect",()=>{e.disable()})},10)}}])}}return e},prepareConfigSubTBar(e){const t=e.subTBar;if(t)for(var i=0,l=t.length;i<l;i++)switch(t[i].type){case"search":e.searching=e.searching||{},e.filter=e.filter||!0}return e},prepareConfigChart(e){var t=e.data,i=t.chart;return Fancy.isObject(i)&&(i=[i]),t&&t.chart&&(e._plugins.push({type:"grid.chartintegration",chart:i,toChart:!!t.items||!!t.proxy}),Fancy.each(i,function(t){var i=t.type;switch(i){case"highchart":case"highcharts":e._plugins.push({type:"grid.highchart"});break;case void 0:throw new Error("[FancyGrid Error] - type of chart is undefined");default:throw new Error("[FancyGrid Error] - type of chart "+i+" does not exist")}})),e},prepareConfigSize(e){var t,i,l,r=this,s=e.renderTo,n=!!(e.title||e.subTitle||e.tbar||e.bbar||e.buttons||e.panel),o=e.panelBodyBorders,a=e.gridWithoutPanelBorders,d=e.gridBorders;if(void 0===e.width){if(s){if(e.responsive=!0,e.responsiveWidth=!0,i=Fancy.get(s),e.width=parseInt(i.width()),e.width<1&&"body"!==i.prop("tagName").toLocaleLowerCase()){const t=i.closest(".tab-pane");t?(t.css({display:"block",visibility:"hidden"}),e.width=parseInt(i.width()),t.css({display:"",visibility:""})):e.width=i.parent().width()}0===e.width&&(e.width=parseInt(i.parent().width()))}}else if("fit"===e.width){var c=0,h=!1;this.fitWidth=!0,Fancy.each(e.columns,e=>{e.hidden||(c+=e.width),e.locked&&(h=!0)}),e.title||e.subTitle?c+=o[1]+o[3]+d[1]+d[3]:c+=a[1]+a[3]+d[1]+d[3],h&&c--,e.width=c}if(void 0===e.height)s&&(e.responsiveHeight=!0,(l=parseInt(i.height()))<50&&(l=parseInt(i.parent().css("height"))),e.height=l);else if("fit"===e.height){var g=1;t=0,Fancy.each(e.columns,e=>{e.grouping&&(g<2&&(g=2),e.filter&&e.filter.header&&g<3&&(g=3)),e.filter&&e.filter.header&&g<2&&(g=2)}),Fancy.isArray(e.data)?t=e.data.length:e.data&&Fancy.isArray(e.data.items)&&(t=e.data.items.length),l=t*e.cellHeight,e.title&&(l+=e.titleHeight),e.tbar&&(l+=e.tbarHeight||e.barHeight),e.tabs&&(l+=e.barHeight),e.bbar&&(l+=r.bbarHeight||e.barHeight),e.buttons&&(l+=e.buttonsHeight||e.barHeight),e.subTBar&&(l+=e.subTBarHeight||e.barHeight),e.footer&&(l+=e.barHeight),!1!==e.header&&(l+=e.cellHeaderHeight*g),l+=n?o[0]+o[2]+d[0]+d[2]:a[0]+a[2]+d[0]+d[2],e.minHeight&&l<e.minHeight&&(l=e.minHeight),e.heightFit=!0,e.height=l}return n&&!e.title&&(e.panelBodyBorders=[0,0,0,0],setTimeout(function(){r.panel&&r.panel.css("border-bottom-width",0)},1)),e},wasDefaultChanged(e,t){e+="-memory-defaults";const i=JSON.parse(localStorage.getItem(e));if(!i||!t)return!1;for(var l in i){switch(Fancy.typeOf(i[l])){case"number":case"string":case"boolean":break;default:continue}if(t[l]!==i[l])return!0}for(var l in t){switch(Fancy.typeOf(t[l])){case"number":case"string":case"boolean":break;default:continue}if(void 0===i[l])return!0}return!1},wasColumnsCodeChanged(e,t){e+="-memory-columns";const i=JSON.parse(localStorage.getItem(e));if(!i)return!1;if(t.length!==i.length)return!0;var l=!1;return Fancy.each(i,(e,i)=>{for(const r in e)if(e[r]!==t[i][r]){if("width"===r&&e.autoWidth)continue;return l=!0,!0}}),Fancy.each(t,(e,t)=>{for(const r in e)switch(Fancy.typeOf(e[r])){case"number":case"string":case"boolean":if(void 0===i[t][r])return l=!0,!0}}),l},memoryInitialDefaults(e,t){e+="-memory-defaults";const i={};for(var l in t)switch(Fancy.typeOf(t[l])){case"string":case"number":case"boolean":i[l]=t[l]}localStorage.setItem(e,JSON.stringify(i))},memoryInitialColumns(e,t){e+="-memory-columns";const i=[];Fancy.each(t,e=>{const t={};for(const i in e)switch(Fancy.typeOf(e[i])){case"string":case"number":case"boolean":t[i]=e[i]}i.push(t)}),localStorage.setItem(e,JSON.stringify(i))}}),Fancy.Mixin("Fancy.grid.mixin.ActionColumn",{initActionColumnHandler(){this.on("cellclick",this.onCellClickColumnAction,this)},onCellClickColumnAction(e,t){var i,l,r=t.column,s=r.items;"action"===r.type&&(i=this.getActiveActionColumnItem(t),s&&void 0!==i&&(l=s[i]).handler&&l.handler(this,t))},getActiveActionColumnItem(e){for(var t=Fancy.get(e.cell),i=e.e.target,l=t.select(`.${Fancy.GRID_COLUMN_ACTION_ITEM_CLS}`),r=0,s=l.length;r<s;r++)if(l.item(r).within(i))return r}}),function(){const e=Fancy,t=e.TOUCH_CLS,i=e.HIDDEN_CLS,l=e.GRID_CLS,r=e.GRID_STATE_SORTED_CLS,s=e.GRID_STATE_FILTERED_CLS,n=e.GRID_CENTER_CLS,o=e.GRID_LEFT_CLS,a=e.GRID_RIGHT_CLS,d=e.GRID_HEADER_CLS,c=e.GRID_BODY_CLS,h=e.PANEL_BODY_INNER_CLS,g=e.GRID_UNSELECTABLE_CLS,u=e.GRID_LEFT_EMPTY_CLS,p=e.GRID_RIGHT_EMPTY_CLS,m=e.GRID_COLUMN_SORT_ASC,f=e.GRID_COLUMN_SORT_DESC,C=e.GRID_ROW_GROUP_CLS,v=e.GRID_ROW_GROUP_COLLAPSED_CLS,y=e.PANEL_CLS,w=e.PANEL_TBAR_CLS,b=e.PANEL_SUB_TBAR_CLS,x=e.PANEL_BBAR_CLS,S=e.PANEL_BUTTONS_CLS,I=e.PANEL_GRID_INSIDE_CLS,T=e.ANIMATE_DURATION;e.GRID_ANIMATION_CLS;let E;e.Mixin("Fancy.grid.mixin.Grid",{tabScrollStep:80,waitingForFilters:!1,tpl:['<div class="'+o+" "+u+'"></div>','<div class="'+n+'"></div>','<div class="'+a+" "+p+'"></div>','<div class="fancy-grid-editors"></div>'],initStore(){var t,i,l,r=this,s=r.getFieldsFromData(r.data),n="Fancy.model."+e.id(),o=r.data,a=!1,d=r.state;r.data.items&&(o=r.data.items),t=r.data.remoteSort,i=r.data.remoteFilter,(l=r.data.remotePage)&&(l="server"),e.define(n,{extend:e.Model,fields:s}),r.isGroupable()&&void 0!==r.grouping.collapsed&&(a=r.grouping.collapsed);const c={widget:r,model:n,data:o,paging:r.paging,remoteSort:t,remoteFilter:i,pageType:l,collapsed:a,multiSort:r.multiSort};r.multiSortLimit&&(c.multiSortLimit=r.multiSortLimit),r.infinite&&(c.infinite=!0),d&&d.filters&&(c.filters=d.filters),!0!==r.filterable||c.filters||(c.filters={}),o.pageSize&&(c.pageSize=o.pageSize),r.store=new e.Store(c),r.model=n,r.fields=s},initDebug(){const t=this;e.DEBUG&&(t.panel?t.panel.addCls("fancy-debug"):t.addCls("fancy-debug"))},initTouch(){const i=this;e.isTouch&&window.FastClick&&(i.panel?(FastClick.attach(i.panel.el.dom),i.panel.addCls(t)):(FastClick.attach(i.el.dom),i.addCls(t)))},initElements(){const t=this;!1!==t.header&&(t.leftHeader=new e.grid.Header({widget:t,side:"left"}),t.header=new e.grid.Header({widget:t,side:"center"}),t.rightHeader=new e.grid.Header({widget:t,side:"right"})),t.leftBody=new e.grid.Body({widget:t,side:"left"}),t.body=new e.grid.Body({widget:t,side:"center"}),t.rightBody=new e.grid.Body({widget:t,side:"right"}),t.leftEl=t.el.select(`.${o}`),t.centerEl=t.el.select(`.${n}`),t.rightEl=t.el.select(`.${a}`)},getFieldsFromData(t){const i=this,l=t.items||t;if(t.fields)return i.isTreeData&&(t.fields.push("$deep"),t.fields.push("leaf"),t.fields.push("parentId"),t.fields.push("expanded"),t.fields.push("child"),t.fields.push("filteredChild")),t.fields;l||e.error("Data is empty and not set fields of data to build model",4);const r=l[0],s=[];for(var n in r)s.push(n);return i.isTreeData&&(s.push("$deep"),s.push("leaf"),s.push("parentId"),s.push("expanded"),s.push("child")),s},render(){var t=this,i=Fancy.get(t.renderTo||document.body),l=e.get(document.createElement("div")),r=t.panelBodyBorders;t.renderOuter&&(l=i),i.dom||e.error("Could not find renderTo element: "+t.renderTo,1),l.addCls(e.cls,t.widgetCls,t.cls),Fancy.loadingStyle&&(t.panel?(t.panel.el.css("opacity",0),t.intervalStyleLoad=setInterval(()=>{Fancy.loadingStyle||(clearInterval(t.intervalStyleLoad),t.panel.el.animate({opacity:1,force:!0}))},100)):(l.css("opacity",0),t.intervalStyleLoad=setInterval(()=>{Fancy.loadingStyle||(clearInterval(t.intervalStyleLoad),t.el.animate({opacity:1,force:!0}))},100))),l.attr("role","grid"),l.attr("id",t.id),void 0===t.panel&&t.shadow&&l.addCls("fancy-panel-shadow"),!1===t.columnLines&&l.addCls("fancy-grid-disable-column-lines"),!1===t.rowLines&&l.addCls("fancy-grid-disable-row-lines"),"default"===t.theme||t.panel||l.addCls(Fancy.getThemeCSSCls(t.theme)),t.treeFolder&&l.addCls("fancy-grid-tree-folder");var s=0;t.panel&&(s=r[1]+r[3]),l.css({width:t.width-s+"px",height:t.height-0+"px"}),t.initTpl(),l.update(t.tpl.getHTML({})),t.renderOuter?t.el=l:t.el=e.get(i.dom.appendChild(l.dom)),t.setHardBordersWidth(),setTimeout(()=>{Fancy.nojQuery&&t.el.addCls(Fancy.GRID_ANIMATION_CLS)},100),t.rendered=!0},setHardBordersWidth(){var e=this,t=e.panel?e.gridBorders:e.gridWithoutPanelBorders;e.wrapped&&(t=e.gridBorders),e.css({"border-top-width":t[0],"border-right-width":t[1],"border-bottom-width":t[2],"border-left-width":t[3]})},update(e){const t=this;if(!t.store.loading){t.expander&&t.expander.reSet();var i="default";if(e&&e.type&&(i=e.type),t.updater.update(i),t.fire("update"),t.heightFit&&t.fitHeight(),t.setBodysHeight(),t.paging&&t.paging.update(),e&&e.flash){const i=t.store.changed;for(const l in i){const r=i[l],s=t.getRowById(l);if(void 0!==s)for(const i in r)switch(i){case"length":break;default:const l=t.getColumnOrderByKey(i);switch(e.flash){case!0:t.flashCell(s,l.order,l.side);break;case"plusminus":t.flashCell(s,l.order,l.side,{type:"plusminus",delta:r[i].value-r[i].originValue})}}}t.clearDirty()}else t.scroller.update();t._setColumnsAutoWidth()}},lightStartUpdate(){const e=this;e.rowheight&&e.rowheight.onUpdate(),e.bugFixReFreshChartColumns("left"),e.bugFixReFreshChartColumns("center"),e.bugFixReFreshChartColumns("right")},bugFixReFreshChartColumns(t){const i=this.getBody(t),l=this.getColumns(t);e.each(l,(e,t)=>{switch(e.type){case"grossloss":i.renderGrossLoss(t);break;case"hbar":i.renderHBar(t)}})},getColumnsWidth(e){const t=this;switch(e){case"center":case void 0:return t.getCenterFullWidth();case"left":return t.getLeftFullWidth();case"right":return t.getRightFullWidth()}},setSides(){var e=this,t=e.leftColumns,i=e.rightColumns,l=e.getLeftFullWidth(),r=e.getCenterFullWidth(),s=e.getRightFullWidth(),h=e.gridBorders,g=e.panelBodyBorders,m=e.gridWithoutPanelBorders;t.length>0&&e.leftEl.removeCls(u),i.length>0&&e.rightEl.removeCls(p),r=e.wrapped?e.width-h[1]-h[3]:e.panel?e.width-h[1]-h[3]-g[1]-g[3]:e.width-m[1]-m[3],0===l&&0===s||(0===s?r-=l:0===l?r-=s:e.width>l+r+s?r-=l:r-=l+s),e.leftEl.css({width:l+"px"}),e.centerEl.css({left:l+"px",width:r+"px"}),e.header&&(e.el.select("."+o+" ."+d).css({width:l+"px"}),e.el.select("."+n+" ."+d).css({width:r+"px"})),e.el.select("."+n+" ."+c).css({width:r+"px"}),e.width>l+r+s?e.rightEl.css({right:"0px"}):e.rightEl.css({left:"",right:"0px"}),e.rightEl.css({width:s}),e.header&&e.el.select(`.${a} .${d}`).css({width:s+"px"}),e.startWidths={center:r,left:l,right:s}},setColumnsPosition(){this.body.setColumnsPosition(),this.leftBody.setColumnsPosition(),this.rightBody.setColumnsPosition()},setSidesHeight(e){var t=this,i=t.store,l=1,r=t.cellHeaderHeight;!1!==t.header&&(l+=r,t.filter&&t.filter.header&&(t.groupheader?t.filter.groupHeader&&(l+=r):l+=r),t.groupheader&&(t.filter&&t.filter.header,l+=r)),t.isGroupable()&&(l+=t.grouping.groups.length*t.groupRowHeight),t.expander&&(l+=t.expander.plusHeight),t.summary&&(l+=t.summary.topOffSet),t.rowheight&&t.rowheight.totalHeight&&(e=t.rowheight.totalHeight),l+=e||i.getLength()*t.cellHeight-1,t.paging&&t.summary&&"bottom"===t.summary.position&&(l=t.height),t.leftEl.css({height:l+"px"}),t.centerEl.css({height:l+"px"}),t.rightEl.css({height:l+"px"})},setBodysHeight(){this.body.setHeight(),this.leftBody.setHeight(),this.rightBody.setHeight()},preRender(){const e=this;(e.title||e.subTitle||e.tbar||e.bbar||e.buttons||e.panel)&&e.renderPanel()},renderPanel(){const t=this,i={renderTo:t.renderTo,renderOuter:t.renderOuter,title:t.title,subTitle:t.subTitle,width:t.width,height:t.height,titleHeight:t.titleHeight,subTitleHeight:t.subTitleHeight,barHeight:t.barHeight,subTBarHeight:t.subTBarHeight||t.barHeight,tbarHeight:t.tbarHeight||t.barHeight,bbarHeight:t.bbarHeight||t.barHeight,buttonsHeight:t.buttonsHeight||t.barHeight,theme:t.theme,shadow:t.shadow,style:t.style||{},window:t.window,modal:t.modal,frame:t.frame,items:[t],draggable:t.draggable,resizable:t.resizable,minWidth:t.minWidth,minHeight:t.minHeight,panelBodyBorders:t.panelBodyBorders,barContainer:t.barContainer,barScrollEnabled:t.barScrollEnabled,tabScrollStep:t.tabScrollStep},l=t.panelBodyBorders;t.bbar&&(i.bbar=t.bbar,t.bbarHidden?i.bbarHidden=!0:t.height-=t.bbarHeight||t.barHeight),t.tbar&&(i.tbar=t.tbar,t.tbarHidden?i.tbarHidden=!0:t.height-=t.tbarHeight||t.barHeight),t.subTBar&&(i.subTBar=t.subTBar,t.subTBarHidden?i.subTBarHidden=!0:t.height-=t.subTBarHeight||t.barHeight),t.buttons&&(i.buttons=t.buttons,t.buttonsHidden?i.buttonsHidden=!0:t.height-=t.buttonsHeight||t.barHeight),t.footer&&(i.footer=t.footer,t.height-=t.barHeight),t.panel=new e.Panel(i),t.bbar=t.panel.bbar,t.tbar=t.panel.tbar,t.subTBar=t.panel.subTBar,t.buttons=t.panel.buttons,t.wrapped||t.panel.addCls(I),t.title&&(t.height-=t.titleHeight),t.subTitle&&(t.height-=t.subTitleHeight,t.height+=l[2]),t.height-=l[0]+l[2],t.renderTo=t.panel.el.select(`.${h}`).dom,t.resizable&&t.panel.on("resize",()=>t.setBodysHeight())},getBodyHeight(){let e=this,t=e.height,i=1,l=e.gridBorders,r=e.gridWithoutPanelBorders;return e.groupheader&&(i=2),e.filter&&e.filter.header&&(e.groupheader?(e.filter.groupHeader&&!e.subHeaderFilter&&i++,e.subHeaderFilter&&(t-=e.cellHeight)):e.subHeaderFilter?t-=e.cellHeight:i++),!1!==e.header&&(t-=e.cellHeaderHeight*i),e.panel?t-=l[0]+l[2]:t-=r[0]+r[2],e.summary&&(t-=e.summary.topOffSet,t-=e.summary.bottomOffSet),t},ons(){const t=this,i=t.store,l=e.get(document);i.on("set",t.onSetStore,t),i.on("insert",t.onInsertStore,t),i.on("remove",t.onRemoveStore,t),i.on("beforesort",t.onBeforeSortStore,t),i.on("sort",t.onSortStore,t),i.on("beforeload",t.onBeforeLoadStore,t),i.on("load",t.onLoadStore,t),l.on("mouseup",t.onDocMouseUp,t),l.on("click",t.onDocClick,t),l.on("mousemove",t.onDocMove,t),i.on("servererror",t.onServerError,t),i.on("serversuccess",t.onServerSuccess,t),t.responsive&&t.once("render",t.initResponsiveness,t),t.on("activate",t.onActivate,t),t.on("deactivate",t.onDeActivate,t),t.on("filter",t.onFilter,t),t.on("sort",t.onSort,t)},onServerError(e,t,i,l){this.fire("servererror",t,i,l)},onServerSuccess(e,t,i){this.fire("serversuccess",t,i)},onBeforeLoadStore(){this.fire("beforeload")},onRemoveStore(e,t,i){this.fire("remove",t,i)},onInsertStore(e,t){this.fire("insert",t)},onLoadStore(){const e=this;setTimeout(()=>{e.fire("load"),e.stateIsWaiting||(e.UPDATING_AFTER_LOAD=!0,e.store.changeDataView({reSort:!0}),e.update(),e.setSidesHeight(),delete e.UPDATING_AFTER_LOAD)},1)},onSetStore(e,t){this.fire("set",t),this.fire("change",t),this.fire("edit",t)},onBeforeSortStore(e,t){this.fire("beforesort",t)},onSortStore(e,t){this.fire("sort",t)},getCellsViewHeight(){var e=this,t=e.store,l=0,r=0;return e.isGroupable()&&(e.grouping.calcPlusScroll(),l+=e.grouping.plusScroll),e.expander&&(l+=e.expander.plusScroll),!e.scroller.scrollBottomEl||e.scroller.scrollBottomEl.hasCls(i)||(r=e.scroller.cornerSize),(e.rowheight?e.rowheight.totalHeight:e.cellHeight*t.dataView.length)+r+l},onDocMouseUp(){this.fire("docmouseup")},onDocClick(e){this.fire("docclick",e)},onDocMove(e){this.fire("docmove",e)},getCenterViewWidth(){const e=this,t=e.centerEl.width();if(0===t){for(var i=0,l=e.columns,r=0,s=l.length;r<s;r++){const e=l[r];e.hidden||(i+=e.width)}return i}return t},getCenterFullWidth(){for(var e=0,t=this.columns,i=0,l=t.length;i<l;i++){const l=t[i];l.hidden||(e+=l.width)}return e},getLeftFullWidth(){for(var e=0,t=this.leftColumns,i=0,l=t.length;i<l;i++){const l=t[i];l.hidden||(e+=l.width)}return e},getRightFullWidth(){for(var e=0,t=this.rightColumns,i=0,l=t.length;i<l;i++){const l=t[i];l.hidden||(e+=l.width)}return e},getColumns(e){var t=this,i=[];switch(e){case"left":i=t.leftColumns;break;case"center":i=t.columns;break;case"right":i=t.rightColumns;break;case void 0:i=i.concat(t.leftColumns).concat(t.columns).concat(t.rightColumns)}return i},setColumnsLinksToSide(e,t){const i=this;switch(t){case"left":i.leftColumns=e;break;case"center":case void 0:i.columns=e;break;case"right":i.rightColumns=e}},getBody(e){var t;switch(e){case"left":t=this.leftBody;break;case"center":t=this.body;break;case"right":t=this.rightBody}return t},getHeader(e){var t;switch(e){case"left":t=this.leftHeader;break;case"center":t=this.header;break;case"right":t=this.rightHeader}return t},getHeaderCell(t,i){var l,r;if(e.isString(t)){const e=this.getColumnOrderByKey(t);if(!(r=this.getHeader(e.side)))return;l=r.getCell(e.order)}else{if(i=i||"center",!(r=this.getHeader(i)))return;l=r.getCell(t)}return l},getDomRow(e){for(var t=this,i=t.leftBody,l=t.body,r=t.rightBody,s=t.leftColumns,n=t.columns,o=t.rightColumns,a=0,d=s.length,c=[];a<d;a++)c.push(i.getDomCell(e,a));for(a=0,d=n.length;a<d;a++)c.push(l.getDomCell(e,a));for(a=0,d=o.length;a<d;a++)c.push(r.getDomCell(e,a));return c},initTextSelection(){const e=this;!1===e.textSelection&&e.addCls(g)},setTrackOver(e,t){const i=this;switch(e){case"cell":i.cellTrackOver=t;break;case"column":i.columnTrackOver=t;break;case"row":i.trackOver=t}},setSelModel(e){const t=this,i=t.selection;i.cell=!1,i.cells=!1,i.row=!1,i.rows=!1,i.column=!1,i.columns=!1,i[e]=!0,i.selModel=e,t.multiSelect="rows"===e,i.clearSelection()},getSelection(e){return this.selection.getSelection(e)},selectCell(e){return this.selection.selectCell(e)},selectCellLeft(){return this.selection.moveLeft()},selectCellRight(){return this.selection.moveRight()},selectCellDown(){return this.selection.moveDown()},selectCellUp(){return this.selection.moveUp()},clearSelection(){const e=this.selection;e&&e.clearSelection()},destroy(e){const t=this,i=t.store;t.panel?t.panel.hide():t.el.hide(),t.el&&t.el.dom&&(t.body.destroy(),t.leftBody.destroy(),t.rightBody.destroy(),t.header.destroy(),t.leftHeader.destroy(),t.rightHeader.destroy(),t.scroller.destroy(),!1===e?t.panel?Fancy.each(t.panel.el.child(),function(e){e.destroy()}):Fancy.each(t.el.child(),function(e){e.destroy()}):(t.el.destroy(),t.panel&&t.panel.el.destroy())),i.destroy(),t.responsiveOverver&&t.responsiveOverver.stop&&(t.responsiveOverver.stop(),delete t.responsiveOverver)},clearData(){this.setData([]),this.update(),this.scroller.update()},showAt(){const e=this;e.panel&&e.panel.showAt.apply(e.panel,arguments)},show(){const e=this;setTimeout(()=>{e.panel?e.panel.show.apply(e.panel,arguments):e.el.show()},30)},hide(){const e=this;if(e.panel?e.panel.hide.apply(e.panel,arguments):e.el.hide(),e.celledit){const t=e.celledit.activeEditor;t&&t.hide()}},initDateColumn(){const t=this,i=function(i){for(var l=0,r=i.length;l<r;l++){const r=i[l];if("date"===r.type){r.format=r.format||{};const i={type:"date"};e.applyIf(i,t.lang.date),e.applyIf(r.format,i)}}return i};t.columns=i(t.columns),t.leftColumns=i(t.leftColumns),t.rightColumns=i(t.rightColumns)},stopEditor(){this.edit.stopEditor()},stopSaving(){this.store.stopSaving=!0},getById(e){return this.store.getById(e)},get(e,t){const i=this.store;return void 0!==t?i.get(e,t):void 0===e?i.get():i.getItem(e)},getRowById(e){return this.store.getRow(e)},getTotal(){return this.store.getTotal()},getViewTotal(){return this.store.getLength()},getDataView(){return this.store.getDataView()},getData(){return this.store.getData()},selectRow(e,t,i,l){this.selection.selectRow(e,t,i,l)},deSelectRow(e){this.selection.selectRow(e,!1,!0)},selectById(e,t,i){this.selection.selectById(e,t,i)},selectColumn(e){var t,i,l=this.leftColumns||[],r=this.columns||[],s=this.rightColumns||[];const n=t=>{for(var l=0,r=t.length;l<r;l++){if(t[l].index===e)return i=l,!0}return!1};n(l)?t="left":n(r)?t="center":n(s)&&(t="right"),t&&this.selection.selectColumn(i,t)},getColumnByIndex(e){for(var t=this.getColumns(),i=0,l=t.length;i<l;i++){const l=t[i];if(l.index===e)return l}},getColumn(e){return this.getColumnByIndex(e)},getColumnById(e){for(var t=this.getColumns(),i=0,l=t.length;i<l;i++){const l=t[i];if(l.id===e)return l}},getColumnOrderByKey(t){var i,l=this.leftColumns||[],r=this.columns||[],s=this.rightColumns||[],n="";return e.each(r,(e,l)=>{e.index===t&&(n="center",i=l)}),n||(e.each(l,(e,l)=>{e.index===t&&(n="left",i=l)}),n||e.each(s,(e,l)=>{e.index===t&&(n="right",i=l)})),{side:n,order:i}},getColumnOrderById(t){var i,l=this.leftColumns||[],r=this.columns||[],s=this.rightColumns||[],n="";return e.each(r,(e,l)=>{e.id===t&&(n="center",i=l)}),n||(e.each(l,(e,l)=>{e.id===t&&(n="left",i=l)}),n||e.each(s,(e,l)=>{e.id===t&&(n="right",i=l)})),{side:n,order:i}},load(e){this.store.loadData(e)},save(){this.store.save()},onWindowResize(){var t,i=this,r=i.renderTo;i.panel&&(r=i.panel.renderTo),((t=i.responsive?e.get(r):i.panel?i.panel.el:e.get(r)).hasClass(y)||t.hasClass(l))&&(t=t.parent());let s=t.width();if(void 0!==t.dom){if(0===s&&(s=t.parent().width()),i.responsive?i.setWidth(s):i.fitWidth,i.responsiveHeight){var n=parseInt(t.height());0===n&&(n=parseInt(t.parent().height())),i.setHeight(n)}i.setBodysHeight(),i.updateColumnsWidth(),i.scroller.scrollDelta(0),i.scroller.update()}},updateColumnsWidth(){const e=this,t=function(e,t,i){Fancy.each(e,(e,i)=>{if(!e.hidden&&e.flex)t.getCell(i)})};t(e.columns,e.header),t(e.leftColumns,e.leftHeader),t(e.rightColumns,e.rightHeader)},setWidth(e){const t=this,i=t.el,l=t.gridBorders,r=t.gridWithoutPanelBorders,s=t.panelBodyBorders,o=t.body,a=t.header,d=e=>{for(var t=0,i=e.length,l=0;t<i;t++){e[t].hidden||(l+=e[t].width)}return l};var c,h=d(t.leftColumns),g=d(t.rightColumns),u=e-h-g-s[1]-s[3];t.wrapped?(c=e,u=e-h-g,u-=l[1]+l[3],t.css({width:c})):t.panel?(u=e-h-g-s[1]-s[3],t.panel.el.width(e),u-=l[1]+l[3],c=e-s[1]-s[3],t.css({width:c})):(u=e-h-g-r[1]-r[3],i.css("width",e)),u<100&&(u=100),i.select(`.${n}`).css("width",u),a.css("width",u),o.css("width",u),t.hasFlexColumns&&(t.reCalcColumnsWidth(),t.columnresizer.updateColumnsWidth()),t.scroller.setScrollBars(),t.fire("changewidth",e)},getWidth(){return this.panel?parseInt(this.panel.css("width")):parseInt(this.css("width"))},getHeight(){return this.panel?parseInt(this.panel.css("height")):parseInt(this.css("height"))},setHeight(e,t){const i=this,l=e,r=i.gridBorders;i.panelBodyBorders;i.panel&&!1!==t&&i.panel.setHeight(e),i.title&&(e-=i.titleHeight),i.subTitle&&(e-=i.subTitleHeight),i.footer&&(e-=i.barHeight),i.bbar&&!i.bbarHidden&&(e-=i.bbarHeight||i.barHeight),i.tbar&&!i.tbarHidden&&(e-=i.tbarHeight||i.barHeight),i.subTBar&&!i.subTBarHidden&&(e-=i.subTBarHeight||i.barHeight),i.buttons&&!i.buttonsHidden&&(e-=i.buttonsHeight||i.barHeight);var s=e;i.header&&(s-=i.cellHeaderHeight,i.groupheader&&(s-=i.cellHeaderHeight)),i.panel?s-=2:s-=r[0]+r[2],i.summary&&(i.summary.el?s-=i.summary.el.dom.clientHeight:s-=i.cellHeight),i.body&&i.body.css("height",s),i.leftBody&&i.leftBody.css("height",s),i.rightBody&&i.rightBody.css("height",s),i.el.css("height",e),i.height=e,i.scroller.update(),i.fire("changeheight",l)},find(e,t,i){return this.store.find(e,t,i)},findItem(e,t){return this.store.findItem(e,t)},each(e,t){this.store.each(e,t)},onActivate(){const t=this,i=e.get(document);E&&E.id!==t.id&&E.fire("deactivate"),setTimeout(()=>{i.on("click",t.onDeactivateClick,t)},100),E=t},onDeActivate(){const t=this,i=e.get(document);t.activated=!1,i.un("click",t.onDeactivateClick,t),t.selection&&t.selection.activeCell&&t.selection.clearActiveCell()},onDeactivateClick(t){for(var i=0,l=e.get(t.target);i<20;i++){if(!l.dom)return;if(!l.dom.tagName||"body"===l.dom.tagName.toLocaleLowerCase())return void this.fire("deactivate");if(void 0===l.hasCls)return void this.fire("deactivate");if(l.hasCls(c))return;l=l.parent()}},search(e,t){this.searching.search(e,t)},stopSelection(){const e=this;e.selection&&e.selection.stopSelection()},enableSelection(e){const t=this;t.selection&&t.selection.enableSelection(e)},hideColumn(t,i,l){const r=this;void 0!==i||e.isArray(i)||e.isArray(t)||(i=t,(t=this.getSideByColumnIndex(i))||((s=r.getColumnOrderById(i)).side||e.error("Column does not exist"),l=r.getColumnById(i),t=s.side));if(void 0===i&&(i=t,t=void 0),e.isArray(i))e.each(i,e=>{t?r.hideColumn(t,e):r.hideColumn(e)});else{if(l){var s=r.getColumnOrderById(l.id);if(t=s.side,l.hidden)return}var n,o=r.getBody(t),a=r.getHeader(t),d=r.getColumns(t),c=0,h=d.length,g=r.centerEl,u=r.leftEl,p=r.leftHeader,m=r.rightEl,f=r.rightHeader;if(l)n=s.order,l.hidden=!0;else if(e.isNumber(i)){if((l=d[i]).hidden)return;n=i,l.hidden=!0}else for(;c<h;c++)if((l=d[c]).index===i){if(l.hidden)return;n=c,l.hidden=!0;break}if(a.hideCell(n),o.hideColumn(n),r.rowedit&&r.rowedit.hideField(n,t),r.leftColumns.length||r.rightColumns.length){var C=r.calcCurrentLeftWidth(),v=r.calcCurrentRightWidth(),y=parseInt(r.el.css("width"))-C-v;r.panel?y-=r.gridBorders[1]+r.gridBorders[3]:y-=r.gridWithoutPanelBorders[1]+r.gridWithoutPanelBorders[3],u.animate({width:C},T),p.el.animate({width:C},T),g.animate({left:C},T),g.animate({width:y},T),r.body.el.animate({width:y},T),r.header.el.animate({width:y},T),m.animate({width:v},T),f.el.animate({width:v},T),0===v&&setTimeout(function(){m.css("display","none")},T)}r.isGroupable()&&r.grouping.updateGroupRows(),"right"!==t&&"left"!==t||(clearInterval(r.intervalScrollUpdate),r.intervalScrollUpdate=setTimeout(()=>{r.scroller.update(),delete r.intervalScrollUpdate},T)),r.onWindowResize(),r.fire("columnhide",{column:l,side:t,orderIndex:n})}},showColumn(t,i,l){const r=this;void 0!==i||e.isArray(i)||e.isArray(t)||(i=t,(t=this.getSideByColumnIndex(i))||((s=r.getColumnOrderById(i)).side||e.error(`Column ${i} does not exist`),l=r.getColumnById(i),t=s.side));if(void 0===i&&(i=t,t=void 0),e.isArray(i))e.each(i,e=>{t?r.showColumn(t,e):r.showColumn(e)});else{if(l){var s=r.getColumnOrderById(l.id);if(t=s.side,!l.hidden)return}var n,o=r.getBody(t),a=r.getHeader(t),d=r.getColumns(t),c=0,h=d.length,g=r.centerEl,u=r.leftEl,p=r.leftHeader,m=r.rightEl,f=r.rightHeader;if(l)n=s.order,l.hidden=!1;else if(e.isNumber(i)){if(!(l=d[i]).hidden)return;n=i,l.hidden=!1}else for(;c<h;c++)if((l=d[c]).index===i){if(!l.hidden)return;n=c,delete l.hidden;break}if(a.showCell(n,l.width),o.showColumn(n,l.width),r.rowedit&&r.rowedit.showField(n,t),r.leftColumns.length||r.rightColumns.length){var C=r.calcCurrentLeftWidth(),v=r.calcCurrentRightWidth(),y=parseInt(r.el.css("width"))-C-v;r.panel?y-=r.gridBorders[1]+r.gridBorders[3]:y-=r.gridWithoutPanelBorders[1]+r.gridWithoutPanelBorders[3],"none"===m.css("display")&&m.show(),u.animate({width:C},T),p.el.animate({width:C},T),g.animate({left:C},T),g.animate({width:y},T),r.body.el.animate({width:y},T),r.header.el.animate({width:y},T),m.animate({width:v},T),f.el.animate({width:v},T)}r.isGroupable()&&r.grouping.updateGroupRows(),"right"!==t&&"left"!==t||(clearInterval(r.intervalScrollUpdate),r.intervalScrollUpdate=setTimeout(()=>{r.scroller.update(),delete r.intervalScrollUpdate},T)),r.onWindowResize(),r.fire("columnshow",{column:l,side:t,orderIndex:n})}},removeColumn(t,i){var l,r=this,s=r.leftEl,n=r.leftHeader,o=r.leftBody,a=r.centerEl,d=r.body,c=r.header,h=r.rightEl,g=r.rightBody,u=r.rightHeader;if(void 0===i&&(i="center"),e.isString(t))if((m=r.getColumnOrderById(t)).side)t=m.order,i=m.side;else{var p=r.getColumns(i);e.each(p,(e,i)=>{if(e.index===t)return t=i,!0}),e.isString(t)&&"center"===i&&(p=r.getColumns("left"),e.each(p,(e,l)=>{if(e.index===t)return t=l,i="left",!0}),e.isString(t)&&(p=r.getColumns("right"),e.each(p,(e,l)=>{if(e.index===t)return t=l,i="right",!0}),e.isString(t)&&e.error("Column was not found for method removeColumn",7)))}else if(e.isObject(t)){var m=r.getColumnOrderById(t.id);l=t,t=m.order,i=m.side}switch(i){case"left":l=r.leftColumns[t],r.leftColumns.splice(t,1),n.removeCell(t),o.removeColumn(t),s.css("width",parseInt(s.css("width"))-l.width),a.css("left",parseInt(a.css("left"))-l.width),a.css("width",parseInt(a.css("width"))+l.width),d.css("width",parseInt(d.css("width"))+l.width),c.css("width",parseInt(c.css("width"))+l.width),0===r.leftColumns.length&&r.leftEl.addCls(Fancy.GRID_LEFT_EMPTY_CLS);break;case"center":l=r.columns[t],r.columns.splice(t,1),c.removeCell(t),d.removeColumn(t);break;case"right":var f=0;l=r.rightColumns[t],r.rightColumns.splice(t,1),u.removeCell(t),g.removeColumn(t),h.css("width",parseInt(h.css("width"))-l.width),a.css("width",parseInt(a.css("width"))+l.width),c.css("width",parseInt(c.css("width"))+l.width),0===r.rightColumns.length&&(r.rightEl.addCls(Fancy.GRID_RIGHT_EMPTY_CLS),e.nojQuery&&(f=2)),d.css("width",parseInt(d.css("width"))+l.width-f)}return l.grouping&&delete l.grouping,r.summary&&r.summary.removeColumn(t,i),r.fire("columnremove"),clearInterval(r.removeColumnScrollInt),r.removeColumnScrollInt=setTimeout(()=>{delete r.removeColumnScrollInt,r.scroller.update()},Fancy.ANIMATE_DURATION),l.index===l.id?delete r.columnsIdsSeed[l.index]:new RegExp(l.index).test(l.id)&&(1===r.columnsIdsSeed[l.index]?delete r.columnsIdsSeed[l.index]:r.columnsIdsSeed[l.index]--),l},insertColumn(t,i,l,r){var s=this,n=s.store,o=s.leftEl,a=s.leftBody,d=s.leftHeader,c=s.centerEl,h=s.body,g=s.header,m=s.rightEl,f=s.rightBody,C=s.rightHeader,v=0;switch(t.index&&n.addField(t.index),l=l||"center"){case"center":delete t.rightLocked,delete t.locked,s.columns.splice(i,0,t),g.insertCell(i,t),h.insertColumn(i,t);break;case"left":t.locked=!0,v=0;var y=0,w=0;0===s.leftColumns.length?(e.nojQuery||(v=1,w=2),s.leftEl.removeCls(u)):w=2,e.nojQuery||(y=0);var b=o.dom.clientWidth+t.width+w;b-parseInt(o.css("width"))-t.width<-10&&(b=parseInt(o.css("width"))+t.width),s.leftColumns.splice(i,0,t),d.insertCell(i,t),d.css("width",parseInt(d.css("width"))+y),a.insertColumn(i,t),o.css("width",b),c.css("width",parseInt(c.css("width"))-t.width),c.css("left",parseInt(c.css("left"))+t.width+v),h.el.css("width",parseInt(h.el.css("width"))-t.width),g.el.css("width",parseInt(g.el.css("width"))-t.width);break;case"right":t.rightLocked=!0;w=0;0===s.rightColumns.length&&(e.nojQuery||(v=1,w=2),s.rightEl.removeCls(p)),s.rightColumns.splice(i,0,t),C.insertCell(i,t),f.insertColumn(i,t),m.css("width",parseInt(m.css("width"))+t.width),c.css("width",parseInt(c.css("width"))-t.width-v),h.css("width",parseInt(h.css("width"))-t.width-w),g.css("width",parseInt(g.css("width"))-t.width-w)}if(t.menu)if(t._menu)t.menu=t._menu;else{var x=!0;e.each(t.menu,t=>{e.isString(t)||e.isObject(t)&&t._isConfigApplied&&(x=!1)}),x||(t.menu=!0)}if(s.isGroupable()){switch(l){case"left":1===s.leftColumns.length&&s.grouping.softRenderGroupedRows("left");break;case"right":1===s.rightColumns.length&&s.grouping.softRenderGroupedRows("right")}s.grouping.updateGroupRows(),s.grouping.setCellsPosition(i,l)}t.rowEditor&&("left"===l&&i--,s.rowedit.moveEditor(t,i,l,r)),s.summary&&s.summary.insertColumn(i,l),s.header.destroyMenus(),s.leftHeader.destroyMenus(),s.rightHeader.destroyMenus(),s.sorter&&s.sorter.updateSortedHeader(),s.filter&&(clearInterval(s.intFilterFieldsUpdate),s.intFilterFieldsUpdate=setTimeout(()=>{s.filter.updateFields(),delete s.intFilterFieldsUpdate},e.ANIMATE_DURATION))},addColumn(e,t,i,l){const r=this;!1!==l?setTimeout(()=>{r._addColumn(e,t,i)},1):r._addColumn(e,t,i)},_addColumn(t,i="center",l){const r=this;if(t.type||(t.type="string"),t.width||(t.width=r.defaultColumnWidth),void 0===l){l=r.getColumns(i).length}const s={$selected:!0,$order:!0,$rowdrag:!0};void 0===t.id&&(t.index&&!s[t.index]?t.id=r.getColumnId(t.index):t.id=Fancy.id(null,"col-id-")),r.defaults&&e.applyIf(t,r.defaults),r.insertColumn(t,l,i),r.scroller.update(),r.fire("columnadd")},disableLegend(e,t){this.columns[e].disabled=this.columns[e].disabled||{},this.columns[e].disabled[t]=!0,this.update()},enableLegend(e,t){this.columns[e].disabled=this.columns[e].disabled||{},delete this.columns[e].disabled[t],this.update()},fitHeight(){var e=this,t=e.store,i=e.panelBodyBorders,l=e.gridBorders,r=t.getLength()*e.cellHeight,s=1,n=e.columns.concat(e.leftColumns||[]).concat(e.rightColumns||[]);Fancy.each(n,e=>{e.grouping&&(s<2&&(s=2),e.filter&&e.filter.header&&s<3&&(s=3)),e.filter&&e.filter.header&&s<2&&(s=2)}),e.getCenterFullWidth()>e.getCenterViewWidth()&&!e.nativeScroller&&!Fancy.isIE&&(r+=e.bottomScrollHeight),e.title&&(r+=e.titleHeight),e.tbar&&(r+=e.tbarHeight||e.barHeight),e.summary&&(r+=e.cellHeight),e.bbar&&(r+=e.bbarHeight||e.barHeight),e.buttons&&(r+=e.buttonsHeight||e.barHeight),e.subTBar&&(r+=e.subTBarHeight||e.barHeight),e.footer&&(r+=e.barHeight),!1!==e.header&&(r+=e.cellHeaderHeight*s),e.isGroupable()&&(r+=e.grouping.groups.length*e.groupRowHeight),e.panel?r+=i[0]+i[2]+l[0]+l[2]:r+=l[0]+l[2],e.setHeight(r)},addFilter(t,i,l,r){var s=this,n=s.store.filters[t],o=!1===s.waitingForFilters;if(e.isFunction(i)&&(l="fn"),l=l||"",void 0===n&&(n={}),e.isDate(i)){const e=this.getColumnByIndex(t).format;n.type="date",n.format=e,i=Number(i)}n[l]=i,s.store.filters[t]=n,o&&(clearInterval(s.intervalUpdatingFilter),s.intervalUpdatingFilter=setTimeout(()=>{s.WAIT_FOR_STATE_TO_LOAD?s.filter.updateStoreFilters(!1):s.filter.updateStoreFilters(),delete s.intervalUpdatingFilter},1)),!1!==r?s.filter.addValuesInColumnFields(t,i,l):s.searching},clearFilter(t,i,l){const r=this,s=r.store,n=!1===r.waitingForFilters;r.isRequiredChangeAllMemorySelection()&&(r.selection.memory.selectAllFiltered(),setTimeout(()=>{r.selection.updateHeaderCheckBox()},1)),void 0===t||null===t?s.filters={}:void 0===i||null===i?s.filters&&s.filters[t]&&delete s.filters[t]:r.filter&&s.filters&&s.filters[t]&&void 0!==s.filters[t][i]&&(delete s.filters[t][i],e.Object.isEmpty(s.filters[t])&&delete s.filters[t]),e.Object.isEmpty(s.filter)&&(delete s.filteredData,delete s.filterOrder,delete s.filteredDataMap),r.searching&&void 0===t&&void 0===i&&(r.searching.clearBarField(),r.search(""),r.expander&&r.expander.reSet()),n&&(clearInterval(r.intervalUpdatingFilter),r.intervalUpdatingFilter=setTimeout(()=>{if(s.remoteFilter)return s.once("serversuccess",()=>{r.fire("filter",s.filters),delete r.intervalUpdatingFilter}),void s.serverFilter();if(s.grouping&&s.grouping.by){const e=r.grouping;s.isFiltered()?(s.changeDataView(),e.initGroups("filteredData")):e.initGroups(),e.reFreshExpanded(),e.initOrder(),s.changeDataView(),e.updateGroupRows(),e.setCellsPosition(),e.setPositions(),e.reFreshGroupTexts(),e.update()}else s.changeDataView();s.grouping&&s.grouping.by||r.update(),r.setSidesHeight(),delete r.intervalUpdatingFilter},100)),r.filter&&!1!==l&&r.filter.clearColumnsFields(t,i),n&&(r.fire("filter",s.filters),r.setSidesHeight())},isRequiredChangeAllMemorySelection(){const e=this.store,t=this.selection;return e.hasFilters()&&t&&t.memory&&t.memory.all},updateFilters(){delete this.waitingForFilters,this.filter.updateStoreFilters()},updateFilter(){this.updateFilters()},showLoadMask(e){this.loadmask.show(e)},clearSorter(){this.sorter&&this.sorter.clearSort()},hideLoadMask(){this.loadmask.hide()},prevPage(){this.paging.prevPage()},nextPage(){this.paging.nextPage()},setPage(e,t){--e<0&&(e=0),this.paging.setPage(e,t)},firstPage(){this.paging.firstPage()},lastPage(){this.paging.lastPage()},setPageSize(e){this.paging.setPageSize(e)},getPage(){return this.store.showPage+1},getPages(){return this.store.pages},getPageSize(){return this.store.pageSize},refresh(){this.paging.refresh()},scroll(e,t,i){const l=this,r=l.scroller;void 0!==t&&t>0&&(t=-t);const s=r.getScrollHeight();e>s&&(e=s,l.nativeScroller&&r.isRightScrollable()&&(e+=17));const n=r.getScrollWidth();Math.abs(t)>n&&(t=-n),!1===r.isBottomScrollable()?t=0:l.nativeScroller&&r.isRightScrollable()&&(t-=17),r.scroll(e,t,i),r.scrollBottomKnob(),r.scrollRightKnob()},getDataFiltered(){return this.store.filteredData},reCalcColumnsWidth(){const e=this;if(e.hasFlexColumns){var t,i,l=e.scroller,r=e.getCenterViewWidth(),s=e.columns,n=0,o=0,a=s.length,d=r;for(!1!==e.flexScrollSensitive&&l.isRightScrollable()&&!l.nativeScroller&&(d-=e.bottomScrollHeight);o<a;o++)(i=s[o]).hidden||(i.flex?n+=i.flex:d-=i.width);if(0!==n)for(t=d/n,o=0;o<a;o++)(i=s[o]).hidden||i.flex&&(i.width=Math.floor(i.flex*t),i.minWidth&&i.width<i.minWidth&&(i.width=i.minWidth),i.minWidth&&i.width<i.minWidth?i.width=i.minWidth:i.width<e.minColumnWidth&&(i.width=e.minColumnWidth))}},getDisplayedData(t,i,l,r,s){var n=this,o=n.getViewTotal(),a=[],d=0,c=n.leftColumns,h=n.columns,g=n.rightColumns,u={};s&&(s=this.getSelection()),l&&e.each(l,function(e){u[e]=!0}),t&&(o=n.getTotal());const p=function(e){if(!(void 0===e.index||"$selected"===e.index||e.hidden||r&&!1===e.exportable)){if(/spark/.test(e.type))return!1;switch(e.type){case"select":case"action":case"expand":case"grossloss":case"hbar":case"rowdrag":break;case"order":m.push(d+1);break;default:if(s)var t=(l=s[d])[e.index];else{var l=n.get(d);t=n.get(d,e.index)}e.exportFn&&r?(l&&l.data&&(l=l.data),m.push(e.exportFn({value:t,data:l}).value)):e.render&&!0!==i?(l&&l.data&&(l=l.data),t=e.render({value:t,data:l}).value.replace(/<\/?[^>]+(>|$)/g,""),m.push(t)):s?m.push(t):m.push(n.get(d,e.index))}}};for(s&&(d=0,o=s.length);d<o;d++){var m=[];if(l){var f=n.get(d);if(!f||!u[f.id])continue}e.each(c,p),e.each(h,p),e.each(g,p),a.push(m)}return a},getAllDisplayedData(){var t=this,i=t.getViewTotal(),l=[],r=0,s=t.leftColumns,n=t.columns,o=t.rightColumns;const a=function(e){if(void 0!==e.index&&"$selected"!==e.index&&!e.hidden)switch(e.type){case"order":d.push(r+1);break;default:if(e.render){var i=t.get(r),l=t.get(r,e.index);d.push(e.render({value:l,data:i}).value)}else d.push(t.get(r,e.index))}};for(;r<i;r++){var d=[];e.each(s,a),e.each(n,a),e.each(o,a),l.push(d)}return l},setData(e){const t=this,i=t.store;i.isTree?i.initTreeData(e):i.setData(e),t.isGroupable()&&i.orderDataByGroup(),i.sorters&&i.reSort(),i.filterOrder&&t.filter.updateStoreFilters(!1),i.clearDirty(),(i.sorters||i.filterOrder)&&i.changeDataView({doNotFired:!0}),t.setSidesHeight(),t.filter&&t.filter.waitForComboData&&t.filter.updateFilterComboData(),t.isGroupable()&&(t.grouping.reGroup(),t.update())},exportToExcel(e){const t=this;t.exporter&&t.exporter.exportToExcel(e)},getDataAsCsv(e){const t=this;if(t.exporter)return t.exporter.getDataAsCsv(e)},getDataAsCSV(e){return this.getDataAsCsv(e)},exportToCSV(e){const t=this;if(t.exporter)return t.exporter.exportToCSV(e)},exportToCsv(e){return this.exportToCSV(e)},disableSelection(){this.selection.disableSelection()},setParams(t){const i=this.store;i.proxy&&(i.proxy.params=i.proxy.params||{},e.apply(i.proxy.params,t))},setUrl(t){const i=this.store;if(e.isString(t)){if(i.proxy&&i.proxy.api)if("rest"===i.proxy.type)for(var l in i.proxy.api)i.proxy.api[l]=t;else i.proxy.api.read=t}else i.proxy&&i.proxy.api&&e.apply(i.proxy.api,t)},getSideByCell(e){var t;return this.centerEl.within(e)?t="center":this.leftEl.within(e)?t="left":this.rightEl.within(e)&&(t="right"),t},getSideEl(e){const t=this;switch(e){case"left":return t.leftEl;case"center":return t.centerEl;case"right":return t.rightEl}},addChild(t,i){const l=this,r=l.store;if(void 0===i)t.$deep=1,void 0===t.child&&(t.child=[]),l.add(t);else{e.isNumber(t)&&(t=l.getById(t));var s=!1;!0===t.get("leaf")&&(t.set("leaf",!1),t.set("expanded",!0),t.set("child",[]),s=!0);const n=t.get("$deep"),o=t.get("child"),a=l.getRowById(t.id)+o.length+1;if(i.$deep=n+1,i.parentId=t.id,s){const r=t.get("parentId");if(r){const s=l.getById(r);e.each(s.data.child,e=>{if(e.id===t.id)return e.leaf=!1,e.expanded=!0,e.child=[i],!0})}}o.push(new r.model(i)),t.set("child",o),!0===t.get("expanded")&&l.insert(a,i)}},expand(t,i){var l,r=this;switch(e.typeOf(t)){case"number":case"string":l=r.getById(t)}if(l)if(!0!==l.get("expanded")){if(r.tree&&r.tree.expandRow(l),r.expander){if(i&&this.expander._expandedIds[t])return void this.collapse(t);var s=r.getRowById(t);r.expander.expand(s)}}else i&&this.collapse(t)},toggleExpand(e){this.expand(e,!0)},collapse(t,i){var l,r=this;switch(e.typeOf(t)){case"number":case"string":l=r.getById(t)}if(!1!==l.get("expanded")){if(r.tree&&r.tree.collapseRow(l),r.expander){var s=!this.expander._expandedIds[t];if(!s&&this.expander._expandedIds[t].hidden&&(s=!0),i&&s)return void this.expand(t);var n=r.getRowById(t);r.expander.collapse(n)}}else i&&this.expand(t)},toggleCollapse(e){this.collapse(e,!0)},collapseAll(){const t=this;if(t.tree){const i=t.findItem("$deep",1);e.each(i,e=>{t.collapse(e.id)})}else t.expander&&t.expander.collapseAll()},expandAll(){var t=this,i=t.findItem("expanded",!1);e.each(i,e=>{t.expand(e.id)}),(i=t.findItem("expanded",!1)).length&&t.expandAll()},copy(e){const t=this;t.selection&&t.selection.copy(e)},sort(t,i,l){var r,s,n=this.getColumnByIndex(t),o=this.getColumnOrderByKey(t);if(void 0===l&&(l=!0),o.side)if(s=(r=this.getHeader(o.side)).getCell(o.order),i){switch(i=i||"ASC",s=r.getCell(o.order),i=i.toLocaleLowerCase()){case"asc":s.removeCls(f),s.addCls(m);break;case"desc":s.removeCls(m),s.addCls(f);break;case"drop":s.removeCls(m),s.removeCls(f);break;default:e.error("sorting type is not right - "+i)}this.sorter.sort(i,t,o.side,n,s,l)}else s.dom.click()},flashRow(t){const i=this.getDomRow(t);e.each(i,t=>{(t=e.get(t)).addCls("fancy-grid-cell-flash")}),setTimeout(()=>{e.each(i,t=>{(t=e.get(t)).addCls("fancy-grid-cell-animation")})},200),setTimeout(()=>{e.each(i,t=>{(t=e.get(t)).removeCls("fancy-grid-cell-flash"),t.removeCls("fancy-grid-cell-animation")})},700)},flashCell(e,t,i="center",l){var r=this.getBody(i),s=700,n=Fancy.isObject(e)?e:r.getCell(e,t);if(l)switch(l.duration&&(s=l.duration),l.type){case"plusminus":l.delta>0?(n.addCls("fancy-grid-cell-flash-plus"),setTimeout(()=>{n.removeCls("fancy-grid-cell-flash-plus"),n.removeCls("fancy-grid-cell-animation")},s)):(n.addCls("fancy-grid-cell-flash-minus"),setTimeout(()=>{n.removeCls("fancy-grid-cell-flash-minus"),n.removeCls("fancy-grid-cell-animation")},s))}else n.addCls("fancy-grid-cell-flash"),setTimeout(()=>{n.removeCls("fancy-grid-cell-flash"),n.removeCls("fancy-grid-cell-animation")},700);setTimeout(()=>{n.addCls("fancy-grid-cell-animation")},200)},scrollToRow(e){const t=this.body.getCell(e,0);this.scroller.scrollToCell(t.dom,!1,!0),this.scroller.update(),this.flashRow(e)},getStateSorters(){const t={},i=JSON.parse(localStorage.getItem(this.getStateName()));if(!i)return;if(!i.sorters)return{};const l=JSON.parse(i.sorters);return e.each(l,e=>{t[e.key]=e}),t},getStateName(){const e=this,t=e.id,i=location.host+"-"+location.pathname;return e.stateId?e.stateId:t+"-"+i},setWidthFit(){var e=this,t=e.panelBodyBorders,i=e.gridWithoutPanelBorders,l=e.gridBorders,r=0,s=!1,n=[].concat(e.leftColumns).concat(e.columns).concat(e.rightColumns);Fancy.each(n,e=>{e.hidden||(r+=e.width),e.locked&&(s=!0)}),e.panel?r+=t[1]+t[3]+l[1]+l[3]:r+=i[1]+i[3]+l[1]+l[3],s&&r--,e.setWidth(r)},setColumnTitle(e,t,i="center"){var l,r=this.getHeader(i),s=r.getColumns();Fancy.isString(e)&&(e=this.getColumnOrderByKey(e).order),(l=s[e]).title=t,r.getCell(e).select(`.${Fancy.GRID_HEADER_CELL_TEXT_CLS}`).item(0).update(t),this.fire("columntitlechange",{orderIndex:e,index:l.index,value:t,side:i})},clearDirty(){this.store.clearDirty(),this.body.clearDirty(),this.leftBody.clearDirty(),this.rightBody.clearDirty()},isDirty(){return this.store.isDirty()},hideBar(t){var i,l,r=this;r.barHeight;switch(t){case"tbar":i=w,r.tbarHidden=!0,r.tbarHeight&&r.tbarHeight;break;case"subtbar":i=b,r.subTBarHidden=!0,r.subTBarHeight&&r.subTBarHeight;break;case"bbar":i=x,r.bbarHidden=!0,r.bbarHeight&&r.bbarHeight;break;case"buttons":i=S,r.buttonsHidden=!0,r.buttonsHeight&&r.buttonsHeight;break;default:e.error("Bar does not exist")}if("none"!==(l=r.panel.el.select(`.${i}`)).css("display")){l.hide();const e=parseInt(r.panel.el.css("height"));r.setHeight(e)}},showBar(t){var i,l,r=this;r.barHeight;switch(t){case"tbar":i=w,delete r.tbarHidden,r.tbarHeight&&r.tbarHeight;break;case"subtbar":i=b,delete r.subTBarHidden,r.subTBarHeight&&r.subTBarHeight;break;case"bbar":i=x,delete r.bbarHidden,r.bbarHeight&&r.bbarHeight;break;case"buttons":i=S,delete r.buttonsHidden,r.buttonsHeight&&r.buttonsHeight;break;default:e.error("Bar does not exist")}if("none"==(l=r.panel.el.select(`.${i}`)).css("display")){l.show();const e=parseInt(r.panel.el.css("height"));r.setHeight(e)}},initResponsiveness(){const t=this,i=function(){t.onWindowResize(),clearInterval(t.intWindowResize),t.intWindowResize=setTimeout(()=>{t.onWindowResize(),delete t.intWindowResize,setTimeout(()=>{t.onWindowResize()},300)},30)};"ResizeObserver"in window?(setTimeout(()=>{var l,r;t.nativeResizeObserver?l=new ResizeObserver(i):(l=new e.ResizeObserver(i),t.responsiveOverver=l),(r=t.panel?t.panel.el.parent().dom:t.el.parent().dom)&&l.observe(r)},100),e.$(window).bind("resize",i)):(setTimeout(()=>{const l=new e.ResizeObserver(i),r=t.el.parent().dom;r&&(t.responsiveOverver=l,l.observe(r))},100),e.$(window).bind("resize",i))},getNumOfVisibleCells(){const e=this;if(!e.numOfVisibleCells)try{e.numOfVisibleCells=Math.ceil(e.getBodyHeight()/e.cellHeaderHeight)}catch(t){e.numOfVisibleCells=0}return e.numOfVisibleCells},getSideByColumnIndex(t){var i;return e.each(this.columns,e=>{e.index===t&&(i="center")}),e.each(this.leftColumns,e=>{e.index===t&&(i="left")}),e.each(this.rightColumns,e=>{e.index===t&&(i="right")}),i},setColumnWidth(t,i,l="center"){const r=this;if(e.isArray(t))e.each(t,e=>{r.setColumnWidth(e.index,e.width,e.side)});else{const s=r.getColumns(l);e.isNumber(t)?s[t].width=i:r.getColumnByIndex(t).width=i}clearInterval(r.intervalUpdateColumnsWidth),r.intervalUpdateColumnsWidth=setTimeout(()=>{r.columnresizer&&(r.columnresizer.updateColumnsWidth("all"),delete this.intervalUpdateColumnsWidth,setTimeout(()=>{r.scroller.update()},Fancy.ANIMATE_DURATION))},100)},isLoading(){return this.store.loading},getChanges(){const e=this.store,t={};return t.changed=e.changed,t.removed=e.removed,t.inserted=e.inserted,t},autoSizeColumn(t,i,l){var r,s=this;if(e.isBoolean(i)?i=(r=s.getColumnOrderById(t)).side:(r=s.getColumnOrderByKey(t))&&void 0!==r.order||(i=(r=s.getColumnOrderById(t)).side),r&&void 0!==r.order){i=i||r.side;var n,o=s.getBody(i),a=e.get(o.getDomColumn(r.order)),d=a.css("width");if(d>500&&(d=100),a.css("width",""),n=a.dom.offsetWidth+2,l&&l.maxWidth&&l.maxWidth<n?n=l.maxWidth:l&&l.minWidth&&l.minWidth>n?n=l.minWidth:l&&l.maxAutoWidth&&l.maxAutoWidth<n&&(n=l.maxAutoWidth),a.css("width",d),s.header){const e=s.getHeaderCell(r.order,i);d=e.css("width"),e.css("width","");const t=e.dom.offsetWidth+25;e.css("width",d),t>n&&(n=t)}s.setColumnWidth(r.order,n,i)}else e.error("Column index was not found")},autoSizeColumns(){const t=this,i=t.getColumns();e.each(i,e=>{t.isServiceColumn(e)||e.id&&t.autoSizeColumn(e.id,!0,e)})},onFilter(){const e=this;e.store.hasFilters()?e.addCls(s):e.removeCls(s)},onSort(){const e=this,t=e.store;t.sorters&&t.sorters.length?e.addCls(r):e.removeCls(r)},isServiceColumn(e){switch(e.type){case"order":case"select":case"expand":case"rowdrag":return!0}return!1},getFilter(e,t){const i=this;if(void 0===e&&void 0===t)return i.store.filters;const l=i.store.filters[e];return void 0===t?l||void 0:l&&l[t]?l[t]:void 0},getSorter(t){const i=this;if(void 0!==t){let l;return e.each(i.store.sorters,e=>{if(e.key===t)return l=e,!0}),l}return i.store.sorters},setColumnComboData(t,i){const l=this.getColumns();e.each(l,l=>{if(l.index===t||l.id===t){if(l.data=i,l.editor&&delete l.editor,l.filterField){var r=[];e.isObject(i[0])?r=i:e.each(i,(e,t)=>{r.push({value:t,text:e})}),l.filterField.setData(r)}if(l.rowEditor){r=[];e.isObject(i[0])?r=i:e.each(i,(e,t)=>{r.push({value:t,text:e})}),l.rowEditor.setData(r)}}})},clearGroup(){const e=this,t=e.store;t.clearGroup(),e.grouping.clearGroup(),t.changeDataView(),e.update(),e.setSidesHeight(),e.scroller.update()},addGroup(e,t){const i=this,l=i.store,r=!i.grouping.by;l.addGroup(e),l.sorters&&l.reSort(),l.filterOrder,i.grouping.addGroup(r),i.setSidesHeight(),t&&i.expandGroup(),i.scroller.update(),i.scroll(0,0)},isGroupable(){return this.grouping&&this.grouping.by},expandGroup(t){const i=this,l=i.store,r=i.grouping,s=r.groups;t?(i.el.select("."+C+'[group="'+t+'"]').removeCls(v),r.expand(r.by,t)):(e.each(s,function(e){i.el.select("."+C+'[group="'+e+'"]').removeCls(v)}),r.expand(r.by,s)),(l.sorters||l.filterOrder)&&l.changeDataView({doNotFired:!0}),l.filterOrder&&l.grouping&&l.grouping.by&&i.filter.reGroupAccordingToFilters(),r.update()},collapseGroup(t){const i=this,l=i.grouping,r=l.groups;t?(i.el.select("."+C+'[group="'+t+'"]').addCls(v),l.collapse(l.by,t)):e.each(r,function(e){i.el.select("."+C+'[group="'+e+'"]').addCls(v),l.collapse(l.by,e)}),l.update()},calcCurrentLeftWidth(){var t=this.getColumns("left"),i=0;return e.each(t,e=>{e.hidden||(i+=e.width)}),i},calcCurrentRightWidth(){var t=this.getColumns("right"),i=0;return e.each(t,e=>{e.hidden||(i+=e.width)}),i},setColumns(e){const t=this;e=Fancy.Array.copy(e,!0),e=t.prepareConfigColumnMinMaxWidth({columns:e}).columns,t.defaults&&(e=t.prepareConfigDefaults({defaults:t.defaults,columns:e}).columns),t.refreshcolumns.setColumns(e),t._setColumnsAutoWidth(),setTimeout(()=>{Fancy.each(["left","center","right"],e=>{const i=t.getHeader(e),l=t.getBody(e);i.reSetColumnsAlign(),i.reSetColumnsCls(),l.reSetColumnsAlign(),l.reSetColumnsCls(),l.reSetIndexes()})},1)}}),e.ResizeObserver=function(e){this.fn=e},e.ResizeObserver.prototype.observe=function(e){this.el=e,this.init()},e.ResizeObserver.prototype.init=function(){const e=this;e.width=e.el.clientWidth,e.height=e.el.clientHeight,e.interval=setInterval(()=>{const t=e.el.clientWidth,i=e.el.clientHeight;t===e.width&&i===e.height||(e.fn(),e.width=e.el.clientWidth,e.height=e.el.clientHeight)},100)},e.ResizeObserver.prototype.stop=function(){clearInterval(this.interval),delete this.width,delete this.height}}(),Fancy.define("Fancy.grid.plugin.Updater",{extend:Fancy.Plugin,ptype:"grid.updater",inWidgetName:"updater",constructor:function(e){Fancy.applyConfig(this,e),this.Super("const",arguments)},init(){},update(e=""){const t=this.widget;t.leftColumns&&t.leftColumns.length&&t.leftBody.update(e),t.body.update(e),t.rightColumns&&t.rightColumns.length&&t.rightBody.update(e)},updateRow(e){const t=this.widget;t.leftBody.updateRows(e),t.body.updateRows(e),t.rightBody.updateRows(e)}}),function(){const e=Fancy,t=e.HIDDEN_CLS,i=e.GRID_COLUMN_CLS,l=e.GRID_CENTER_CLS;e.define("Fancy.grid.plugin.Scroller",{extend:e.Plugin,ptype:"grid.scroller",inWidgetName:"scroller",rightKnobDown:!1,bottomKnobDown:!1,minRightKnobHeight:35,minBottomKnobWidth:35,cornerSize:12,scrollLeft:0,scrollTop:0,constructor:function(){this.Super("const",arguments)},init(){this.Super("init",arguments),this.ons()},ons(){const t=this,i=t.widget,l=e.getMouseWheelEventName();i.once("render",()=>{t.render(),i.leftBody.el.on(l,t.onMouseWheel,t),i.nativeScroller&&(i.leftBody.el.on(l,t.onMouseWheelLeft,t),i.rightBody.el.on(l,t.onMouseWheelRight,t)),i.body.el.on(l,t.onMouseWheel,t),i.rightBody.el.on(l,t.onMouseWheel,t),i.once("init",t.onGridInit,t),i.nativeScroller?(i.body.el.on("scroll",t.onNativeScrollBody,t),i.leftBody.el.on("scroll",t.onNativeScrollLeftBody,t),i.rightBody.el.on("scroll",t.onNativeScrollRightBody,t)):(i.panel&&i.panel.on("resize",t.onPanelResize,t),i.body.el.on("scroll",t.onScrollBodyBugFix,t))}),t.on("render",t.onRender,t),i.store.on("change",t.onChangeStore,t)},destroy(){const t=this,i=t.widget,l=i.leftBody,r=i.body,s=i.rightBody,n=e.getMouseWheelEventName();l.el.un(n,t.onMouseWheel,t),r.el.un(n,t.onMouseWheel,t),s.el.un(n,t.onMouseWheel,t),i.nativeScroller||(t.scrollBottomEl.un("mousedown",t.onMouseDownBottomSpin,t),t.scrollRightEl.un("mousedown",t.onMouseDownRightSpin,t)),e.isTouch&&(l.el.un("touchstart",t.onBodyTouchStart,t),l.el.un("touchmove",t.onBodyTouchMove,t),r.el.un("touchstart",t.onBodyTouchStart,t),r.el.un("touchmove",t.onBodyTouchMove,t),s.el.un("touchstart",t.onBodyTouchStart,t),s.el.un("touchmove",t.onBodyTouchMove,t))},onGridInit(){const t=this,i=t.widget,l=i.store,r=e.get(document);t.setScrollBars(),r.on("mouseup",t.onMouseUpDoc,t),r.on("mousemove",t.onMouseMoveDoc,t),i.on("columnresize",t.onColumnResize,t),i.on("lockcolumn",t.onLockColumn,t),i.on("rightlockcolumn",t.onRightLockColumn,t),i.on("unlockcolumn",t.onUnLockColumn,t),l.on("changepages",t.onChangePages,t),i.on("columndrag",t.onColumnDrag,t),setTimeout(()=>{t.update()},1)},render(){const i=this,l=i.widget,r=l.body,s=e.get(document.createElement("div")),n=e.get(document.createElement("div")),o=e.get(document.createElement("div"));l.nativeScroller?l.el.addCls("fancy-grid-native-scroller"):(s.addCls("fancy-scroll-right"),n.addCls("fancy-scroll-bottom",t),s.update(['<div class="fancy-scroll-right-inner"></div>'].join(" ")),s.select(".fancy-scroll-right-inner").css("margin-top",l.knobOffSet),n.update(['<div class="fancy-scroll-bottom-inner"></div>'].join(" ")),e.get(r.el.append(s.dom)),i.scrollRightEl=r.el.select(".fancy-scroll-right"),e.get(r.el.append(n.dom)),i.scrollBottomEl=r.el.select(".fancy-scroll-bottom"),l.doubleHorizontalScroll&&(o.addCls("fancy-scroll-top",t),o.update(['<div class="fancy-scroll-top-inner"></div>'].join(" ")),e.get(r.el.append(o.dom)),i.scrollTopEl=r.el.select(".fancy-scroll-top"))),i.fire("render")},onMouseWheel(t){const i=this,l=i.widget,r=l.store,s=e.getWheelDelta(t.originalEvent||t);if(l.infinite){let e;return t.preventDefault(),(e=s<0?r.infiniteScrolledToRow+1:r.infiniteScrolledToRow-1)>r.getNumOfInfiniteRows()-(l.numOfVisibleCells-1)&&(e=r.getNumOfInfiniteRows()-(l.numOfVisibleCells-1)),e<0&&(e=0),r.infiniteScrolledToRow=e,l.update(),void(l.selection&&l.selection.updateSelection())}0!=i.isRightScrollable()&&(l.stopProp&&t.stopPropagation(),l.nativeScroller||(i.scrollDelta(s)&&t.preventDefault(),i.scrollRightKnob()))},onRender(){const t=this,i=t.widget;!0!==i.nativeScroller&&(t.scrollRightEl.hover(function(){!0!==t.bottomKnobDown&&t.scrollRightEl.addCls("fancy-scroll-right-hover")},function(){t.scrollRightEl.removeCls("fancy-scroll-right-hover")}),t.scrollBottomEl.hover(function(){!0!==t.rightKnobDown&&t.scrollBottomEl.addCls("fancy-scroll-bottom-hover")},function(){t.scrollBottomEl.removeCls("fancy-scroll-bottom-hover")}),i.doubleHorizontalScroll&&t.scrollTopEl.hover(function(){!0!==t.bottomKnobDown&&t.scrollTopEl.addCls("fancy-scroll-top-hover")},function(){!0!==t.bottomKnobDown&&t.scrollTopEl.removeCls("fancy-scroll-top-hover")}),t.initRightScroll(),t.initBottomScroll()),e.isTouch&&t.initTouch()},initTouch(){const t=this,i=t.widget,l=i.leftBody,r=i.body,s=i.rightBody,n=e.get(document);l.el.on("touchstart",t.onBodyTouchStart,t),l.el.on("touchmove",t.onBodyTouchMove,t),r.el.on("touchstart",t.onBodyTouchStart,t),r.el.on("touchmove",t.onBodyTouchMove,t),s.el.on("touchstart",t.onBodyTouchStart,t),s.el.on("touchmove",t.onBodyTouchMove,t),n.on("touchend",t.onBodyTouchEnd,t)},onBodyTouchStart(e){e=e.originalEvent||e;const t=this,i=t.widget,l=e.changedTouches[0];i.nativeScroller||(Fancy.nojQuery&&(i.panel?i.panel.el.select("."+Fancy.GRID_ANIMATION_CLS).removeCls(Fancy.GRID_ANIMATION_CLS):i.el.removeCls(Fancy.GRID_ANIMATION_CLS)),e.preventDefault(),t.rightKnobDown=!0,t.bottomKnobDown=!0,t.mouseDownXY={x:l.pageX,y:l.pageY},t.rightKnobTop=parseInt(t.rightKnob.css("margin-top")),t.scrollRightEl.addCls("fancy-scroll-right-active"),t.bottomKnobLeft=parseInt(t.bottomKnob.css("margin-left")),t.scrollBottomEl.addCls("fancy-scroll-bottom-active"),i.doubleHorizontalScroll&&t.scrollTopEl.addCls("fancy-scroll-top-active"))},onBodyTouchEnd(){const e=this,t=e.widget;if(e.onMouseUpDoc(),!0!==t.nativeScroller&&e.spyOnSwipe){const t=e.spyOnSwipe.swipedX,i=e.spyOnSwipe.swipedY;i&&t?"top"===e.touchScrollDirection?e.swipeTop():"left"===e.touchScrollDirection&&e.swipeLeft():i?e.swipeTop():t&&e.swipeLeft()}delete e.spyOnSwipe,delete e.touchScrollDirection},swipeTop(){let e=this.widget,t=this.scrollTop+10*this.spyOnSwipe.swipedY;this.isRightScrollable()&&(t<0&&(t=0),e.scroll(t,!1,!0))},swipeLeft(){let e=this.widget,t=this.scrollLeft+10*this.spyOnSwipe.swipedX;this.isBottomScrollable()&&(t<0&&(t=0),e.scroll(!1,t,!0))},onBodyTouchMove(t){var i=this,l=i.widget,r=(t=t.originalEvent||t).changedTouches[0],s=!0;if(l.nativeScroller){if(e.isTouch)return;i.onMouseMoveDoc({pageX:r.pageX,pageY:r.pageY})}else{var n=i.scrollLeft,o=i.scrollTop;i.onMouseMoveDoc({pageX:r.pageX,pageY:r.pageY}),s=n!==i.scrollLeft||o!==i.scrollTop,t.preventDefault()}!0===i.rightKnobDown&&s&&t.preventDefault(),!0===i.bottomKnobDown&&s&&t.preventDefault()},initRightScroll(){const e=this;e.rightKnob=e.scrollRightEl.select(".fancy-scroll-right-inner"),e.scrollRightEl.on("mousedown",e.onMouseDownRightSpin,e)},initBottomScroll(){const e=this,t=e.widget;e.bottomKnob=e.scrollBottomEl.select(".fancy-scroll-bottom-inner"),e.scrollBottomEl.on("mousedown",e.onMouseDownBottomSpin,e),t.doubleHorizontalScroll&&(e.topKnob=e.scrollTopEl.select(".fancy-scroll-top-inner"),e.scrollTopEl.on("mousedown",e.onMouseDownBottomSpin,e))},onMouseDownRightSpin(t){const i=this,l=i.widget;e.isTouch||(Fancy.nojQuery&&(l.panel?l.panel.el.select("."+Fancy.GRID_ANIMATION_CLS).removeCls(Fancy.GRID_ANIMATION_CLS):l.el.removeCls(Fancy.GRID_ANIMATION_CLS)),t.preventDefault(),i.rightKnobDown=!0,i.mouseDownXY={x:t.pageX,y:t.pageY},i.rightKnobTop=parseInt(i.rightKnob.css("margin-top")),i.scrollRightEl.addCls("fancy-scroll-right-active"))},onMouseDownBottomSpin(t){const i=this,l=i.widget,r=e.get(t.target);t.preventDefault(),Fancy.nojQuery&&(l.panel?l.panel.el.select("."+Fancy.GRID_ANIMATION_CLS).removeCls(Fancy.GRID_ANIMATION_CLS):l.el.removeCls(Fancy.GRID_ANIMATION_CLS)),i.bottomKnobDown=!0,i.mouseDownXY={x:t.pageX,y:t.pageY},i.bottomKnobLeft=parseInt(i.bottomKnob.css("margin-left")),i.scrollBottomEl.addCls("fancy-scroll-bottom-active"),r.hasClass()&&i.scrollTopEl.addCls("fancy-scroll-top-inner")},onMouseUpDoc(){const e=this,t=e.widget;e.mouseDownXY={},delete e.mouseMoveInitXY,!1!==e.rightKnobDown||!1!==e.bottomKnobDown?(Fancy.nojQuery&&t.addCls(Fancy.GRID_ANIMATION_CLS),e.scrollRightEl.removeCls("fancy-scroll-right-active"),e.scrollBottomEl.removeCls("fancy-scroll-bottom-active"),e.rightKnobDown=!1,e.bottomKnobDown=!1,t.doubleHorizontalScroll&&(e.scrollTopEl.removeCls("fancy-scroll-top-active"),e.scrollTopEl.removeCls("fancy-scroll-top-hover"))):t.nativeScroller&&Fancy.nojQuery&&t.addCls(Fancy.GRID_ANIMATION_CLS)},onMouseMoveDoc(t){var i,l,r,s,n=this,o=n.widget,a=!1,d=!1,c=o.knobOffSet,h=t.pageX,g=t.pageY;if(!e.isTouch||n.mouseMoveInitXY){if(e.isTouch&&!n.touchScrollDirection){if(i=n.mouseMoveInitXY.x-h,l=n.mouseMoveInitXY.y-g,!n.touchScrollDirection&&Math.abs(l)<5&&Math.abs(i)<5)return;Math.abs(l)>Math.abs(i)?n.touchScrollDirection="top":n.touchScrollDirection="left"}clearInterval(n.scrollInterval),n.spyOnSwipe?(Math.abs(n.spyOnSwipe.x-h)>1?n.spyOnSwipe.swipedX=n.spyOnSwipe.x-h:delete n.spyOnSwipe.swipedX,Math.abs(n.spyOnSwipe.y-g)>1?n.spyOnSwipe.swipedY=n.spyOnSwipe.y-g:delete n.spyOnSwipe.swipedY,n.spyOnSwipe.x=h,n.spyOnSwipe.y=g):n.spyOnSwipe={x:h,y:g},n.scrollInterval=setTimeout(()=>{if(n.rightKnobDown&&"left"!==n.touchScrollDirection&&(e.isTouch?(l=n.mouseDownXY.y-g,r=l+Math.ceil(n.rightKnobTop*n.rightScrollScale)):(l=g-n.mouseDownXY.y,r=l+n.rightKnobTop),e.isTouch?n.bodyViewHeight<r/n.rightScrollScale+n.rightKnobHeight&&(r=n.bodyFullViewHeight-n.bodyViewHeight):n.bodyViewHeight<r+n.rightKnobHeight&&(r=n.bodyViewHeight-n.rightKnobHeight),r<0&&(r=0),e.isTouch?(a=r,n.rightKnob.css("margin-top",r/n.rightScrollScale+c+"px")):(a=n.rightScrollScale*r,n.rightKnob.css("margin-top",r+c+"px")),o.doubleHorizontalScroll&&"none"!==n.scrollBottomEl.css("display")&&r<n.cornerSize&&(r=n.cornerSize),o.infinite&&o.selection&&(o.selection.updateSelection(),o.selection.clearActiveCell())),n.bottomKnobDown&&"top"!==n.touchScrollDirection&&(e.isTouch?(i=n.mouseDownXY.x-h,l=n.mouseDownXY.y-g,s=i+Math.ceil(n.bottomKnobLeft*Math.abs(n.bottomScrollScale))):(i=h-n.mouseDownXY.x,l=g-n.mouseDownXY.y,s=i+n.bottomKnobLeft),s<1&&(s=1),e.isTouch?n.bodyViewWidth-2<Math.abs(s/n.bottomScrollScale)+n.bottomKnobWidth&&(s=n.bodyFullViewWidth-n.bodyViewWidth-2):n.bodyViewWidth-2<s+n.bottomKnobWidth&&(s=n.bodyViewWidth-n.bottomKnobWidth-2),n.bottomScrollScale<0&&s<0&&(s=0,n.bottomScrollScale=0),e.isTouch?(d=-s-1,n.bottomKnob.css("margin-left",Math.abs(s/n.bottomScrollScale)+"px")):(d=Math.ceil(n.bottomScrollScale*(s-1)),n.bottomKnob.css("margin-left",s+"px")),o.doubleHorizontalScroll&&n.topKnob.css("margin-left",s+"px")),e.isTouch)switch(n.touchScrollDirection){case"top":n.scroll(a);break;case"left":n.scroll(!1,d)}else!1!==a&&!1!==d?n.scroll(a,d):!1!==a?n.scroll(a):!1!==d&&n.scroll(!1,d)},1)}else n.mouseMoveInitXY={x:h,y:g}},setScrollBars(e){const t=this,i=t.widget;i.rowheight&&void 0===e||(setTimeout(()=>{t.checkRightScroll(e)},1),t.checkBottomScroll()||t.scrollTop&&!i.infinite&&i.scroll(!1,0),i.nativeScroller||setTimeout(()=>{t.checkCorner(),t.setRightKnobSize(e),t.setBottomKnobSize()},1))},checkRightScroll(e){const i=this,l=i.widget,r=l.body,s=l.gridBorders,n=l.getBodyHeight(),o=(e||l.getCellsViewHeight())-s[0]-s[2];l.nativeScroller?n>=o?r.el.css("overflow-y","hidden"):r.el.css("overflow-y","scroll"):n>=o?i.scrollRightEl.addCls(t):i.scrollRightEl.removeCls(t)},isRightScrollable(){const e=this.widget;return e.nativeScroller?"scroll"===e.body.el.css("overflow-y"):!this.scrollRightEl.hasCls(t)},isBottomScrollable(){const e=this.widget;return e.nativeScroller?"scroll"===e.body.el.css("overflow-x"):!this.scrollBottomEl.hasCls(t)},setRightKnobSize(e){const t=this,i=t.widget;if(!i.nativeScroller){var l=i.getBodyHeight()-(t.corner?t.cornerSize:0)-2,r=(e||i.getCellsViewHeight())-(t.corner?t.cornerSize:0),s=l*((100-(r-l)/(l/100))/100),n=i.knobOffSet;s<t.minRightKnobHeight&&(s=t.minRightKnobHeight,i.doubleHorizontalScroll&&(s+=t.minRightKnobHeight)),!1===t.corner&&(l-=n),t.rightKnob.css({height:s}),t.rightKnobHeight=s,t.bodyViewHeight=l,t.bodyFullViewHeight=r,t.rightScrollScale=(r-l)/(l-s)}},checkBottomScroll(){var e,i=this,l=i.widget,r=l.body,s=l.getCenterViewWidth(),n=l.getCenterFullWidth()-2;return l.nativeScroller?s>n?(e=!1,r.el.css("overflow-x","hidden")):(e=!0,r.el.css("overflow-x","scroll")):s>n?(e=!1,i.scrollBottomEl.addCls(t),l.doubleHorizontalScroll&&i.scrollTopEl.addCls(t)):(e=!0,i.scrollBottomEl.removeCls(t),l.doubleHorizontalScroll&&i.scrollTopEl.removeCls(t)),e},checkCorner(){this.widget.nativeScroller||(this.corner=!this.scrollRightEl.hasCls(t)&&!this.scrollBottomEl.hasCls(t))},setBottomKnobSize(){const t=this,i=t.widget;if(!i.nativeScroller){var l=i.getCenterViewWidth()-(t.corner?t.cornerSize:0),r=i.getCenterFullWidth()-(t.corner?t.cornerSize:0),s=l*((100-(r-l)/(r/100))/100)-2;s<t.minBottomKnobWidth&&(s=t.minBottomKnobWidth),t.bottomKnob.css({width:s}),i.doubleHorizontalScroll&&t.topKnob.css({width:s},e.ANIMATE_DURATION),t.bottomKnobWidth=s,t.bodyViewWidth=l,t.bottomScrollScale=(l-r)/(l-s-2-1),t.bodyFullViewWidth=r}},scroll(t,i,l){var r,s=this.widget;if(i>0&&(i=0),s.nativeScroller)return null!==t&&void 0!==t&&(s.body.el.dom.scrollTop=t),null!==i&&void 0!==i&&(s.body.el.dom.scrollLeft=Math.abs(i),s.header&&s.header.scroll(i,!0)),void s.fire("scroll");l&&(s.el.addCls("fancy-grid-columns-animation"),setTimeout(()=>{s.el.removeCls("fancy-grid-columns-animation")},e.ANIMATE_DURATION+150)),s.leftBody.scroll(t),r=s.body.scroll(t,i,l),s.rightBody.scroll(t),void 0!==r.scrollTop&&(this.scrollTop=Math.abs(r.scrollTop)),void 0!==r.scrollLeft&&(this.scrollLeft=Math.abs(r.scrollLeft)),s.fire("scroll"),e.isTouch&&(s._preventTouchDown=!0)},scrollDelta(e){var t,i=this.widget;if(i.leftBody.wheelScroll(e),t=i.body.wheelScroll(e),i.rightBody.wheelScroll(e),void 0!==t)return this.scrollTop=Math.abs(t.newScroll),i.fire("scroll"),t.scrolled},scrollRightKnob(){var e=this,t=e.widget,i=(t.store,e.getScroll()/e.rightScrollScale+t.knobOffSet);e.rightKnob&&(t.doubleHorizontalScroll&&(i+=e.cornerSize),t.infinite,e.rightKnob.css("margin-top",i+"px"))},scrollBottomKnob(){var e=this,t=e.widget,i=e.getBottomScroll(),l=i/e.bottomScrollScale+t.knobOffSet;0===i&&(l=-1),e.bottomKnob&&(e.bottomKnob.css("margin-left",-l+"px"),t.doubleHorizontalScroll&&e.topKnob.css("margin-left",-l+"px"))},getScroll(){const e=this.widget,t=e.store;if(e.nativeScroller)return e.body.el.dom.scrollTop;if(e.infinite)return Math.abs(t.infiniteScrolledToRow*e.cellHeight);if(0===e.columns.length){if(e.leftColumns.length)return Math.abs(parseInt(e.leftBody.el.select("."+i).item(0).css("top")));if(e.rightColumns.length)return Math.abs(parseInt(e.rightBody.el.select("."+i).item(0).css("top")))}const l=e.body.el.select("."+i);return 0===l.length?0:Math.abs(parseInt(l.item(0).css("top")))},getBottomScroll(){const e=this.widget;if(e.nativeScroller)return e.body.el.dom.scrollLeft;if(0===e.columns.length){if(e.leftColumns.length)return Math.abs(parseInt(e.leftBody.el.select("."+i).item(0).css("left")));if(e.rightColumns.length)return Math.abs(parseInt(e.rightBody.el.select("."+i).item(0).css("left")))}const t=e.body.el.select("."+i);return 0===t.length?0:Math.abs(parseInt(t.item(0).css("left")))},update(e){this.setScrollBars(e),this.checkScroll(e),this.scrollRightKnob(),this.scrollBottomKnob()},onChangeStore(){this.update()},onColumnResize(){const e=this;e.setScrollBars(),setTimeout(()=>{e.setScrollBars()},Fancy.ANIMATE_DURATION+20)},getScrollHeight(){const e=this,t=e.widget,i=t.getBodyHeight()-(e.corner?e.cornerSize:0),l=t.getCellsViewHeight()-(e.corner?e.cornerSize:0);return i>l?i:l-i},getScrollWidth(){const e=this,t=e.widget,i=t.getCenterViewWidth()-(e.corner?e.cornerSize:0),l=t.getCenterFullWidth()-(e.corner?e.cornerSize:0);return i>l?i:l-i},checkScroll(t){var i=this,l=i.widget,r=i.getScroll(),s=l.getBodyHeight()-(i.corner?i.cornerSize:0),n=(t||l.getCellsViewHeight())-(i.corner?i.cornerSize:0),o=l.getCenterFullWidth(),a=l.getCenterViewWidth(),d=i.getScrollTop(),c=i.getScrollLeft();o<c+a?setTimeout(function(){d=i.getScrollTop(),c=i.getScrollLeft();const e=o-(c+a);c+e<0?l.scroll(d,0):l.scroll(d,c+e)},e.nojQuery?10:e.ANIMATE_DURATION):r&&n<s&&(i.scroll(0),l.nativeScroller||i.scrollRightKnob())},scrollToCell(t,i,r){if(void 0!==t){var s=this,n=s.widget,o=n.store,a=n.cellHeight,d=e.get(t),c=d.parent(),h=Number(d.attr("index")),g=Number(c.attr("index")),u=s.getScroll(),p=a*(h+1),m=n.getBodyHeight(),f=s.getBottomScroll(),C=n.getSideByCell(t),v=n.getColumnsWidth(C),y=parseInt(n.body.el.css("width")),w=0,b=c.parent().parent().hasCls(l);if(n.rowheight&&(p=n.rowheight.rowIndexesSum[h]),!n.nativeScroller||i){if(n.infinite&&(h+=o.infiniteScrolledToRow,p+=a*o.infiniteScrolledToRow),0===h&&0===g){if(0===s.scrollLeft||"row"!==n.selModel&&"rows"!==n.selModel||n.selection&&n.selection.activeCell)if(n.selection&&n.selection.activeCell){"center"!==n.selection.getActiveCellInfo().side?s.scroll(0):s.scroll(0,0)}else s.scroll(0,0);else s.scroll(0);return s.scrollBottomKnob(),void s.scrollRightKnob()}if(0!==h||0===s.scrollTop){if(n.isGroupable()&&(p+=n.grouping.getSpecialRowsAbove(h)*n.groupRowHeight),n.expander&&(p+=n.expander.getBeforeHeight(h)),r){const e=n.getCellsViewHeight();e-(u=p-a)<m&&(u-=Math.abs(e-u-m)),s.scroll(u)}else if(p-u>m){var x=5;n.nativeScroller&&(x=20),u=p-m+x,s.scroll(u)}else p-u<n.cellHeight&&((u=p-a-5)<0&&(u=0),s.scroll(u));if(b){for(var S=n.columns,I=0;I<=g;I++)S[I].hidden||(w+=S[I].width);w-f>y?S[I]?s.scroll(u,-(f+(w-f)-y)):s.scroll(u,-(v-y)):w-f<S[g].width?((f=-(w-S[g].width))>0&&(f=0),s.scroll(u,f)):0!==f&&0===g&&s.scroll(u,0),s.scrollBottomKnob()}s.scrollRightKnob()}else s.scroll(0)}}},onNativeScrollBody(){const t=this.widget,i=t.body.el.dom.scrollTop,l=t.body.el.dom.scrollLeft;t.header&&t.header.scroll(-l),t.leftBody&&(t.leftBody.el.dom.scrollTop=i),t.rightBody&&(t.rightBody.el.dom.scrollTop=i),t.leftColumns.length&&t.leftBody.el.dom.scrollTop!==t.body.el.dom.scrollTop?t.body.el.dom.scrollTop=t.leftBody.el.dom.scrollTop:t.rightColumns.length&&t.rightBody.el.dom.scrollTop!==t.body.el.dom.scrollTop&&(t.body.el.dom.scrollTop=t.rightBody.el.dom.scrollTop),Fancy.nojQuery&&(t.panel?t.panel.el.select("."+Fancy.GRID_ANIMATION_CLS).removeCls(Fancy.GRID_ANIMATION_CLS):t.el.removeCls(Fancy.GRID_ANIMATION_CLS)),t.summary&&t.summary.scrollLeft(-l),t.subHeaderFilter&&t.filter.scrollLeft(-l),t.fire("nativescroll"),e.isTouch&&(t._preventTouchDown=!0)},onNativeScrollLeftBody(){const e=this.widget;e.leftBody.el.dom.scrollTop!==e.body.el.dom.scrollTop&&this.onNativeScrollBody()},onNativeScrollRightBody(){const e=this.widget;e.rightBody.el.dom.scrollTop!==e.body.el.dom.scrollTop&&this.onNativeScrollBody()},onMouseWheelLeft(t){const i=this.widget,l=e.getWheelDelta(t.originalEvent||t)*i.cellHeight;i.leftBody.el.dom.scrollTop-=l,i.body.el.dom.scrollTop-=l,i.rightBody.el.dom.scrollTop-=l},onMouseWheelRight(t){const i=this.widget,l=e.getWheelDelta(t.originalEvent||t)*i.cellHeight;i.leftBody.el.dom.scrollTop-=l,i.body.el.dom.scrollTop-=l,i.rightBody.el.dom.scrollTop-=l},onLockColumn(){const t=this;t.update(),t.widget.setColumnsPosition(),setTimeout(()=>{t.update(),t.widget.setColumnsPosition()},e.ANIMATE_DURATION)},onColumnDrag(){const t=this;e.nojQuery&&setTimeout(()=>{t.update()},e.ANIMATE_DURATION)},onRightLockColumn(){const t=this;t.update(),t.widget.setColumnsPosition(),setTimeout(()=>{t.update(),t.widget.setColumnsPosition()},e.ANIMATE_DURATION)},onUnLockColumn(){const t=this;t.update(),t.widget.setColumnsPosition(),setTimeout(()=>{t.update(),t.widget.setColumnsPosition()},e.ANIMATE_DURATION+100)},onPanelResize(){this.widget.scroll(0,0)},onChangePages(){var e=this;!e.widget.nativeScroller&&e.scrollTop&&setTimeout(()=>{e.scrollDelta(0)},1)},onScrollBodyBugFix(){const e=this.widget,t=e.body,i=t.el.dom.scrollLeft;t.el.dom.scrollLeft=this.scrollLeft,e.scroll(this.scrollTop,-this.scrollLeft-i)},getScrollTop(){const e=this.widget;return e.nativeScroller?e.body.el.dom.scrollTop:this.scrollTop},getScrollLeft(){const e=this.widget;return e.nativeScroller?e.body.el.dom.scrollLeft:this.scrollLeft}})}(),function(){const e=Fancy;let t;const i={title:function(e,t,i,l){e.setColumnTitle(i,t,l)},width:function(e,t,i,l){e.setColumnWidth(i,t,l)},hidden:function(e,t,i,l,r){t?e.hideColumn(r):e.showColumn(r)},render:function(e,i,l,r,s){clearInterval(t),e.getColumnById(s).render=i,t=setTimeout(function(){e.update()},1)}};e.define("Fancy.grid.plugin.RefreshColumn",{extend:e.Plugin,ptype:"grid.refreshcolumns",inWidgetName:"refreshcolumns",constructor:function(){this.Super("const",arguments)},setColumns(t){const i=this.widget;this.applyChanges(t),t=i.prepareConfigColumnsWidth({columns:t,width:i.width}).columns,t=i.prepareConfigColumns({columns:t},!1).columns,this.setColumnsByOrder(t),i.filter&&(clearInterval(i.intFilterFieldsUpdate),i.intFilterFieldsUpdate=setTimeout(()=>{delete i.intFilterFieldsUpdate,i.filter.updateFields()},e.ANIMATE_DURATION))},applyChanges(t){const i={},l=[];e.each(t,e=>{e.id?i[e.id]=e:e.index?i[e.index]=e:l.push(e)}),this.setChangesByIds(i),this.setChangesWithoutIds(l),this.setChangesToNotCheckedColumns(t)},setChangesByIds(t){const l=this.widget,r=l.getColumns();e.each(r,e=>{!e.id||/col-id-/.test(e.id)||t[e.id]||l.removeColumn(e.id)});for(const e in t){const r=l.getColumnById(e),s=l.getColumnOrderById(e),n=t[e];if(r){for(const t in i)void 0!==n[t]&&r[t]!==n[t]&&i[t](l,n[t],s.order,s.side,e);n.$checked=!0,r.$checked=!0}}},setChangesWithoutIds(t){const l=this.widget,r=l.getColumns();e.each(t,t=>{if(t.render){const s=[],n=t.render.toString();if(e.each(r,e=>{e.render&&n===e.render.toString()&&s.push(e)}),1===s.length){const e=s[0],r=l.getColumnOrderById(e.id);for(const s in i)void 0!==t[s]&&e[s]!==t[s]&&i[s](l,t[s],r.order,r.side,e.id);t.$checked=!0,e.$checked=!0}}})},setChangesToNotCheckedColumns(t){var i=this.widget,l=i.getColumns(),r=[],s={},n={};for(var o in e.each(l,e=>{e.$checked||(r.push(e),s[e.type]=s[e.type]||[],s[e.type].push(e))}),e.each(t,e=>{e.$checked||(n[e.type]=n[e.type]||[],n[e.type].push(e))}),s){var a=s[o];e.each(a,t=>{var i=n[o];e.each(i,e=>{var l=!0;for(const i in e)if(e[i]!==t[i]){l=!1;break}l&&(i.$checked=!0,t.$checked=!0)})})}r=[],e.each(l,e=>{e.$checked||r.push(e)}),e.each(r,e=>{i.removeColumn(e.id)}),e.each(t,e=>{delete e.$checked}),e.each(l,e=>{delete e.$checked})},setColumnsByOrder(t){const i=[],l=[],r=[];e.each(t,e=>{e.locked?i.push(e):e.rightLocked?l.push(e):r.push(e)}),this.setColumnsByOrderInSide(r,"center"),this.setColumnsByOrderInSide(i,"left"),this.setColumnsByOrderInSide(l,"right")},setColumnsByOrderInSide(t,i){const l=this.widget,r=l.getColumns(i);e.each(t,(e,t)=>{var s=!0,n=r[t];if(void 0!==n)for(const t in e){if(void 0!==e.id&&e.id===n.id)break;switch(t){case"width":case"hidden":continue}if(e[t]!==n[t]){s=!1;break}}else s=!1;if(!s)if(n&&n.index===e.index)l.removeColumn(n.id),l.addColumn(e,i,t,!1);else if(!e.id){const r=l.getColumnByIndex(e.index);r&&l.removeColumn(r.id),l.addColumn(e,i,t,!1)}})}})}(),Fancy.define("Fancy.grid.plugin.LoadMask",{extend:Fancy.Plugin,ptype:"grid.loadmask",inWidgetName:"loadmask",cls:"fancy-loadmask",innerCls:"fancy-loadmask-inner",imageCls:"fancy-loadmask-image",textCls:"fancy-loadmask-text",constructor:function(){this.Super("const",arguments)},init(){this.Super("init",arguments),this.ons()},ons(){const e=this,t=e.widget,i=t.store;t.once("render",()=>{e.render(),i.loading&&e.onBeforeLoad(),t.on("beforeload",e.onBeforeLoad,e),t.on("load",e.onLoad,e)})},render(){var e,t,i=this,l=i.widget,r=l.el,s=Fancy.get(document.createElement("div")),n=l.lang;l.panel&&(r=l.panel.el),e=r.width(),t=r.height(),s.addCls(i.cls),"default"!==l.theme&&s.addCls(Fancy.getThemeCSSCls(l.theme)),s.css({width:e,height:t,opacity:0}),i.loadText?s.update(['<div class="'+i.innerCls+'"><div class="'+i.textCls+'">'+i.loadText+"</div></div>"].join(" ")):s.update(['<div class="'+i.innerCls+'"><div class="'+i.imageCls+'"></div><div class="'+i.textCls+'">'+n.loadingText+"</div></div>"].join(" ")),i.el=Fancy.get(r.dom.appendChild(s.dom)),i.innerEl=i.el.select("."+i.innerCls),i.textEl=i.el.select("."+i.textCls);var o=i.innerEl.width(),a=i.innerEl.height(),d=e/2-o/2;d<10&&(i.intLeft=setInterval(function(){"none"===i.el.css("display")&&clearInterval(i.intLeft),o=i.innerEl.width(),a=i.innerEl.height(),(d=e/2-o/2)<10||(i.innerEl.css({left:d}),clearInterval(i.intLeft))},100)),i.innerEl.css({left:d,top:t/2-a/2}),!0!==l.store.loading?s.css("display","none"):!1===i.showOnWaitingServer?s.css("display","none"):s.css("display","block")},onBeforeLoad(){this.showOnWaitingServer&&this.show()},onLoad(){const e=this,t=e.widget;e.showOnWaitingServer&&t.once("update",()=>e.hide())},show(e){const t=this,i=t.el,l=t.widget.lang;if(i.stop(),i.css("opacity",1),t.el.css("display","block"),t.updateSize(),e)return t.textEl.update(e),void t.el.css("display","block");t.loaded=!1,setTimeout(()=>{!0!==t.loaded&&(t.textEl.update(t.loadText||l.loadingText),t.el.css("display","block"))},50)},hide(){const e=this,t=e.el;t.stop(),t.css("opacity",1),t.animate({opacity:0,force:!0},{complete(){e.loaded=!0,t.css("display","none")}})},updateSize(){const e=this,t=e.widget,i=t.getWidth(),l=t.getHeight();e.el.css({height:l,width:i});const r=i/2-Math.abs(e.innerEl.width())/2,s=l/2-Math.abs(e.innerEl.height())/2;e.innerEl.css({left:r,top:s})}}),function(){const e=Fancy,t=e.get,i=e.FIELD_CLS,l=e.GRID_RESIZER_LEFT_CLS,r=e.GRID_RESIZER_RIGHT_CLS,s=e.GRID_HEADER_CELL_TRIGGER_CLS,n=e.GRID_HEADER_CELL_TRIGGER_IMAGE_CLS,o=e.GRID_HEADER_CELL_CLS,a=e.GRID_COLUMN_RESIZER_CLS,d=e.GRID_COLUMN_CLS,c=e.GRID_HEADER_CELL_GROUP_LEVEL_2_CLS,h=e.GRID_STATE_RESIZE_COLUMN_CLS,g=e.ANIMATE_DURATION;e.define("Fancy.grid.plugin.ColumnResizer",{extend:e.Plugin,ptype:"grid.columnresizer",inWidgetName:"columnresizer",constructor:function(){this.Super("const",arguments)},init(){const e=this,t=e.widget;e.Super("init",arguments),t.header&&t.on("render",function(){e.render(),e.ons()})},ons(){const e=this,t=e.widget;t.on("headercellmousemove",e.onCellMouseMove,e),t.on("headercellmousedown",e.onHeaderCellMouseDown,e),t.on("docclick",e.onDocClick,e),t.on("docmove",e.onDocMove,e),t.on("docmouseup",e.onDocMouseUp,e)},onCellMouseMove(e,l){var r=this,o=r.widget,a=l.e,d=t(l.cell),c=a.offsetX,h=d.width(),g=t(a.target),u=g.hasCls(s),p=g.hasCls(n),m=d.select("."+s).item(0),f=d.select("."+n).item(0),C=t(a.target).closest("."+i).hasCls(i),v=parseInt(m.css("width")),y=parseInt(f.css("width")),w=h,b=7;if(u&&(w=v),p&&(w=y),!o.startResizing)if(p)r.removeCellResizeCls(l.cell);else if("left"===l.side&&l.index===o.leftColumns.length-1&&w-c<b+2&&(b+=2),!u&&!p&&"right"===l.side&&0===l.index&&c<b)r.isColumnResizable(l)&&(C||r.addCellResizeCls(l.cell));else if(!u&&!p&&c<b&&"center"===l.side&&0===l.index&&o.leftColumns.length)l.side="left",l.index=o.leftColumns.length-1,r.isColumnResizable(l)&&(C||r.addCellResizeCls(l.cell));else if(u||p||!(w-c<b||c<b)||0===l.index)w-c<b?p?y-c>2?r.removeCellResizeCls(l.cell):r.addCellResizeCls(l.cell):r.isColumnResizable(l)&&r.addCellResizeCls(l.cell):r.removeCellResizeCls(l.cell);else{const e=c<b;r.isColumnResizable(l,e)&&(C||r.addCellResizeCls(l.cell))}},addCellResizeCls(e){const i=this.widget.columndrag;i&&"dragging"===i.status||(t(e).addCls(a),t(e).select("."+s).addCls(a))},removeCellResizeCls(e){t(e).removeClass(a),t(e).select("."+s).item(0).removeClass(a)},onHeaderCellMouseDown(l,r){l=r.e;var o=this,a=o.widget,d=t(l.target),c=t(r.cell),h=l.offsetX,g=c.width(),u=c.select("."+i),p=d.hasCls(s),m=d.hasCls(n),f=c.select("."+s).item(0),C=c.select("."+n).item(0),v=parseInt(f.css("width")),y=parseInt(C.css("width")),w=g,b=7;p&&(w=v),m?w=y:u.length>0&&u.item(0).within(d.dom)||("left"===r.side&&r.index===a.leftColumns.length-1&&w-h<b+2&&(b+=2),!p&&!m&&"right"===r.side&&0===r.index&&h<b?(a.startResizing=!0,e.apply(o,{cell:r.cell,activeSide:r.side,clientX:l.clientX,columnIndex:r.index,moveLeftResizer:!0})):h<7&&"center"===r.side&&0===r.index&&a.leftColumns.length?(a.startResizing=!0,r.side="left",r.index=a.leftColumns.length-1,e.apply(o,{cell:o.getCell(r),activeSide:r.side,clientX:l.clientX,columnIndex:r.index})):!p&&!m&&h<b&&0!==r.index?(a.startResizing=!0,e.apply(o,{cell:o.getPrevCell(r),activeSide:r.side,clientX:l.clientX,columnIndex:r.index-1})):w-h<b&&(a.startResizing=!0,e.apply(o,{cell:r.cell,activeSide:r.side,clientX:l.clientX,columnIndex:r.index})),a.startResizing&&o.isColumnResizable())},isColumnResizable(e,t){var i,l,r,s=this,n=s.widget;if(e){if(i=n.getColumns(e.side),r=e.index,t&&(l=i[--r],r>0&&i[r].hidden&&r--),isNaN(r))return;return l=i[r],!(0===r&&l.hidden&&("center"!==e.side||!n.leftColumns))&&(!l.hidden&&!0===l.resizable)}!0!==(i=n.getColumns(s.activeSide))[s.columnIndex].resizable&&(n.startResizing=!1,delete s.cell,delete s.activeSide,delete s.clientX,delete s.columnIndex)},getMinColumnWidth(){var e,t=this.widget,i=t.minCellWidth;return void 0===this.columnIndex?i:(e=t.getColumns(this.activeSide)[this.columnIndex]).minWidth?e.minWidth:i},getMaxColumnWidth(){var e,t=this.widget;return void 0!==this.columnIndex&&(!!(e=t.getColumns(this.activeSide)[this.columnIndex]).maxWidth&&e.maxWidth)},onDocClick(){this.widget.startResizing=!1},onDocMove(e,t){this.widget.startResizing&&this.moveResizeEls(t)},render(){var e=this.widget,i=t(document.createElement("div")),s=t(document.createElement("div"));i.addCls(l),s.addCls(r),this.leftEl=t(e.el.dom.appendChild(i.dom)),this.rightEl=t(e.el.dom.appendChild(s.dom))},moveResizeEls(i){var l=this,r=l.widget,s=t(l.cell),n=parseInt(s.css("left")),o=l.getMinColumnWidth(),a=l.getMaxColumnWidth();switch(r.header.hideMenu&&r.header.hideMenu(),r.el.addCls(h),e.get(document.body).addCls(h),l.activeSide){case"left":break;case"center":n+=parseInt(r.leftEl.css("width"));break;case"right":n+=parseInt(r.leftEl.css("width")),n+=parseInt(r.centerEl.css("width"))}var d=i.clientX,c=d-l.clientX,g=s.width()+c;g<o&&(g=o),a&&g>a&&(g=a),l.deltaWidth=s.width()-g,l.moveLeftResizer?(c=d-l.clientX,(g=s.width()-c)<o&&(g=o),l.deltaWidth=s.width()-g,l.leftEl.css({display:"block",left:n+c+"px"}),l.rightEl.css({display:"block",left:n+s.width()-1+"px"})):(l.leftEl.css({display:"block",left:n+"px"}),l.rightEl.css({display:"block",left:n+g+"px"})),l.cellWidth=g},onDocMouseUp(){const t=this,i=t.widget;!1!==i.startResizing&&(i.el.removeCls(h),e.get(document.body).removeCls(h),t.leftEl.css({display:"none"}),t.rightEl.css({display:"none"}),t.fixSidesWidth(),i.startResizing=!1,t.moveLeftResizer=!1,delete t.cellWidth,i.scroller.update())},fixSidesWidth(){var i,l,r,s,n=this,a=n.widget,h=n.cellWidth,u=n.columnIndex,p=n.deltaWidth,m=a.leftEl,f=a.centerEl,C=a.rightEl,v=a.leftHeader.el,y=a.header.el,w=a.rightHeader.el,b=a.body.el,x={},S={},I=n.minCenterWidth;if(void 0!==h){var T=1;switch(e.nojQuery&&(T=0),n.activeSide){case"left":if((s=parseInt(f.css("width"))+p+T)<I)return;r=a.leftColumns[u],a.leftColumns[n.columnIndex].width=h,i=a.leftBody.el.select("."+d),l=a.leftHeader.el.select("."+o),(H=i.item(u)).animate({width:h},g),H.css("overflow","");for(var E=n.columnIndex+1,L=l.length,R=0,D=E;R<D;R++){(M=(F=l.item(R)).attr("group-index"))&&(S[M]=!0)}for(;E<L;E++){var _=i.item(E),F=l.item(E);_.animate({left:parseInt(_.css("left"))-p-T},g),F.hasCls(c)&&S[F.attr("index")]||F.animate({left:parseInt(F.css("left"))-p-T},g)}m.animate({width:parseInt(m.css("width"))-p-T},g),v.animate({width:parseInt(v.css("width"))-p-T+"px"},g),a.columns.length&&(f.animate({left:parseInt(f.css("left"))-p-T,width:s},g),y.animate({width:parseInt(y.css("width"))+p+T},g),b.animate({width:parseInt(b.css("width"))+p+T},g));break;case"center":r=a.columns[u],a.columns[n.columnIndex].width=h,i=a.body.el.select("."+d),l=a.header.el.select("."+o),(H=i.item(u)).animate({width:h},g),H.css("overflow","");for(E=n.columnIndex+1,L=l.length,R=0,D=E;R<D;R++){(M=(F=l.item(R)).attr("group-index"))&&(S[M]=!0)}for(;E<L;E++){_=i.item(E),F=l.item(E);var B=parseInt(_.css("left"))-p-T,k=parseInt(F.css("left"))-p-T;F.attr("group-index")&&(x[F.attr("group-index")]={}),_.animate({left:B},g),F.hasCls(c)&&S[F.attr("index")]||F.animate({left:k},g)}break;case"right":if((s=parseInt(f.css("width"))+p+T)<I)return;var H;r=a.rightColumns[u],a.rightColumns[n.columnIndex].width=h,i=a.rightBody.el.select("."+d),l=a.rightHeader.el.select("."+o),(H=i.item(u)).animate({width:h+"px"},g),H.css("overflow","");for(E=n.columnIndex+1,L=l.length,R=0,D=E;R<D;R++){var M;(M=(F=l.item(R)).attr("group-index"))&&(S[M]=!0)}for(;E<L;E++){_=i.item(E),F=l.item(E);_.animate({left:parseInt(_.css("left"))-p-T},g),F.hasCls(c)&&S[F.attr("index")]||F.animate({left:parseInt(F.css("left"))-p-T},g)}C.animate({width:parseInt(C.css("width"))-p-T},g),w.animate({width:parseInt(w.css("width"))-p-T+"px"},g),a.columns.length&&(f.animate({width:s},g),y.animate({width:parseInt(y.css("width"))+p+T},g),b.animate({width:parseInt(b.css("width"))+p+T},g))}var O,A=t(n.cell),N=A.attr("group-index");if(A.animate({width:h+"px"},g),N)(O=a.el.select("[index='"+N+"']")).animate({width:parseInt(O.css("width"))-p-T},g);else for(var W in x)(O=a.el.select("[index='"+W+"']")).css("left",parseInt(O.css("left"))-(x[W].delta||0)-T);if(a.fire("columnresize",{cell:A.dom,width:h,column:r,side:n.activeSide}),/sparkline/.test(r.type))switch(n.activeSide){case"left":a.leftBody.updateRows(void 0,u);break;case"center":a.body.updateRows(void 0,u);break;case"right":a.rightBody.updateRows(void 0,u)}else switch(r.type){case"progressbar":case"hbar":a.update()}}},getPrevCell(t){var i,l=this.widget;switch(t.side){case"left":i=l.leftHeader;break;case"center":i=l.header;break;case"right":i=l.rightHeader}const r=i.el.select(`.${o}`).item(t.index-1).dom;return"none"===e.get(r).css("display")&&0!==t.index?(t.cell=r,t.index--,this.getPrevCell(t)):r},getCell(e){var t,i=this.widget;switch(e.side){case"left":t=i.leftHeader;break;case"center":t=i.header;break;case"right":t=i.rightHeader}return t.el.select(`.${o}`).item(e.index).dom},updateColumnsWidth:function(t){if("all"===t)return this.updateColumnsWidth("left"),this.updateColumnsWidth("right"),void this.updateColumnsWidth("center");var i=1;e.nojQuery&&(i=0);for(var l=this.widget,r=(t=t||"center",l.getHeader(t)),s=l.getBody(t),n=l.getColumns(t),o=0,a=n.length,d=0,c=l.leftEl,h=l.rightEl,u=l.leftHeader.el,p=l.rightHeader.el;o<a;o++){const e=n[o];e.hidden||(d+=e.width,this.setColumnWidth(o,e.width,t))}switch(l.header&&(r.setCellsPosition(),r.updateCellsSizes()),s.updateColumnsSizes(),t){case"center":break;case"left":var m=parseInt(c.css("width")),f=parseInt(u.css("width")),C=m-d;c.animate({width:m-C-i},g),u.animate({width:f-C-i},g),l.columns.length&&this.updateCenterSideWidth();break;case"right":var v=parseInt(c.css("width"));f=parseInt(u.css("width")),C=v-d;h.animate({width:v-C},g),p.animate({width:f-C},g),l.columns.length&&this.updateCenterSideWidth()}},updateCenterSideWidth(){var t=this.widget,i=t.centerEl,l=t.header.el,r=t.body.el,s=0,n=0,o=t.getColumns("left"),a=t.getColumns("right"),d=t.width;t.panel?(d-=t.panelBodyBorders[1],d-=t.panelBodyBorders[3],d-=t.gridBorders[1],d-=t.gridBorders[3]):(d-=t.gridWithoutPanelBorders[1],d-=t.gridWithoutPanelBorders[3]);var c=1;e.nojQuery&&(c=0),e.each(o,e=>{e.hidden||(s+=e.width)}),e.each(a,e=>{e.hidden||(n+=e.width)}),d-=s,d-=n,d+=c,i.animate({left:s-c,width:d},g),i.animate({width:d},g),l.animate({width:d},g),r.animate({width:d},g)},setColumnWidth(e,i,l="center"){var r,s,n=this.widget,o=n.getColumns(l),a=n.getBody(l),d=t(a.getDomColumn(e));(n.header&&(r=n.getHeader(l).getCell(e)),parseInt(d.css("width"))!==i)&&(n.header&&(s=r.dom),n.fire("columnresize",{cell:s,width:i,column:o[e],side:l}))},getNextVisibleIndex(e,t){for(var i=this.widget.getColumns(t),l=e+1,r=i.length;l<r;l++){if(!i[l].hidden)return l}}})}(),Fancy.define("Fancy.grid.plugin.Licence",{extend:Fancy.Plugin,ptype:"grid.licence",inWidgetName:"licence",constructor:function(){this.Super("const",arguments)},init(){this.Super("init",arguments),this.ons()},ons(){const e=this;e.widget.once("render",()=>e.render())},render(){const e=this,t=e.widget,i=t.body,l=Fancy.get(document.createElement("div"));/fancygrid/.test(location.host)&&!t.watermark||(!0!==e.checkLicence()||t.watermark)&&(l.css({position:"absolute","z-index":2,width:"30px",height:"30px"}),t.nativeScroller?l.css({top:"2px",left:"2px"}):l.css({right:"4px",bottom:"0px"}),l.update('<a href="http://www.fancygrid.com" title="JavaScript Grid - FancyGrid" style="background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAPklEQVR42mNgGLGAo+/4f1IwTN+i8y/+k4JHLR61eNTiUYuHgcUjD5AbZORG0ajFoxaPWjxq8RC2eBQMWwAAuxzh7E9tdUsAAAAASUVORK5CYII=);color: #60B3E2;font-size: 25px;line-height: 30px;text-decoration: none;background-repeat: no-repeat;">&nbsp;&nbsp;&nbsp;&nbsp;</a>'),Fancy.get(i.el.append(l.dom)),e.licenceEl=l,t.watermark&&e.configWatermark(),e.showConsoleText())},showConsoleText(){window.console&&console.log&&Fancy.isChrome&&(console.log("%cFancy%cGrid%c %cTrial%c Version!","color:#A2CFE8;font-size: 14px;font-weight: bold;","color:#088EC7;font-size: 14px;font-weight: bold;","font-weight:bold;color: #515151;font-size: 12px;","color: red;font-weight: bold;font-size: 14px;","font-weight:bold;color: #515151;font-size: 12px;"),console.log("%cPurchase license for legal usage!\nSales email: sales@fancygrid.com","font-weight:bold;color: #515151;font-size: 12px;"))},configWatermark(){const e=this,t=e.widget.watermark;if(t.text){const i=e.licenceEl.firstChild();i.css("background-image","none"),i.css("font-size","11px"),i.update(t.text),e.licenceEl.css("width","initial")}t.style&&e.licenceEl.css(t.style)},checkLicence(){var e=this,t="FancyGrid";if(!Fancy.LICENSE&&!FancyGrid.LICENSE)return!1;var i,l,r=String(e.md5(location.host.replace(/^www\./,""),t)),s=Fancy.LICENSE||FancyGrid.LICENSE||[],n=e.md5("UNIVERSAL",t),o=e.md5("SAAS",t),a=e.md5("INTERNAL",t),d=e.md5("OEM",t),c=e.md5("ENTERPRISE",t);for(i=0,l=s.length;i<l;i++)switch(String(s[i])){case r:case n:case o:case a:case d:case c:return!0}return!1},md5(e,t,i){var l=function(e,t){var i=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(i>>16)<<16|65535&i},r=function(e,t,i,r,s,n){return l((o=l(l(t,e),l(r,n)))<<(a=s)|o>>>32-a,i);var o,a},s=function(e,t,i,l,s,n,o){return r(t&i|~t&l,e,t,s,n,o)},n=function(e,t,i,l,s,n,o){return r(t&l|i&~l,e,t,s,n,o)},o=function(e,t,i,l,s,n,o){return r(t^i^l,e,t,s,n,o)},a=function(e,t,i,l,s,n,o){return r(i^(t|~l),e,t,s,n,o)},d=function(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;var i,r,d,c,h,g=1732584193,u=-271733879,p=-1732584194,m=271733878;for(i=0;i<e.length;i+=16)r=g,d=u,c=p,h=m,g=s(g,u,p,m,e[i],7,-680876936),m=s(m,g,u,p,e[i+1],12,-389564586),p=s(p,m,g,u,e[i+2],17,606105819),u=s(u,p,m,g,e[i+3],22,-1044525330),g=s(g,u,p,m,e[i+4],7,-176418897),m=s(m,g,u,p,e[i+5],12,1200080426),p=s(p,m,g,u,e[i+6],17,-1473231341),u=s(u,p,m,g,e[i+7],22,-45705983),g=s(g,u,p,m,e[i+8],7,1770035416),m=s(m,g,u,p,e[i+9],12,-1958414417),p=s(p,m,g,u,e[i+10],17,-42063),u=s(u,p,m,g,e[i+11],22,-1990404162),g=s(g,u,p,m,e[i+12],7,1804603682),m=s(m,g,u,p,e[i+13],12,-40341101),p=s(p,m,g,u,e[i+14],17,-1502002290),u=s(u,p,m,g,e[i+15],22,1236535329),g=n(g,u,p,m,e[i+1],5,-165796510),m=n(m,g,u,p,e[i+6],9,-1069501632),p=n(p,m,g,u,e[i+11],14,643717713),u=n(u,p,m,g,e[i],20,-373897302),g=n(g,u,p,m,e[i+5],5,-701558691),m=n(m,g,u,p,e[i+10],9,38016083),p=n(p,m,g,u,e[i+15],14,-660478335),u=n(u,p,m,g,e[i+4],20,-405537848),g=n(g,u,p,m,e[i+9],5,568446438),m=n(m,g,u,p,e[i+14],9,-1019803690),p=n(p,m,g,u,e[i+3],14,-187363961),u=n(u,p,m,g,e[i+8],20,1163531501),g=n(g,u,p,m,e[i+13],5,-1444681467),m=n(m,g,u,p,e[i+2],9,-51403784),p=n(p,m,g,u,e[i+7],14,1735328473),u=n(u,p,m,g,e[i+12],20,-1926607734),g=o(g,u,p,m,e[i+5],4,-378558),m=o(m,g,u,p,e[i+8],11,-2022574463),p=o(p,m,g,u,e[i+11],16,1839030562),u=o(u,p,m,g,e[i+14],23,-35309556),g=o(g,u,p,m,e[i+1],4,-1530992060),m=o(m,g,u,p,e[i+4],11,1272893353),p=o(p,m,g,u,e[i+7],16,-155497632),u=o(u,p,m,g,e[i+10],23,-1094730640),g=o(g,u,p,m,e[i+13],4,681279174),m=o(m,g,u,p,e[i],11,-358537222),p=o(p,m,g,u,e[i+3],16,-722521979),u=o(u,p,m,g,e[i+6],23,76029189),g=o(g,u,p,m,e[i+9],4,-640364487),m=o(m,g,u,p,e[i+12],11,-421815835),p=o(p,m,g,u,e[i+15],16,530742520),u=o(u,p,m,g,e[i+2],23,-995338651),g=a(g,u,p,m,e[i],6,-198630844),m=a(m,g,u,p,e[i+7],10,1126891415),p=a(p,m,g,u,e[i+14],15,-1416354905),u=a(u,p,m,g,e[i+5],21,-57434055),g=a(g,u,p,m,e[i+12],6,1700485571),m=a(m,g,u,p,e[i+3],10,-1894986606),p=a(p,m,g,u,e[i+10],15,-1051523),u=a(u,p,m,g,e[i+1],21,-2054922799),g=a(g,u,p,m,e[i+8],6,1873313359),m=a(m,g,u,p,e[i+15],10,-30611744),p=a(p,m,g,u,e[i+6],15,-1560198380),u=a(u,p,m,g,e[i+13],21,1309151649),g=a(g,u,p,m,e[i+4],6,-145523070),m=a(m,g,u,p,e[i+11],10,-1120210379),p=a(p,m,g,u,e[i+2],15,718787259),u=a(u,p,m,g,e[i+9],21,-343485551),g=l(g,r),u=l(u,d),p=l(p,c),m=l(m,h);return[g,u,p,m]},c=function(e){var t,i="";for(t=0;t<32*e.length;t+=8)i+=String.fromCharCode(e[t>>5]>>>t%32&255);return i},h=function(e){var t,i=[];for(i[(e.length>>2)-1]=void 0,t=0;t<i.length;t+=1)i[t]=0;for(t=0;t<8*e.length;t+=8)i[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return i},g=function(e){var t,i,l="";for(i=0;i<e.length;i+=1)t=e.charCodeAt(i),l+="0123456789abcdef".charAt(t>>>4&15)+"0123456789abcdef".charAt(15&t);return l},u=function(e){return unescape(encodeURIComponent(e))},p=function(e){return function(e){return c(d(h(e),8*e.length))}(u(e))},m=function(e,t){return function(e,t){var i,l,r=h(e),s=[],n=[];for(s[15]=n[15]=void 0,r.length>16&&(r=d(r,8*e.length)),i=0;i<16;i+=1)s[i]=909522486^r[i],n[i]=1549556828^r[i];return l=d(s.concat(h(t)),512+8*t.length),c(d(n.concat(l),640))}(u(e),u(t))};return function(e,t,i){return t?i?m(t,e):g(m(t,e)):i?p(e):g(p(e))}(e,t,i)}}),function(){const e=Fancy,t=e.GRID_CELL_CLS,i=e.GRID_CELL_EVEN_CLS,l=e.GRID_CELL_SELECTED_CLS,r=e.GRID_COLUMN_CLS,s=e.GRID_COLUMN_TEXT_CLS,n=e.GRID_COLUMN_ELLIPSIS_CLS,o=e.GRID_COLUMN_ORDER_CLS,a=e.GRID_COLUMN_SELECT_CLS,d=e.GRID_COLUMN_TREE_CLS,c=e.GRID_CELL_INNER_CLS,h=e.GRID_CELL_DIRTY_CLS,g=e.GRID_CELL_DIRTY_EL_CLS,u=e.GRID_PSEUDO_CELL_CLS,p=e.GRID_EMPTY_CLS,m=e.GRID_COLUMN_SPARKLINE_CLS,f=e.GRID_COLUMN_SPARKLINE_BULLET_CLS,C=e.GRID_COLUMN_CHART_CIRCLE_CLS,v=e.GRID_COLUMN_SPARK_PROGRESS_DONUT_CLS,y=e.GRID_COLUMN_GROSSLOSS_CLS,w=e.GRID_COLUMN_PROGRESS_CLS,b=e.GRID_COLUMN_PROGRESS_BAR_CLS,x=e.GRID_COLUMN_H_BAR_CLS,S=e.GRID_COLUMN_ROW_DRAG_CLS,I=e.GRID_ROW_DRAG_EL_CLS;e.ns("Fancy.grid.body.mixin"),e.grid.body.mixin.Updater=function(){},e.grid.body.mixin.Updater.prototype={update(e){let t,i=this,l=i.widget,r=l.store;switch(e){case"cell":case"cells":break;case"waitstate":return void i.checkDomColumns();default:i.checkDomColumns()}if(!r.loading){switch(e){case"row":case"rows":for(var s in t=r.changed){var n=t[s],o=l.getRowById(s);for(var a in n)switch(a){case"length":break;default:i.updateRows(o)}}break;case"cell":case"cells":for(var s in t=r.changed){n=t[s],o=l.getRowById(s);for(var a in n)switch(a){case"length":break;default:var d=l.getColumnOrderByKey(a);i.updateRows(o,d.order)}}break;default:i.checkDomCells(),i.updateRows()}i.showEmptyText()}},checkDomColumns(){var t=this,i=t.widget,l=t.el.select("."+r).length,c=t.getColumns(),h=0,g=c.length;if(!(g<=l)){for(;h<g;h++){const l=c[h],g=l.width,u=e.get(document.createElement("div"));if(l.hidden&&u.css("display","none"),u.addCls(r),u.attr("grid",i.id),u.attr("role","presentation"),"$selected"===l.index||l.select)u.addCls(a);else switch(l.type){case"order":u.addCls(o);break;case"rowdrag":u.addCls(S)}if("tree"===l.type&&(u.addCls(d),l.folder&&u.addCls("fancy-grid-tree-column-folder")),l.rowdrag&&u.addCls(S),l.cls&&u.addCls(l.cls),"text"===l.type&&u.addCls(s),u.css({width:g+"px"}),u.attr("index",h),l.cellAlign&&u.css("text-align",l.cellAlign),!0===l.ellipsis)switch(l.type){case"string":case"text":case"number":case"currency":case"date":case"combo":case"tree":u.addCls(n)}t.el.dom.appendChild(u.dom)}t.fire("adddomcolumns")}},checkDomCells(s){var n,o,a=this,d=a.widget,c=d.body,h=d.store,g=0,p=h.dataView.length,m=0;switch(h.infinite&&(p=h.infiniteDisplayedRows)>h.dataView.length&&(p=h.dataView.length),a.side){case"left":o=d.leftColumns;break;case"center":o=d.columns;break;case"right":o=d.rightColumns}n=o.length;var f=a.el.select("."+r),C=h.getLength(),v=a.cellTpl;for(d.cellWrapper&&(v=a.cellWrapperTpl),void 0!==s&&(m=s,n=s);m<n;m++){var y=f.item(m);for(g=p-(C-y.select("."+t).length);g<p;g++){var w=v.getHTML({});(b=e.get(document.createElement("div"))).attr("role","gridcell"),b.css({height:d.cellHeight+"px"}),b.addCls(t),b.attr("index",g),g%2!=0&&d.striped&&b.addCls(i),b.update(w),y.dom.appendChild(b.dom),c.el.select("."+t+"."+l+'[index="'+g+'"]').length&&b.addCls(l)}if(d.nativeScroller&&("left"===a.side||"right"===a.side)){y.select(`.${u}`).destroy();var b;w=v.getHTML({cellValue:"&nbsp;"});(b=e.get(document.createElement("div"))).attr("role","gridcell"),b.css({height:d.cellHeight+"px"}),b.addCls(u),b.update(w),y.dom.appendChild(b.dom)}}},updateRows(e,t){var i,l,r=this,s=r.widget,n=0;switch(void 0===e?r.clearDirty():r.clearDirty(e),r.side){case"left":i=s.leftColumns;break;case"center":i=s.columns;break;case"right":i=s.rightColumns}if(l=i.length,!(void 0!==t&&(n=t,(l=t+1)>i.length))){for(;n<l;n++){const t=i[n];switch(t.type){case"string":case"number":case"combo":case"action":case"text":case"date":case"currency":r.renderUniversal(n,e);break;case"tree":r.renderTree(n,e);break;case"order":r.renderOrder(n,e);break;case"expand":r.renderExpand(n,e);break;case"select":r.renderSelect(n,e);break;case"color":r.renderColor(n,e);break;case"checkbox":r.renderCheckbox(n,e);break;case"switcher":r.renderCheckbox(n,e,!0);break;case"image":r.renderImage(n,e);break;case"sparklineline":r.renderSparkLine(n,e,"line");break;case"sparklinebar":r.renderSparkLine(n,e,"bar");break;case"sparklinetristate":r.renderSparkLine(n,e,"tristate");break;case"sparklinediscrete":r.renderSparkLine(n,e,"discrete");break;case"sparklinebullet":r.renderSparkLine(n,e,"bullet");break;case"sparklinepie":r.renderSparkLine(n,e,"pie");break;case"sparklinebox":r.renderSparkLine(n,e,"box");break;case"circle":r.renderCircle(n,e);break;case"progressdonut":r.renderProgressDonut(n,e);break;case"progressbar":r.renderProgressBar(n,e);break;case"hbar":r.renderHBar(n,e);break;case"grossloss":r.renderGrossLoss(n,e);break;case"rowdrag":r.renderRowDrag(n,e);break;default:throw new Error("[FancyGrid error] - not existed column type "+t.type)}t.select&&r.renderSelect(n,e,!0),t.rowdrag&&r.renderRowDrag(n,e,!0)}r.removeNotUsedCells()}},renderUniversal(e,i){var l,s,n,o=this,a=o.widget,d=a.lang,h=a.emptyValue,g=a.store,u=o.getColumns()[e],p=o.el.select(`.${r}`).item(e),m=p.select(`.${t}`),f=p.select(`.${t} .${c}`),C=u.currency||d.currencySign,v=!1;u.select&&(v=!0),u.rowdrag&&(v=!0),l=void 0!==u.index?u.index:"action"===u.type?"none":void 0,void 0!==i?(s=i,n=i+1):(s=0,n=g.getLength());var y=0;if(a.infinite){y=g.infiniteScrolledToRow;const e=a.getNumOfVisibleCells();n>e&&(n=e)}for(;s<n;s++){if(a.infinite){var w=g.dataView[s+y],b=m.item(s);if(void 0===w){a.el.select("."+t+'[index="'+s+'"]').css("visibility","hidden");break}if("hidden"===b.css("visibility")){a.el.select("."+t+'[index="'+s+'"]').css("visibility","");break}}var x,S=g.get(s+y),I=g.getId(s+y),T=f.item(s),E=(b=m.item(s),{rowIndex:s,data:S,style:{},column:u,id:I,item:g.getItem(s+y),inner:T,cell:b}),L=!1;switch(g.changed[E.id]&&g.changed[E.id][u.index]&&(L=!0),x=u.smartIndexFn?u.smartIndexFn(S):void 0===l?"":g.get(s+y,l),E.value=x,u.format&&(E.value=o.format(E.value,u.format,u.precision),x=E.value),u.type){case"currency":""!==x&&(x=C+x),E.value=x}switch(u.render&&(x=(E=u.render(E)).value),x){case"":case null:case void 0:x=h}if(a.cellStylingCls&&o.clearCls(b),E.cls&&b.addCls(E.cls),L&&a.dirtyEnabled&&o.enableCellDirty(b),b.css(E.style),v){const e=[];u.rowdrag&&e.push('<div class="fancy-grid-cell-inner-rowdrag"></div>'),u.select?e.push('<div class="fancy-grid-cell-inner-select"></div>'):u.rowdrag&&e.push('<div class="fancy-grid-cell-inner-rowdrag-fix"></div>');const t=T.select(".fancy-grid-cell-inner-text");t.length?t.update(x):(e.push('<span class="fancy-grid-cell-inner-text">'+x+"</span>"),T.update(e.join(" ")))}else E.column.widget||T.update(x);if(E.column.autoHeight){b.css("height","");let e=parseInt(b.css("height"))+4;a.rowheight.waitToShow(),e<a.cellHeight&&(e=a.cellHeight),a.rowheight.add(I,e,E.rowIndex)}}},renderOrder(e){var i=this.widget,l=i.store,s=this.getColumns()[e],n=this.el.select(`.${r}`).item(e),o=n.select(`.${t}`),a=n.select(`.${t} .${c}`),d=0,h=l.getLength(),g=0;if(i.paging&&(g+=l.showPage*l.pageSize),i.infinite){const e=i.getNumOfVisibleCells();h>e&&(h=e),g=l.infiniteScrolledToRow}for(;d<h;d++){var u=l.get(d),p=l.getId(d),m={rowIndex:d,data:u,style:{},column:s,id:p,item:l.getItem(d)},f=d+1+g;i.grouping&&(f+=i.grouping.getCollapsedRowsBefore(p)),m.value=f,s.render&&(f=(m=s.render(m)).value);const e=o.item(d);i.cellStylingCls&&this.clearCls(e),m.cls&&e.addCls(m.cls),e.css(m.style),a.item(d).update(f)}i.grouping&&delete i.grouping.collapsedRowsBefore},renderRowDrag(e,i,l){var s=this.widget,n=s.store,o=this.getColumns()[e],a=this.el.select(`.${r}`).item(e),d=a.select(`.${t}`),h=a.select(`.${t} .${c}`),g=0,u=n.getLength();if(s.infinite){const e=s.getNumOfVisibleCells();u>e&&(u=e)}for(;g<u;g++){const e={rowIndex:g,data:n.get(g),style:{},column:o,id:n.getId(g),item:n.getItem(g)},t='<svg class="'+I+'" style="opacity: 0;" viewBox="0 0 6 14"><path fill-rule="evenodd" clip-rule="evenodd" d="M0 2h2V0H0v2zm0 4h2V4H0v2zm0 3.999h2V8H0v1.999zM0 14h2v-2H0v2zM4 0v2h2V0H4zm0 6h2V4H4v2zm0 3.999h2V8H4v1.999zM4 14h2v-2H4v2z"></path></svg>';e.value=t;const i=d.item(g);if(s.cellStylingCls&&this.clearCls(i),e.cls&&i.addCls(e.cls),i.css(e.style),l){h.item(g).select(".fancy-grid-cell-inner-rowdrag").item(0).update(t)}else h.item(g).update(t)}},renderTree(e,i){var l,s,n=this.widget,o=n.store,a=this.getColumns()[e],d=this.el.select(`.${r}`).item(e).select(`.${t} .${c}`),h=a.index;if(void 0!==i?(l=i,s=i+1):(l=0,s=o.getLength()),n.infinite){const e=n.getNumOfVisibleCells();s>e&&(s=e)}for(;l<s;l++){var g=d.item(l),u=n.get(l),p=u.get(h),m=Number(u.get("$deep"))-1,f="fancy-grid-tree-expander";u.get("leaf")&&(f="fancy-grid-tree-expander-leaf"),u.get("expanded")&&(f+=" fancy-grid-tree-expander-expanded");let e=15*m,t="";if(a.render){const e=a.render({item:u,data:u.data,deep:m,leaf:u.get("leaf"),rowIndex:i,column:a,value:p});e.nodeImgCls&&(t='<span class="fancy-grid-tree-expander-node '+e.nodeImgCls+'"></span>'),void 0!==e.value&&(p=e.value)}if(a.folder){const e=u.get("leaf"),i=u.get("expanded");t=e?'<span class="fancy-grid-tree-folder-file"></span>':i?'<span class="fancy-grid-tree-folder-opened"></span>':'<span class="fancy-grid-tree-folder-closed"></span>'}u.get("leaf")&&(e-=8);const r=[];r.push('<span class="'+f+'" style="margin-left: '+e+'px;"></span>'),a.select&&r.push('<span class="fancy-grid-cell-inner-select" style="margin-left: 6px;"></span>'),r.push(t),r.push('<span class="fancy-grid-tree-expander-text">'+p+"</span>"),g.update(r.join(""))}},renderExpand(i,l){var s,n,o=this.widget,a=o.store,d=this.getColumns()[i],h=this.el.select(`.${r}`).item(i).select(`.${t} .${c}`);if(void 0!==l?(s=l,n=l+1):(s=0,n=a.getLength()),o.infinite){const e=o.getNumOfVisibleCells();n>e&&(n=e)}for(;s<n;s++){var g,u=h.item(s).select(".fancy-field-checkbox"),p=0!==u.length,m=o.get(s).id;!1===p?(h.item(s).update(""),u=new e.CheckBox({renderTo:h.item(s).dom,renderId:!0,value:!1,label:!1,expander:!0,style:{padding:"0px",display:"inline-block"},events:[{change:function(e,t){l=e.el.parent().parent().attr("index"),t?o.expander.expand(l):o.expander.collapse(l)}}]})):(g=u.dom.id,u=e.getWidget(g),o.expander._expandedIds[m]?u.set(!0,!1):u.set(!1,!1));const t={rowIndex:s,data:a.get(s),style:{},column:d,id:a.getId(s),item:a.getItem(s)};d.render&&(!0===d.render(t).hidden?u.hide():u.show())}},clearCls(t){const i=this.widget;e.each(i.cellStylingCls,e=>{t.removeCls(e)})},renderColor(e,i){var l,s,n=this.widget,o=n.store,a=this.getColumns()[e],d=a.index,h=this.el.select("."+r).item(e).select("."+t);if(void 0!==i?(l=i,s=i+1):(l=0,s=o.getLength()),n.infinite){const e=n.getNumOfVisibleCells();s>e&&(s=e)}for(;l<s;l++){var g,u=o.get(l),p={rowIndex:l,data:u,style:{},column:a};g=a.smartIndexFn?a.smartIndexFn(u):o.get(l,d),a.render&&(g=(p=a.render(p)).value),p.value=g;const e=h.item(l);e.css(p.style),e.select(`.${c}`).update('<div class="fancy-grid-color-cell" style="background: '+g+';"></div>')}},renderCombo(e,i){var l,s,n=this.widget.store,o=this.getColumns()[e],a=o.index,d=this.el.select(`.${r}`).item(e),h=d.select(`.${t}`),g=d.select(`.${t} .${c}`);for(void 0!==i?(l=i,s=i+1):(l=0,s=n.getLength());l<s;l++){var u=n.get(l,a),p={rowIndex:l,value:u,style:{}};o.render&&(u=(p=o.render(p)).value),h.item(l).css(p.style),g.item(l).update(u)}},renderCheckbox(i,l,s){var n,o,a=this,d=a.widget,h=d.store,g=a.getColumns()[i],u=g.index,p=a.el.select(`.${r}`).item(i),m=p.select(`.${t}`),f=p.select(`.${t} .${c}`),C="CheckBox";if(s&&(C="Switcher"),void 0!==l?(n=l,o=l+1):(n=0,o=h.getLength()),d.infinite){const e=d.getNumOfVisibleCells();o>e&&(o=e)}for(;n<o;n++){var v,y=h.get(n),w=h.get(n,u),b=f.item(n),x=m.item(n),S=s?b.select(".fancy-field-switcher"):b.select(".fancy-field-checkbox"),I=0!==S.length,T=!1,E=h.getId(n),L={rowIndex:n,data:y,style:{},column:g,id:E,item:h.getItem(n),value:w};if(h.changed[L.id]&&h.changed[L.id][g.index]&&(T=!0),g.render&&(w=(L=g.render(L)).value),!1===I)if(L.stopped)f.item(n).update(w);else{let t=!0;d.rowEdit&&(t=!1),f.item(n).update(""),new e[C]({renderTo:f.item(n).dom,renderId:!0,value:w,label:!1,editable:t,style:{padding:"0px",display:"inline-block"},events:[{beforechange(e){"$selected"===g.index||g.select||!0!==g.editable&&(e.canceledChange=!0)}},{change(e,t){"$selected"===g.index||g.select||(d.celledit.checkBoxChangedValue=t)}}]})}else v=S.dom.id,S=e.getWidget(v),L.stopped?(S.destroy(),f.item(n).update(w)):S.set(w,!1);d.cellStylingCls&&a.clearCls(x),L.cls&&x.addCls(L.cls),x.css(L.style),T&&d.dirtyEnabled&&(x=m.item(n),a.enableCellDirty(x))}},renderSelect(i,s,n){let o;var a,d,h=this.widget,g=h.store,u=this.getColumns()[i],p=this.el.select(`.${r}`).item(i).select(`.${t} .${c}`);if(void 0!==s?(a=s,d=s+1):(a=0,d=g.getLength()),h.infinite){const e=h.getNumOfVisibleCells();d>e&&(d=e)}for(;a<d;a++){var m,f,C=!1,v=g.get(a,"id"),y=p.item(a),w=0!==(o=y.select(".fancy-field-checkbox")).length,b=!0;if(h.selection.memory){if(h.selection.memory.all&&!h.selection.memory.excepted[v]?(C=!0,h.selection.domSelectRow(a)):h.selection.memory.has(v)?(C=!0,h.selection.domSelectRow(a)):(C=!1,h.selection.domDeSelectRow(a)),g.isTree){var x=(m=g.getItem(a)).get("$selected");if(x){const t=function(i){e.each(i,function(e){e.fields&&(!1!==e.get("$selected")?(m.set("$selected",void 0),e.set("$selected",!0),h.selection.memory.add(e.id),e.data.child&&e.data.child[0]&&e.data.child[0].fields&&t(e.data.child)):h.selection.memory.remove(e.id))})};t(m.data.child)}}}else y.parent().hasClass(l)&&(C=!0);if("select"===u.type||u.select)if(h.selection.disabled&&(b=!1),!1===w){let t=p.item(a);n?(t=t.select(".fancy-grid-cell-inner-select").item(0).dom,Fancy.isBoolean(C)||(C=!1)):(p.item(a).update(""),t=t.dom);const i={renderTo:t,renderId:!0,value:C,label:!1,stopIfCTRL:!0,editable:b,disabled:!b,style:{padding:"0px",display:"inline-block"},events:[{beforechange:function(e){h.selection.stopOneTick&&(e.canceledChange=!0)}}]};if(o=new e.CheckBox(i),g.isTree&&h.selection.memory&&h.selection.memory.tree.selected[v]&&!h.selection.memory.tree.allSelected[v]&&m){const e=m.get("child");e&&e.length&&o.setMiddle(!0)}}else f=o.dom.id,(o=e.getWidget(f)).set(C,!1)}},renderImage(e,i){var l,s,n=this.widget,o=n.store,a=this.getColumns()[e],d=a.index,h=this.el.select(`.${r}`).item(e),g=h.select(`.${t}`),u=h.select(`.${t} .${c}`);if(void 0!==i?(l=i,s=i+1):(l=0,s=o.getLength()),n.infinite){const e=n.getNumOfVisibleCells();s>e&&(s=e)}for(;l<s;l++){var p=o.get(l,d),m={rowIndex:l,value:p,data:o.get(l),style:{}},f="";if(a.render&&(p=(m=a.render(m)).value),m.attr)for(var C in m.attr)f+=C+'="'+m.attr[C]+'"';p="<img "+f+' src="'+m.value+'">',g.item(l).css(m.style),u.item(l).update(p)}},renderSparkLine(i,l,s){var n,o,a=this.widget,d=a.cellHeight,h=a.store,g=this.getColumns()[i],u=g.width,p=g.index,C=this.el.select(`.${r}`).item(i),v=C.select(`.${t}`),y=C.select(`.${t} .${c}`),w=g.sparkConfig||{};C.addCls(m),void 0!==l?(n=l,o=l+1):(n=0,o=h.getLength());var b,x=d-1,S=u-20;switch(s){case"line":case"pie":case"box":b="width";break;case"bullet":b="width",x-=11,C.addCls(f);break;case"discrete":b="width",S=u,x-=2;break;case"bar":case"tristate":b="barWidth"}if(a.infinite){const e=a.getNumOfVisibleCells();o>e&&(o=e)}for(;n<o;n++){var I=h.get(n,p),T={rowIndex:n,value:I,data:h.get(n),style:{}};if(g.render&&(I=(T=g.render(T)).value),e.isArray(g.values)){var E=0,L=g.values.length;for(I=[];E<L;E++)I.push(h.get(n,g.values[E]))}v.item(n).css(T.style);const t=y.item(n).dom,i={type:s,fillColor:"transparent",height:x};e.apply(i,w),"bar"!==s&&"tristate"!==s||(S=u-20,S/=I.length),i[b]=S,e.$(t).sparkline(I,i)}},renderProgressDonut(i,l){var s,n,o=this.widget,a=o.store,d=this.getColumns()[i],h=d.index,g=this.el.select(`.${r}`).item(i),u=g.select(`.${t}`),p=g.select(`.${t} .${c}`);if(g.addCls(v),void 0!==l?(s=l,n=l+1):(s=0,n=a.getLength()),o.infinite){const e=o.getNumOfVisibleCells();n>e&&(n=e)}for(;s<n;s++){var m,f=a.get(s),C={rowIndex:s,data:f,style:{},column:d};m=d.smartIndexFn?d.smartIndexFn(f):a.get(s,h),C.value=m,d.format&&(C.value=this.format(C.value,d.format),m=C.value),d.render&&(m=(C=d.render(C)).value),u.item(s).css(C.style);const t=d.sparkConfig||{},i=p.item(s).dom;e.apply(t,{renderTo:i,value:m}),t.size||t.height||t.width||(t.size=o.cellHeaderHeight-6),e.get(i).update(""),new e.spark.ProgressDonut(t)}},renderGrossLoss(i,l){var s,n,o=this.widget,a=o.store,d=this.getColumns()[i],h=d.index,g=this.el.select(`.${r}`).item(i),u=g.select(`.${t}`),p=g.select(`.${t} .${c}`);g.addCls(y),void 0!==l?(s=l,n=l+1):(s=0,n=a.getLength());const m=d.sparkConfig||{};if(m.showOnMax&&(m.maxValue=Math.max.apply(Math,a.getColumnData(h,d.smartIndexFn))),o.infinite){const e=o.getNumOfVisibleCells();n>e&&(n=e)}for(;s<n;s++){var f,C=a.get(s),v={rowIndex:s,data:C,style:{},column:d};f=d.smartIndexFn?d.smartIndexFn(C):a.get(s,h),v.value=f,d.format&&(v.value=this.format(v.value,d.format),f=v.value),d.render&&(f=(v=d.render(v)).value),u.item(s).css(v.style),e.apply(m,{renderTo:p.item(s).dom,value:f,column:d}),new e.spark.GrossLoss(m)}},renderProgressBar(i,l){var s,n,o=this,a=o.widget,d=a.store,h=o.getColumns()[i],g=h.index,u=o.el.select(`.${r}`).item(i),p=u.select(`.${t}`),m=u.select(`.${t} .${c}`),f=100;u.addCls(w),void 0!==l?(s=l,n=l+1):(s=0,n=d.getLength());const C=h.sparkConfig||{};if(!1===C.percents&&(f=Math.max.apply(Math,d.getColumnData(g))),a.infinite){const e=a.getNumOfVisibleCells();n>e&&(n=e)}for(;s<n;s++){var v,y=d.get(s),x={rowIndex:s,data:y,style:{},column:h},S=p.item(s);v=h.smartIndexFn?h.smartIndexFn(y):d.get(s,g),x.value=v,h.format&&(x.value=o.format(x.value,h.format),v=x.value),h.render&&(v=(x=h.render(x)).value),S.css(x.style),a.cellStylingCls&&o.clearCls(S),x.cls&&S.addCls(x.cls);const t=e.get(m.item(s).dom);if(t.select("."+b).length){const i=e.getWidget(t.select(`.${b}`).item(0).attr("id"));i.value=v,i.maxValue=f,i.update()}else e.apply(C,{renderTo:m.item(s).dom,value:v,column:h,maxValue:f}),new e.spark.ProgressBar(C)}},renderHBar(i,l){let s,n;var o,a,d=this.widget,h=d.store,g=this.getColumns()[i],u=g.index,p=this.el.select(`.${r}`).item(i),m=p.select(`.${t}`),f=p.select(`.${t} .${c}`),C=g.sparkConfig||{},v=g.disabled||{};p.addCls(x);var y,w,b={},S=(i=0,Number.MIN_VALUE);if(e.isArray(g.index))for(y=g.index.length;i<y;i++){const e=g.index[i];v[e]||(b[e]=h.getColumnData(e),(n=Math.max.apply(Math,b[e]))>S&&(S=n),w=b[e].length)}else{let e=[];for(y=(s=h.getColumnData(g.index)).length;i<y;i++){let e=0,t=s[i].length;for(;e<t;e++)v[e]||(b[e]=b[e]||[],b[e].push(s[i][e]))}for(var I in b)n=Math.max.apply(Math,b[I]),e.push(I),n>S&&(S=n),w=b[I].length;g.fields||(g.fields=e)}for(var T=[],E=0;E<w;E++)for(var I in T[E]=0,b)g.fields&&v[g.index+"."+I]||v[I]||(T[E]+=b[I][E]);const L=Math.max.apply(Math,T);if(C.maxItemValue=S,void 0!==l?(o=l,a=l+1):(o=0,a=h.getLength()),d.infinite){const e=d.getNumOfVisibleCells();a>e&&(a=e)}for(;o<a;o++){var R,D={rowIndex:o,data:s=h.get(o),style:{},column:g};R=g.smartIndexFn?g.smartIndexFn(s):h.get(o,u),D.value=R,g.format&&(D.value=this.format(D.value,g.format),R=D.value),g.render&&(R=(D=g.render(D)).value),m.item(o).css(D.style);const t=e.get(f.item(o).dom);if(t.select(".fancy-spark-hbar").length){const i=e.getWidget(t.select(".fancy-spark-hbar").item(0).attr("id"));i.maxValue=L,i.maxItemValue=S,i.update(s)}else e.apply(C,{renderTo:f.item(o).dom,value:R,data:s,column:g,maxValue:L,height:d.cellHeight-1}),new e.spark.HBar(C)}},renderCircle(e,i){var l,s,n=this.widget,o=n.store,a=this.getColumns()[e],d=a.index,h=this.el.select(`.${r}`).item(e),g=h.select(`.${t} .${c}`),u=n.cellHeight-4;function p(e,t){const i="http://www.w3.org/2000/svg",l=document.createElementNS(i,"svg:svg");l.setAttribute("width",t),l.setAttribute("height",t),l.setAttribute("viewBox","0 0 "+t+" "+t);const r=document.createElementNS(i,"circle");r.setAttributeNS(null,"cx",t/2),r.setAttributeNS(null,"cy",t/2),r.setAttributeNS(null,"r",t/2);let s="#F0F0F0";t>50&&(s="F0F0F0"),e<0&&(s="#F9DDE0"),r.setAttributeNS(null,"fill",s),l.appendChild(r);var n=document.createElementNS(i,"path"),o=e*(2*Math.PI/100)-.001,a=t/2+t/2*Math.sin(0),d=t/2-t/2*Math.cos(0),c=t/2+t/2*Math.sin(o),h=t/2-t/2*Math.cos(o),g=0;o-0>Math.PI&&(g=1);var u="M "+t/2+","+t/2+" L "+a+","+d+" A "+t/2+","+t/2+" 0 "+g+" 1 "+c+","+h+" Z";n.setAttribute("d",u),e<0?n.setAttribute("fill","#EA7369"):n.setAttribute("fill","#44A4D3"),l.appendChild(n);const p=document.createElementNS(i,"circle");return p.setAttributeNS(null,"cx",t/2),p.setAttributeNS(null,"cy",t/2),p.setAttributeNS(null,"r",.25*t),p.setAttributeNS(null,"fill","#fff"),l.appendChild(p),l}if(h.addCls(C),void 0!==i?(l=i,s=i+1):(l=0,s=o.getLength()),n.infinite){const e=n.getNumOfVisibleCells();s>e&&(s=e)}for(;l<s;l++){var m,f=o.get(l),v={rowIndex:l,data:f,style:{}};m=a.smartIndexFn?a.smartIndexFn(f):o.get(l,d),v.value=m,a.render&&(m=(v=a.render(v)).value);const e=g.item(l).dom;""===e.innerHTML&&e.appendChild(p(m,u))}},removeNotUsedCells(){for(var e=this.widget.store,i=this.el.select("."+r),l=0,s=i.length;l<s;l++)for(var n=i.item(l).select("."+t),o=e.getLength(),a=n.length;o<a;o++)n.item(o).remove()},getFormat(t){const i=this.widget.lang;switch(t){case"number":return function(e,t){if(void 0===e)return"";const l=e.toString().split(i.decimalSeparator);if(t=t||0,l[0]=l[0].replace(/\B(?=(\d{3})+(?!\d))/g,i.thousandSeparator),l[1]){if(t>0){if(l[1].length<t){for(var r="",s=l[1].length;s<t;s++)r+="0";return l[0]+i.decimalSeparator+l[1]+r}return l[1]=String(l[1]).substring(0,t),l[0]+i.decimalSeparator+l[1]}return l[0]}if(t>0&&""!==l[0]){for(r="",s=0;s<t;s++)r+="0";return l[0]+i.decimalSeparator+r}return l[0]};case"date":return function(l){const r=e.Date.parse(l,i.date.read,t.mode);return l=e.Date.format(r,i.date.write,t.mode)}}switch(t.type){case"date":return function(i){let l;return i&&0!==i.length?(l=e.isDate(i)?i:e.Date.parse(i,t.read,t.mode),i=e.Date.format(l,t.write,void 0,t.mode)):""}}},format(t,i,l){switch(e.typeOf(i)){case"string":t=this.getFormat(i)(t,l);break;case"function":t=i(t);break;case"object":const r=this.getFormat(i);r&&(t=r(t))}return t},enableCellDirty(e){e.hasCls(h)||(e.addCls(h),e.append('<div class="'+g+'"></div>'))},clearDirty(e){const i=this;if(void 0!==e)return i.el.select("."+t+'[index="'+e+'"] .'+g).destroy(),void i.el.select("."+h+'[index="'+e+'"]').removeCls(h);i.el.select(`.${g}`).destroy(),i.el.select(`.${h}`).removeCls(h)},showEmptyText:function(){const t=this,i=t.widget,l=i.store;if("center"===t.side&&(t.emptyTextEl&&(t.emptyTextEl.destroy(),delete t.emptyTextEl),0===l.dataView.length)){const l=e.get(document.createElement("div"));l.addCls(p),l.update(i.emptyText),t.emptyTextEl=e.get(t.el.dom.appendChild(l.dom))}}}}(),function(){const e=Fancy,t=e.GRID_CELL_CLS,i=e.GRID_CELL_INNER_CLS,l=e.GRID_COLUMN_CLS,r=e.GRID_BODY_CLS,s=e.GRID_CELL_WRAPPER_CLS,n=e.GRID_COLUMN_SELECT_CLS,o=e.GRID_COLUMN_ELLIPSIS_CLS,a=e.GRID_COLUMN_ORDER_CLS,d=e.GRID_COLUMN_TEXT_CLS,c=e.GRID_COLUMN_TREE_CLS,h=e.GRID_COLUMN_SPARKLINE_CLS,g=e.GRID_COLUMN_CHART_CIRCLE_CLS,u=e.GRID_COLUMN_SPARK_PROGRESS_DONUT_CLS,p=e.GRID_COLUMN_GROSSLOSS_CLS,m=e.GRID_COLUMN_PROGRESS_CLS,f=e.GRID_COLUMN_H_BAR_CLS,C=e.GRID_COLUMN_ROW_DRAG_CLS,v=e.GRID_ROW_EXPAND_CLS,y=e.ANIMATE_DURATION,w={sparklineline:h,sparklinebar:h,sparklinetristate:h,sparklinediscrete:h,sparklinebullet:h,sparklinepie:h,sparklinebox:h,circle:g,progressdonut:u,grossloss:p,progressbar:m,hbar:f};e.define("Fancy.grid.Body",{extend:e.Widget,mixins:[e.grid.body.mixin.Updater],cls:r,cellTpl:['<div class="'+i+'">{cellValue}</div>'],cellWrapperTpl:['<div class="'+s+'">','<div class="'+i+'">{cellValue}</div>',"</div>"],constructor:function(){this.Super("const",arguments)},init(){const e=this;e.Super("init",arguments),e.addEvents("adddomcolumns"),e.initTpl(),e.render(),e.ons()},initTpl(){this.cellTpl=new e.Template(this.cellTpl),this.cellWrapperTpl=new e.Template(this.cellWrapperTpl)},ons(){const i=this,r=i.widget,s=r.id;r.on("afterrender",i.onAfterRender,i);const n=`.${l}[grid="${s}"]`,o=`${n} div.${t}`;i.el.on("click",i.onCellClick,i,o),Fancy.isTouch||i.el.on("dblclick",i.onCellDblClick,i,o),i.el.on("mouseenter",i.onCellMouseEnter,i,o),i.el.on("mouseleave",i.onCellMouseLeave,i,o),e.isTouch?i.el.on("touchend",i.onCellMouseDown,i,o):i.el.on("mousedown",i.onCellMouseDown,i,o),i.el.on("mouseenter",i.onColumnMouseEnter,i,n),i.el.on("mouseleave",i.onColumnMouseLeave,i,n),e.isTouch?i.initTouchContextMenu(o):i.el.on("contextmenu",i.onContextMenu,i,o),i.el.on("mouseleave",i.onBodyLeave,i)},render(){let t,i=this.widget,l=e.get(document.createElement("div"));l.addCls(r),l.attr("role","presentation"),t=i.el.select(`.fancy-grid-${this.side}`).dom,this.el=e.get(t.appendChild(l.dom))},onAfterRender(){const e=this,t=e.widget,i=t.store;("left"!==e.side||t.leftColumns.length)&&("right"!==e.side||t.rightColumns.length)&&(!t.grouping||t.grouping&&!t.grouping.by?t.state&&t.state.startState&&(t.state.startState.sorters||t.state.startState.filters||void 0!==t.state.startState.page)?e.update("waitstate"):e.update():t.grouping&&"server"===i.proxyType&&e.update(),e.setHeight())},setColumnsPosition(t,i){var r=this.widget,s=this.getColumns(),n=0,o=s.length,a=0,d=this.el.select(`.${l}[grid="${r.id}"]`);for(a+=t=t||this.scrollLeft||0;n<o;n++){const t=s[n],l=d.item(n);i&&!e.nojQuery?l.animate({left:a+"px"},e.ANIMATE_DURATION):l.css({left:a+"px"}),t.hidden||(a+=t.width)}},wheelScroll(e){const t=this.widget,i=(t.store,t.knobOffSet),r=this.el.select(`.${l}[grid="${t.id}"]`);if(0!==r.length){var s=parseInt(r.item(0).css("top")),n=0,o=r.length,a=t.getBodyHeight(),d=t.getCellsViewHeight()-a+i,c={oldScroll:parseInt(r.item(0).css("top")),newScroll:parseInt(r.item(0).css("top"))+30*e,deltaScroll:30*e};for(d<0&&(d=0);n<o;n++){let t=r.item(n),l=parseInt(t.css("top"))+30*e;l>0?(l=0,c.newScroll=0):Math.abs(l)>d&&(l=-d-i,c.newScroll=l),l>0&&(l=0),t.css("top",l+"px")}return c.scrolled=s!==parseInt(r.item(0).css("top")),c}},scroll(e,t,i){var r=this,s=r.widget,n=s.scroller,o=s.store,a=r.el.select(`.${l}[grid="${s.id}"]`),d=0,c=a.length,h={};if(!1!==e&&null!==e&&void 0!==e)if(h.scrollTop=e,s.infinite){if(n.scrollTop!==e){const t=Math.round(e/s.cellHeight);if(o.infiniteScrolledToRow!==t){if(o.infiniteScrolledToRow=t,r.infiniteTimeOut){new Date-r.infiniteTimeOutDate<100&&clearInterval(r.infiniteTimeOut)}else r.infiniteTimeOutDate=new Date;r.infiniteTimeOut=setTimeout(function(){s.leftBody.update(),s.body.update(),s.rightBody.update(),clearInterval(r.infiniteTimeOut),delete r.infiniteTimeOut,delete r.infiniteTimeOutDate},1)}}}else for(;d<c;d++){a.item(d).css("top",-e+"px")}return!1!==t&&null!==t&&void 0!==t&&(h.scrollLeft=t,s.header&&s.header.scroll(t,i),r.scrollLeft=t,s.body.setColumnsPosition(t,i),"center"===r.side&&(s.grouping&&s.grouping.by&&s.grouping.scrollLeft(t),s.summary&&s.summary.scrollLeft(t),s.subHeaderFilter&&s.filter.scrollLeft(t))),h},setHeight(){const e=this.widget.getBodyHeight();this.css("height",`${e}px`)},onCellClick(t){const i=this,l=i.widget;if(e.isTouch)if(i.waitForDblClickInt){if(new Date-i.waitForDblClickDate<500)return l.fire("celldblclick",i.getEventParams(t)),l.fire("rowdblclick",i.getEventParams(t)),void l.fire("columndblclick",i.getColumnEventParams(t));delete i.waitForDblClickInt,delete i.waitForDblClickDate}else i.waitForDblClickDate=new Date,i.waitForDblClickInt=setTimeout(function(){delete i.waitForDblClickInt,delete i.waitForDblClickDate},500);l.fire("cellclick",i.getEventParams(t)),l.fire("rowclick",i.getEventParams(t)),l.fire("columnclick",i.getColumnEventParams(t)),!1===l.activated&&(l.activated=!0,l.fire("activate"))},onCellDblClick(e){const t=this.widget;t.fire("celldblclick",this.getEventParams(e)),t.fire("rowdblclick",this.getEventParams(e)),t.fire("columndblclick",this.getColumnEventParams(e))},getEventParams(t){const i=this.widget.store,l=this.getColumns(),r=t.currentTarget,s=e.get(t.currentTarget),n=s.parent();if(void 0===s.parent().dom)return!1;if(0===i.getLength())return!1;if(void 0===n.attr("index"))return!1;const o=i.infiniteScrolledToRow||0;let a=parseInt(n.attr("index")),d=parseInt(s.attr("index")),c=l[a],h=c.index,g=i.get(d+o,h),u=i.getId(d+o),p=i.get(d+o),m=i.getById(u);return c.smartIndexFn&&(g=c.smartIndexFn(p)),{e:t,id:u,side:this.side,cell:r,column:c,rowIndex:d,infiniteRowIndex:d+o,columnIndex:a,value:g,data:p,item:m}},getColumnEventParams(t){const i=this.widget,l=i.store,r=e.get(t.currentTarget),s=r.parent(),n=parseInt(s.attr("index")),o=this.getColumns()[n],a={e:t,side:this.side,columnIndex:n,column:o,columnDom:s.dom,cell:r.dom};return i.columnClickData&&(a.data=l.getColumnData(o.index,o.smartIndexFn)),a},getColumnHoverEventParams(i){let l=e.get(i.currentTarget),r=parseInt(l.attr("index")),s=this.getColumns()[r],n=i.target;return e.get(n).hasCls(t)||(n=e.get(n).parent("."+t).dom),{e:i,side:this.side,columnIndex:r,column:s,columnDom:l.dom,cell:n}},getColumns(){return this.widget.getColumns(this.side)},onCellMouseEnter(t){const i=this,l=i.widget,r=i.getEventParams(t),s=i.prevCellOver;e.nojQuery&&s&&i.fixZeptoBug&&(r.rowIndex===s.rowIndex&&r.columnIndex===s.columnIndex&&r.side===s.side||(l.fire("cellleave",s),r.rowIndex!==s.rowIndex&&l.fire("rowleave",s))),s?r.rowIndex!==i.prevCellOver.rowIndex&&l.fire("rowenter",r):l.fire("rowenter",r),l.fire("cellenter",r),i.prevCellOver=r},onCellMouseDown(t){const i=this.widget,l=this.getEventParams(t),r={e:l.e,side:l.side,columnDom:e.get(l.cell).parent().dom,column:l.column,columnIndex:l.columnIndex,cell:l.cell};2===t.button&&2===t.buttons||3===t.which||(i.fire("beforecellmousedown",l),i.fire("cellmousedown",l),i.fire("columnmousedown",r),!1===i.activated&&(i.activated=!0,i.fire("activate")))},onCellMouseLeave(t){const i=this,l=i.widget,r=i.getEventParams(t),s=i.prevCellOver;if(e.nojQuery){if(r.rowIndex+1===l.getDataView().length){const e=r.cell.getBoundingClientRect();if(t.clientY>e.top+e.height-2)return l.fire("rowleave",s),l.fire("cellleave",s),void delete i.prevCellOver}if(void 0===s)return;i.fixZeptoBug=r}else l.fire("rowleave",s),l.fire("cellleave",s),delete i.prevCellOver},onColumnMouseEnter(e){const t=this,i=t.widget,l=t.getColumnHoverEventParams(e);t.prevColumnOver?t.prevCellOver&&l.rowIndex!==t.prevCellOver.rowIndex&&i.fire("rowenter",l):i.fire("columnenter",l),t.prevColumnOver=l},onColumnMouseLeave(){this.widget.fire("columnleave",this.prevColumnOver),delete this.prevColumnOver},getCell(e,i){const r=this.widget;return this.el.select("."+l+'[index="'+i+'"][grid="'+r.id+'"] .'+t+'[index="'+e+'"]')},getDomCell(e,i){const r=this.widget;return this.el.select("."+l+'[index="'+i+'"][grid="'+r.id+'"] .'+t+'[index="'+e+'"]').dom},getDomColumn(e){const t=this.widget;return this.el.select("."+l+'[index="'+e+'"][grid="'+t.id+'"]').dom},destroy(){const i=this,r=i.el,s="div."+t,n="div."+l;r.un("click",i.onCellClick,i,s),Fancy.isTouch||r.un("dblclick",i.onCellDblClick,i,s),r.un("mouseenter",i.onCellMouseEnter,i,s),r.un("mouseleave",i.onCellMouseLeave,i,s),e.isTouch?r.un("touchend",i.onCellMouseDown,i,s):r.un("mousedown",i.onCellMouseDown,i,s),r.un("mouseenter",i.onColumnMouseEnter,i,n),r.un("mouseleave",i.onColumnMouseLeave,i,n)},hideColumn(e){var t=this.widget,i=this.getColumns(),r=this.el.select("."+l),s=r.item(e),n=0,o=i.length,a=0;for("center"===this.side&&(a-=t.scroller.scrollLeft),s.hide();n<o;n++){s=r.item(n);var d=i[n],c=parseInt(s.css("left"));d.hidden||(c!==a&&(s.stop(),s.animate({left:a},y)),a+=d.width)}},showColumn(t,i){var r=this.widget,s=this.getColumns(),n=this.el.select("."+l),o=n.item(t),a=0,d=0,c=s.length;for("center"===this.side&&(a-=r.scroller.scrollLeft),e.isNumber(i)&&o.css("width",i+"px"),o.show();d<c;d++){o=n.item(d);parseInt(o.css("left"));const e=s[d];e.hidden||(o.stop(),o.animate({left:a},y),a+=e.width)}},removeColumn(e){var t=this.el.select("."+l),i=t.item(e),r=parseInt(i.css("width")),s=e+1,n=t.length;for(i.destroy();s<n;s++){const e=t.item(s),i=parseInt(e.css("left"))-r;e.attr("index",s-1),e.css("left",i)}},insertColumn(t,i){var r,s=this,h=s.widget,g=s.getColumns(),u=s.el.select("."+l),p=i.width,m=e.get(document.createElement("div")),f=t,v=u.length,y=0,w=0,b=t;for("center"===s.side&&(y=-h.scroller.scrollLeft);w<b;w++)g[w].hidden||(y+=g[w].width);for(r=y;f<v;f++){if(g[f].hidden)continue;const e=u.item(f);y=parseInt(e.css("left"))+i.width,e.css("left",y),e.attr("index",f+1)}if(m.attr("role","presentation"),m.addCls(l),m.attr("grid",h.id),"$selected"===i.index||i.select)m.addCls(n);else switch(i.type){case"order":m.addCls(a);break;case"rowdrag":m.addCls(C)}if(i.cls&&m.addCls(i.cls),"tree"===i.type&&(m.addCls(c),i.folder&&m.addCls("fancy-grid-tree-column-folder")),"text"===i.type&&m.addCls(d),m.css({width:p+"px"}),m.attr("index",t),i.cellAlign&&m.css("text-align",i.cellAlign),!0===i.ellipsis)switch(i.type){case"string":case"text":case"number":case"date":case"combo":case"tree":m.addCls(o)}const x=h.scroller.getScroll();m.css("top",-x),0===t&&u.length?(m.css("left","0px"),s.el.dom.insertBefore(m.dom,u.item(t).dom)):0!==t&&u.length?t===u.length?(m.css("left",y+"px"),s.el.dom.appendChild(m.dom)):(m.css("left",r+"px"),s.el.dom.insertBefore(m.dom,u.item(t).dom)):(m.css("left",y+"px"),s.el.dom.appendChild(m.dom)),s.checkDomCells(),s.updateRows(void 0,t)},reSetIndexes(){this.el.select(`.${l}`).each((e,t)=>{e.attr("index",t)})},clearColumnsStyles(){this.el.select(`div.${t}`).each(e=>{e.css("color",""),e.css("background-color","")})},updateColumnsSizes(){let t=this,i=t.widget,r=t.getColumns(),s=0;"center"===t.side&&(s=-i.scroller.scrollLeft),e.each(r,(e,i)=>{if(e.hidden)return;const r=t.el.select(`.${l}[index="${i}"]`);Fancy.nojQuery?r.css({width:e.width,left:s}):(r.$dom.stop(),r.animate({width:e.width,left:s},y,void 0,()=>{r.css("overflow","")})),s+=e.width})},reSetColumnsAlign(){const e=this.getColumns();this.el.select(`.${l}`).each(function(t,i){const l=e[i];t.css("text-align",l.cellAlign||"")})},reSetColumnsCls(){const t=this.getColumns();this.el.select(`.${l}`).each((i,r)=>{const s=t[r],d=i.attr("class").split(" ");if(e.each(d,e=>{switch(e){case l:case s.cls:case w[s.type]:break;default:i.removeCls(e)}}),s.cls&&i.addCls(s.cls),s.ellipsis)switch(s.type){case"checkbox":break;default:i.addCls(o)}switch(s.type){case"order":i.addCls(a);break;case"select":i.addCls(n);break;case"rowdrag":i.addCls(C);break;case"tree":i.addCls(c),s.folder&&i.addCls("fancy-grid-tree-column-folder")}s.select&&i.addCls(n),s.rowdrag&&i.addCls(C)})},initTouchContextMenu(e){this.el.on("touchstart",this.onTouchStart,this,e)},onTouchStart(e){const t=this;t.touchEvent=e,t.intTouchStart=setTimeout(()=>{t.touchLongPress=!0},1e3),t.el.once("touchend",t.onTouchEnd,t),t.el.once("touchmove",t.onTouchMove,t)},onTouchEnd(){const e=this,t=e.widget;e.touchLongPress&&t.fire("contextmenu",e.getEventParams(e.touchEvent)),clearInterval(e.intTouchStart),e.el.un("touchmove",e.onTouchMove),delete e.touchLongPress},onTouchMove(){clearInterval(this.intTouchStart),delete this.touchLongPress,this.un("touchend",this.onTouchEnd)},onContextMenu(e){this.widget.fire("contextmenu",this.getEventParams(e))},updateColumnsVisibility(){const e=this.getColumns();this.el.parent().select(`:not(.${v}) .${l}`).each((t,i)=>{e[i].hidden?t.hide():"none"===t.css("display")&&t.show()})},onBodyLeave(){delete this.prevCellOver}})}(),function(){const e=Fancy,t=e.GRID_HEADER_CLS,i=e.GRID_HEADER_CELL_CLS,l=e.GRID_HEADER_CELL_CONTAINER_CLS,r=e.GRID_HEADER_CELL_TEXT_CLS,s=e.GRID_HEADER_CELL_LEFT_IMAGE_CLS,n=e.GRID_HEADER_CELL_CONTAINS_LI,o=e.GRID_HEADER_CELL_TRIGGER_CLS,a=e.GRID_HEADER_CELL_TRIGGER_IMAGE_CLS,d=e.GRID_HEADER_CELL_TRIGGER_DISABLED_CLS,c=e.GRID_HEADER_CELL_GROUP_LEVEL_1_CLS,h=e.GRID_HEADER_CELL_GROUP_LEVEL_2_CLS,g=e.GRID_HEADER_CELL_SELECT_CLS,u=e.GRID_HEADER_CELL_FILTER_FULL_CLS,p=e.GRID_HEADER_CELL_FILTER_SMALL_CLS,m=e.GRID_HEADER_CELL_TRIPLE_CLS,f=e.GRID_HEADER_CELL_CHECKBOX_CLS,C=e.GRID_HEADER_CELL_SORTABLE_CLS,v=e.GRID_HEADER_CELL_NOT_SORTABLE_CLS,y=e.FIELD_CHECKBOX_CLS,w=e.ANIMATE_DURATION;e.define("Fancy.grid.Header",{extend:e.Widget,cls:t,mixins:["Fancy.grid.header.mixin.Menu"],cellTpl:['<div role="columnheader" col-id="{id}" class="'+i+' {cls}" style="display:{display};width:{columnWidth}px;height: {height};left: {left};" {groupIndex} index="{index}">','<div class="'+l+'" style="height: {height};">','<span class="'+s+' {headerLImageCls}">&nbsp;</span>','<span class="'+r+'">{columnName}</span>','<span class="'+o+'">','<div class="'+a+'"></div>',"</span>","</div>","</div>"],constructor:function(){this.Super("const",arguments)},init(){const e=this;e.Super("init",arguments),e.initTpl(),e.render(),e.renderHeaderCheckBox(),e.setAlign(),e.setCellsPosition(),e.ons()},initTpl(){this.cellTpl=new e.Template(this.cellTpl)},ons(){const e=this,t=e.widget,l=e.el,s=`div.${i}`;t.on("render",e.onAfterRender,e),t.on("docmove",e.onDocMove,e),t.on("columndrag",e.onColumnDrag,e),l.on("click",e.onTriggerClick,e,`span.${o}`),l.on("click",e.onCellClick,e,s),l.on("mousemove",e.onCellMouseMove,e,s),l.on("mousedown",e.onCellMouseDown,e,s),l.on("mousedown",e.onMouseDown,e),l.on("dblclick",e.onCellTextDBLClick,e,`.${r}`),l.on("mouseenter",e.onCellMouseEnter,e,s),l.on("mouseleave",e.onCellMouseLeave,e,s)},render(){var t,i=this,l=i.widget,r=i.getColumns(),s=e.get(document.createElement("div")),o="",a=0,h=r.length,m=1,f={},y=0,w=l.filter&&l.filter.header&&!l.subHeaderFilter,b="full",x=l.cellHeaderHeight;for(l.groupheader&&(w&&!l.filter.groupHeader?b="small":m=2),w&&m++;a<h;a++){var S=r[a],I=S.title||S.header,T=x,E="",L="";if(void 0!==I&&""!==I&&" "!==I||(I="&nbsp;"),1!==m)if(S.grouping){if(!f[S.grouping]){const e=l.groupheader.groupsMap[S.grouping];f[S.grouping]={width:0,title:S.grouping,left:y,cls:e.headerCls||""}}T=w&&l.filter.groupHeader?2*x+"px":x+"px",S.hidden||(f[S.grouping].width+=S.width),L='group-index="{column.grouping}"',E=c}else T=m*x+"px";if(y+=S.width,("$selected"===S.index||S.select)&&(E+=" "+g),S.menu||(E+=" "+d),S.filter&&S.filter.header)switch(b){case"small":E+=" "+p;break;case"full":l.subHeaderFilter||(E+=" "+u)}S.headerLImageCls&&(E+=" "+n),S.headerCls&&(E+=" "+S.headerCls),S.sortable?E+=" "+C:E+=" "+v,e.isNumber(T)&&(T+="px");const t={cls:E,columnName:I,columnWidth:S.width,index:a,height:T,left:"initial",groupIndex:L,display:S.hidden?"none":"",id:S.id||"",headerLImageCls:S.headerLImageCls||""};o+=i.cellTpl.getHTML(t)}s.css({height:x*m+"px",width:i.getColumnsWidth()}),s.attr("role","presentation"),s.addCls(i.cls),l.groupheader&&(s.addCls("fancy-grid-header-grouped"),o+=i.getGroupingCellsHTML(f)),s.update(o),t=l.el.select(".fancy-grid-"+i.side).dom,i.el=e.get(t.appendChild(s.dom))},insertCell(t,i){var l,r=this,s=r.widget,n=r.getCells(),o=r.getColumns(),a="",c=i.title||i.header,u=0;if(n.length&&(l=parseInt(n.item(0).css("height"))),l=parseInt(s.header.el.css("height")),"center"===r.side&&(u=-s.scroller.scrollLeft),s.groupheader){const e=r.el.select(`.${h}`);t!==s.columns.length-1&&e.each(e=>{const t=parseInt(e.css("left")||0)+i.width;e.css("left",t)})}("$selected"===i.index||i.select)&&(a+=" "+g),i.menu||(a+=" "+d);for(var p=0,m=t;p<m;p++)o[p].hidden||(u+=o[p].width);"center"===r.side&&(u+=s.scroller.scrollLeft||0),i.headerCls&&(a+=" "+i.headerCls),i.sortable?a+=" "+C:a+=" "+v;var f=r.cellTpl.getHTML({cls:a,columnName:c,columnWidth:i.width,index:t,height:String(l)+"px",left:String(u)+"px",groupIndex:"",id:i.id||""});0===t&&n.length?e.get(n.item(0).before(f)):0!==t&&n.length?t===n.length?r.el.append(f):e.get(n.item(t).before(f)):r.el.append(f);var y=0,w=o.length,b=0;for(u=0,"center"===r.side&&(u-=s.scroller.scrollLeft),n=r.getCells();y<w;y++){if((i=o[y]).hidden)continue;n.item(y).css("left",u),u+=i.width,b+=i.width}const x=parseInt(r.css("width"));x>b&&(b=x),r.css("width",b),s.subHeaderFilter&&s.filter.addSubHeaderFilterCellContainer(r.side),r.reSetColumnsAlign(),r.reSetIndexes(),s.subHeaderFilter&&s.filter.updateSubHeaderFilterSizes()},setAlign(){for(var e=this.getColumns(),t=0,i=e.length;t<i;t++){const i=e[t];i.align&&this.getDomCell(t).css("text-align",i.align)}},onAfterRender(){},setCellsPosition(t){var i=this,l=i.widget,r=i.getColumns(),s=0,n=i.getCells();if(s+=i.scrollLeft||0,e.each(r,(e,t)=>{let i=n.item(t),r="0px";e.grouping&&(r=l.cellHeaderHeight+"px"),i.css({top:r,left:s+"px"}),e.hidden||(s+=e.width)}),l.groupheader){i.el.select(`.${h}`).each(function(l){const s=l.attr("index");i.el.select('[group-index="'+s+'"]');var n=i.scrollLeft||0,o=0;e.each(r,e=>{if(e.grouping===s)return!0;e.hidden||(n+=e.width)}),e.each(r,e=>{e.grouping!==s||e.hidden||(o+=e.width)}),t&&!e.nojQuery?(l.css({left:n,width:o}),0===o&&l.css({display:"none"})):l.css({left:n,width:o})})}},fixGroupHeaderSizing(){var t=this,i=t.widget,r=i.cellHeaderHeight,s=t.getColumns(),n=t.getCells(),o=0,a={},d={},g={},m=t.calcRows(),f=i.filter&&i.filter.header&&!i.subHeaderFilter,C=!1;"center"===t.side&&(o=i.scroller.scrollLeft),f&&e.each(s,e=>{e.grouping&&e.filter&&e.filter.header&&(C=!0)}),e.each(s,(e,t)=>{var s=n.item(t),h=e.grouping,v="0px",y=r*m;a[h]=!0,h?(void 0===d[h]?(d[h]=e.width,g[h]=o):d[h]+=e.width,s.addCls(c),v=r+"px",y=r,C&&(y=2*r),e.filter&&e.filter.header&&f&&setTimeout(function(){s.addCls(u)},30)):(s.removeCls(c),e.filter&&e.filter.header&&f&&(setTimeout(function(){s.addCls(p)},30),s.addCls(p))),!i.groupheader||y!==r||h||e.filter||f||(y=2*r),s.css({top:v,height:y}),s.select(`.${l}`).css({height:y}),o+=e.width});for(const e in d){t.el.select(`[index="${e}"]`).css({left:g[e],width:d[e]})}t.el.select(`.${h}`).each(e=>{const t=e.attr("index");a[t]||e.destroy()})},getColumnsWidth(){for(var e=this.getColumns(),t=0,i=0,l=e.length;i<l;i++){t+=e[i].width}return t},getColumns(){let e,t=this,i=t.widget;switch(t.side){case"left":e=i.leftColumns;break;case"center":e=i.columns;break;case"right":e=i.rightColumns}return e},getDomCell(e){return this.getCells().item(e)},onCellClick(t){const i=this,l=i.widget,r=l.columndrag,s=t.currentTarget,n=e.get(t.target),d=parseInt(e.get(s).attr("index")),c=i.getColumns()[d];r&&"dragging"===r.status||n.hasCls(o)||n.hasCls(a)||e.get(s).hasCls(h)||i.textDBLClick||(c.titleEditable?setTimeout(()=>{i.textDBLClick?setTimeout(()=>{delete i.textDBLClick},400):l.fire("headercellclick",{e:t,side:i.side,cell:s,index:d,column:c})},300):l.fire("headercellclick",{e:t,side:i.side,cell:s,index:d,column:c}))},onCellMouseMove(t){const i=this.widget,l=t.currentTarget,r=e.get(l).hasCls(h),s=parseInt(e.get(l).attr("index"));r||i.fire("headercellmousemove",{e:t,side:this.side,cell:l,index:s})},onMouseDown(t){"INPUT"===e.get(t.target).prop("tagName")||t.preventDefault()},onCellMouseDown(t){const i=this.widget,l=t.currentTarget,r=parseInt(e.get(l).attr("index"));i.fire("headercellmousedown",{e:t,side:this.side,cell:l,index:r})},scroll(e,t){this.scrollLeft=e,this.setCellsPosition(t)},getGroupingCellsHTML(t){var i=this,l=i.widget,r="";return e.each(t,(e,t)=>{r+=i.cellTpl.getHTML({cls:h+" "+e.cls,columnName:e.title,columnWidth:e.width,index:t,height:l.cellHeaderHeight+"px",left:e.left+"px",groupIndex:"",id:e.id||""})}),r},destroy(){const e=this,t=e.el,l=`div.${i}`;t.un("click",e.onCellClick,e,l),t.un("mousemove",e.onCellMouseMove,e,l),t.un("mousedown",e.onCellMouseDown,e,l),t.un("mousedown",e.onMouseDown,e),t.un("mouseenter",e.onCellMouseEnter,e,l),t.un("mouseleave",e.onCellMouseLeave,e,l)},getCell(e){return this.el.select(`.${i}[index="${e}"]`)},onTriggerClick(t){const i=e.get(t.currentTarget).parent().parent(),l=parseInt(i.attr("index")),r=this.getColumns(),s=r[l];t.stopPropagation(),this.showMenu(i,l,s,r)},hideCell(t){var i=this,l=i.widget,r=i.getCells(),s=r.item(t),n=parseInt(s.css("width")),o=0,a=r.length,d=i.getColumns();if(s.hasCls(c)){const e=s.attr("group-index"),t=i.el.select(`.${h}[index="${e}"]`).item(0),l=parseInt(t.css("width"));t.stop(),l-n==0?t.css({display:"none",width:l-n}):t.animate({width:l-n},w)}s.hide();var g={},u=0,p=0;for("center"===i.side&&(u-=p=l.scroller.scrollLeft);o<a;o++){const e=r.item(o),i=parseInt(e.css("left")),l=d[o];l.hidden||(l.grouping&&d[t].grouping!==l.grouping&&(g[l.grouping]=!0),i!==u&&(e.stop(),e.animate({left:u},w)),u+=l.width)}e.each(g,(t,r)=>{var s=i.el.select("."+h+'[index="'+r+'"]').item(0),n=0;"center"===i.side&&(p=l.scroller.scrollLeft,n-=p),e.each(d,e=>{if(!e.hidden)return e.grouping===r||void(n+=e.width)}),s.stop(),s.animate({left:n},w)})},showCell(t,i){var l,r=this,s=r.widget,n=r.getCells(),o=n.item(t),a=0,d=0,g=n.length,u=r.getColumns();if(e.isNumber(i)&&o.css("width",`${i}px`),o.show(),l=parseInt(o.css("width")),o.hasCls(c)){const e=o.attr("group-index"),t=r.el.select("."+h+'[index="'+e+'"]').item(0),i=parseInt(t.css("width"));t.stop(),"none"===t.css("display")&&t.show(),t.animate({width:i+l},w)}let p=0;"center"===r.side&&(a-=p=s.scroller.scrollLeft);const m={};for(;d<g;d++){const e=n.item(d),i=(parseInt(e.css("left")),u[d]);i.hidden||(i.grouping&&u[t].grouping!==i.grouping&&(m[i.grouping]=!0),e.stop(),e.animate({left:a},w),a+=i.width)}e.each(m,(t,i)=>{var l=r.el.select("."+h+'[index="'+i+'"]').item(0),n=0;"center"===r.side&&(p=s.scroller.scrollLeft,n-=p),e.each(u,e=>{if(!e.hidden)return e.grouping===i||void(n+=e.width)}),l.stop(),l.animate({left:n},w)})},removeCell(e){var t=this,i=t.widget,l=t.getCells(),r=l.item(e),s=parseInt(r.css("width")),n=e+1,o=l.length,a={},d=!1;for(r.attr("group-index")&&(a[d=r.attr("group-index")]=!0),r.destroy();n<o;n++){const e=l.item(n),t=parseInt(e.css("left"))-s;e.attr("group-index")&&(a[e.attr("group-index")]=!0),e.attr("index",n-1),e.css("left",t)}for(const e in a){var c=t.el.select(`[index="${e}"]`),h=parseInt(c.css("width"))-s,g=parseInt(c.css("left"))-s;d&&c?(c.css("width",h),c.attr("index")!==d&&c.css("left",g)):c.css("left",g)}d&&0===t.el.select(`[group-index="${d}"]`).length&&(c=t.el.select(`[index="${d}"]`)).destroy(),"center"!==t.side&&t.css("width",parseInt(t.css("width"))-s),i.subHeaderFilter&&i.filter.removeSubHeaderCell(t.side,e),t.reSetIndexes()},renderHeaderCheckBox(){for(var t=this.widget,i=this.getColumns(),l=0,s=i.length,n=this.getCells();l<s;l++){const s=i[l];if(e.isObject(s.headerCheckBox)){var o=s.headerCheckBox.el,a=o.attr("id");(o=e.get(a)).dom||(s.headerCheckBox=!0)}if(!0===s.headerCheckBox&&"select"!==s.type){var d=n.item(l),c=d.firstChild(),h=d.select(`.${r}`),u=!!s.title&&s.title,p=0;switch(s.type){case"checkbox":case"switcher":d.addCls(f);break;case"select":d.addCls(g)}h.update(""),u.length&&(p=15*u.width),s.headerCheckBox=new e.CheckBox({renderTo:c.dom,renderId:!0,labelWidth:p,value:!1,label:!1,labelAlign:"right",style:{padding:"0px",display:"inline-block"},events:[{change:(e,i)=>{for(var l=0,r=t.getViewTotal();l<r;l++)t.set(l,s.index,i)}}]})}}},reSetIndexes(){const e=this,t=e.widget,l=e.getCells(),r=e.getColumns();if(l.each((e,t)=>{e.attr("index",t);const i=r[t];e.attr("col-id",i.id)}),t.subHeaderFilter){t.filter.getSubHeaderFilterEl(e.side).select(`.${i}`).each((e,t)=>{e.attr("index",t)})}},reSetGroupIndexes(){const e=this.getColumns();this.getCells().each((t,i)=>{const l=e[i].grouping;t.attr("group-index")&&!l?t.removeAttr("group-index"):l&&t.attr("group-index")!==l&&t.attr("group-index",l)})},updateTitles(){const t=this,l=t.getColumns();e.each(l,(e,l)=>{e.headerCheckBox||t.el.select("div."+i+'[index="'+l+'"] .'+r).update(e.title||"")})},updateCellsSizes(){var t=this,l=t.widget,r=t.getColumns(),s=0;"center"===t.side&&(s=l.nativeScroller?-l.body.el.dom.scrollLeft:-l.scroller.scrollLeft),e.each(r,(e,l)=>{if(e.hidden)return;const r=t.el.select(`div.${i}[index="${l}"]`),n=parseInt(r.css("left")),o=parseInt(r.css("width"));n!==s||o!==e.width?(Fancy.nojQuery?r.css({width:e.width,left:s}):r.animate({width:e.width,left:s},w),s+=e.width):s+=e.width})},calcRows(){var e=this.widget,t=e.columns.concat(e.leftColumns).concat(e.rightColumns),i=1;if(Fancy.each(t,t=>{t.grouping&&(i<2&&(i=2),t.filter&&t.filter.header&&!e.subHeaderFilter&&i<3&&(i=3)),t.filter&&t.filter.header&&!e.subHeaderFilter&&i<2&&(i=2)}),e.groupheader&&2===i){e.el.select(`.${m}`).length&&(i=3)}return i},reSetColumnsAlign(){const e=this.getColumns();this.getCells().each((t,i)=>{const l=e[i];t.css("text-align",l.align||"")})},destroyMenus(){},onDocMove(){const e=this,t=e.widget;("none"===t.el.css("display")||t.panel&&t.panel.el&&"none"===t.panel.el.css("display")&&e.hideMenu)&&e.hideMenu()},reSetColumnsCls(){const t=this.getColumns(),i=this.getCells(),l=[];e.each(t,e=>{e.headerCls&&l.push(e.headerCls),e.sortable?l.push(C):l.push(v)}),i.each((i,r)=>{const s=t[r];e.each(l,e=>{i.removeCls(e)}),s.headerCls&&i.addCls(s.headerCls),s.sortable?i.addCls(C):i.addCls(v),s.menu?i.removeCls(d):i.addCls(d)})},updateCellsVisibility(){const e=this.getColumns();this.getCells().each((t,i)=>{e[i].hidden?t.hide():"none"===t.css("display")&&t.show()})},reSetCheckBoxes(){const t=this.getColumns(),i=this.getCells();e.each(t,(t,l)=>{const r=i.item(l),s=r.select(`.${y}`);if(s.length){if("select"===t.type||t.select)return;const i=e.getWidget(s.item(0).attr("id"));switch(r.removeCls(f),r.removeCls(g),t.type){case"select":r.addCls(g);break;case"checkbox":r.addCls(f);break;default:t.headerCheckBox||i.destroy()}}}),this.renderHeaderCheckBox()},onCellTextDBLClick(e){const t=this,i=t.widget,l=Fancy.get(e.target).parent().parent(),r=l.attr("index"),s=t.getColumns()[r],n=s.title;s.titleEditable&&(t.textDBLClick=!0,t.activeEditColumnField&&(t.activeEditColumnField.destroy(),delete t.activeEditColumnField),t.activeEditColumnField=new Fancy.StringField({renderTo:t.el.dom,label:!1,theme:i.theme,padding:"0px 0px 0px",width:s.width+1,value:s.title||"",inputHeight:i.cellHeaderHeight+1,events:[{enter(e){e.destroy()}},{esc(e){i.setColumnTitle(s.index,n,t.side),e.destroy(),delete t.activeEditColumnField}},{input(e,l){i.setColumnTitle(s.index,l,t.side),delete t.activeEditColumnField}},{render(e){e.focus(),delete t.activeEditColumnField}}],style:{position:"absolute",top:-1,left:parseInt(l.css("left"))-1}}),i.once("scroll",()=>{t.activeEditColumnField&&(t.activeEditColumnField.destroy(),delete t.activeEditColumnField)}))},onCellMouseEnter(t){const i=this,l=i.widget,r=i.getEventParams(t),s=i.prevCellOver;if(e.nojQuery&&s&&i.fixZeptoBug){if(r.columnIndex===s.columnIndex&&r.side===s.side)return;l.fire("headercellleave",s)}l.fire("headercellenter",r),i.prevCellOver=r},onCellMouseLeave(t){const i=this,l=i.widget,r=i.getEventParams(t),s=i.prevCellOver;if(t.toElement&&i.el.within(t.toElement)||(l.fire("headercellleave",s),delete i.prevCellOver),e.nojQuery){if(void 0===s)return;i.fixZeptoBug=r}else l.fire("headercellleave",s),delete i.prevCellOver},getEventParams(t){const i=this.widget.store,l=this.getColumns(),r=t.currentTarget,s=e.get(t.currentTarget);if(void 0===s.parent().dom)return!1;if(0===i.getLength())return!1;if(void 0===s.attr("index"))return!1;const n=parseInt(s.attr("index")),o=l[n];return{e:t,side:this.side,cell:r,column:o,columnIndex:n}},updateLImages(){const t=this.getCells(),i=this.getColumns();t.each(t=>{const l=t.attr("index"),r=i[l],o=r.headerLImageCls,a=t.select(`.${s}`),d=a.getCls();e.each(d,e=>{e!==s&&(o&&e===r.headerLImageCls||a.removeCls(e))}),o?(a.addCls(o),t.addCls(n)):t.removeCls(n)})},getCells(){return this.el.select(`.${i}:not(.${h})`)},onColumnDrag(){this.reSetIndexes()}})}();