Fancy.Mixin("Fancy.store.mixin.Paging",{initPaging:function(){var a=this;void 0!==a.paging&&(Fancy.isObject(a.paging)&&Fancy.apply(a,a.paging),a.calcPages(),a.changeDataView())},firstPage:function(){var a=this;a.calcPages(),a.showPage=0,"server"===a.pageType?a.loadPage():a.changeDataView()},prevPage:function(){var a=this;a.calcPages(),a.showPage--,a.showPage<0&&(a.showPage=0),"server"===a.pageType?a.loadPage():a.changeDataView()},nextPage:function(){var a=this;a.calcPages(),a.showPage++,a.showPage===a.pages&&a.showPage--,a.showPage<0&&(a.showPage=0),"server"===a.pageType?a.loadPage():a.changeDataView()},lastPage:function(){var a=this;a.calcPages(),a.showPage=a.pages-1,a.showPage<0&&(a.showPage=0),"server"===a.pageType?a.loadPage():a.changeDataView()},calcPages:function(){var a=this;if("server"===a.pageType){var b=a.pages;if(a.pages=Math.ceil(a.getTotal()/a.pageSize),!isNaN(b)&&b>a.pages)return a.showPage--,a.showPage<0&&(a.showPage=0),"needs reload"}else a.pages=Math.ceil(a.getTotal()/a.pageSize);a.showPage>=a.pages&&(a.showPage=a.pages-1),a.showPage<0&&(a.showPage=0),a.fire("changepages")},setPage:function(a){var b=this;b.showPage=a,b.showPage===b.pages&&b.showPage--,b.showPage<0&&(b.showPage=0),"server"===b.pageType?b.loadPage():b.changeDataView()},processPagingData:function(a){var b=this;b.checkPagingType(a),b.setData(a[b.readerRootProperty]),b.changeDataView(),"needs reload"===b.calcPages()&&b.loadPage()},checkPagingType:function(a){var b=this;void 0!==a.totalCount&&a.totalCount!==a[b.readerRootProperty].length&&(b.totalCount=a.totalCount,b.pageType="server",void 0===b.remoteSort&&(b.remoteSort=!0))},loadPage:function(){var a=this;a.loadData()},setPageSize:function(a){var b=this;b.pageSize=a,b.calcPages(),"server"===b.pageType?b.loadPage():b.changeDataView()}}),Fancy.define("Fancy.grid.plugin.Paging",{extend:Fancy.Plugin,ptype:"grid.paging",inWidgetName:"paging",constructor:function(a){var b=this;b.Super("const",arguments)},init:function(){var a=this;a.Super("init",arguments),a.ons()},ons:function(){var a=this,b=a.widget,c=b.store;c.on("change",a.onChangeStore,a),c.on("remove",a.onChangeStore,a),c.on("filter",a.onChangeStore,a),b.on("render",a.onRenderGrid,a)},setPageSize:function(a){var b=this,c=b.widget,d=c.store;d.setPageSize(a)},nextPage:function(){var a=this,b=a.widget,c=b.store;c.nextPage()},lastPage:function(){var a=this,b=a.widget,c=b.store;c.lastPage()},prevPage:function(){var a=this,b=a.widget,c=b.store;c.prevPage()},firstPage:function(){var a=this,b=a.widget,c=b.store;c.firstPage()},onChangeStore:function(a){var b=this,c=b.widget,d=c.store,e=c.panel,f=e._bbar.roles.pagenumber;f.setValue(d.showPage+1),b.updateBar(),c.setSidesHeight(),c.fire("changepage")},setPage:function(a){var b=this,c=b.widget,d=c.store;d.setPage(a)},updateBar:function(){var a=this,b=a.widget,c=b.store,d=c.showPage,e=c.pageSize,f=c.pages,g=b.panel,h=g._bbar.roles,i=h.pagenumber,j=h.ofText,k=h.info,l=h.first,m=h.prev,n=h.next,o=h.last,p=d*e+1,q=p+e,r=c.getTotal()||0,s=b.lang;q>r&&(q=r),0===q&&(p=0),i.setValue(c.showPage+1),j.el.update(Fancy.String.format(s.paging.of,[f||1])),k.el.update(Fancy.String.format(s.paging.info,[p,q,r])),0===d?(l.disable(),m.disable()):(l.enable(),m.enable()),f-1===d||0===f?(o.disable(),n.disable()):(o.enable(),n.enable())},onRenderGrid:function(){var a=this;a.updateBar()}});